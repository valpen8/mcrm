/*! For license information please see main.4c477c8c.js.LICENSE.txt */
(()=>{"use strict";var e={730:(e,t,n)=>{var r=n(43),a=n(853);function i(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var s=new Set,o={};function l(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(o[e]=t,e=0;e<t.length;e++)s.add(t[e])}var u=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),h=Object.prototype.hasOwnProperty,d=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f={},p={};function m(e,t,n,r,a,i,s){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=a,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=s}var g={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){g[e]=new m(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];g[t]=new m(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){g[e]=new m(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){g[e]=new m(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){g[e]=new m(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){g[e]=new m(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){g[e]=new m(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){g[e]=new m(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){g[e]=new m(e,5,!1,e.toLowerCase(),null,!1,!1)}));var v=/[\-:]([a-z])/g;function y(e){return e[1].toUpperCase()}function b(e,t,n,r){var a=g.hasOwnProperty(t)?g[t]:null;(null!==a?0!==a.type:r||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,r){if(null===t||"undefined"===typeof t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,a,r)&&(n=null),r||null===a?function(e){return!!h.call(p,e)||!h.call(f,e)&&(d.test(e)?p[e]=!0:(f[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):a.mustUseProperty?e[a.propertyName]=null===n?3!==a.type&&"":n:(t=a.attributeName,r=a.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(a=a.type)||4===a&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(v,y);g[t]=new m(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(v,y);g[t]=new m(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(v,y);g[t]=new m(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!1,!1)})),g.xlinkHref=new m("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!0,!0)}));var w=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,S=Symbol.for("react.element"),T=Symbol.for("react.portal"),E=Symbol.for("react.fragment"),x=Symbol.for("react.strict_mode"),_=Symbol.for("react.profiler"),A=Symbol.for("react.provider"),k=Symbol.for("react.context"),C=Symbol.for("react.forward_ref"),I=Symbol.for("react.suspense"),N=Symbol.for("react.suspense_list"),O=Symbol.for("react.memo"),R=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var D=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var j=Symbol.iterator;function P(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=j&&e[j]||e["@@iterator"])?e:null}var L,M=Object.assign;function F(e){if(void 0===L)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);L=t&&t[1]||""}return"\n"+L+e}var U=!1;function V(e,t){if(!e||U)return"";U=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var r=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){r=c}e.call(t.prototype)}else{try{throw Error()}catch(c){r=c}e()}}catch(c){if(c&&r&&"string"===typeof c.stack){for(var a=c.stack.split("\n"),i=r.stack.split("\n"),s=a.length-1,o=i.length-1;1<=s&&0<=o&&a[s]!==i[o];)o--;for(;1<=s&&0<=o;s--,o--)if(a[s]!==i[o]){if(1!==s||1!==o)do{if(s--,0>--o||a[s]!==i[o]){var l="\n"+a[s].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=s&&0<=o);break}}}finally{U=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?F(e):""}function B(e){switch(e.tag){case 5:return F(e.type);case 16:return F("Lazy");case 13:return F("Suspense");case 19:return F("SuspenseList");case 0:case 2:case 15:return e=V(e.type,!1);case 11:return e=V(e.type.render,!1);case 1:return e=V(e.type,!0);default:return""}}function z(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case E:return"Fragment";case T:return"Portal";case _:return"Profiler";case x:return"StrictMode";case I:return"Suspense";case N:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case k:return(e.displayName||"Context")+".Consumer";case A:return(e._context.displayName||"Context")+".Provider";case C:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case O:return null!==(t=e.displayName||null)?t:z(e.type)||"Memo";case R:t=e._payload,e=e._init;try{return z(e(t))}catch(n){}}return null}function H(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return z(t);case 8:return t===x?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function W(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function G(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function q(e){e._valueTracker||(e._valueTracker=function(e){var t=G(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var a=n.get,i=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(e){r=""+e,i.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function K(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=G(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function Y(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(ys){return e.body}}function Q(e,t){var n=t.checked;return M({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function X(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=W(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function J(e,t){null!=(t=t.checked)&&b(e,"checked",t,!1)}function $(e,t){J(e,t);var n=W(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,W(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Z(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&Y(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,r){if(e=e.options,t){t={};for(var a=0;a<n.length;a++)t["$"+n[a]]=!0;for(n=0;n<e.length;n++)a=t.hasOwnProperty("$"+e[n].value),e[n].selected!==a&&(e[n].selected=a),a&&r&&(e[n].defaultSelected=!0)}else{for(n=""+W(n),t=null,a=0;a<e.length;a++){if(e[a].value===n)return e[a].selected=!0,void(r&&(e[a].defaultSelected=!0));null!==t||e[a].disabled||(t=e[a])}null!==t&&(t.selected=!0)}}function re(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(i(91));return M({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ae(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(i(92));if(te(n)){if(1<n.length)throw Error(i(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:W(n)}}function ie(e,t){var n=W(t.value),r=W(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function se(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function oe(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function le(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?oe(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,ue,he=(ue=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction((function(){return ue(e,t)}))}:ue);function de(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var fe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},pe=["Webkit","ms","Moz","O"];function me(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||fe.hasOwnProperty(e)&&fe[e]?(""+t).trim():t+"px"}function ge(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),a=me(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,a):e[n]=a}}Object.keys(fe).forEach((function(e){pe.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),fe[t]=fe[e]}))}));var ve=M({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ye(e,t){if(t){if(ve[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(i(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(i(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(i(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(i(62))}}function be(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var we=null;function Se(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Te=null,Ee=null,xe=null;function _e(e){if(e=ba(e)){if("function"!==typeof Te)throw Error(i(280));var t=e.stateNode;t&&(t=Sa(t),Te(e.stateNode,e.type,t))}}function Ae(e){Ee?xe?xe.push(e):xe=[e]:Ee=e}function ke(){if(Ee){var e=Ee,t=xe;if(xe=Ee=null,_e(e),t)for(e=0;e<t.length;e++)_e(t[e])}}function Ce(e,t){return e(t)}function Ie(){}var Ne=!1;function Oe(e,t,n){if(Ne)return e(t,n);Ne=!0;try{return Ce(e,t,n)}finally{Ne=!1,(null!==Ee||null!==xe)&&(Ie(),ke())}}function Re(e,t){var n=e.stateNode;if(null===n)return null;var r=Sa(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(i(231,t,typeof n));return n}var De=!1;if(u)try{var je={};Object.defineProperty(je,"passive",{get:function(){De=!0}}),window.addEventListener("test",je,je),window.removeEventListener("test",je,je)}catch(ue){De=!1}function Pe(e,t,n,r,a,i,s,o,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(u){this.onError(u)}}var Le=!1,Me=null,Fe=!1,Ue=null,Ve={onError:function(e){Le=!0,Me=e}};function Be(e,t,n,r,a,i,s,o,l){Le=!1,Me=null,Pe.apply(Ve,arguments)}function ze(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function He(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function We(e){if(ze(e)!==e)throw Error(i(188))}function Ge(e){return e=function(e){var t=e.alternate;if(!t){if(null===(t=ze(e)))throw Error(i(188));return t!==e?null:e}for(var n=e,r=t;;){var a=n.return;if(null===a)break;var s=a.alternate;if(null===s){if(null!==(r=a.return)){n=r;continue}break}if(a.child===s.child){for(s=a.child;s;){if(s===n)return We(a),e;if(s===r)return We(a),t;s=s.sibling}throw Error(i(188))}if(n.return!==r.return)n=a,r=s;else{for(var o=!1,l=a.child;l;){if(l===n){o=!0,n=a,r=s;break}if(l===r){o=!0,r=a,n=s;break}l=l.sibling}if(!o){for(l=s.child;l;){if(l===n){o=!0,n=s,r=a;break}if(l===r){o=!0,r=s,n=a;break}l=l.sibling}if(!o)throw Error(i(189))}}if(n.alternate!==r)throw Error(i(190))}if(3!==n.tag)throw Error(i(188));return n.stateNode.current===n?e:t}(e),null!==e?qe(e):null}function qe(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=qe(e);if(null!==t)return t;e=e.sibling}return null}var Ke=a.unstable_scheduleCallback,Ye=a.unstable_cancelCallback,Qe=a.unstable_shouldYield,Xe=a.unstable_requestPaint,Je=a.unstable_now,$e=a.unstable_getCurrentPriorityLevel,Ze=a.unstable_ImmediatePriority,et=a.unstable_UserBlockingPriority,tt=a.unstable_NormalPriority,nt=a.unstable_LowPriority,rt=a.unstable_IdlePriority,at=null,it=null;var st=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(ot(e)/lt|0)|0},ot=Math.log,lt=Math.LN2;var ct=64,ut=4194304;function ht(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function dt(e,t){var n=e.pendingLanes;if(0===n)return 0;var r=0,a=e.suspendedLanes,i=e.pingedLanes,s=268435455&n;if(0!==s){var o=s&~a;0!==o?r=ht(o):0!==(i&=s)&&(r=ht(i))}else 0!==(s=n&~a)?r=ht(s):0!==i&&(r=ht(i));if(0===r)return 0;if(0!==t&&t!==r&&0===(t&a)&&((a=r&-r)>=(i=t&-t)||16===a&&0!==(4194240&i)))return t;if(0!==(4&r)&&(r|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)a=1<<(n=31-st(t)),r|=e[n],t&=~a;return r}function ft(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function pt(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function mt(){var e=ct;return 0===(4194240&(ct<<=1))&&(ct=64),e}function gt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function vt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-st(t)]=n}function yt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-st(n),a=1<<r;a&t|e[r]&t&&(e[r]|=t),n&=~a}}var bt=0;function wt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var St,Tt,Et,xt,_t,At=!1,kt=[],Ct=null,It=null,Nt=null,Ot=new Map,Rt=new Map,Dt=[],jt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Pt(e,t){switch(e){case"focusin":case"focusout":Ct=null;break;case"dragenter":case"dragleave":It=null;break;case"mouseover":case"mouseout":Nt=null;break;case"pointerover":case"pointerout":Ot.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Rt.delete(t.pointerId)}}function Lt(e,t,n,r,a,i){return null===e||e.nativeEvent!==i?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[a]},null!==t&&(null!==(t=ba(t))&&Tt(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==a&&-1===t.indexOf(a)&&t.push(a),e)}function Mt(e){var t=ya(e.target);if(null!==t){var n=ze(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=He(n)))return e.blockedOn=t,void _t(e.priority,(function(){Et(n)}))}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Ft(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Qt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=ba(n))&&Tt(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);we=r,n.target.dispatchEvent(r),we=null,t.shift()}return!0}function Ut(e,t,n){Ft(e)&&n.delete(t)}function Vt(){At=!1,null!==Ct&&Ft(Ct)&&(Ct=null),null!==It&&Ft(It)&&(It=null),null!==Nt&&Ft(Nt)&&(Nt=null),Ot.forEach(Ut),Rt.forEach(Ut)}function Bt(e,t){e.blockedOn===t&&(e.blockedOn=null,At||(At=!0,a.unstable_scheduleCallback(a.unstable_NormalPriority,Vt)))}function zt(e){function t(t){return Bt(t,e)}if(0<kt.length){Bt(kt[0],e);for(var n=1;n<kt.length;n++){var r=kt[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==Ct&&Bt(Ct,e),null!==It&&Bt(It,e),null!==Nt&&Bt(Nt,e),Ot.forEach(t),Rt.forEach(t),n=0;n<Dt.length;n++)(r=Dt[n]).blockedOn===e&&(r.blockedOn=null);for(;0<Dt.length&&null===(n=Dt[0]).blockedOn;)Mt(n),null===n.blockedOn&&Dt.shift()}var Ht=w.ReactCurrentBatchConfig,Wt=!0;function Gt(e,t,n,r){var a=bt,i=Ht.transition;Ht.transition=null;try{bt=1,Kt(e,t,n,r)}finally{bt=a,Ht.transition=i}}function qt(e,t,n,r){var a=bt,i=Ht.transition;Ht.transition=null;try{bt=4,Kt(e,t,n,r)}finally{bt=a,Ht.transition=i}}function Kt(e,t,n,r){if(Wt){var a=Qt(e,t,n,r);if(null===a)Wr(e,t,r,Yt,n),Pt(e,r);else if(function(e,t,n,r,a){switch(t){case"focusin":return Ct=Lt(Ct,e,t,n,r,a),!0;case"dragenter":return It=Lt(It,e,t,n,r,a),!0;case"mouseover":return Nt=Lt(Nt,e,t,n,r,a),!0;case"pointerover":var i=a.pointerId;return Ot.set(i,Lt(Ot.get(i)||null,e,t,n,r,a)),!0;case"gotpointercapture":return i=a.pointerId,Rt.set(i,Lt(Rt.get(i)||null,e,t,n,r,a)),!0}return!1}(a,e,t,n,r))r.stopPropagation();else if(Pt(e,r),4&t&&-1<jt.indexOf(e)){for(;null!==a;){var i=ba(a);if(null!==i&&St(i),null===(i=Qt(e,t,n,r))&&Wr(e,t,r,Yt,n),i===a)break;a=i}null!==a&&r.stopPropagation()}else Wr(e,t,r,null,n)}}var Yt=null;function Qt(e,t,n,r){if(Yt=null,null!==(e=ya(e=Se(r))))if(null===(t=ze(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=He(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Yt=e,null}function Xt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch($e()){case Ze:return 1;case et:return 4;case tt:case nt:return 16;case rt:return 536870912;default:return 16}default:return 16}}var Jt=null,$t=null,Zt=null;function en(){if(Zt)return Zt;var e,t,n=$t,r=n.length,a="value"in Jt?Jt.value:Jt.textContent,i=a.length;for(e=0;e<r&&n[e]===a[e];e++);var s=r-e;for(t=1;t<=s&&n[r-t]===a[i-t];t++);return Zt=a.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nn(){return!0}function rn(){return!1}function an(e){function t(t,n,r,a,i){for(var s in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=a,this.target=i,this.currentTarget=null,e)e.hasOwnProperty(s)&&(t=e[s],this[s]=t?t(a):a[s]);return this.isDefaultPrevented=(null!=a.defaultPrevented?a.defaultPrevented:!1===a.returnValue)?nn:rn,this.isPropagationStopped=rn,this}return M(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),t}var sn,on,ln,cn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},un=an(cn),hn=M({},cn,{view:0,detail:0}),dn=an(hn),fn=M({},hn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:_n,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ln&&(ln&&"mousemove"===e.type?(sn=e.screenX-ln.screenX,on=e.screenY-ln.screenY):on=sn=0,ln=e),sn)},movementY:function(e){return"movementY"in e?e.movementY:on}}),pn=an(fn),mn=an(M({},fn,{dataTransfer:0})),gn=an(M({},hn,{relatedTarget:0})),vn=an(M({},cn,{animationName:0,elapsedTime:0,pseudoElement:0})),yn=M({},cn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),bn=an(yn),wn=an(M({},cn,{data:0})),Sn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Tn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},En={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function xn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=En[e])&&!!t[e]}function _n(){return xn}var An=M({},hn,{key:function(e){if(e.key){var t=Sn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?Tn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:_n,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),kn=an(An),Cn=an(M({},fn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),In=an(M({},hn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:_n})),Nn=an(M({},cn,{propertyName:0,elapsedTime:0,pseudoElement:0})),On=M({},fn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Rn=an(On),Dn=[9,13,27,32],jn=u&&"CompositionEvent"in window,Pn=null;u&&"documentMode"in document&&(Pn=document.documentMode);var Ln=u&&"TextEvent"in window&&!Pn,Mn=u&&(!jn||Pn&&8<Pn&&11>=Pn),Fn=String.fromCharCode(32),Un=!1;function Vn(e,t){switch(e){case"keyup":return-1!==Dn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Bn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var zn=!1;var Hn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Wn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Hn[e.type]:"textarea"===t}function Gn(e,t,n,r){Ae(r),0<(t=qr(t,"onChange")).length&&(n=new un("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var qn=null,Kn=null;function Yn(e){Fr(e,0)}function Qn(e){if(K(wa(e)))return e}function Xn(e,t){if("change"===e)return t}var Jn=!1;if(u){var $n;if(u){var Zn="oninput"in document;if(!Zn){var er=document.createElement("div");er.setAttribute("oninput","return;"),Zn="function"===typeof er.oninput}$n=Zn}else $n=!1;Jn=$n&&(!document.documentMode||9<document.documentMode)}function tr(){qn&&(qn.detachEvent("onpropertychange",nr),Kn=qn=null)}function nr(e){if("value"===e.propertyName&&Qn(Kn)){var t=[];Gn(t,Kn,e,Se(e)),Oe(Yn,t)}}function rr(e,t,n){"focusin"===e?(tr(),Kn=n,(qn=t).attachEvent("onpropertychange",nr)):"focusout"===e&&tr()}function ar(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Qn(Kn)}function ir(e,t){if("click"===e)return Qn(t)}function sr(e,t){if("input"===e||"change"===e)return Qn(t)}var or="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function lr(e,t){if(or(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var a=n[r];if(!h.call(t,a)||!or(e[a],t[a]))return!1}return!0}function cr(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ur(e,t){var n,r=cr(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=cr(r)}}function hr(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?hr(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function dr(){for(var e=window,t=Y();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=Y((e=t.contentWindow).document)}return t}function fr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function pr(e){var t=dr(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&hr(n.ownerDocument.documentElement,n)){if(null!==r&&fr(n))if(t=r.start,void 0===(e=r.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var a=n.textContent.length,i=Math.min(r.start,a);r=void 0===r.end?i:Math.min(r.end,a),!e.extend&&i>r&&(a=r,r=i,i=a),a=ur(n,i);var s=ur(n,r);a&&s&&(1!==e.rangeCount||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==s.node||e.focusOffset!==s.offset)&&((t=t.createRange()).setStart(a.node,a.offset),e.removeAllRanges(),i>r?(e.addRange(t),e.extend(s.node,s.offset)):(t.setEnd(s.node,s.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var mr=u&&"documentMode"in document&&11>=document.documentMode,gr=null,vr=null,yr=null,br=!1;function wr(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;br||null==gr||gr!==Y(r)||("selectionStart"in(r=gr)&&fr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},yr&&lr(yr,r)||(yr=r,0<(r=qr(vr,"onSelect")).length&&(t=new un("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=gr)))}function Sr(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Tr={animationend:Sr("Animation","AnimationEnd"),animationiteration:Sr("Animation","AnimationIteration"),animationstart:Sr("Animation","AnimationStart"),transitionend:Sr("Transition","TransitionEnd")},Er={},xr={};function _r(e){if(Er[e])return Er[e];if(!Tr[e])return e;var t,n=Tr[e];for(t in n)if(n.hasOwnProperty(t)&&t in xr)return Er[e]=n[t];return e}u&&(xr=document.createElement("div").style,"AnimationEvent"in window||(delete Tr.animationend.animation,delete Tr.animationiteration.animation,delete Tr.animationstart.animation),"TransitionEvent"in window||delete Tr.transitionend.transition);var Ar=_r("animationend"),kr=_r("animationiteration"),Cr=_r("animationstart"),Ir=_r("transitionend"),Nr=new Map,Or="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Rr(e,t){Nr.set(e,t),l(t,[e])}for(var Dr=0;Dr<Or.length;Dr++){var jr=Or[Dr];Rr(jr.toLowerCase(),"on"+(jr[0].toUpperCase()+jr.slice(1)))}Rr(Ar,"onAnimationEnd"),Rr(kr,"onAnimationIteration"),Rr(Cr,"onAnimationStart"),Rr("dblclick","onDoubleClick"),Rr("focusin","onFocus"),Rr("focusout","onBlur"),Rr(Ir,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Pr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Lr=new Set("cancel close invalid load scroll toggle".split(" ").concat(Pr));function Mr(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,a,s,o,l,c){if(Be.apply(this,arguments),Le){if(!Le)throw Error(i(198));var u=Me;Le=!1,Me=null,Fe||(Fe=!0,Ue=u)}}(r,t,void 0,e),e.currentTarget=null}function Fr(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],a=r.event;r=r.listeners;e:{var i=void 0;if(t)for(var s=r.length-1;0<=s;s--){var o=r[s],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==i&&a.isPropagationStopped())break e;Mr(a,o,c),i=l}else for(s=0;s<r.length;s++){if(l=(o=r[s]).instance,c=o.currentTarget,o=o.listener,l!==i&&a.isPropagationStopped())break e;Mr(a,o,c),i=l}}}if(Fe)throw e=Ue,Fe=!1,Ue=null,e}function Ur(e,t){var n=t[ma];void 0===n&&(n=t[ma]=new Set);var r=e+"__bubble";n.has(r)||(Hr(t,e,2,!1),n.add(r))}function Vr(e,t,n){var r=0;t&&(r|=4),Hr(n,e,r,t)}var Br="_reactListening"+Math.random().toString(36).slice(2);function zr(e){if(!e[Br]){e[Br]=!0,s.forEach((function(t){"selectionchange"!==t&&(Lr.has(t)||Vr(t,!1,e),Vr(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Br]||(t[Br]=!0,Vr("selectionchange",!1,t))}}function Hr(e,t,n,r){switch(Xt(t)){case 1:var a=Gt;break;case 4:a=qt;break;default:a=Kt}n=a.bind(null,t,n,e),a=void 0,!De||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(a=!0),r?void 0!==a?e.addEventListener(t,n,{capture:!0,passive:a}):e.addEventListener(t,n,!0):void 0!==a?e.addEventListener(t,n,{passive:a}):e.addEventListener(t,n,!1)}function Wr(e,t,n,r,a){var i=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var s=r.tag;if(3===s||4===s){var o=r.stateNode.containerInfo;if(o===a||8===o.nodeType&&o.parentNode===a)break;if(4===s)for(s=r.return;null!==s;){var l=s.tag;if((3===l||4===l)&&((l=s.stateNode.containerInfo)===a||8===l.nodeType&&l.parentNode===a))return;s=s.return}for(;null!==o;){if(null===(s=ya(o)))return;if(5===(l=s.tag)||6===l){r=i=s;continue e}o=o.parentNode}}r=r.return}Oe((function(){var r=i,a=Se(n),s=[];e:{var o=Nr.get(e);if(void 0!==o){var l=un,c=e;switch(e){case"keypress":if(0===tn(n))break e;case"keydown":case"keyup":l=kn;break;case"focusin":c="focus",l=gn;break;case"focusout":c="blur",l=gn;break;case"beforeblur":case"afterblur":l=gn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=pn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=mn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=In;break;case Ar:case kr:case Cr:l=vn;break;case Ir:l=Nn;break;case"scroll":l=dn;break;case"wheel":l=Rn;break;case"copy":case"cut":case"paste":l=bn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=Cn}var u=0!==(4&t),h=!u&&"scroll"===e,d=u?null!==o?o+"Capture":null:o;u=[];for(var f,p=r;null!==p;){var m=(f=p).stateNode;if(5===f.tag&&null!==m&&(f=m,null!==d&&(null!=(m=Re(p,d))&&u.push(Gr(p,m,f)))),h)break;p=p.return}0<u.length&&(o=new l(o,c,null,n,a),s.push({event:o,listeners:u}))}}if(0===(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(o="mouseover"===e||"pointerover"===e)||n===we||!(c=n.relatedTarget||n.fromElement)||!ya(c)&&!c[pa])&&(l||o)&&(o=a.window===a?a:(o=a.ownerDocument)?o.defaultView||o.parentWindow:window,l?(l=r,null!==(c=(c=n.relatedTarget||n.toElement)?ya(c):null)&&(c!==(h=ze(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(l=null,c=r),l!==c)){if(u=pn,m="onMouseLeave",d="onMouseEnter",p="mouse","pointerout"!==e&&"pointerover"!==e||(u=Cn,m="onPointerLeave",d="onPointerEnter",p="pointer"),h=null==l?o:wa(l),f=null==c?o:wa(c),(o=new u(m,p+"leave",l,n,a)).target=h,o.relatedTarget=f,m=null,ya(a)===r&&((u=new u(d,p+"enter",c,n,a)).target=f,u.relatedTarget=h,m=u),h=m,l&&c)e:{for(d=c,p=0,f=u=l;f;f=Kr(f))p++;for(f=0,m=d;m;m=Kr(m))f++;for(;0<p-f;)u=Kr(u),p--;for(;0<f-p;)d=Kr(d),f--;for(;p--;){if(u===d||null!==d&&u===d.alternate)break e;u=Kr(u),d=Kr(d)}u=null}else u=null;null!==l&&Yr(s,o,l,u,!1),null!==c&&null!==h&&Yr(s,h,c,u,!0)}if("select"===(l=(o=r?wa(r):window).nodeName&&o.nodeName.toLowerCase())||"input"===l&&"file"===o.type)var g=Xn;else if(Wn(o))if(Jn)g=sr;else{g=ar;var v=rr}else(l=o.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===o.type||"radio"===o.type)&&(g=ir);switch(g&&(g=g(e,r))?Gn(s,g,n,a):(v&&v(e,o,r),"focusout"===e&&(v=o._wrapperState)&&v.controlled&&"number"===o.type&&ee(o,"number",o.value)),v=r?wa(r):window,e){case"focusin":(Wn(v)||"true"===v.contentEditable)&&(gr=v,vr=r,yr=null);break;case"focusout":yr=vr=gr=null;break;case"mousedown":br=!0;break;case"contextmenu":case"mouseup":case"dragend":br=!1,wr(s,n,a);break;case"selectionchange":if(mr)break;case"keydown":case"keyup":wr(s,n,a)}var y;if(jn)e:{switch(e){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else zn?Vn(e,n)&&(b="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(b="onCompositionStart");b&&(Mn&&"ko"!==n.locale&&(zn||"onCompositionStart"!==b?"onCompositionEnd"===b&&zn&&(y=en()):($t="value"in(Jt=a)?Jt.value:Jt.textContent,zn=!0)),0<(v=qr(r,b)).length&&(b=new wn(b,e,null,n,a),s.push({event:b,listeners:v}),y?b.data=y:null!==(y=Bn(n))&&(b.data=y))),(y=Ln?function(e,t){switch(e){case"compositionend":return Bn(t);case"keypress":return 32!==t.which?null:(Un=!0,Fn);case"textInput":return(e=t.data)===Fn&&Un?null:e;default:return null}}(e,n):function(e,t){if(zn)return"compositionend"===e||!jn&&Vn(e,t)?(e=en(),Zt=$t=Jt=null,zn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Mn&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(r=qr(r,"onBeforeInput")).length&&(a=new wn("onBeforeInput","beforeinput",null,n,a),s.push({event:a,listeners:r}),a.data=y))}Fr(s,t)}))}function Gr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function qr(e,t){for(var n=t+"Capture",r=[];null!==e;){var a=e,i=a.stateNode;5===a.tag&&null!==i&&(a=i,null!=(i=Re(e,n))&&r.unshift(Gr(e,i,a)),null!=(i=Re(e,t))&&r.push(Gr(e,i,a))),e=e.return}return r}function Kr(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Yr(e,t,n,r,a){for(var i=t._reactName,s=[];null!==n&&n!==r;){var o=n,l=o.alternate,c=o.stateNode;if(null!==l&&l===r)break;5===o.tag&&null!==c&&(o=c,a?null!=(l=Re(n,i))&&s.unshift(Gr(n,l,o)):a||null!=(l=Re(n,i))&&s.push(Gr(n,l,o))),n=n.return}0!==s.length&&e.push({event:t,listeners:s})}var Qr=/\r\n?/g,Xr=/\u0000|\uFFFD/g;function Jr(e){return("string"===typeof e?e:""+e).replace(Qr,"\n").replace(Xr,"")}function $r(e,t,n){if(t=Jr(t),Jr(e)!==t&&n)throw Error(i(425))}function Zr(){}var ea=null,ta=null;function na(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ra="function"===typeof setTimeout?setTimeout:void 0,aa="function"===typeof clearTimeout?clearTimeout:void 0,ia="function"===typeof Promise?Promise:void 0,sa="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof ia?function(e){return ia.resolve(null).then(e).catch(oa)}:ra;function oa(e){setTimeout((function(){throw e}))}function la(e,t){var n=t,r=0;do{var a=n.nextSibling;if(e.removeChild(n),a&&8===a.nodeType)if("/$"===(n=a.data)){if(0===r)return e.removeChild(a),void zt(t);r--}else"$"!==n&&"$?"!==n&&"$!"!==n||r++;n=a}while(n);zt(t)}function ca(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function ua(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var ha=Math.random().toString(36).slice(2),da="__reactFiber$"+ha,fa="__reactProps$"+ha,pa="__reactContainer$"+ha,ma="__reactEvents$"+ha,ga="__reactListeners$"+ha,va="__reactHandles$"+ha;function ya(e){var t=e[da];if(t)return t;for(var n=e.parentNode;n;){if(t=n[pa]||n[da]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=ua(e);null!==e;){if(n=e[da])return n;e=ua(e)}return t}n=(e=n).parentNode}return null}function ba(e){return!(e=e[da]||e[pa])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function wa(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(i(33))}function Sa(e){return e[fa]||null}var Ta=[],Ea=-1;function xa(e){return{current:e}}function _a(e){0>Ea||(e.current=Ta[Ea],Ta[Ea]=null,Ea--)}function Aa(e,t){Ea++,Ta[Ea]=e.current,e.current=t}var ka={},Ca=xa(ka),Ia=xa(!1),Na=ka;function Oa(e,t){var n=e.type.contextTypes;if(!n)return ka;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var a,i={};for(a in n)i[a]=t[a];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function Ra(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Da(){_a(Ia),_a(Ca)}function ja(e,t,n){if(Ca.current!==ka)throw Error(i(168));Aa(Ca,t),Aa(Ia,n)}function Pa(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var a in r=r.getChildContext())if(!(a in t))throw Error(i(108,H(e)||"Unknown",a));return M({},n,r)}function La(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||ka,Na=Ca.current,Aa(Ca,e),Aa(Ia,Ia.current),!0}function Ma(e,t,n){var r=e.stateNode;if(!r)throw Error(i(169));n?(e=Pa(e,t,Na),r.__reactInternalMemoizedMergedChildContext=e,_a(Ia),_a(Ca),Aa(Ca,e)):_a(Ia),Aa(Ia,n)}var Fa=null,Ua=!1,Va=!1;function Ba(e){null===Fa?Fa=[e]:Fa.push(e)}function za(){if(!Va&&null!==Fa){Va=!0;var e=0,t=bt;try{var n=Fa;for(bt=1;e<n.length;e++){var r=n[e];do{r=r(!0)}while(null!==r)}Fa=null,Ua=!1}catch(a){throw null!==Fa&&(Fa=Fa.slice(e+1)),Ke(Ze,za),a}finally{bt=t,Va=!1}}return null}var Ha=[],Wa=0,Ga=null,qa=0,Ka=[],Ya=0,Qa=null,Xa=1,Ja="";function $a(e,t){Ha[Wa++]=qa,Ha[Wa++]=Ga,Ga=e,qa=t}function Za(e,t,n){Ka[Ya++]=Xa,Ka[Ya++]=Ja,Ka[Ya++]=Qa,Qa=e;var r=Xa;e=Ja;var a=32-st(r)-1;r&=~(1<<a),n+=1;var i=32-st(t)+a;if(30<i){var s=a-a%5;i=(r&(1<<s)-1).toString(32),r>>=s,a-=s,Xa=1<<32-st(t)+a|n<<a|r,Ja=i+e}else Xa=1<<i|n<<a|r,Ja=e}function ei(e){null!==e.return&&($a(e,1),Za(e,1,0))}function ti(e){for(;e===Ga;)Ga=Ha[--Wa],Ha[Wa]=null,qa=Ha[--Wa],Ha[Wa]=null;for(;e===Qa;)Qa=Ka[--Ya],Ka[Ya]=null,Ja=Ka[--Ya],Ka[Ya]=null,Xa=Ka[--Ya],Ka[Ya]=null}var ni=null,ri=null,ai=!1,ii=null;function si(e,t){var n=Dc(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function oi(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,ni=e,ri=ca(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,ni=e,ri=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==Qa?{id:Xa,overflow:Ja}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Dc(18,null,null,0)).stateNode=t,n.return=e,e.child=n,ni=e,ri=null,!0);default:return!1}}function li(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function ci(e){if(ai){var t=ri;if(t){var n=t;if(!oi(e,t)){if(li(e))throw Error(i(418));t=ca(n.nextSibling);var r=ni;t&&oi(e,t)?si(r,n):(e.flags=-4097&e.flags|2,ai=!1,ni=e)}}else{if(li(e))throw Error(i(418));e.flags=-4097&e.flags|2,ai=!1,ni=e}}}function ui(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;ni=e}function hi(e){if(e!==ni)return!1;if(!ai)return ui(e),ai=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!na(e.type,e.memoizedProps)),t&&(t=ri)){if(li(e))throw di(),Error(i(418));for(;t;)si(e,t),t=ca(t.nextSibling)}if(ui(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(i(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){ri=ca(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}ri=null}}else ri=ni?ca(e.stateNode.nextSibling):null;return!0}function di(){for(var e=ri;e;)e=ca(e.nextSibling)}function fi(){ri=ni=null,ai=!1}function pi(e){null===ii?ii=[e]:ii.push(e)}var mi=w.ReactCurrentBatchConfig;function gi(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(i(309));var r=n.stateNode}if(!r)throw Error(i(147,e));var a=r,s=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===s?t.ref:(t=function(e){var t=a.refs;null===e?delete t[s]:t[s]=e},t._stringRef=s,t)}if("string"!==typeof e)throw Error(i(284));if(!n._owner)throw Error(i(290,e))}return e}function vi(e,t){throw e=Object.prototype.toString.call(t),Error(i(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function yi(e){return(0,e._init)(e._payload)}function bi(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function a(e,t){return(e=Pc(e,t)).index=0,e.sibling=null,e}function s(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=2,n):r:(t.flags|=2,n):(t.flags|=1048576,n)}function o(t){return e&&null===t.alternate&&(t.flags|=2),t}function l(e,t,n,r){return null===t||6!==t.tag?((t=Uc(n,e.mode,r)).return=e,t):((t=a(t,n)).return=e,t)}function c(e,t,n,r){var i=n.type;return i===E?h(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===i||"object"===typeof i&&null!==i&&i.$$typeof===R&&yi(i)===t.type)?((r=a(t,n.props)).ref=gi(e,t,n),r.return=e,r):((r=Lc(n.type,n.key,n.props,null,e.mode,r)).ref=gi(e,t,n),r.return=e,r)}function u(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Vc(n,e.mode,r)).return=e,t):((t=a(t,n.children||[])).return=e,t)}function h(e,t,n,r,i){return null===t||7!==t.tag?((t=Mc(n,e.mode,r,i)).return=e,t):((t=a(t,n)).return=e,t)}function d(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Uc(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case S:return(n=Lc(t.type,t.key,t.props,null,e.mode,n)).ref=gi(e,null,t),n.return=e,n;case T:return(t=Vc(t,e.mode,n)).return=e,t;case R:return d(e,(0,t._init)(t._payload),n)}if(te(t)||P(t))return(t=Mc(t,e.mode,n,null)).return=e,t;vi(e,t)}return null}function f(e,t,n,r){var a=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==a?null:l(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case S:return n.key===a?c(e,t,n,r):null;case T:return n.key===a?u(e,t,n,r):null;case R:return f(e,t,(a=n._init)(n._payload),r)}if(te(n)||P(n))return null!==a?null:h(e,t,n,r,null);vi(e,n)}return null}function p(e,t,n,r,a){if("string"===typeof r&&""!==r||"number"===typeof r)return l(t,e=e.get(n)||null,""+r,a);if("object"===typeof r&&null!==r){switch(r.$$typeof){case S:return c(t,e=e.get(null===r.key?n:r.key)||null,r,a);case T:return u(t,e=e.get(null===r.key?n:r.key)||null,r,a);case R:return p(e,t,n,(0,r._init)(r._payload),a)}if(te(r)||P(r))return h(t,e=e.get(n)||null,r,a,null);vi(t,r)}return null}function m(a,i,o,l){for(var c=null,u=null,h=i,m=i=0,g=null;null!==h&&m<o.length;m++){h.index>m?(g=h,h=null):g=h.sibling;var v=f(a,h,o[m],l);if(null===v){null===h&&(h=g);break}e&&h&&null===v.alternate&&t(a,h),i=s(v,i,m),null===u?c=v:u.sibling=v,u=v,h=g}if(m===o.length)return n(a,h),ai&&$a(a,m),c;if(null===h){for(;m<o.length;m++)null!==(h=d(a,o[m],l))&&(i=s(h,i,m),null===u?c=h:u.sibling=h,u=h);return ai&&$a(a,m),c}for(h=r(a,h);m<o.length;m++)null!==(g=p(h,a,m,o[m],l))&&(e&&null!==g.alternate&&h.delete(null===g.key?m:g.key),i=s(g,i,m),null===u?c=g:u.sibling=g,u=g);return e&&h.forEach((function(e){return t(a,e)})),ai&&$a(a,m),c}function g(a,o,l,c){var u=P(l);if("function"!==typeof u)throw Error(i(150));if(null==(l=u.call(l)))throw Error(i(151));for(var h=u=null,m=o,g=o=0,v=null,y=l.next();null!==m&&!y.done;g++,y=l.next()){m.index>g?(v=m,m=null):v=m.sibling;var b=f(a,m,y.value,c);if(null===b){null===m&&(m=v);break}e&&m&&null===b.alternate&&t(a,m),o=s(b,o,g),null===h?u=b:h.sibling=b,h=b,m=v}if(y.done)return n(a,m),ai&&$a(a,g),u;if(null===m){for(;!y.done;g++,y=l.next())null!==(y=d(a,y.value,c))&&(o=s(y,o,g),null===h?u=y:h.sibling=y,h=y);return ai&&$a(a,g),u}for(m=r(a,m);!y.done;g++,y=l.next())null!==(y=p(m,a,g,y.value,c))&&(e&&null!==y.alternate&&m.delete(null===y.key?g:y.key),o=s(y,o,g),null===h?u=y:h.sibling=y,h=y);return e&&m.forEach((function(e){return t(a,e)})),ai&&$a(a,g),u}return function e(r,i,s,l){if("object"===typeof s&&null!==s&&s.type===E&&null===s.key&&(s=s.props.children),"object"===typeof s&&null!==s){switch(s.$$typeof){case S:e:{for(var c=s.key,u=i;null!==u;){if(u.key===c){if((c=s.type)===E){if(7===u.tag){n(r,u.sibling),(i=a(u,s.props.children)).return=r,r=i;break e}}else if(u.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===R&&yi(c)===u.type){n(r,u.sibling),(i=a(u,s.props)).ref=gi(r,u,s),i.return=r,r=i;break e}n(r,u);break}t(r,u),u=u.sibling}s.type===E?((i=Mc(s.props.children,r.mode,l,s.key)).return=r,r=i):((l=Lc(s.type,s.key,s.props,null,r.mode,l)).ref=gi(r,i,s),l.return=r,r=l)}return o(r);case T:e:{for(u=s.key;null!==i;){if(i.key===u){if(4===i.tag&&i.stateNode.containerInfo===s.containerInfo&&i.stateNode.implementation===s.implementation){n(r,i.sibling),(i=a(i,s.children||[])).return=r,r=i;break e}n(r,i);break}t(r,i),i=i.sibling}(i=Vc(s,r.mode,l)).return=r,r=i}return o(r);case R:return e(r,i,(u=s._init)(s._payload),l)}if(te(s))return m(r,i,s,l);if(P(s))return g(r,i,s,l);vi(r,s)}return"string"===typeof s&&""!==s||"number"===typeof s?(s=""+s,null!==i&&6===i.tag?(n(r,i.sibling),(i=a(i,s)).return=r,r=i):(n(r,i),(i=Uc(s,r.mode,l)).return=r,r=i),o(r)):n(r,i)}}var wi=bi(!0),Si=bi(!1),Ti=xa(null),Ei=null,xi=null,_i=null;function Ai(){_i=xi=Ei=null}function ki(e){var t=Ti.current;_a(Ti),e._currentValue=t}function Ci(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Ii(e,t){Ei=e,_i=xi=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(So=!0),e.firstContext=null)}function Ni(e){var t=e._currentValue;if(_i!==e)if(e={context:e,memoizedValue:t,next:null},null===xi){if(null===Ei)throw Error(i(308));xi=e,Ei.dependencies={lanes:0,firstContext:e}}else xi=xi.next=e;return t}var Oi=null;function Ri(e){null===Oi?Oi=[e]:Oi.push(e)}function Di(e,t,n,r){var a=t.interleaved;return null===a?(n.next=n,Ri(t)):(n.next=a.next,a.next=n),t.interleaved=n,ji(e,r)}function ji(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var Pi=!1;function Li(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Mi(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Fi(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Ui(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&Nl)){var a=r.pending;return null===a?t.next=t:(t.next=a.next,a.next=t),r.pending=t,ji(e,n)}return null===(a=r.interleaved)?(t.next=t,Ri(r)):(t.next=a.next,a.next=t),r.interleaved=t,ji(e,n)}function Vi(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,yt(e,n)}}function Bi(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var a=null,i=null;if(null!==(n=n.firstBaseUpdate)){do{var s={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===i?a=i=s:i=i.next=s,n=n.next}while(null!==n);null===i?a=i=t:i=i.next=t}else a=i=t;return n={baseState:r.baseState,firstBaseUpdate:a,lastBaseUpdate:i,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function zi(e,t,n,r){var a=e.updateQueue;Pi=!1;var i=a.firstBaseUpdate,s=a.lastBaseUpdate,o=a.shared.pending;if(null!==o){a.shared.pending=null;var l=o,c=l.next;l.next=null,null===s?i=c:s.next=c,s=l;var u=e.alternate;null!==u&&((o=(u=u.updateQueue).lastBaseUpdate)!==s&&(null===o?u.firstBaseUpdate=c:o.next=c,u.lastBaseUpdate=l))}if(null!==i){var h=a.baseState;for(s=0,u=c=l=null,o=i;;){var d=o.lane,f=o.eventTime;if((r&d)===d){null!==u&&(u=u.next={eventTime:f,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var p=e,m=o;switch(d=t,f=n,m.tag){case 1:if("function"===typeof(p=m.payload)){h=p.call(f,h,d);break e}h=p;break e;case 3:p.flags=-65537&p.flags|128;case 0:if(null===(d="function"===typeof(p=m.payload)?p.call(f,h,d):p)||void 0===d)break e;h=M({},h,d);break e;case 2:Pi=!0}}null!==o.callback&&0!==o.lane&&(e.flags|=64,null===(d=a.effects)?a.effects=[o]:d.push(o))}else f={eventTime:f,lane:d,tag:o.tag,payload:o.payload,callback:o.callback,next:null},null===u?(c=u=f,l=h):u=u.next=f,s|=d;if(null===(o=o.next)){if(null===(o=a.shared.pending))break;o=(d=o).next,d.next=null,a.lastBaseUpdate=d,a.shared.pending=null}}if(null===u&&(l=h),a.baseState=l,a.firstBaseUpdate=c,a.lastBaseUpdate=u,null!==(t=a.shared.interleaved)){a=t;do{s|=a.lane,a=a.next}while(a!==t)}else null===i&&(a.shared.lanes=0);Fl|=s,e.lanes=s,e.memoizedState=h}}function Hi(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],a=r.callback;if(null!==a){if(r.callback=null,r=n,"function"!==typeof a)throw Error(i(191,a));a.call(r)}}}var Wi={},Gi=xa(Wi),qi=xa(Wi),Ki=xa(Wi);function Yi(e){if(e===Wi)throw Error(i(174));return e}function Qi(e,t){switch(Aa(Ki,t),Aa(qi,e),Aa(Gi,Wi),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:le(null,"");break;default:t=le(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}_a(Gi),Aa(Gi,t)}function Xi(){_a(Gi),_a(qi),_a(Ki)}function Ji(e){Yi(Ki.current);var t=Yi(Gi.current),n=le(t,e.type);t!==n&&(Aa(qi,e),Aa(Gi,n))}function $i(e){qi.current===e&&(_a(Gi),_a(qi))}var Zi=xa(0);function es(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var ts=[];function ns(){for(var e=0;e<ts.length;e++)ts[e]._workInProgressVersionPrimary=null;ts.length=0}var rs=w.ReactCurrentDispatcher,as=w.ReactCurrentBatchConfig,is=0,ss=null,os=null,ls=null,cs=!1,us=!1,hs=0,ds=0;function fs(){throw Error(i(321))}function ps(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!or(e[n],t[n]))return!1;return!0}function ms(e,t,n,r,a,s){if(is=s,ss=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,rs.current=null===e||null===e.memoizedState?Zs:eo,e=n(r,a),us){s=0;do{if(us=!1,hs=0,25<=s)throw Error(i(301));s+=1,ls=os=null,t.updateQueue=null,rs.current=no,e=n(r,a)}while(us)}if(rs.current=$s,t=null!==os&&null!==os.next,is=0,ls=os=ss=null,cs=!1,t)throw Error(i(300));return e}function gs(){var e=0!==hs;return hs=0,e}function vs(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===ls?ss.memoizedState=ls=e:ls=ls.next=e,ls}function bs(){if(null===os){var e=ss.alternate;e=null!==e?e.memoizedState:null}else e=os.next;var t=null===ls?ss.memoizedState:ls.next;if(null!==t)ls=t,os=e;else{if(null===e)throw Error(i(310));e={memoizedState:(os=e).memoizedState,baseState:os.baseState,baseQueue:os.baseQueue,queue:os.queue,next:null},null===ls?ss.memoizedState=ls=e:ls=ls.next=e}return ls}function ws(e,t){return"function"===typeof t?t(e):t}function Ss(e){var t=bs(),n=t.queue;if(null===n)throw Error(i(311));n.lastRenderedReducer=e;var r=os,a=r.baseQueue,s=n.pending;if(null!==s){if(null!==a){var o=a.next;a.next=s.next,s.next=o}r.baseQueue=a=s,n.pending=null}if(null!==a){s=a.next,r=r.baseState;var l=o=null,c=null,u=s;do{var h=u.lane;if((is&h)===h)null!==c&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:e(r,u.action);else{var d={lane:h,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};null===c?(l=c=d,o=r):c=c.next=d,ss.lanes|=h,Fl|=h}u=u.next}while(null!==u&&u!==s);null===c?o=r:c.next=l,or(r,t.memoizedState)||(So=!0),t.memoizedState=r,t.baseState=o,t.baseQueue=c,n.lastRenderedState=r}if(null!==(e=n.interleaved)){a=e;do{s=a.lane,ss.lanes|=s,Fl|=s,a=a.next}while(a!==e)}else null===a&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Ts(e){var t=bs(),n=t.queue;if(null===n)throw Error(i(311));n.lastRenderedReducer=e;var r=n.dispatch,a=n.pending,s=t.memoizedState;if(null!==a){n.pending=null;var o=a=a.next;do{s=e(s,o.action),o=o.next}while(o!==a);or(s,t.memoizedState)||(So=!0),t.memoizedState=s,null===t.baseQueue&&(t.baseState=s),n.lastRenderedState=s}return[s,r]}function Es(){}function xs(e,t){var n=ss,r=bs(),a=t(),s=!or(r.memoizedState,a);if(s&&(r.memoizedState=a,So=!0),r=r.queue,Ls(ks.bind(null,n,r,e),[e]),r.getSnapshot!==t||s||null!==ls&&1&ls.memoizedState.tag){if(n.flags|=2048,Os(9,As.bind(null,n,r,a,t),void 0,null),null===Ol)throw Error(i(349));0!==(30&is)||_s(n,t,a)}return a}function _s(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=ss.updateQueue)?(t={lastEffect:null,stores:null},ss.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function As(e,t,n,r){t.value=n,t.getSnapshot=r,Cs(t)&&Is(e)}function ks(e,t,n){return n((function(){Cs(t)&&Is(e)}))}function Cs(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!or(e,n)}catch(r){return!0}}function Is(e){var t=ji(e,1);null!==t&&ac(t,e,1,-1)}function Ns(e){var t=vs();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ws,lastRenderedState:e},t.queue=e,e=e.dispatch=Ys.bind(null,ss,e),[t.memoizedState,e]}function Os(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=ss.updateQueue)?(t={lastEffect:null,stores:null},ss.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function Rs(){return bs().memoizedState}function Ds(e,t,n,r){var a=vs();ss.flags|=e,a.memoizedState=Os(1|t,n,void 0,void 0===r?null:r)}function js(e,t,n,r){var a=bs();r=void 0===r?null:r;var i=void 0;if(null!==os){var s=os.memoizedState;if(i=s.destroy,null!==r&&ps(r,s.deps))return void(a.memoizedState=Os(t,n,i,r))}ss.flags|=e,a.memoizedState=Os(1|t,n,i,r)}function Ps(e,t){return Ds(8390656,8,e,t)}function Ls(e,t){return js(2048,8,e,t)}function Ms(e,t){return js(4,2,e,t)}function Fs(e,t){return js(4,4,e,t)}function Us(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Vs(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,js(4,4,Us.bind(null,t,e),n)}function Bs(){}function zs(e,t){var n=bs();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&ps(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Hs(e,t){var n=bs();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&ps(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Ws(e,t,n){return 0===(21&is)?(e.baseState&&(e.baseState=!1,So=!0),e.memoizedState=n):(or(n,t)||(n=mt(),ss.lanes|=n,Fl|=n,e.baseState=!0),t)}function Gs(e,t){var n=bt;bt=0!==n&&4>n?n:4,e(!0);var r=as.transition;as.transition={};try{e(!1),t()}finally{bt=n,as.transition=r}}function qs(){return bs().memoizedState}function Ks(e,t,n){var r=rc(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Qs(e))Xs(t,n);else if(null!==(n=Di(e,t,n,r))){ac(n,e,r,nc()),Js(n,t,r)}}function Ys(e,t,n){var r=rc(e),a={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Qs(e))Xs(t,a);else{var i=e.alternate;if(0===e.lanes&&(null===i||0===i.lanes)&&null!==(i=t.lastRenderedReducer))try{var s=t.lastRenderedState,o=i(s,n);if(a.hasEagerState=!0,a.eagerState=o,or(o,s)){var l=t.interleaved;return null===l?(a.next=a,Ri(t)):(a.next=l.next,l.next=a),void(t.interleaved=a)}}catch(c){}null!==(n=Di(e,t,a,r))&&(ac(n,e,r,a=nc()),Js(n,t,r))}}function Qs(e){var t=e.alternate;return e===ss||null!==t&&t===ss}function Xs(e,t){us=cs=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Js(e,t,n){if(0!==(4194240&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,yt(e,n)}}var $s={readContext:Ni,useCallback:fs,useContext:fs,useEffect:fs,useImperativeHandle:fs,useInsertionEffect:fs,useLayoutEffect:fs,useMemo:fs,useReducer:fs,useRef:fs,useState:fs,useDebugValue:fs,useDeferredValue:fs,useTransition:fs,useMutableSource:fs,useSyncExternalStore:fs,useId:fs,unstable_isNewReconciler:!1},Zs={readContext:Ni,useCallback:function(e,t){return vs().memoizedState=[e,void 0===t?null:t],e},useContext:Ni,useEffect:Ps,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Ds(4194308,4,Us.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Ds(4194308,4,e,t)},useInsertionEffect:function(e,t){return Ds(4,2,e,t)},useMemo:function(e,t){var n=vs();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=vs();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=Ks.bind(null,ss,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},vs().memoizedState=e},useState:Ns,useDebugValue:Bs,useDeferredValue:function(e){return vs().memoizedState=e},useTransition:function(){var e=Ns(!1),t=e[0];return e=Gs.bind(null,e[1]),vs().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=ss,a=vs();if(ai){if(void 0===n)throw Error(i(407));n=n()}else{if(n=t(),null===Ol)throw Error(i(349));0!==(30&is)||_s(r,t,n)}a.memoizedState=n;var s={value:n,getSnapshot:t};return a.queue=s,Ps(ks.bind(null,r,s,e),[e]),r.flags|=2048,Os(9,As.bind(null,r,s,n,t),void 0,null),n},useId:function(){var e=vs(),t=Ol.identifierPrefix;if(ai){var n=Ja;t=":"+t+"R"+(n=(Xa&~(1<<32-st(Xa)-1)).toString(32)+n),0<(n=hs++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=ds++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},eo={readContext:Ni,useCallback:zs,useContext:Ni,useEffect:Ls,useImperativeHandle:Vs,useInsertionEffect:Ms,useLayoutEffect:Fs,useMemo:Hs,useReducer:Ss,useRef:Rs,useState:function(){return Ss(ws)},useDebugValue:Bs,useDeferredValue:function(e){return Ws(bs(),os.memoizedState,e)},useTransition:function(){return[Ss(ws)[0],bs().memoizedState]},useMutableSource:Es,useSyncExternalStore:xs,useId:qs,unstable_isNewReconciler:!1},no={readContext:Ni,useCallback:zs,useContext:Ni,useEffect:Ls,useImperativeHandle:Vs,useInsertionEffect:Ms,useLayoutEffect:Fs,useMemo:Hs,useReducer:Ts,useRef:Rs,useState:function(){return Ts(ws)},useDebugValue:Bs,useDeferredValue:function(e){var t=bs();return null===os?t.memoizedState=e:Ws(t,os.memoizedState,e)},useTransition:function(){return[Ts(ws)[0],bs().memoizedState]},useMutableSource:Es,useSyncExternalStore:xs,useId:qs,unstable_isNewReconciler:!1};function ro(e,t){if(e&&e.defaultProps){for(var n in t=M({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}function ao(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:M({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var io={isMounted:function(e){return!!(e=e._reactInternals)&&ze(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=nc(),a=rc(e),i=Fi(r,a);i.payload=t,void 0!==n&&null!==n&&(i.callback=n),null!==(t=Ui(e,i,a))&&(ac(t,e,a,r),Vi(t,e,a))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=nc(),a=rc(e),i=Fi(r,a);i.tag=1,i.payload=t,void 0!==n&&null!==n&&(i.callback=n),null!==(t=Ui(e,i,a))&&(ac(t,e,a,r),Vi(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=nc(),r=rc(e),a=Fi(n,r);a.tag=2,void 0!==t&&null!==t&&(a.callback=t),null!==(t=Ui(e,a,r))&&(ac(t,e,r,n),Vi(t,e,r))}};function so(e,t,n,r,a,i,s){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,i,s):!t.prototype||!t.prototype.isPureReactComponent||(!lr(n,r)||!lr(a,i))}function oo(e,t,n){var r=!1,a=ka,i=t.contextType;return"object"===typeof i&&null!==i?i=Ni(i):(a=Ra(t)?Na:Ca.current,i=(r=null!==(r=t.contextTypes)&&void 0!==r)?Oa(e,a):ka),t=new t(n,i),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=io,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=i),t}function lo(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&io.enqueueReplaceState(t,t.state,null)}function co(e,t,n,r){var a=e.stateNode;a.props=n,a.state=e.memoizedState,a.refs={},Li(e);var i=t.contextType;"object"===typeof i&&null!==i?a.context=Ni(i):(i=Ra(t)?Na:Ca.current,a.context=Oa(e,i)),a.state=e.memoizedState,"function"===typeof(i=t.getDerivedStateFromProps)&&(ao(e,t,i,n),a.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof a.getSnapshotBeforeUpdate||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||(t=a.state,"function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount(),t!==a.state&&io.enqueueReplaceState(a,a.state,null),zi(e,n,a,r),a.state=e.memoizedState),"function"===typeof a.componentDidMount&&(e.flags|=4194308)}function uo(e,t){try{var n="",r=t;do{n+=B(r),r=r.return}while(r);var a=n}catch(i){a="\nError generating stack: "+i.message+"\n"+i.stack}return{value:e,source:t,stack:a,digest:null}}function ho(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function fo(e,t){try{console.error(t.value)}catch(n){setTimeout((function(){throw n}))}}var po="function"===typeof WeakMap?WeakMap:Map;function mo(e,t,n){(n=Fi(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){ql||(ql=!0,Kl=r),fo(0,t)},n}function go(e,t,n){(n=Fi(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"===typeof r){var a=t.value;n.payload=function(){return r(a)},n.callback=function(){fo(0,t)}}var i=e.stateNode;return null!==i&&"function"===typeof i.componentDidCatch&&(n.callback=function(){fo(0,t),"function"!==typeof r&&(null===Yl?Yl=new Set([this]):Yl.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function vo(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new po;var a=new Set;r.set(t,a)}else void 0===(a=r.get(t))&&(a=new Set,r.set(t,a));a.has(n)||(a.add(n),e=kc.bind(null,e,t,n),t.then(e,e))}function yo(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function bo(e,t,n,r,a){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=Fi(-1,1)).tag=2,Ui(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=a,e)}var wo=w.ReactCurrentOwner,So=!1;function To(e,t,n,r){t.child=null===e?Si(t,null,n,r):wi(t,e.child,n,r)}function Eo(e,t,n,r,a){n=n.render;var i=t.ref;return Ii(t,a),r=ms(e,t,n,r,i,a),n=gs(),null===e||So?(ai&&n&&ei(t),t.flags|=1,To(e,t,r,a),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,qo(e,t,a))}function xo(e,t,n,r,a){if(null===e){var i=n.type;return"function"!==typeof i||jc(i)||void 0!==i.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Lc(n.type,null,r,t,t.mode,a)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=i,_o(e,t,i,r,a))}if(i=e.child,0===(e.lanes&a)){var s=i.memoizedProps;if((n=null!==(n=n.compare)?n:lr)(s,r)&&e.ref===t.ref)return qo(e,t,a)}return t.flags|=1,(e=Pc(i,r)).ref=t.ref,e.return=t,t.child=e}function _o(e,t,n,r,a){if(null!==e){var i=e.memoizedProps;if(lr(i,r)&&e.ref===t.ref){if(So=!1,t.pendingProps=r=i,0===(e.lanes&a))return t.lanes=e.lanes,qo(e,t,a);0!==(131072&e.flags)&&(So=!0)}}return Co(e,t,n,r,a)}function Ao(e,t,n){var r=t.pendingProps,a=r.children,i=null!==e?e.memoizedState:null;if("hidden"===r.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Aa(Pl,jl),jl|=n;else{if(0===(1073741824&n))return e=null!==i?i.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Aa(Pl,jl),jl|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=null!==i?i.baseLanes:n,Aa(Pl,jl),jl|=r}else null!==i?(r=i.baseLanes|n,t.memoizedState=null):r=n,Aa(Pl,jl),jl|=r;return To(e,t,a,n),t.child}function ko(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Co(e,t,n,r,a){var i=Ra(n)?Na:Ca.current;return i=Oa(t,i),Ii(t,a),n=ms(e,t,n,r,i,a),r=gs(),null===e||So?(ai&&r&&ei(t),t.flags|=1,To(e,t,n,a),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,qo(e,t,a))}function Io(e,t,n,r,a){if(Ra(n)){var i=!0;La(t)}else i=!1;if(Ii(t,a),null===t.stateNode)Go(e,t),oo(t,n,r),co(t,n,r,a),r=!0;else if(null===e){var s=t.stateNode,o=t.memoizedProps;s.props=o;var l=s.context,c=n.contextType;"object"===typeof c&&null!==c?c=Ni(c):c=Oa(t,c=Ra(n)?Na:Ca.current);var u=n.getDerivedStateFromProps,h="function"===typeof u||"function"===typeof s.getSnapshotBeforeUpdate;h||"function"!==typeof s.UNSAFE_componentWillReceiveProps&&"function"!==typeof s.componentWillReceiveProps||(o!==r||l!==c)&&lo(t,s,r,c),Pi=!1;var d=t.memoizedState;s.state=d,zi(t,r,s,a),l=t.memoizedState,o!==r||d!==l||Ia.current||Pi?("function"===typeof u&&(ao(t,n,u,r),l=t.memoizedState),(o=Pi||so(t,n,o,r,d,l,c))?(h||"function"!==typeof s.UNSAFE_componentWillMount&&"function"!==typeof s.componentWillMount||("function"===typeof s.componentWillMount&&s.componentWillMount(),"function"===typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount()),"function"===typeof s.componentDidMount&&(t.flags|=4194308)):("function"===typeof s.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=l),s.props=r,s.state=l,s.context=c,r=o):("function"===typeof s.componentDidMount&&(t.flags|=4194308),r=!1)}else{s=t.stateNode,Mi(e,t),o=t.memoizedProps,c=t.type===t.elementType?o:ro(t.type,o),s.props=c,h=t.pendingProps,d=s.context,"object"===typeof(l=n.contextType)&&null!==l?l=Ni(l):l=Oa(t,l=Ra(n)?Na:Ca.current);var f=n.getDerivedStateFromProps;(u="function"===typeof f||"function"===typeof s.getSnapshotBeforeUpdate)||"function"!==typeof s.UNSAFE_componentWillReceiveProps&&"function"!==typeof s.componentWillReceiveProps||(o!==h||d!==l)&&lo(t,s,r,l),Pi=!1,d=t.memoizedState,s.state=d,zi(t,r,s,a);var p=t.memoizedState;o!==h||d!==p||Ia.current||Pi?("function"===typeof f&&(ao(t,n,f,r),p=t.memoizedState),(c=Pi||so(t,n,c,r,d,p,l)||!1)?(u||"function"!==typeof s.UNSAFE_componentWillUpdate&&"function"!==typeof s.componentWillUpdate||("function"===typeof s.componentWillUpdate&&s.componentWillUpdate(r,p,l),"function"===typeof s.UNSAFE_componentWillUpdate&&s.UNSAFE_componentWillUpdate(r,p,l)),"function"===typeof s.componentDidUpdate&&(t.flags|=4),"function"===typeof s.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof s.componentDidUpdate||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!==typeof s.getSnapshotBeforeUpdate||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=p),s.props=r,s.state=p,s.context=l,r=c):("function"!==typeof s.componentDidUpdate||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!==typeof s.getSnapshotBeforeUpdate||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),r=!1)}return No(e,t,n,r,i,a)}function No(e,t,n,r,a,i){ko(e,t);var s=0!==(128&t.flags);if(!r&&!s)return a&&Ma(t,n,!1),qo(e,t,i);r=t.stateNode,wo.current=t;var o=s&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&s?(t.child=wi(t,e.child,null,i),t.child=wi(t,null,o,i)):To(e,t,o,i),t.memoizedState=r.state,a&&Ma(t,n,!0),t.child}function Oo(e){var t=e.stateNode;t.pendingContext?ja(0,t.pendingContext,t.pendingContext!==t.context):t.context&&ja(0,t.context,!1),Qi(e,t.containerInfo)}function Ro(e,t,n,r,a){return fi(),pi(a),t.flags|=256,To(e,t,n,r),t.child}var Do,jo,Po,Lo,Mo={dehydrated:null,treeContext:null,retryLane:0};function Fo(e){return{baseLanes:e,cachePool:null,transitions:null}}function Uo(e,t,n){var r,a=t.pendingProps,s=Zi.current,o=!1,l=0!==(128&t.flags);if((r=l)||(r=(null===e||null!==e.memoizedState)&&0!==(2&s)),r?(o=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(s|=1),Aa(Zi,1&s),null===e)return ci(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(l=a.children,e=a.fallback,o?(a=t.mode,o=t.child,l={mode:"hidden",children:l},0===(1&a)&&null!==o?(o.childLanes=0,o.pendingProps=l):o=Fc(l,a,0,null),e=Mc(e,a,n,null),o.return=t,e.return=t,o.sibling=e,t.child=o,t.child.memoizedState=Fo(n),t.memoizedState=Mo,e):Vo(t,l));if(null!==(s=e.memoizedState)&&null!==(r=s.dehydrated))return function(e,t,n,r,a,s,o){if(n)return 256&t.flags?(t.flags&=-257,Bo(e,t,o,r=ho(Error(i(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(s=r.fallback,a=t.mode,r=Fc({mode:"visible",children:r.children},a,0,null),(s=Mc(s,a,o,null)).flags|=2,r.return=t,s.return=t,r.sibling=s,t.child=r,0!==(1&t.mode)&&wi(t,e.child,null,o),t.child.memoizedState=Fo(o),t.memoizedState=Mo,s);if(0===(1&t.mode))return Bo(e,t,o,null);if("$!"===a.data){if(r=a.nextSibling&&a.nextSibling.dataset)var l=r.dgst;return r=l,Bo(e,t,o,r=ho(s=Error(i(419)),r,void 0))}if(l=0!==(o&e.childLanes),So||l){if(null!==(r=Ol)){switch(o&-o){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}0!==(a=0!==(a&(r.suspendedLanes|o))?0:a)&&a!==s.retryLane&&(s.retryLane=a,ji(e,a),ac(r,e,a,-1))}return vc(),Bo(e,t,o,r=ho(Error(i(421))))}return"$?"===a.data?(t.flags|=128,t.child=e.child,t=Ic.bind(null,e),a._reactRetry=t,null):(e=s.treeContext,ri=ca(a.nextSibling),ni=t,ai=!0,ii=null,null!==e&&(Ka[Ya++]=Xa,Ka[Ya++]=Ja,Ka[Ya++]=Qa,Xa=e.id,Ja=e.overflow,Qa=t),t=Vo(t,r.children),t.flags|=4096,t)}(e,t,l,a,r,s,n);if(o){o=a.fallback,l=t.mode,r=(s=e.child).sibling;var c={mode:"hidden",children:a.children};return 0===(1&l)&&t.child!==s?((a=t.child).childLanes=0,a.pendingProps=c,t.deletions=null):(a=Pc(s,c)).subtreeFlags=14680064&s.subtreeFlags,null!==r?o=Pc(r,o):(o=Mc(o,l,n,null)).flags|=2,o.return=t,a.return=t,a.sibling=o,t.child=a,a=o,o=t.child,l=null===(l=e.child.memoizedState)?Fo(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},o.memoizedState=l,o.childLanes=e.childLanes&~n,t.memoizedState=Mo,a}return e=(o=e.child).sibling,a=Pc(o,{mode:"visible",children:a.children}),0===(1&t.mode)&&(a.lanes=n),a.return=t,a.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=a,t.memoizedState=null,a}function Vo(e,t){return(t=Fc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Bo(e,t,n,r){return null!==r&&pi(r),wi(t,e.child,null,n),(e=Vo(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function zo(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),Ci(e.return,t,n)}function Ho(e,t,n,r,a){var i=e.memoizedState;null===i?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:a}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=a)}function Wo(e,t,n){var r=t.pendingProps,a=r.revealOrder,i=r.tail;if(To(e,t,r.children,n),0!==(2&(r=Zi.current)))r=1&r|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&zo(e,n,t);else if(19===e.tag)zo(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Aa(Zi,r),0===(1&t.mode))t.memoizedState=null;else switch(a){case"forwards":for(n=t.child,a=null;null!==n;)null!==(e=n.alternate)&&null===es(e)&&(a=n),n=n.sibling;null===(n=a)?(a=t.child,t.child=null):(a=n.sibling,n.sibling=null),Ho(t,!1,a,n,i);break;case"backwards":for(n=null,a=t.child,t.child=null;null!==a;){if(null!==(e=a.alternate)&&null===es(e)){t.child=a;break}e=a.sibling,a.sibling=n,n=a,a=e}Ho(t,!0,n,null,i);break;case"together":Ho(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Go(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function qo(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Fl|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(i(153));if(null!==t.child){for(n=Pc(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Pc(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Ko(e,t){if(!ai)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Yo(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var a=e.child;null!==a;)n|=a.lanes|a.childLanes,r|=14680064&a.subtreeFlags,r|=14680064&a.flags,a.return=e,a=a.sibling;else for(a=e.child;null!==a;)n|=a.lanes|a.childLanes,r|=a.subtreeFlags,r|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Qo(e,t,n){var r=t.pendingProps;switch(ti(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Yo(t),null;case 1:case 17:return Ra(t.type)&&Da(),Yo(t),null;case 3:return r=t.stateNode,Xi(),_a(Ia),_a(Ca),ns(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(hi(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==ii&&(lc(ii),ii=null))),jo(e,t),Yo(t),null;case 5:$i(t);var a=Yi(Ki.current);if(n=t.type,null!==e&&null!=t.stateNode)Po(e,t,n,r,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(null===t.stateNode)throw Error(i(166));return Yo(t),null}if(e=Yi(Gi.current),hi(t)){r=t.stateNode,n=t.type;var s=t.memoizedProps;switch(r[da]=t,r[fa]=s,e=0!==(1&t.mode),n){case"dialog":Ur("cancel",r),Ur("close",r);break;case"iframe":case"object":case"embed":Ur("load",r);break;case"video":case"audio":for(a=0;a<Pr.length;a++)Ur(Pr[a],r);break;case"source":Ur("error",r);break;case"img":case"image":case"link":Ur("error",r),Ur("load",r);break;case"details":Ur("toggle",r);break;case"input":X(r,s),Ur("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},Ur("invalid",r);break;case"textarea":ae(r,s),Ur("invalid",r)}for(var l in ye(n,s),a=null,s)if(s.hasOwnProperty(l)){var c=s[l];"children"===l?"string"===typeof c?r.textContent!==c&&(!0!==s.suppressHydrationWarning&&$r(r.textContent,c,e),a=["children",c]):"number"===typeof c&&r.textContent!==""+c&&(!0!==s.suppressHydrationWarning&&$r(r.textContent,c,e),a=["children",""+c]):o.hasOwnProperty(l)&&null!=c&&"onScroll"===l&&Ur("scroll",r)}switch(n){case"input":q(r),Z(r,s,!0);break;case"textarea":q(r),se(r);break;case"select":case"option":break;default:"function"===typeof s.onClick&&(r.onclick=Zr)}r=a,t.updateQueue=r,null!==r&&(t.flags|=4)}else{l=9===a.nodeType?a:a.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=oe(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof r.is?e=l.createElement(n,{is:r.is}):(e=l.createElement(n),"select"===n&&(l=e,r.multiple?l.multiple=!0:r.size&&(l.size=r.size))):e=l.createElementNS(e,n),e[da]=t,e[fa]=r,Do(e,t,!1,!1),t.stateNode=e;e:{switch(l=be(n,r),n){case"dialog":Ur("cancel",e),Ur("close",e),a=r;break;case"iframe":case"object":case"embed":Ur("load",e),a=r;break;case"video":case"audio":for(a=0;a<Pr.length;a++)Ur(Pr[a],e);a=r;break;case"source":Ur("error",e),a=r;break;case"img":case"image":case"link":Ur("error",e),Ur("load",e),a=r;break;case"details":Ur("toggle",e),a=r;break;case"input":X(e,r),a=Q(e,r),Ur("invalid",e);break;case"option":default:a=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},a=M({},r,{value:void 0}),Ur("invalid",e);break;case"textarea":ae(e,r),a=re(e,r),Ur("invalid",e)}for(s in ye(n,a),c=a)if(c.hasOwnProperty(s)){var u=c[s];"style"===s?ge(e,u):"dangerouslySetInnerHTML"===s?null!=(u=u?u.__html:void 0)&&he(e,u):"children"===s?"string"===typeof u?("textarea"!==n||""!==u)&&de(e,u):"number"===typeof u&&de(e,""+u):"suppressContentEditableWarning"!==s&&"suppressHydrationWarning"!==s&&"autoFocus"!==s&&(o.hasOwnProperty(s)?null!=u&&"onScroll"===s&&Ur("scroll",e):null!=u&&b(e,s,u,l))}switch(n){case"input":q(e),Z(e,r,!1);break;case"textarea":q(e),se(e);break;case"option":null!=r.value&&e.setAttribute("value",""+W(r.value));break;case"select":e.multiple=!!r.multiple,null!=(s=r.value)?ne(e,!!r.multiple,s,!1):null!=r.defaultValue&&ne(e,!!r.multiple,r.defaultValue,!0);break;default:"function"===typeof a.onClick&&(e.onclick=Zr)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Yo(t),null;case 6:if(e&&null!=t.stateNode)Lo(e,t,e.memoizedProps,r);else{if("string"!==typeof r&&null===t.stateNode)throw Error(i(166));if(n=Yi(Ki.current),Yi(Gi.current),hi(t)){if(r=t.stateNode,n=t.memoizedProps,r[da]=t,(s=r.nodeValue!==n)&&null!==(e=ni))switch(e.tag){case 3:$r(r.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&$r(r.nodeValue,n,0!==(1&e.mode))}s&&(t.flags|=4)}else(r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[da]=t,t.stateNode=r}return Yo(t),null;case 13:if(_a(Zi),r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(ai&&null!==ri&&0!==(1&t.mode)&&0===(128&t.flags))di(),fi(),t.flags|=98560,s=!1;else if(s=hi(t),null!==r&&null!==r.dehydrated){if(null===e){if(!s)throw Error(i(318));if(!(s=null!==(s=t.memoizedState)?s.dehydrated:null))throw Error(i(317));s[da]=t}else fi(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Yo(t),s=!1}else null!==ii&&(lc(ii),ii=null),s=!0;if(!s)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=n,t):((r=null!==r)!==(null!==e&&null!==e.memoizedState)&&r&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&Zi.current)?0===Ll&&(Ll=3):vc())),null!==t.updateQueue&&(t.flags|=4),Yo(t),null);case 4:return Xi(),jo(e,t),null===e&&zr(t.stateNode.containerInfo),Yo(t),null;case 10:return ki(t.type._context),Yo(t),null;case 19:if(_a(Zi),null===(s=t.memoizedState))return Yo(t),null;if(r=0!==(128&t.flags),null===(l=s.rendering))if(r)Ko(s,!1);else{if(0!==Ll||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(l=es(e))){for(t.flags|=128,Ko(s,!1),null!==(r=l.updateQueue)&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;null!==n;)e=r,(s=n).flags&=14680066,null===(l=s.alternate)?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=l.childLanes,s.lanes=l.lanes,s.child=l.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=l.memoizedProps,s.memoizedState=l.memoizedState,s.updateQueue=l.updateQueue,s.type=l.type,e=l.dependencies,s.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Aa(Zi,1&Zi.current|2),t.child}e=e.sibling}null!==s.tail&&Je()>Wl&&(t.flags|=128,r=!0,Ko(s,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=es(l))){if(t.flags|=128,r=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),Ko(s,!0),null===s.tail&&"hidden"===s.tailMode&&!l.alternate&&!ai)return Yo(t),null}else 2*Je()-s.renderingStartTime>Wl&&1073741824!==n&&(t.flags|=128,r=!0,Ko(s,!1),t.lanes=4194304);s.isBackwards?(l.sibling=t.child,t.child=l):(null!==(n=s.last)?n.sibling=l:t.child=l,s.last=l)}return null!==s.tail?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=Je(),t.sibling=null,n=Zi.current,Aa(Zi,r?1&n|2:1&n),t):(Yo(t),null);case 22:case 23:return fc(),r=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==r&&(t.flags|=8192),r&&0!==(1&t.mode)?0!==(1073741824&jl)&&(Yo(t),6&t.subtreeFlags&&(t.flags|=8192)):Yo(t),null;case 24:case 25:return null}throw Error(i(156,t.tag))}function Xo(e,t){switch(ti(t),t.tag){case 1:return Ra(t.type)&&Da(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Xi(),_a(Ia),_a(Ca),ns(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return $i(t),null;case 13:if(_a(Zi),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(i(340));fi()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return _a(Zi),null;case 4:return Xi(),null;case 10:return ki(t.type._context),null;case 22:case 23:return fc(),null;default:return null}}Do=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},jo=function(){},Po=function(e,t,n,r){var a=e.memoizedProps;if(a!==r){e=t.stateNode,Yi(Gi.current);var i,s=null;switch(n){case"input":a=Q(e,a),r=Q(e,r),s=[];break;case"select":a=M({},a,{value:void 0}),r=M({},r,{value:void 0}),s=[];break;case"textarea":a=re(e,a),r=re(e,r),s=[];break;default:"function"!==typeof a.onClick&&"function"===typeof r.onClick&&(e.onclick=Zr)}for(u in ye(n,r),n=null,a)if(!r.hasOwnProperty(u)&&a.hasOwnProperty(u)&&null!=a[u])if("style"===u){var l=a[u];for(i in l)l.hasOwnProperty(i)&&(n||(n={}),n[i]="")}else"dangerouslySetInnerHTML"!==u&&"children"!==u&&"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&"autoFocus"!==u&&(o.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in r){var c=r[u];if(l=null!=a?a[u]:void 0,r.hasOwnProperty(u)&&c!==l&&(null!=c||null!=l))if("style"===u)if(l){for(i in l)!l.hasOwnProperty(i)||c&&c.hasOwnProperty(i)||(n||(n={}),n[i]="");for(i in c)c.hasOwnProperty(i)&&l[i]!==c[i]&&(n||(n={}),n[i]=c[i])}else n||(s||(s=[]),s.push(u,n)),n=c;else"dangerouslySetInnerHTML"===u?(c=c?c.__html:void 0,l=l?l.__html:void 0,null!=c&&l!==c&&(s=s||[]).push(u,c)):"children"===u?"string"!==typeof c&&"number"!==typeof c||(s=s||[]).push(u,""+c):"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&(o.hasOwnProperty(u)?(null!=c&&"onScroll"===u&&Ur("scroll",e),s||l===c||(s=[])):(s=s||[]).push(u,c))}n&&(s=s||[]).push("style",n);var u=s;(t.updateQueue=u)&&(t.flags|=4)}},Lo=function(e,t,n,r){n!==r&&(t.flags|=4)};var Jo=!1,$o=!1,Zo="function"===typeof WeakSet?WeakSet:Set,el=null;function tl(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(r){Ac(e,t,r)}else n.current=null}function nl(e,t,n){try{n()}catch(r){Ac(e,t,r)}}var rl=!1;function al(e,t,n){var r=t.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var a=r=r.next;do{if((a.tag&e)===e){var i=a.destroy;a.destroy=void 0,void 0!==i&&nl(t,n,i)}a=a.next}while(a!==r)}}function il(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function sl(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function ol(e){var t=e.alternate;null!==t&&(e.alternate=null,ol(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[da],delete t[fa],delete t[ma],delete t[ga],delete t[va])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function ll(e){return 5===e.tag||3===e.tag||4===e.tag}function cl(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||ll(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function ul(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Zr));else if(4!==r&&null!==(e=e.child))for(ul(e,t,n),e=e.sibling;null!==e;)ul(e,t,n),e=e.sibling}function hl(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(hl(e,t,n),e=e.sibling;null!==e;)hl(e,t,n),e=e.sibling}var dl=null,fl=!1;function pl(e,t,n){for(n=n.child;null!==n;)ml(e,t,n),n=n.sibling}function ml(e,t,n){if(it&&"function"===typeof it.onCommitFiberUnmount)try{it.onCommitFiberUnmount(at,n)}catch(o){}switch(n.tag){case 5:$o||tl(n,t);case 6:var r=dl,a=fl;dl=null,pl(e,t,n),fl=a,null!==(dl=r)&&(fl?(e=dl,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):dl.removeChild(n.stateNode));break;case 18:null!==dl&&(fl?(e=dl,n=n.stateNode,8===e.nodeType?la(e.parentNode,n):1===e.nodeType&&la(e,n),zt(e)):la(dl,n.stateNode));break;case 4:r=dl,a=fl,dl=n.stateNode.containerInfo,fl=!0,pl(e,t,n),dl=r,fl=a;break;case 0:case 11:case 14:case 15:if(!$o&&(null!==(r=n.updateQueue)&&null!==(r=r.lastEffect))){a=r=r.next;do{var i=a,s=i.destroy;i=i.tag,void 0!==s&&(0!==(2&i)||0!==(4&i))&&nl(n,t,s),a=a.next}while(a!==r)}pl(e,t,n);break;case 1:if(!$o&&(tl(n,t),"function"===typeof(r=n.stateNode).componentWillUnmount))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(o){Ac(n,t,o)}pl(e,t,n);break;case 21:pl(e,t,n);break;case 22:1&n.mode?($o=(r=$o)||null!==n.memoizedState,pl(e,t,n),$o=r):pl(e,t,n);break;default:pl(e,t,n)}}function gl(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Zo),t.forEach((function(t){var r=Nc.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))}))}}function vl(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var a=n[r];try{var s=e,o=t,l=o;e:for(;null!==l;){switch(l.tag){case 5:dl=l.stateNode,fl=!1;break e;case 3:case 4:dl=l.stateNode.containerInfo,fl=!0;break e}l=l.return}if(null===dl)throw Error(i(160));ml(s,o,a),dl=null,fl=!1;var c=a.alternate;null!==c&&(c.return=null),a.return=null}catch(u){Ac(a,t,u)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)yl(t,e),t=t.sibling}function yl(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(vl(t,e),bl(e),4&r){try{al(3,e,e.return),il(3,e)}catch(g){Ac(e,e.return,g)}try{al(5,e,e.return)}catch(g){Ac(e,e.return,g)}}break;case 1:vl(t,e),bl(e),512&r&&null!==n&&tl(n,n.return);break;case 5:if(vl(t,e),bl(e),512&r&&null!==n&&tl(n,n.return),32&e.flags){var a=e.stateNode;try{de(a,"")}catch(g){Ac(e,e.return,g)}}if(4&r&&null!=(a=e.stateNode)){var s=e.memoizedProps,o=null!==n?n.memoizedProps:s,l=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===l&&"radio"===s.type&&null!=s.name&&J(a,s),be(l,o);var u=be(l,s);for(o=0;o<c.length;o+=2){var h=c[o],d=c[o+1];"style"===h?ge(a,d):"dangerouslySetInnerHTML"===h?he(a,d):"children"===h?de(a,d):b(a,h,d,u)}switch(l){case"input":$(a,s);break;case"textarea":ie(a,s);break;case"select":var f=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!s.multiple;var p=s.value;null!=p?ne(a,!!s.multiple,p,!1):f!==!!s.multiple&&(null!=s.defaultValue?ne(a,!!s.multiple,s.defaultValue,!0):ne(a,!!s.multiple,s.multiple?[]:"",!1))}a[fa]=s}catch(g){Ac(e,e.return,g)}}break;case 6:if(vl(t,e),bl(e),4&r){if(null===e.stateNode)throw Error(i(162));a=e.stateNode,s=e.memoizedProps;try{a.nodeValue=s}catch(g){Ac(e,e.return,g)}}break;case 3:if(vl(t,e),bl(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{zt(t.containerInfo)}catch(g){Ac(e,e.return,g)}break;case 4:default:vl(t,e),bl(e);break;case 13:vl(t,e),bl(e),8192&(a=e.child).flags&&(s=null!==a.memoizedState,a.stateNode.isHidden=s,!s||null!==a.alternate&&null!==a.alternate.memoizedState||(Hl=Je())),4&r&&gl(e);break;case 22:if(h=null!==n&&null!==n.memoizedState,1&e.mode?($o=(u=$o)||h,vl(t,e),$o=u):vl(t,e),bl(e),8192&r){if(u=null!==e.memoizedState,(e.stateNode.isHidden=u)&&!h&&0!==(1&e.mode))for(el=e,h=e.child;null!==h;){for(d=el=h;null!==el;){switch(p=(f=el).child,f.tag){case 0:case 11:case 14:case 15:al(4,f,f.return);break;case 1:tl(f,f.return);var m=f.stateNode;if("function"===typeof m.componentWillUnmount){r=f,n=f.return;try{t=r,m.props=t.memoizedProps,m.state=t.memoizedState,m.componentWillUnmount()}catch(g){Ac(r,n,g)}}break;case 5:tl(f,f.return);break;case 22:if(null!==f.memoizedState){El(d);continue}}null!==p?(p.return=f,el=p):El(d)}h=h.sibling}e:for(h=null,d=e;;){if(5===d.tag){if(null===h){h=d;try{a=d.stateNode,u?"function"===typeof(s=a.style).setProperty?s.setProperty("display","none","important"):s.display="none":(l=d.stateNode,o=void 0!==(c=d.memoizedProps.style)&&null!==c&&c.hasOwnProperty("display")?c.display:null,l.style.display=me("display",o))}catch(g){Ac(e,e.return,g)}}}else if(6===d.tag){if(null===h)try{d.stateNode.nodeValue=u?"":d.memoizedProps}catch(g){Ac(e,e.return,g)}}else if((22!==d.tag&&23!==d.tag||null===d.memoizedState||d===e)&&null!==d.child){d.child.return=d,d=d.child;continue}if(d===e)break e;for(;null===d.sibling;){if(null===d.return||d.return===e)break e;h===d&&(h=null),d=d.return}h===d&&(h=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:vl(t,e),bl(e),4&r&&gl(e);case 21:}}function bl(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(ll(n)){var r=n;break e}n=n.return}throw Error(i(160))}switch(r.tag){case 5:var a=r.stateNode;32&r.flags&&(de(a,""),r.flags&=-33),hl(e,cl(e),a);break;case 3:case 4:var s=r.stateNode.containerInfo;ul(e,cl(e),s);break;default:throw Error(i(161))}}catch(o){Ac(e,e.return,o)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function wl(e,t,n){el=e,Sl(e,t,n)}function Sl(e,t,n){for(var r=0!==(1&e.mode);null!==el;){var a=el,i=a.child;if(22===a.tag&&r){var s=null!==a.memoizedState||Jo;if(!s){var o=a.alternate,l=null!==o&&null!==o.memoizedState||$o;o=Jo;var c=$o;if(Jo=s,($o=l)&&!c)for(el=a;null!==el;)l=(s=el).child,22===s.tag&&null!==s.memoizedState?xl(a):null!==l?(l.return=s,el=l):xl(a);for(;null!==i;)el=i,Sl(i,t,n),i=i.sibling;el=a,Jo=o,$o=c}Tl(e)}else 0!==(8772&a.subtreeFlags)&&null!==i?(i.return=a,el=i):Tl(e)}}function Tl(e){for(;null!==el;){var t=el;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:$o||il(5,t);break;case 1:var r=t.stateNode;if(4&t.flags&&!$o)if(null===n)r.componentDidMount();else{var a=t.elementType===t.type?n.memoizedProps:ro(t.type,n.memoizedProps);r.componentDidUpdate(a,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;null!==s&&Hi(t,s,r);break;case 3:var o=t.updateQueue;if(null!==o){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}Hi(t,o,n)}break;case 5:var l=t.stateNode;if(null===n&&4&t.flags){n=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var u=t.alternate;if(null!==u){var h=u.memoizedState;if(null!==h){var d=h.dehydrated;null!==d&&zt(d)}}}break;default:throw Error(i(163))}$o||512&t.flags&&sl(t)}catch(f){Ac(t,t.return,f)}}if(t===e){el=null;break}if(null!==(n=t.sibling)){n.return=t.return,el=n;break}el=t.return}}function El(e){for(;null!==el;){var t=el;if(t===e){el=null;break}var n=t.sibling;if(null!==n){n.return=t.return,el=n;break}el=t.return}}function xl(e){for(;null!==el;){var t=el;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{il(4,t)}catch(l){Ac(t,n,l)}break;case 1:var r=t.stateNode;if("function"===typeof r.componentDidMount){var a=t.return;try{r.componentDidMount()}catch(l){Ac(t,a,l)}}var i=t.return;try{sl(t)}catch(l){Ac(t,i,l)}break;case 5:var s=t.return;try{sl(t)}catch(l){Ac(t,s,l)}}}catch(l){Ac(t,t.return,l)}if(t===e){el=null;break}var o=t.sibling;if(null!==o){o.return=t.return,el=o;break}el=t.return}}var _l,Al=Math.ceil,kl=w.ReactCurrentDispatcher,Cl=w.ReactCurrentOwner,Il=w.ReactCurrentBatchConfig,Nl=0,Ol=null,Rl=null,Dl=0,jl=0,Pl=xa(0),Ll=0,Ml=null,Fl=0,Ul=0,Vl=0,Bl=null,zl=null,Hl=0,Wl=1/0,Gl=null,ql=!1,Kl=null,Yl=null,Ql=!1,Xl=null,Jl=0,$l=0,Zl=null,ec=-1,tc=0;function nc(){return 0!==(6&Nl)?Je():-1!==ec?ec:ec=Je()}function rc(e){return 0===(1&e.mode)?1:0!==(2&Nl)&&0!==Dl?Dl&-Dl:null!==mi.transition?(0===tc&&(tc=mt()),tc):0!==(e=bt)?e:e=void 0===(e=window.event)?16:Xt(e.type)}function ac(e,t,n,r){if(50<$l)throw $l=0,Zl=null,Error(i(185));vt(e,n,r),0!==(2&Nl)&&e===Ol||(e===Ol&&(0===(2&Nl)&&(Ul|=n),4===Ll&&cc(e,Dl)),ic(e,r),1===n&&0===Nl&&0===(1&t.mode)&&(Wl=Je()+500,Ua&&za()))}function ic(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,a=e.expirationTimes,i=e.pendingLanes;0<i;){var s=31-st(i),o=1<<s,l=a[s];-1===l?0!==(o&n)&&0===(o&r)||(a[s]=ft(o,t)):l<=t&&(e.expiredLanes|=o),i&=~o}}(e,t);var r=dt(e,e===Ol?Dl:0);if(0===r)null!==n&&Ye(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(null!=n&&Ye(n),1===t)0===e.tag?function(e){Ua=!0,Ba(e)}(uc.bind(null,e)):Ba(uc.bind(null,e)),sa((function(){0===(6&Nl)&&za()})),n=null;else{switch(wt(r)){case 1:n=Ze;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=rt}n=Oc(n,sc.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function sc(e,t){if(ec=-1,tc=0,0!==(6&Nl))throw Error(i(327));var n=e.callbackNode;if(xc()&&e.callbackNode!==n)return null;var r=dt(e,e===Ol?Dl:0);if(0===r)return null;if(0!==(30&r)||0!==(r&e.expiredLanes)||t)t=yc(e,r);else{t=r;var a=Nl;Nl|=2;var s=gc();for(Ol===e&&Dl===t||(Gl=null,Wl=Je()+500,pc(e,t));;)try{wc();break}catch(l){mc(e,l)}Ai(),kl.current=s,Nl=a,null!==Rl?t=0:(Ol=null,Dl=0,t=Ll)}if(0!==t){if(2===t&&(0!==(a=pt(e))&&(r=a,t=oc(e,a))),1===t)throw n=Ml,pc(e,0),cc(e,r),ic(e,Je()),n;if(6===t)cc(e,r);else{if(a=e.current.alternate,0===(30&r)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var r=0;r<n.length;r++){var a=n[r],i=a.getSnapshot;a=a.value;try{if(!or(i(),a))return!1}catch(o){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(a)&&(2===(t=yc(e,r))&&(0!==(s=pt(e))&&(r=s,t=oc(e,s))),1===t))throw n=Ml,pc(e,0),cc(e,r),ic(e,Je()),n;switch(e.finishedWork=a,e.finishedLanes=r,t){case 0:case 1:throw Error(i(345));case 2:case 5:Ec(e,zl,Gl);break;case 3:if(cc(e,r),(130023424&r)===r&&10<(t=Hl+500-Je())){if(0!==dt(e,0))break;if(((a=e.suspendedLanes)&r)!==r){nc(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=ra(Ec.bind(null,e,zl,Gl),t);break}Ec(e,zl,Gl);break;case 4:if(cc(e,r),(4194240&r)===r)break;for(t=e.eventTimes,a=-1;0<r;){var o=31-st(r);s=1<<o,(o=t[o])>a&&(a=o),r&=~s}if(r=a,10<(r=(120>(r=Je()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Al(r/1960))-r)){e.timeoutHandle=ra(Ec.bind(null,e,zl,Gl),r);break}Ec(e,zl,Gl);break;default:throw Error(i(329))}}}return ic(e,Je()),e.callbackNode===n?sc.bind(null,e):null}function oc(e,t){var n=Bl;return e.current.memoizedState.isDehydrated&&(pc(e,t).flags|=256),2!==(e=yc(e,t))&&(t=zl,zl=n,null!==t&&lc(t)),e}function lc(e){null===zl?zl=e:zl.push.apply(zl,e)}function cc(e,t){for(t&=~Vl,t&=~Ul,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-st(t),r=1<<n;e[n]=-1,t&=~r}}function uc(e){if(0!==(6&Nl))throw Error(i(327));xc();var t=dt(e,0);if(0===(1&t))return ic(e,Je()),null;var n=yc(e,t);if(0!==e.tag&&2===n){var r=pt(e);0!==r&&(t=r,n=oc(e,r))}if(1===n)throw n=Ml,pc(e,0),cc(e,t),ic(e,Je()),n;if(6===n)throw Error(i(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Ec(e,zl,Gl),ic(e,Je()),null}function hc(e,t){var n=Nl;Nl|=1;try{return e(t)}finally{0===(Nl=n)&&(Wl=Je()+500,Ua&&za())}}function dc(e){null!==Xl&&0===Xl.tag&&0===(6&Nl)&&xc();var t=Nl;Nl|=1;var n=Il.transition,r=bt;try{if(Il.transition=null,bt=1,e)return e()}finally{bt=r,Il.transition=n,0===(6&(Nl=t))&&za()}}function fc(){jl=Pl.current,_a(Pl)}function pc(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,aa(n)),null!==Rl)for(n=Rl.return;null!==n;){var r=n;switch(ti(r),r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&Da();break;case 3:Xi(),_a(Ia),_a(Ca),ns();break;case 5:$i(r);break;case 4:Xi();break;case 13:case 19:_a(Zi);break;case 10:ki(r.type._context);break;case 22:case 23:fc()}n=n.return}if(Ol=e,Rl=e=Pc(e.current,null),Dl=jl=t,Ll=0,Ml=null,Vl=Ul=Fl=0,zl=Bl=null,null!==Oi){for(t=0;t<Oi.length;t++)if(null!==(r=(n=Oi[t]).interleaved)){n.interleaved=null;var a=r.next,i=n.pending;if(null!==i){var s=i.next;i.next=a,r.next=s}n.pending=r}Oi=null}return e}function mc(e,t){for(;;){var n=Rl;try{if(Ai(),rs.current=$s,cs){for(var r=ss.memoizedState;null!==r;){var a=r.queue;null!==a&&(a.pending=null),r=r.next}cs=!1}if(is=0,ls=os=ss=null,us=!1,hs=0,Cl.current=null,null===n||null===n.return){Ll=1,Ml=t,Rl=null;break}e:{var s=e,o=n.return,l=n,c=t;if(t=Dl,l.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var u=c,h=l,d=h.tag;if(0===(1&h.mode)&&(0===d||11===d||15===d)){var f=h.alternate;f?(h.updateQueue=f.updateQueue,h.memoizedState=f.memoizedState,h.lanes=f.lanes):(h.updateQueue=null,h.memoizedState=null)}var p=yo(o);if(null!==p){p.flags&=-257,bo(p,o,l,0,t),1&p.mode&&vo(s,u,t),c=u;var m=(t=p).updateQueue;if(null===m){var g=new Set;g.add(c),t.updateQueue=g}else m.add(c);break e}if(0===(1&t)){vo(s,u,t),vc();break e}c=Error(i(426))}else if(ai&&1&l.mode){var v=yo(o);if(null!==v){0===(65536&v.flags)&&(v.flags|=256),bo(v,o,l,0,t),pi(uo(c,l));break e}}s=c=uo(c,l),4!==Ll&&(Ll=2),null===Bl?Bl=[s]:Bl.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t,Bi(s,mo(0,c,t));break e;case 1:l=c;var y=s.type,b=s.stateNode;if(0===(128&s.flags)&&("function"===typeof y.getDerivedStateFromError||null!==b&&"function"===typeof b.componentDidCatch&&(null===Yl||!Yl.has(b)))){s.flags|=65536,t&=-t,s.lanes|=t,Bi(s,go(s,l,t));break e}}s=s.return}while(null!==s)}Tc(n)}catch(w){t=w,Rl===n&&null!==n&&(Rl=n=n.return);continue}break}}function gc(){var e=kl.current;return kl.current=$s,null===e?$s:e}function vc(){0!==Ll&&3!==Ll&&2!==Ll||(Ll=4),null===Ol||0===(268435455&Fl)&&0===(268435455&Ul)||cc(Ol,Dl)}function yc(e,t){var n=Nl;Nl|=2;var r=gc();for(Ol===e&&Dl===t||(Gl=null,pc(e,t));;)try{bc();break}catch(a){mc(e,a)}if(Ai(),Nl=n,kl.current=r,null!==Rl)throw Error(i(261));return Ol=null,Dl=0,Ll}function bc(){for(;null!==Rl;)Sc(Rl)}function wc(){for(;null!==Rl&&!Qe();)Sc(Rl)}function Sc(e){var t=_l(e.alternate,e,jl);e.memoizedProps=e.pendingProps,null===t?Tc(e):Rl=t,Cl.current=null}function Tc(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=Qo(n,t,jl)))return void(Rl=n)}else{if(null!==(n=Xo(n,t)))return n.flags&=32767,void(Rl=n);if(null===e)return Ll=6,void(Rl=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Rl=t);Rl=t=e}while(null!==t);0===Ll&&(Ll=5)}function Ec(e,t,n){var r=bt,a=Il.transition;try{Il.transition=null,bt=1,function(e,t,n,r){do{xc()}while(null!==Xl);if(0!==(6&Nl))throw Error(i(327));n=e.finishedWork;var a=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(i(177));e.callbackNode=null,e.callbackPriority=0;var s=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var a=31-st(n),i=1<<a;t[a]=0,r[a]=-1,e[a]=-1,n&=~i}}(e,s),e===Ol&&(Rl=Ol=null,Dl=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||Ql||(Ql=!0,Oc(tt,(function(){return xc(),null}))),s=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||s){s=Il.transition,Il.transition=null;var o=bt;bt=1;var l=Nl;Nl|=4,Cl.current=null,function(e,t){if(ea=Wt,fr(e=dr())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var a=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch(to){n=null;break e}var o=0,l=-1,c=-1,u=0,h=0,d=e,f=null;t:for(;;){for(var p;d!==n||0!==a&&3!==d.nodeType||(l=o+a),d!==s||0!==r&&3!==d.nodeType||(c=o+r),3===d.nodeType&&(o+=d.nodeValue.length),null!==(p=d.firstChild);)f=d,d=p;for(;;){if(d===e)break t;if(f===n&&++u===a&&(l=o),f===s&&++h===r&&(c=o),null!==(p=d.nextSibling))break;f=(d=f).parentNode}d=p}n=-1===l||-1===c?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(ta={focusedElem:e,selectionRange:n},Wt=!1,el=t;null!==el;)if(e=(t=el).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,el=e;else for(;null!==el;){t=el;try{var m=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==m){var g=m.memoizedProps,v=m.memoizedState,y=t.stateNode,b=y.getSnapshotBeforeUpdate(t.elementType===t.type?g:ro(t.type,g),v);y.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var w=t.stateNode.containerInfo;1===w.nodeType?w.textContent="":9===w.nodeType&&w.documentElement&&w.removeChild(w.documentElement);break;default:throw Error(i(163))}}catch(to){Ac(t,t.return,to)}if(null!==(e=t.sibling)){e.return=t.return,el=e;break}el=t.return}m=rl,rl=!1}(e,n),yl(n,e),pr(ta),Wt=!!ea,ta=ea=null,e.current=n,wl(n,e,a),Xe(),Nl=l,bt=o,Il.transition=s}else e.current=n;if(Ql&&(Ql=!1,Xl=e,Jl=a),s=e.pendingLanes,0===s&&(Yl=null),function(e){if(it&&"function"===typeof it.onCommitFiberRoot)try{it.onCommitFiberRoot(at,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),ic(e,Je()),null!==t)for(r=e.onRecoverableError,n=0;n<t.length;n++)a=t[n],r(a.value,{componentStack:a.stack,digest:a.digest});if(ql)throw ql=!1,e=Kl,Kl=null,e;0!==(1&Jl)&&0!==e.tag&&xc(),s=e.pendingLanes,0!==(1&s)?e===Zl?$l++:($l=0,Zl=e):$l=0,za()}(e,t,n,r)}finally{Il.transition=a,bt=r}return null}function xc(){if(null!==Xl){var e=wt(Jl),t=Il.transition,n=bt;try{if(Il.transition=null,bt=16>e?16:e,null===Xl)var r=!1;else{if(e=Xl,Xl=null,Jl=0,0!==(6&Nl))throw Error(i(331));var a=Nl;for(Nl|=4,el=e.current;null!==el;){var s=el,o=s.child;if(0!==(16&el.flags)){var l=s.deletions;if(null!==l){for(var c=0;c<l.length;c++){var u=l[c];for(el=u;null!==el;){var h=el;switch(h.tag){case 0:case 11:case 15:al(8,h,s)}var d=h.child;if(null!==d)d.return=h,el=d;else for(;null!==el;){var f=(h=el).sibling,p=h.return;if(ol(h),h===u){el=null;break}if(null!==f){f.return=p,el=f;break}el=p}}}var m=s.alternate;if(null!==m){var g=m.child;if(null!==g){m.child=null;do{var v=g.sibling;g.sibling=null,g=v}while(null!==g)}}el=s}}if(0!==(2064&s.subtreeFlags)&&null!==o)o.return=s,el=o;else e:for(;null!==el;){if(0!==(2048&(s=el).flags))switch(s.tag){case 0:case 11:case 15:al(9,s,s.return)}var y=s.sibling;if(null!==y){y.return=s.return,el=y;break e}el=s.return}}var b=e.current;for(el=b;null!==el;){var w=(o=el).child;if(0!==(2064&o.subtreeFlags)&&null!==w)w.return=o,el=w;else e:for(o=b;null!==el;){if(0!==(2048&(l=el).flags))try{switch(l.tag){case 0:case 11:case 15:il(9,l)}}catch(T){Ac(l,l.return,T)}if(l===o){el=null;break e}var S=l.sibling;if(null!==S){S.return=l.return,el=S;break e}el=l.return}}if(Nl=a,za(),it&&"function"===typeof it.onPostCommitFiberRoot)try{it.onPostCommitFiberRoot(at,e)}catch(T){}r=!0}return r}finally{bt=n,Il.transition=t}}return!1}function _c(e,t,n){e=Ui(e,t=mo(0,t=uo(n,t),1),1),t=nc(),null!==e&&(vt(e,1,t),ic(e,t))}function Ac(e,t,n){if(3===e.tag)_c(e,e,n);else for(;null!==t;){if(3===t.tag){_c(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===Yl||!Yl.has(r))){t=Ui(t,e=go(t,e=uo(n,e),1),1),e=nc(),null!==t&&(vt(t,1,e),ic(t,e));break}}t=t.return}}function kc(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=nc(),e.pingedLanes|=e.suspendedLanes&n,Ol===e&&(Dl&n)===n&&(4===Ll||3===Ll&&(130023424&Dl)===Dl&&500>Je()-Hl?pc(e,0):Vl|=n),ic(e,t)}function Cc(e,t){0===t&&(0===(1&e.mode)?t=1:(t=ut,0===(130023424&(ut<<=1))&&(ut=4194304)));var n=nc();null!==(e=ji(e,t))&&(vt(e,t,n),ic(e,n))}function Ic(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Cc(e,n)}function Nc(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,a=e.memoizedState;null!==a&&(n=a.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(i(314))}null!==r&&r.delete(t),Cc(e,n)}function Oc(e,t){return Ke(e,t)}function Rc(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Dc(e,t,n,r){return new Rc(e,t,n,r)}function jc(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Pc(e,t){var n=e.alternate;return null===n?((n=Dc(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Lc(e,t,n,r,a,s){var o=2;if(r=e,"function"===typeof e)jc(e)&&(o=1);else if("string"===typeof e)o=5;else e:switch(e){case E:return Mc(n.children,a,s,t);case x:o=8,a|=8;break;case _:return(e=Dc(12,n,t,2|a)).elementType=_,e.lanes=s,e;case I:return(e=Dc(13,n,t,a)).elementType=I,e.lanes=s,e;case N:return(e=Dc(19,n,t,a)).elementType=N,e.lanes=s,e;case D:return Fc(n,a,s,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case A:o=10;break e;case k:o=9;break e;case C:o=11;break e;case O:o=14;break e;case R:o=16,r=null;break e}throw Error(i(130,null==e?e:typeof e,""))}return(t=Dc(o,n,t,a)).elementType=e,t.type=r,t.lanes=s,t}function Mc(e,t,n,r){return(e=Dc(7,e,r,t)).lanes=n,e}function Fc(e,t,n,r){return(e=Dc(22,e,r,t)).elementType=D,e.lanes=n,e.stateNode={isHidden:!1},e}function Uc(e,t,n){return(e=Dc(6,e,null,t)).lanes=n,e}function Vc(e,t,n){return(t=Dc(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Bc(e,t,n,r,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gt(0),this.expirationTimes=gt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gt(0),this.identifierPrefix=r,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function zc(e,t,n,r,a,i,s,o,l){return e=new Bc(e,t,n,o,l),1===t?(t=1,!0===i&&(t|=8)):t=0,i=Dc(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Li(i),e}function Hc(e){if(!e)return ka;e:{if(ze(e=e._reactInternals)!==e||1!==e.tag)throw Error(i(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Ra(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(i(171))}if(1===e.tag){var n=e.type;if(Ra(n))return Pa(e,n,t)}return t}function Wc(e,t,n,r,a,i,s,o,l){return(e=zc(n,r,!0,e,0,i,0,o,l)).context=Hc(null),n=e.current,(i=Fi(r=nc(),a=rc(n))).callback=void 0!==t&&null!==t?t:null,Ui(n,i,a),e.current.lanes=a,vt(e,a,r),ic(e,r),e}function Gc(e,t,n,r){var a=t.current,i=nc(),s=rc(a);return n=Hc(n),null===t.context?t.context=n:t.pendingContext=n,(t=Fi(i,s)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),null!==(e=Ui(a,t,s))&&(ac(e,a,s,i),Vi(e,a,s)),s}function qc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Kc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Yc(e,t){Kc(e,t),(e=e.alternate)&&Kc(e,t)}_l=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Ia.current)So=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return So=!1,function(e,t,n){switch(t.tag){case 3:Oo(t),fi();break;case 5:Ji(t);break;case 1:Ra(t.type)&&La(t);break;case 4:Qi(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,a=t.memoizedProps.value;Aa(Ti,r._currentValue),r._currentValue=a;break;case 13:if(null!==(r=t.memoizedState))return null!==r.dehydrated?(Aa(Zi,1&Zi.current),t.flags|=128,null):0!==(n&t.child.childLanes)?Uo(e,t,n):(Aa(Zi,1&Zi.current),null!==(e=qo(e,t,n))?e.sibling:null);Aa(Zi,1&Zi.current);break;case 19:if(r=0!==(n&t.childLanes),0!==(128&e.flags)){if(r)return Wo(e,t,n);t.flags|=128}if(null!==(a=t.memoizedState)&&(a.rendering=null,a.tail=null,a.lastEffect=null),Aa(Zi,Zi.current),r)break;return null;case 22:case 23:return t.lanes=0,Ao(e,t,n)}return qo(e,t,n)}(e,t,n);So=0!==(131072&e.flags)}else So=!1,ai&&0!==(1048576&t.flags)&&Za(t,qa,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Go(e,t),e=t.pendingProps;var a=Oa(t,Ca.current);Ii(t,n),a=ms(null,t,r,e,a,n);var s=gs();return t.flags|=1,"object"===typeof a&&null!==a&&"function"===typeof a.render&&void 0===a.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Ra(r)?(s=!0,La(t)):s=!1,t.memoizedState=null!==a.state&&void 0!==a.state?a.state:null,Li(t),a.updater=io,t.stateNode=a,a._reactInternals=t,co(t,r,e,n),t=No(null,t,r,!0,s,n)):(t.tag=0,ai&&s&&ei(t),To(null,t,a,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Go(e,t),e=t.pendingProps,r=(a=r._init)(r._payload),t.type=r,a=t.tag=function(e){if("function"===typeof e)return jc(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===C)return 11;if(e===O)return 14}return 2}(r),e=ro(r,e),a){case 0:t=Co(null,t,r,e,n);break e;case 1:t=Io(null,t,r,e,n);break e;case 11:t=Eo(null,t,r,e,n);break e;case 14:t=xo(null,t,r,ro(r.type,e),n);break e}throw Error(i(306,r,""))}return t;case 0:return r=t.type,a=t.pendingProps,Co(e,t,r,a=t.elementType===r?a:ro(r,a),n);case 1:return r=t.type,a=t.pendingProps,Io(e,t,r,a=t.elementType===r?a:ro(r,a),n);case 3:e:{if(Oo(t),null===e)throw Error(i(387));r=t.pendingProps,a=(s=t.memoizedState).element,Mi(e,t),zi(t,r,null,n);var o=t.memoizedState;if(r=o.element,s.isDehydrated){if(s={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=s,t.memoizedState=s,256&t.flags){t=Ro(e,t,r,n,a=uo(Error(i(423)),t));break e}if(r!==a){t=Ro(e,t,r,n,a=uo(Error(i(424)),t));break e}for(ri=ca(t.stateNode.containerInfo.firstChild),ni=t,ai=!0,ii=null,n=Si(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(fi(),r===a){t=qo(e,t,n);break e}To(e,t,r,n)}t=t.child}return t;case 5:return Ji(t),null===e&&ci(t),r=t.type,a=t.pendingProps,s=null!==e?e.memoizedProps:null,o=a.children,na(r,a)?o=null:null!==s&&na(r,s)&&(t.flags|=32),ko(e,t),To(e,t,o,n),t.child;case 6:return null===e&&ci(t),null;case 13:return Uo(e,t,n);case 4:return Qi(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=wi(t,null,r,n):To(e,t,r,n),t.child;case 11:return r=t.type,a=t.pendingProps,Eo(e,t,r,a=t.elementType===r?a:ro(r,a),n);case 7:return To(e,t,t.pendingProps,n),t.child;case 8:case 12:return To(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,a=t.pendingProps,s=t.memoizedProps,o=a.value,Aa(Ti,r._currentValue),r._currentValue=o,null!==s)if(or(s.value,o)){if(s.children===a.children&&!Ia.current){t=qo(e,t,n);break e}}else for(null!==(s=t.child)&&(s.return=t);null!==s;){var l=s.dependencies;if(null!==l){o=s.child;for(var c=l.firstContext;null!==c;){if(c.context===r){if(1===s.tag){(c=Fi(-1,n&-n)).tag=2;var u=s.updateQueue;if(null!==u){var h=(u=u.shared).pending;null===h?c.next=c:(c.next=h.next,h.next=c),u.pending=c}}s.lanes|=n,null!==(c=s.alternate)&&(c.lanes|=n),Ci(s.return,n,t),l.lanes|=n;break}c=c.next}}else if(10===s.tag)o=s.type===t.type?null:s.child;else if(18===s.tag){if(null===(o=s.return))throw Error(i(341));o.lanes|=n,null!==(l=o.alternate)&&(l.lanes|=n),Ci(o,n,t),o=s.sibling}else o=s.child;if(null!==o)o.return=s;else for(o=s;null!==o;){if(o===t){o=null;break}if(null!==(s=o.sibling)){s.return=o.return,o=s;break}o=o.return}s=o}To(e,t,a.children,n),t=t.child}return t;case 9:return a=t.type,r=t.pendingProps.children,Ii(t,n),r=r(a=Ni(a)),t.flags|=1,To(e,t,r,n),t.child;case 14:return a=ro(r=t.type,t.pendingProps),xo(e,t,r,a=ro(r.type,a),n);case 15:return _o(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,a=t.pendingProps,a=t.elementType===r?a:ro(r,a),Go(e,t),t.tag=1,Ra(r)?(e=!0,La(t)):e=!1,Ii(t,n),oo(t,r,a),co(t,r,a,n),No(null,t,r,!0,e,n);case 19:return Wo(e,t,n);case 22:return Ao(e,t,n)}throw Error(i(156,t.tag))};var Qc="function"===typeof reportError?reportError:function(e){console.error(e)};function Xc(e){this._internalRoot=e}function Jc(e){this._internalRoot=e}function $c(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Zc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function eu(){}function tu(e,t,n,r,a){var i=n._reactRootContainer;if(i){var s=i;if("function"===typeof a){var o=a;a=function(){var e=qc(s);o.call(e)}}Gc(t,s,e,a)}else s=function(e,t,n,r,a){if(a){if("function"===typeof r){var i=r;r=function(){var e=qc(s);i.call(e)}}var s=Wc(t,r,e,0,null,!1,0,"",eu);return e._reactRootContainer=s,e[pa]=s.current,zr(8===e.nodeType?e.parentNode:e),dc(),s}for(;a=e.lastChild;)e.removeChild(a);if("function"===typeof r){var o=r;r=function(){var e=qc(l);o.call(e)}}var l=zc(e,0,!1,null,0,!1,0,"",eu);return e._reactRootContainer=l,e[pa]=l.current,zr(8===e.nodeType?e.parentNode:e),dc((function(){Gc(t,l,n,r)})),l}(n,t,e,a,r);return qc(s)}Jc.prototype.render=Xc.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(i(409));Gc(e,t,null,null)},Jc.prototype.unmount=Xc.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;dc((function(){Gc(null,e,null,null)})),t[pa]=null}},Jc.prototype.unstable_scheduleHydration=function(e){if(e){var t=xt();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Dt.length&&0!==t&&t<Dt[n].priority;n++);Dt.splice(n,0,e),0===n&&Mt(e)}},St=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=ht(t.pendingLanes);0!==n&&(yt(t,1|n),ic(t,Je()),0===(6&Nl)&&(Wl=Je()+500,za()))}break;case 13:dc((function(){var t=ji(e,1);if(null!==t){var n=nc();ac(t,e,1,n)}})),Yc(e,1)}},Tt=function(e){if(13===e.tag){var t=ji(e,134217728);if(null!==t)ac(t,e,134217728,nc());Yc(e,134217728)}},Et=function(e){if(13===e.tag){var t=rc(e),n=ji(e,t);if(null!==n)ac(n,e,t,nc());Yc(e,t)}},xt=function(){return bt},_t=function(e,t){var n=bt;try{return bt=e,t()}finally{bt=n}},Te=function(e,t,n){switch(t){case"input":if($(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var a=Sa(r);if(!a)throw Error(i(90));K(r),$(r,a)}}}break;case"textarea":ie(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},Ce=hc,Ie=dc;var nu={usingClientEntryPoint:!1,Events:[ba,wa,Sa,Ae,ke,hc]},ru={findFiberByHostInstance:ya,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},au={bundleType:ru.bundleType,version:ru.version,rendererPackageName:ru.rendererPackageName,rendererConfig:ru.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:w.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=Ge(e))?null:e.stateNode},findFiberByHostInstance:ru.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var iu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!iu.isDisabled&&iu.supportsFiber)try{at=iu.inject(au),it=iu}catch(ue){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=nu,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!$c(t))throw Error(i(200));return function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:T,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!$c(e))throw Error(i(299));var n=!1,r="",a=Qc;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onRecoverableError&&(a=t.onRecoverableError)),t=zc(e,1,!1,null,0,n,0,r,a),e[pa]=t.current,zr(8===e.nodeType?e.parentNode:e),new Xc(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(i(188));throw e=Object.keys(e).join(","),Error(i(268,e))}return e=null===(e=Ge(t))?null:e.stateNode},t.flushSync=function(e){return dc(e)},t.hydrate=function(e,t,n){if(!Zc(t))throw Error(i(200));return tu(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!$c(e))throw Error(i(405));var r=null!=n&&n.hydratedSources||null,a=!1,s="",o=Qc;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(a=!0),void 0!==n.identifierPrefix&&(s=n.identifierPrefix),void 0!==n.onRecoverableError&&(o=n.onRecoverableError)),t=Wc(t,null,e,1,null!=n?n:null,a,0,s,o),e[pa]=t.current,zr(e),r)for(e=0;e<r.length;e++)a=(a=(n=r[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,a]:t.mutableSourceEagerHydrationData.push(n,a);return new Jc(t)},t.render=function(e,t,n){if(!Zc(t))throw Error(i(200));return tu(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!Zc(e))throw Error(i(40));return!!e._reactRootContainer&&(dc((function(){tu(null,null,e,!1,(function(){e._reactRootContainer=null,e[pa]=null}))})),!0)},t.unstable_batchedUpdates=hc,t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Zc(n))throw Error(i(200));if(null==e||void 0===e._reactInternals)throw Error(i(38));return tu(e,t,n,!1,r)},t.version="18.3.1-next-f1338f8080-20240426"},391:(e,t,n)=>{var r=n(950);t.createRoot=r.createRoot,t.hydrateRoot=r.hydrateRoot},950:(e,t,n)=>{!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(730)},153:(e,t,n)=>{var r=n(43),a=Symbol.for("react.element"),i=Symbol.for("react.fragment"),s=Object.prototype.hasOwnProperty,o=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var r,i={},c=null,u=null;for(r in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(u=t.ref),t)s.call(t,r)&&!l.hasOwnProperty(r)&&(i[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===i[r]&&(i[r]=t[r]);return{$$typeof:a,type:e,key:c,ref:u,props:i,_owner:o.current}}t.Fragment=i,t.jsx=c,t.jsxs=c},202:(e,t)=>{var n=Symbol.for("react.element"),r=Symbol.for("react.portal"),a=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),f=Symbol.iterator;var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m=Object.assign,g={};function v(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||p}function y(){}function b(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||p}v.prototype.isReactComponent={},v.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},v.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},y.prototype=v.prototype;var w=b.prototype=new y;w.constructor=b,m(w,v.prototype),w.isPureReactComponent=!0;var S=Array.isArray,T=Object.prototype.hasOwnProperty,E={current:null},x={key:!0,ref:!0,__self:!0,__source:!0};function _(e,t,r){var a,i={},s=null,o=null;if(null!=t)for(a in void 0!==t.ref&&(o=t.ref),void 0!==t.key&&(s=""+t.key),t)T.call(t,a)&&!x.hasOwnProperty(a)&&(i[a]=t[a]);var l=arguments.length-2;if(1===l)i.children=r;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];i.children=c}if(e&&e.defaultProps)for(a in l=e.defaultProps)void 0===i[a]&&(i[a]=l[a]);return{$$typeof:n,type:e,key:s,ref:o,props:i,_owner:E.current}}function A(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var k=/\/+/g;function C(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function I(e,t,a,i,s){var o=typeof e;"undefined"!==o&&"boolean"!==o||(e=null);var l=!1;if(null===e)l=!0;else switch(o){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case n:case r:l=!0}}if(l)return s=s(l=e),e=""===i?"."+C(l,0):i,S(s)?(a="",null!=e&&(a=e.replace(k,"$&/")+"/"),I(s,t,a,"",(function(e){return e}))):null!=s&&(A(s)&&(s=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(s,a+(!s.key||l&&l.key===s.key?"":(""+s.key).replace(k,"$&/")+"/")+e)),t.push(s)),1;if(l=0,i=""===i?".":i+":",S(e))for(var c=0;c<e.length;c++){var u=i+C(o=e[c],c);l+=I(o,t,a,u,s)}else if(u=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=f&&e[f]||e["@@iterator"])?e:null}(e),"function"===typeof u)for(e=u.call(e),c=0;!(o=e.next()).done;)l+=I(o=o.value,t,a,u=i+C(o,c++),s);else if("object"===o)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function N(e,t,n){if(null==e)return e;var r=[],a=0;return I(e,r,"","",(function(e){return t.call(n,e,a++)})),r}function O(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var R={current:null},D={transition:null},j={ReactCurrentDispatcher:R,ReactCurrentBatchConfig:D,ReactCurrentOwner:E};function P(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:N,forEach:function(e,t,n){N(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return N(e,(function(){t++})),t},toArray:function(e){return N(e,(function(e){return e}))||[]},only:function(e){if(!A(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=v,t.Fragment=a,t.Profiler=s,t.PureComponent=b,t.StrictMode=i,t.Suspense=u,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=j,t.act=P,t.cloneElement=function(e,t,r){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var a=m({},e.props),i=e.key,s=e.ref,o=e._owner;if(null!=t){if(void 0!==t.ref&&(s=t.ref,o=E.current),void 0!==t.key&&(i=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)T.call(t,c)&&!x.hasOwnProperty(c)&&(a[c]=void 0===t[c]&&void 0!==l?l[c]:t[c])}var c=arguments.length-2;if(1===c)a.children=r;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];a.children=l}return{$$typeof:n,type:e.type,key:i,ref:s,props:a,_owner:o}},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:o,_context:e},e.Consumer=e},t.createElement=_,t.createFactory=function(e){var t=_.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=A,t.lazy=function(e){return{$$typeof:d,_payload:{_status:-1,_result:e},_init:O}},t.memo=function(e,t){return{$$typeof:h,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=D.transition;D.transition={};try{e()}finally{D.transition=t}},t.unstable_act=P,t.useCallback=function(e,t){return R.current.useCallback(e,t)},t.useContext=function(e){return R.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return R.current.useDeferredValue(e)},t.useEffect=function(e,t){return R.current.useEffect(e,t)},t.useId=function(){return R.current.useId()},t.useImperativeHandle=function(e,t,n){return R.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return R.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return R.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return R.current.useMemo(e,t)},t.useReducer=function(e,t,n){return R.current.useReducer(e,t,n)},t.useRef=function(e){return R.current.useRef(e)},t.useState=function(e){return R.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return R.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return R.current.useTransition()},t.version="18.3.1"},43:(e,t,n)=>{e.exports=n(202)},579:(e,t,n)=>{e.exports=n(153)},234:(e,t)=>{function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,a=e[r];if(!(0<i(a,t)))break e;e[r]=t,e[n]=a,n=r}}function r(e){return 0===e.length?null:e[0]}function a(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,a=e.length,s=a>>>1;r<s;){var o=2*(r+1)-1,l=e[o],c=o+1,u=e[c];if(0>i(l,n))c<a&&0>i(u,l)?(e[r]=u,e[c]=n,r=c):(e[r]=l,e[o]=n,r=o);else{if(!(c<a&&0>i(u,n)))break e;e[r]=u,e[c]=n,r=c}}}return t}function i(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var c=[],u=[],h=1,d=null,f=3,p=!1,m=!1,g=!1,v="function"===typeof setTimeout?setTimeout:null,y="function"===typeof clearTimeout?clearTimeout:null,b="undefined"!==typeof setImmediate?setImmediate:null;function w(e){for(var t=r(u);null!==t;){if(null===t.callback)a(u);else{if(!(t.startTime<=e))break;a(u),t.sortIndex=t.expirationTime,n(c,t)}t=r(u)}}function S(e){if(g=!1,w(e),!m)if(null!==r(c))m=!0,D(T);else{var t=r(u);null!==t&&j(S,t.startTime-e)}}function T(e,n){m=!1,g&&(g=!1,y(A),A=-1),p=!0;var i=f;try{for(w(n),d=r(c);null!==d&&(!(d.expirationTime>n)||e&&!I());){var s=d.callback;if("function"===typeof s){d.callback=null,f=d.priorityLevel;var o=s(d.expirationTime<=n);n=t.unstable_now(),"function"===typeof o?d.callback=o:d===r(c)&&a(c),w(n)}else a(c);d=r(c)}if(null!==d)var l=!0;else{var h=r(u);null!==h&&j(S,h.startTime-n),l=!1}return l}finally{d=null,f=i,p=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var E,x=!1,_=null,A=-1,k=5,C=-1;function I(){return!(t.unstable_now()-C<k)}function N(){if(null!==_){var e=t.unstable_now();C=e;var n=!0;try{n=_(!0,e)}finally{n?E():(x=!1,_=null)}}else x=!1}if("function"===typeof b)E=function(){b(N)};else if("undefined"!==typeof MessageChannel){var O=new MessageChannel,R=O.port2;O.port1.onmessage=N,E=function(){R.postMessage(null)}}else E=function(){v(N,0)};function D(e){_=e,x||(x=!0,E())}function j(e,n){A=v((function(){e(t.unstable_now())}),n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){m||p||(m=!0,D(T))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):k=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return r(c)},t.unstable_next=function(e){switch(f){case 1:case 2:case 3:var t=3;break;default:t=f}var n=f;f=t;try{return e()}finally{f=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=f;f=e;try{return t()}finally{f=n}},t.unstable_scheduleCallback=function(e,a,i){var s=t.unstable_now();switch("object"===typeof i&&null!==i?i="number"===typeof(i=i.delay)&&0<i?s+i:s:i=s,e){case 1:var o=-1;break;case 2:o=250;break;case 5:o=1073741823;break;case 4:o=1e4;break;default:o=5e3}return e={id:h++,callback:a,priorityLevel:e,startTime:i,expirationTime:o=i+o,sortIndex:-1},i>s?(e.sortIndex=i,n(u,e),null===r(c)&&e===r(u)&&(g?(y(A),A=-1):g=!0,j(S,i-s))):(e.sortIndex=o,n(c,e),m||p||(m=!0,D(T))),e},t.unstable_shouldYield=I,t.unstable_wrapCallback=function(e){var t=f;return function(){var n=f;f=t;try{return e.apply(this,arguments)}finally{f=n}}}},853:(e,t,n)=>{e.exports=n(234)}},t={};function n(r){var a=t[r];if(void 0!==a)return a.exports;var i=t[r]={exports:{}};return e[r](i,i.exports,n),i.exports}n.m=e,(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;n.t=function(r,a){if(1&a&&(r=this(r)),8&a)return r;if("object"===typeof r&&r){if(4&a&&r.__esModule)return r;if(16&a&&"function"===typeof r.then)return r}var i=Object.create(null);n.r(i);var s={};e=e||[null,t({}),t([]),t(t)];for(var o=2&a&&r;"object"==typeof o&&!~e.indexOf(o);o=t(o))Object.getOwnPropertyNames(o).forEach((e=>s[e]=()=>r[e]));return s.default=()=>r,n.d(i,s),i}})(),n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.f={},n.e=e=>Promise.all(Object.keys(n.f).reduce(((t,r)=>(n.f[r](e,t),t)),[])),n.u=e=>"static/js/"+e+".ffd47ec5.chunk.js",n.miniCssF=e=>{},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={},t="my-webapp:";n.l=(r,a,i,s)=>{if(e[r])e[r].push(a);else{var o,l;if(void 0!==i)for(var c=document.getElementsByTagName("script"),u=0;u<c.length;u++){var h=c[u];if(h.getAttribute("src")==r||h.getAttribute("data-webpack")==t+i){o=h;break}}o||(l=!0,(o=document.createElement("script")).charset="utf-8",o.timeout=120,n.nc&&o.setAttribute("nonce",n.nc),o.setAttribute("data-webpack",t+i),o.src=r),e[r]=[a];var d=(t,n)=>{o.onerror=o.onload=null,clearTimeout(f);var a=e[r];if(delete e[r],o.parentNode&&o.parentNode.removeChild(o),a&&a.forEach((e=>e(n))),t)return t(n)},f=setTimeout(d.bind(null,void 0,{type:"timeout",target:o}),12e4);o.onerror=d.bind(null,o.onerror),o.onload=d.bind(null,o.onload),l&&document.head.appendChild(o)}}})(),n.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.p="/",(()=>{var e={792:0};n.f.j=(t,r)=>{var a=n.o(e,t)?e[t]:void 0;if(0!==a)if(a)r.push(a[2]);else{var i=new Promise(((n,r)=>a=e[t]=[n,r]));r.push(a[2]=i);var s=n.p+n.u(t),o=new Error;n.l(s,(r=>{if(n.o(e,t)&&(0!==(a=e[t])&&(e[t]=void 0),a)){var i=r&&("load"===r.type?"missing":r.type),s=r&&r.target&&r.target.src;o.message="Loading chunk "+t+" failed.\n("+i+": "+s+")",o.name="ChunkLoadError",o.type=i,o.request=s,a[1](o)}}),"chunk-"+t,t)}};var t=(t,r)=>{var a,i,s=r[0],o=r[1],l=r[2],c=0;if(s.some((t=>0!==e[t]))){for(a in o)n.o(o,a)&&(n.m[a]=o[a]);if(l)l(n)}for(t&&t(r);c<s.length;c++)i=s[c],n.o(e,i)&&e[i]&&e[i][0](),e[i]=0},r=self.webpackChunkmy_webapp=self.webpackChunkmy_webapp||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})();var r,a=n(43),i=n.t(a,2),s=n(391),o=n(950),l=n.t(o,2);function c(){return c=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},c.apply(this,arguments)}!function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"}(r||(r={}));const u="popstate";function h(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}function d(e,t){if(!e){"undefined"!==typeof console&&console.warn(t);try{throw new Error(t)}catch(n){}}}function f(e,t){return{usr:e.state,key:e.key,idx:t}}function p(e,t,n,r){return void 0===n&&(n=null),c({pathname:"string"===typeof e?e:e.pathname,search:"",hash:""},"string"===typeof t?g(t):t,{state:n,key:t&&t.key||r||Math.random().toString(36).substr(2,8)})}function m(e){let{pathname:t="/",search:n="",hash:r=""}=e;return n&&"?"!==n&&(t+="?"===n.charAt(0)?n:"?"+n),r&&"#"!==r&&(t+="#"===r.charAt(0)?r:"#"+r),t}function g(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substr(n),e=e.substr(0,n));let r=e.indexOf("?");r>=0&&(t.search=e.substr(r),e=e.substr(0,r)),e&&(t.pathname=e)}return t}function v(e,t,n,a){void 0===a&&(a={});let{window:i=document.defaultView,v5Compat:s=!1}=a,o=i.history,l=r.Pop,d=null,g=v();function v(){return(o.state||{idx:null}).idx}function y(){l=r.Pop;let e=v(),t=null==e?null:e-g;g=e,d&&d({action:l,location:w.location,delta:t})}function b(e){let t="null"!==i.location.origin?i.location.origin:i.location.href,n="string"===typeof e?e:m(e);return n=n.replace(/ $/,"%20"),h(t,"No window.location.(origin|href) available to create URL for href: "+n),new URL(n,t)}null==g&&(g=0,o.replaceState(c({},o.state,{idx:g}),""));let w={get action(){return l},get location(){return e(i,o)},listen(e){if(d)throw new Error("A history only accepts one active listener");return i.addEventListener(u,y),d=e,()=>{i.removeEventListener(u,y),d=null}},createHref:e=>t(i,e),createURL:b,encodeLocation(e){let t=b(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:function(e,t){l=r.Push;let a=p(w.location,e,t);n&&n(a,e),g=v()+1;let c=f(a,g),u=w.createHref(a);try{o.pushState(c,"",u)}catch(h){if(h instanceof DOMException&&"DataCloneError"===h.name)throw h;i.location.assign(u)}s&&d&&d({action:l,location:w.location,delta:1})},replace:function(e,t){l=r.Replace;let a=p(w.location,e,t);n&&n(a,e),g=v();let i=f(a,g),c=w.createHref(a);o.replaceState(i,"",c),s&&d&&d({action:l,location:w.location,delta:0})},go:e=>o.go(e)};return w}var y;!function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"}(y||(y={}));new Set(["lazy","caseSensitive","path","id","index","children"]);function b(e,t,n){return void 0===n&&(n="/"),w(e,t,n,!1)}function w(e,t,n,r){let a=j(("string"===typeof t?g(t):t).pathname||"/",n);if(null==a)return null;let i=S(e);!function(e){e.sort(((e,t)=>e.score!==t.score?t.score-e.score:function(e,t){let n=e.length===t.length&&e.slice(0,-1).every(((e,n)=>e===t[n]));return n?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map((e=>e.childrenIndex)),t.routesMeta.map((e=>e.childrenIndex)))))}(i);let s=null;for(let o=0;null==s&&o<i.length;++o){let e=D(a);s=O(i[o],e,r)}return s}function S(e,t,n,r){void 0===t&&(t=[]),void 0===n&&(n=[]),void 0===r&&(r="");let a=(e,a,i)=>{let s={relativePath:void 0===i?e.path||"":i,caseSensitive:!0===e.caseSensitive,childrenIndex:a,route:e};s.relativePath.startsWith("/")&&(h(s.relativePath.startsWith(r),'Absolute route path "'+s.relativePath+'" nested under path "'+r+'" is not valid. An absolute child route path must start with the combined path of all its parent routes.'),s.relativePath=s.relativePath.slice(r.length));let o=U([r,s.relativePath]),l=n.concat(s);e.children&&e.children.length>0&&(h(!0!==e.index,'Index routes must not have child routes. Please remove all child routes from route path "'+o+'".'),S(e.children,t,l,o)),(null!=e.path||e.index)&&t.push({path:o,score:N(o,e.index),routesMeta:l})};return e.forEach(((e,t)=>{var n;if(""!==e.path&&null!=(n=e.path)&&n.includes("?"))for(let r of T(e.path))a(e,t,r);else a(e,t)})),t}function T(e){let t=e.split("/");if(0===t.length)return[];let[n,...r]=t,a=n.endsWith("?"),i=n.replace(/\?$/,"");if(0===r.length)return a?[i,""]:[i];let s=T(r.join("/")),o=[];return o.push(...s.map((e=>""===e?i:[i,e].join("/")))),a&&o.push(...s),o.map((t=>e.startsWith("/")&&""===t?"/":t))}const E=/^:[\w-]+$/,x=3,_=2,A=1,k=10,C=-2,I=e=>"*"===e;function N(e,t){let n=e.split("/"),r=n.length;return n.some(I)&&(r+=C),t&&(r+=_),n.filter((e=>!I(e))).reduce(((e,t)=>e+(E.test(t)?x:""===t?A:k)),r)}function O(e,t,n){void 0===n&&(n=!1);let{routesMeta:r}=e,a={},i="/",s=[];for(let o=0;o<r.length;++o){let e=r[o],l=o===r.length-1,c="/"===i?t:t.slice(i.length)||"/",u=R({path:e.relativePath,caseSensitive:e.caseSensitive,end:l},c),h=e.route;if(!u&&l&&n&&!r[r.length-1].route.index&&(u=R({path:e.relativePath,caseSensitive:e.caseSensitive,end:!1},c)),!u)return null;Object.assign(a,u.params),s.push({params:a,pathname:U([i,u.pathname]),pathnameBase:V(U([i,u.pathnameBase])),route:h}),"/"!==u.pathnameBase&&(i=U([i,u.pathnameBase]))}return s}function R(e,t){"string"===typeof e&&(e={path:e,caseSensitive:!1,end:!0});let[n,r]=function(e,t,n){void 0===t&&(t=!1);void 0===n&&(n=!0);d("*"===e||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were "'+e.replace(/\*$/,"/*")+'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "'+e.replace(/\*$/,"/*")+'".');let r=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,((e,t,n)=>(r.push({paramName:t,isOptional:null!=n}),n?"/?([^\\/]+)?":"/([^\\/]+)")));e.endsWith("*")?(r.push({paramName:"*"}),a+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?a+="\\/*$":""!==e&&"/"!==e&&(a+="(?:(?=\\/|$))");let i=new RegExp(a,t?void 0:"i");return[i,r]}(e.path,e.caseSensitive,e.end),a=t.match(n);if(!a)return null;let i=a[0],s=i.replace(/(.)\/+$/,"$1"),o=a.slice(1);return{params:r.reduce(((e,t,n)=>{let{paramName:r,isOptional:a}=t;if("*"===r){let e=o[n]||"";s=i.slice(0,i.length-e.length).replace(/(.)\/+$/,"$1")}const l=o[n];return e[r]=a&&!l?void 0:(l||"").replace(/%2F/g,"/"),e}),{}),pathname:i,pathnameBase:s,pattern:e}}function D(e){try{return e.split("/").map((e=>decodeURIComponent(e).replace(/\//g,"%2F"))).join("/")}catch(t){return d(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding ('+t+")."),e}}function j(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,r=e.charAt(n);return r&&"/"!==r?null:e.slice(n)||"/"}function P(e,t,n,r){return"Cannot include a '"+e+"' character in a manually specified `to."+t+"` field ["+JSON.stringify(r)+"].  Please separate it out to the `to."+n+'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.'}function L(e){return e.filter(((e,t)=>0===t||e.route.path&&e.route.path.length>0))}function M(e,t){let n=L(e);return t?n.map(((e,t)=>t===n.length-1?e.pathname:e.pathnameBase)):n.map((e=>e.pathnameBase))}function F(e,t,n,r){let a;void 0===r&&(r=!1),"string"===typeof e?a=g(e):(a=c({},e),h(!a.pathname||!a.pathname.includes("?"),P("?","pathname","search",a)),h(!a.pathname||!a.pathname.includes("#"),P("#","pathname","hash",a)),h(!a.search||!a.search.includes("#"),P("#","search","hash",a)));let i,s=""===e||""===a.pathname,o=s?"/":a.pathname;if(null==o)i=n;else{let e=t.length-1;if(!r&&o.startsWith("..")){let t=o.split("/");for(;".."===t[0];)t.shift(),e-=1;a.pathname=t.join("/")}i=e>=0?t[e]:"/"}let l=function(e,t){void 0===t&&(t="/");let{pathname:n,search:r="",hash:a=""}="string"===typeof e?g(e):e,i=n?n.startsWith("/")?n:function(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach((e=>{".."===e?n.length>1&&n.pop():"."!==e&&n.push(e)})),n.length>1?n.join("/"):"/"}(n,t):t;return{pathname:i,search:B(r),hash:z(a)}}(a,i),u=o&&"/"!==o&&o.endsWith("/"),d=(s||"."===o)&&n.endsWith("/");return l.pathname.endsWith("/")||!u&&!d||(l.pathname+="/"),l}const U=e=>e.join("/").replace(/\/\/+/g,"/"),V=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),B=e=>e&&"?"!==e?e.startsWith("?")?e:"?"+e:"",z=e=>e&&"#"!==e?e.startsWith("#")?e:"#"+e:"";Error;function H(e){return null!=e&&"number"===typeof e.status&&"string"===typeof e.statusText&&"boolean"===typeof e.internal&&"data"in e}const W=["post","put","patch","delete"],G=(new Set(W),["get",...W]);new Set(G),new Set([301,302,303,307,308]),new Set([307,308]);Symbol("deferred");function q(){return q=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},q.apply(this,arguments)}const K=a.createContext(null);const Y=a.createContext(null);const Q=a.createContext(null);const X=a.createContext(null);const J=a.createContext({outlet:null,matches:[],isDataRoute:!1});const Z=a.createContext(null);function ee(){return null!=a.useContext(X)}function te(){return ee()||h(!1),a.useContext(X).location}function ne(e){a.useContext(Q).static||a.useLayoutEffect(e)}function re(){let{isDataRoute:e}=a.useContext(J);return e?function(){let{router:e}=pe(de.UseNavigateStable),t=ge(fe.UseNavigateStable),n=a.useRef(!1);return ne((()=>{n.current=!0})),a.useCallback((function(r,a){void 0===a&&(a={}),n.current&&("number"===typeof r?e.navigate(r):e.navigate(r,q({fromRouteId:t},a)))}),[e,t])}():function(){ee()||h(!1);let e=a.useContext(K),{basename:t,future:n,navigator:r}=a.useContext(Q),{matches:i}=a.useContext(J),{pathname:s}=te(),o=JSON.stringify(M(i,n.v7_relativeSplatPath)),l=a.useRef(!1);return ne((()=>{l.current=!0})),a.useCallback((function(n,a){if(void 0===a&&(a={}),!l.current)return;if("number"===typeof n)return void r.go(n);let i=F(n,JSON.parse(o),s,"path"===a.relative);null==e&&"/"!==t&&(i.pathname="/"===i.pathname?t:U([t,i.pathname])),(a.replace?r.replace:r.push)(i,a.state,a)}),[t,r,o,s,e])}()}const ae=a.createContext(null);function ie(e,t){let{relative:n}=void 0===t?{}:t,{future:r}=a.useContext(Q),{matches:i}=a.useContext(J),{pathname:s}=te(),o=JSON.stringify(M(i,r.v7_relativeSplatPath));return a.useMemo((()=>F(e,JSON.parse(o),s,"path"===n)),[e,o,s,n])}function se(e,t,n,i){ee()||h(!1);let{navigator:s}=a.useContext(Q),{matches:o}=a.useContext(J),l=o[o.length-1],c=l?l.params:{},u=(l&&l.pathname,l?l.pathnameBase:"/");l&&l.route;let d,f=te();if(t){var p;let e="string"===typeof t?g(t):t;"/"===u||(null==(p=e.pathname)?void 0:p.startsWith(u))||h(!1),d=e}else d=f;let m=d.pathname||"/",v=m;if("/"!==u){let e=u.replace(/^\//,"").split("/");v="/"+m.replace(/^\//,"").split("/").slice(e.length).join("/")}let y=b(e,{pathname:v});let w=he(y&&y.map((e=>Object.assign({},e,{params:Object.assign({},c,e.params),pathname:U([u,s.encodeLocation?s.encodeLocation(e.pathname).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?u:U([u,s.encodeLocation?s.encodeLocation(e.pathnameBase).pathname:e.pathnameBase])}))),o,n,i);return t&&w?a.createElement(X.Provider,{value:{location:q({pathname:"/",search:"",hash:"",state:null,key:"default"},d),navigationType:r.Pop}},w):w}function oe(){let e=function(){var e;let t=a.useContext(Z),n=me(fe.UseRouteError),r=ge(fe.UseRouteError);if(void 0!==t)return t;return null==(e=n.errors)?void 0:e[r]}(),t=H(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,r="rgba(200,200,200, 0.5)",i={padding:"0.5rem",backgroundColor:r};return a.createElement(a.Fragment,null,a.createElement("h2",null,"Unexpected Application Error!"),a.createElement("h3",{style:{fontStyle:"italic"}},t),n?a.createElement("pre",{style:i},n):null,null)}const le=a.createElement(oe,null);class ce extends a.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||"idle"!==t.revalidation&&"idle"===e.revalidation?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:void 0!==e.error?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return void 0!==this.state.error?a.createElement(J.Provider,{value:this.props.routeContext},a.createElement(Z.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function ue(e){let{routeContext:t,match:n,children:r}=e,i=a.useContext(K);return i&&i.static&&i.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=n.route.id),a.createElement(J.Provider,{value:t},r)}function he(e,t,n,r){var i;if(void 0===t&&(t=[]),void 0===n&&(n=null),void 0===r&&(r=null),null==e){var s;if(null==(s=n)||!s.errors)return null;e=n.matches}let o=e,l=null==(i=n)?void 0:i.errors;if(null!=l){let e=o.findIndex((e=>e.route.id&&void 0!==(null==l?void 0:l[e.route.id])));e>=0||h(!1),o=o.slice(0,Math.min(o.length,e+1))}let c=!1,u=-1;if(n&&r&&r.v7_partialHydration)for(let a=0;a<o.length;a++){let e=o[a];if((e.route.HydrateFallback||e.route.hydrateFallbackElement)&&(u=a),e.route.id){let{loaderData:t,errors:r}=n,a=e.route.loader&&void 0===t[e.route.id]&&(!r||void 0===r[e.route.id]);if(e.route.lazy||a){c=!0,o=u>=0?o.slice(0,u+1):[o[0]];break}}}return o.reduceRight(((e,r,i)=>{let s,h=!1,d=null,f=null;var p;n&&(s=l&&r.route.id?l[r.route.id]:void 0,d=r.route.errorElement||le,c&&(u<0&&0===i?(p="route-fallback",!1||ve[p]||(ve[p]=!0),h=!0,f=null):u===i&&(h=!0,f=r.route.hydrateFallbackElement||null)));let m=t.concat(o.slice(0,i+1)),g=()=>{let t;return t=s?d:h?f:r.route.Component?a.createElement(r.route.Component,null):r.route.element?r.route.element:e,a.createElement(ue,{match:r,routeContext:{outlet:e,matches:m,isDataRoute:null!=n},children:t})};return n&&(r.route.ErrorBoundary||r.route.errorElement||0===i)?a.createElement(ce,{location:n.location,revalidation:n.revalidation,component:d,error:s,children:g(),routeContext:{outlet:null,matches:m,isDataRoute:!0}}):g()}),null)}var de=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(de||{}),fe=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(fe||{});function pe(e){let t=a.useContext(K);return t||h(!1),t}function me(e){let t=a.useContext(Y);return t||h(!1),t}function ge(e){let t=function(e){let t=a.useContext(J);return t||h(!1),t}(),n=t.matches[t.matches.length-1];return n.route.id||h(!1),n.route.id}const ve={};i.startTransition;function ye(e){let{to:t,replace:n,state:r,relative:i}=e;ee()||h(!1);let{future:s,static:o}=a.useContext(Q),{matches:l}=a.useContext(J),{pathname:c}=te(),u=re(),d=F(t,M(l,s.v7_relativeSplatPath),c,"path"===i),f=JSON.stringify(d);return a.useEffect((()=>u(JSON.parse(f),{replace:n,state:r,relative:i})),[u,f,i,n,r]),null}function be(e){return function(e){let t=a.useContext(J).outlet;return t?a.createElement(ae.Provider,{value:e},t):t}(e.context)}function we(e){h(!1)}function Se(e){let{basename:t="/",children:n=null,location:i,navigationType:s=r.Pop,navigator:o,static:l=!1,future:c}=e;ee()&&h(!1);let u=t.replace(/^\/*/,"/"),d=a.useMemo((()=>({basename:u,navigator:o,static:l,future:q({v7_relativeSplatPath:!1},c)})),[u,c,o,l]);"string"===typeof i&&(i=g(i));let{pathname:f="/",search:p="",hash:m="",state:v=null,key:y="default"}=i,b=a.useMemo((()=>{let e=j(f,u);return null==e?null:{location:{pathname:e,search:p,hash:m,state:v,key:y},navigationType:s}}),[u,f,p,m,v,y,s]);return null==b?null:a.createElement(Q.Provider,{value:d},a.createElement(X.Provider,{children:n,value:b}))}function Te(e){let{children:t,location:n}=e;return se(Ee(t),n)}new Promise((()=>{}));a.Component;function Ee(e,t){void 0===t&&(t=[]);let n=[];return a.Children.forEach(e,((e,r)=>{if(!a.isValidElement(e))return;let i=[...t,r];if(e.type===a.Fragment)return void n.push.apply(n,Ee(e.props.children,i));e.type!==we&&h(!1),e.props.index&&e.props.children&&h(!1);let s={id:e.props.id||i.join("-"),caseSensitive:e.props.caseSensitive,element:e.props.element,Component:e.props.Component,index:e.props.index,path:e.props.path,loader:e.props.loader,action:e.props.action,errorElement:e.props.errorElement,ErrorBoundary:e.props.ErrorBoundary,hasErrorBoundary:null!=e.props.ErrorBoundary||null!=e.props.errorElement,shouldRevalidate:e.props.shouldRevalidate,handle:e.props.handle,lazy:e.props.lazy};e.props.children&&(s.children=Ee(e.props.children,i)),n.push(s)})),n}function xe(){return xe=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},xe.apply(this,arguments)}function _e(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);const Ae=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","unstable_viewTransition"];try{window.__reactRouterVersion="6"}catch(YE){}new Map;const ke=i.startTransition;l.flushSync,i.useId;function Ce(e){let{basename:t,children:n,future:r,window:i}=e,s=a.useRef();var o;null==s.current&&(s.current=(void 0===(o={window:i,v5Compat:!0})&&(o={}),v((function(e,t){let{pathname:n,search:r,hash:a}=e.location;return p("",{pathname:n,search:r,hash:a},t.state&&t.state.usr||null,t.state&&t.state.key||"default")}),(function(e,t){return"string"===typeof t?t:m(t)}),null,o)));let l=s.current,[c,u]=a.useState({action:l.action,location:l.location}),{v7_startTransition:h}=r||{},d=a.useCallback((e=>{h&&ke?ke((()=>u(e))):u(e)}),[u,h]);return a.useLayoutEffect((()=>l.listen(d)),[l,d]),a.createElement(Se,{basename:t,children:n,location:c.location,navigationType:c.action,navigator:l,future:r})}const Ie="undefined"!==typeof window&&"undefined"!==typeof window.document&&"undefined"!==typeof window.document.createElement,Ne=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Oe=a.forwardRef((function(e,t){let n,{onClick:r,relative:i,reloadDocument:s,replace:o,state:l,target:c,to:u,preventScrollReset:d,unstable_viewTransition:f}=e,p=_e(e,Ae),{basename:g}=a.useContext(Q),v=!1;if("string"===typeof u&&Ne.test(u)&&(n=u,Ie))try{let e=new URL(window.location.href),t=u.startsWith("//")?new URL(e.protocol+u):new URL(u),n=j(t.pathname,g);t.origin===e.origin&&null!=n?u=n+t.search+t.hash:v=!0}catch(YE){}let y=function(e,t){let{relative:n}=void 0===t?{}:t;ee()||h(!1);let{basename:r,navigator:i}=a.useContext(Q),{hash:s,pathname:o,search:l}=ie(e,{relative:n}),c=o;return"/"!==r&&(c="/"===o?r:U([r,o])),i.createHref({pathname:c,search:l,hash:s})}(u,{relative:i}),b=function(e,t){let{target:n,replace:r,state:i,preventScrollReset:s,relative:o,unstable_viewTransition:l}=void 0===t?{}:t,c=re(),u=te(),h=ie(e,{relative:o});return a.useCallback((t=>{if(function(e,t){return 0===e.button&&(!t||"_self"===t)&&!function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(e)}(t,n)){t.preventDefault();let n=void 0!==r?r:m(u)===m(h);c(e,{replace:n,state:i,preventScrollReset:s,relative:o,unstable_viewTransition:l})}}),[u,c,h,r,i,n,e,s,o,l])}(u,{replace:o,state:l,target:c,preventScrollReset:d,relative:i,unstable_viewTransition:f});return a.createElement("a",xe({},p,{href:n||y,onClick:v||s?r:function(e){r&&r(e),e.defaultPrevented||b(e)},ref:t,target:c}))}));var Re,De;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(Re||(Re={})),function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"}(De||(De={}));const je=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let a=e.charCodeAt(r);a<128?t[n++]=a:a<2048?(t[n++]=a>>6|192,t[n++]=63&a|128):55296===(64512&a)&&r+1<e.length&&56320===(64512&e.charCodeAt(r+1))?(a=65536+((1023&a)<<10)+(1023&e.charCodeAt(++r)),t[n++]=a>>18|240,t[n++]=a>>12&63|128,t[n++]=a>>6&63|128,t[n++]=63&a|128):(t[n++]=a>>12|224,t[n++]=a>>6&63|128,t[n++]=63&a|128)}return t},Pe={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"===typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let a=0;a<e.length;a+=3){const t=e[a],i=a+1<e.length,s=i?e[a+1]:0,o=a+2<e.length,l=o?e[a+2]:0,c=t>>2,u=(3&t)<<4|s>>4;let h=(15&s)<<2|l>>6,d=63&l;o||(d=64,i||(h=64)),r.push(n[c],n[u],n[h],n[d])}return r.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(je(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){const t=[];let n=0,r=0;for(;n<e.length;){const a=e[n++];if(a<128)t[r++]=String.fromCharCode(a);else if(a>191&&a<224){const i=e[n++];t[r++]=String.fromCharCode((31&a)<<6|63&i)}else if(a>239&&a<365){const i=((7&a)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(i>>10)),t[r++]=String.fromCharCode(56320+(1023&i))}else{const i=e[n++],s=e[n++];t[r++]=String.fromCharCode((15&a)<<12|(63&i)<<6|63&s)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let a=0;a<e.length;){const t=n[e.charAt(a++)],i=a<e.length?n[e.charAt(a)]:0;++a;const s=a<e.length?n[e.charAt(a)]:64;++a;const o=a<e.length?n[e.charAt(a)]:64;if(++a,null==t||null==i||null==s||null==o)throw new Le;const l=t<<2|i>>4;if(r.push(l),64!==s){const e=i<<4&240|s>>2;if(r.push(e),64!==o){const e=s<<6&192|o;r.push(e)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class Le extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Me=function(e){return function(e){const t=je(e);return Pe.encodeByteArray(t,!0)}(e).replace(/\./g,"")},Fe=function(e){try{return Pe.decodeString(e,!0)}catch(YE){console.error("base64Decode failed: ",YE)}return null};const Ue=()=>function(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof n.g)return n.g;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__,Ve=()=>{try{return Ue()||(()=>{if("undefined"===typeof process)return;const e={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.__FIREBASE_DEFAULTS__;return e?JSON.parse(e):void 0})()||(()=>{if("undefined"===typeof document)return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(YE){return}const t=e&&Fe(e[1]);return t&&JSON.parse(t)})()}catch(YE){return void console.info("Unable to get __FIREBASE_DEFAULTS__ due to: ".concat(YE))}},Be=e=>{var t,n;return null===(n=null===(t=Ve())||void 0===t?void 0:t.emulatorHosts)||void 0===n?void 0:n[e]},ze=()=>{var e;return null===(e=Ve())||void 0===e?void 0:e.config},He=e=>{var t;return null===(t=Ve())||void 0===t?void 0:t["_".concat(e)]};class We{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"===typeof e&&(this.promise.catch((()=>{})),1===e.length?e(t):e(t,n))}}}function Ge(){return"undefined"!==typeof navigator&&"string"===typeof navigator.userAgent?navigator.userAgent:""}function qe(){return!function(){var e;const t=null===(e=Ve())||void 0===e?void 0:e.forceEnvironment;if("node"===t)return!0;if("browser"===t)return!1;try{return"[object process]"===Object.prototype.toString.call(n.g.process)}catch(YE){return!1}}()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Ke(){try{return"object"===typeof indexedDB}catch(YE){return!1}}class Ye extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,Ye.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Qe.prototype.create)}}class Qe{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e){const t=(arguments.length<=1?void 0:arguments[1])||{},n="".concat(this.service,"/").concat(e),r=this.errors[e],a=r?function(e,t){return e.replace(Xe,((e,n)=>{const r=t[n];return null!=r?String(r):"<".concat(n,"?>")}))}(r,t):"Error",i="".concat(this.serviceName,": ").concat(a," (").concat(n,").");return new Ye(n,i,t)}}const Xe=/\{\$([^}]+)}/g;function Je(e,t){if(e===t)return!0;const n=Object.keys(e),r=Object.keys(t);for(const a of n){if(!r.includes(a))return!1;const n=e[a],i=t[a];if($e(n)&&$e(i)){if(!Je(n,i))return!1}else if(n!==i)return!1}for(const a of r)if(!n.includes(a))return!1;return!0}function $e(e){return null!==e&&"object"===typeof e}function Ze(e){const t=[];for(const[n,r]of Object.entries(e))Array.isArray(r)?r.forEach((e=>{t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))})):t.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return t.length?"&"+t.join("&"):""}function et(e){const t={};return e.replace(/^\?/,"").split("&").forEach((e=>{if(e){const[n,r]=e.split("=");t[decodeURIComponent(n)]=decodeURIComponent(r)}})),t}function tt(e){const t=e.indexOf("?");if(!t)return"";const n=e.indexOf("#",t);return e.substring(t,n>0?n:void 0)}class nt{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then((()=>{e(this)})).catch((e=>{this.error(e)}))}next(e){this.forEachObserver((t=>{t.next(e)}))}error(e){this.forEachObserver((t=>{t.error(e)})),this.close(e)}complete(){this.forEachObserver((e=>{e.complete()})),this.close()}subscribe(e,t,n){let r;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");r=function(e,t){if("object"!==typeof e||null===e)return!1;for(const n of t)if(n in e&&"function"===typeof e[n])return!0;return!1}(e,["next","error","complete"])?e:{next:e,error:t,complete:n},void 0===r.next&&(r.next=rt),void 0===r.error&&(r.error=rt),void 0===r.complete&&(r.complete=rt);const a=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch(YE){}})),this.observers.push(r),a}unsubscribeOne(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then((()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(YE){"undefined"!==typeof console&&console.error&&console.error(YE)}}))}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then((()=>{this.observers=void 0,this.onNoObservers=void 0})))}}function rt(){}function at(e){return e&&e._delegate?e._delegate:e}class it{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const st="[DEFAULT]";class ot{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const e=new We;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:t});n&&e.resolve(n)}catch(YE){}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const n=this.normalizeInstanceIdentifier(null===e||void 0===e?void 0:e.identifier),r=null!==(t=null===e||void 0===e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error("Service ".concat(this.name," is not available"))}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(YE){if(r)return null;throw YE}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error("Mismatching Component ".concat(e.name," for Provider ").concat(this.name,"."));if(this.component)throw Error("Component for ".concat(this.name," has already been provided"));if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:st})}catch(YE){}for(const[e,t]of this.instancesDeferred.entries()){const n=this.normalizeInstanceIdentifier(e);try{const e=this.getOrInitializeService({instanceIdentifier:n});t.resolve(e)}catch(YE){}}}}clearInstance(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:st;this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter((e=>"INTERNAL"in e)).map((e=>e.INTERNAL.delete())),...e.filter((e=>"_delete"in e)).map((e=>e._delete()))])}isComponentSet(){return null!=this.component}isInitialized(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:st;return this.instances.has(e)}getOptions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:st;return this.instancesOptions.get(e)||{}}initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error("".concat(this.name,"(").concat(n,") has already been initialized"));if(!this.isComponentSet())throw Error("Component ".concat(this.name," has not been registered yet"));const r=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[a,i]of this.instancesDeferred.entries()){n===this.normalizeInstanceIdentifier(a)&&i.resolve(r)}return r}onInit(e,t){var n;const r=this.normalizeInstanceIdentifier(t),a=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;a.add(e),this.onInitCallbacks.set(r,a);const i=this.instances.get(r);return i&&e(i,r),()=>{a.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const a of n)try{a(e,t)}catch(r){}}getOrInitializeService(e){let{instanceIdentifier:t,options:n={}}=e,r=this.instances.get(t);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:(a=t,a===st?void 0:a),options:n}),this.instances.set(t,r),this.instancesOptions.set(t,n),this.invokeOnInitCallbacks(r,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,r)}catch(i){}var a;return r||null}normalizeInstanceIdentifier(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:st;return this.component?this.component.multipleInstances?e:st:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class lt{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error("Component ".concat(e.name," has already been registered with ").concat(this.name));t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new ot(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}const ct=[];var ut;!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(ut||(ut={}));const ht={debug:ut.DEBUG,verbose:ut.VERBOSE,info:ut.INFO,warn:ut.WARN,error:ut.ERROR,silent:ut.SILENT},dt=ut.INFO,ft={[ut.DEBUG]:"log",[ut.VERBOSE]:"log",[ut.INFO]:"info",[ut.WARN]:"warn",[ut.ERROR]:"error"},pt=function(e,t){if(t<e.logLevel)return;const n=(new Date).toISOString(),r=ft[t];if(!r)throw new Error("Attempted to log a message with an invalid logType (value: ".concat(t,")"));for(var a=arguments.length,i=new Array(a>2?a-2:0),s=2;s<a;s++)i[s-2]=arguments[s];console[r]("[".concat(n,"]  ").concat(e.name,":"),...i)};class mt{constructor(e){this.name=e,this._logLevel=dt,this._logHandler=pt,this._userLogHandler=null,ct.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ut))throw new TypeError('Invalid value "'.concat(e,'" assigned to `logLevel`'));this._logLevel=e}setLogLevel(e){this._logLevel="string"===typeof e?ht[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!==typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,ut.DEBUG,...t),this._logHandler(this,ut.DEBUG,...t)}log(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,ut.VERBOSE,...t),this._logHandler(this,ut.VERBOSE,...t)}info(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,ut.INFO,...t),this._logHandler(this,ut.INFO,...t)}warn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,ut.WARN,...t),this._logHandler(this,ut.WARN,...t)}error(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,ut.ERROR,...t),this._logHandler(this,ut.ERROR,...t)}}const gt=(e,t)=>t.some((t=>e instanceof t));let vt,yt;const bt=new WeakMap,wt=new WeakMap,St=new WeakMap,Tt=new WeakMap,Et=new WeakMap;let xt={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return wt.get(e);if("objectStoreNames"===t)return e.objectStoreNames||St.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return kt(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function _t(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(yt||(yt=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.apply(Ct(this),n),kt(bt.get(this))}:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return kt(e.apply(Ct(this),n))}:function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];const i=e.call(Ct(this),t,...r);return St.set(i,t.sort?t.sort():[t]),kt(i)}}function At(e){return"function"===typeof e?_t(e):(e instanceof IDBTransaction&&function(e){if(wt.has(e))return;const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("complete",a),e.removeEventListener("error",i),e.removeEventListener("abort",i)},a=()=>{t(),r()},i=()=>{n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",a),e.addEventListener("error",i),e.addEventListener("abort",i)}));wt.set(e,t)}(e),gt(e,vt||(vt=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(e,xt):e)}function kt(e){if(e instanceof IDBRequest)return function(e){const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("success",a),e.removeEventListener("error",i)},a=()=>{t(kt(e.result)),r()},i=()=>{n(e.error),r()};e.addEventListener("success",a),e.addEventListener("error",i)}));return t.then((t=>{t instanceof IDBCursor&&bt.set(t,e)})).catch((()=>{})),Et.set(t,e),t}(e);if(Tt.has(e))return Tt.get(e);const t=At(e);return t!==e&&(Tt.set(e,t),Et.set(t,e)),t}const Ct=e=>Et.get(e);const It=["get","getKey","getAll","getAllKeys","count"],Nt=["put","add","delete","clear"],Ot=new Map;function Rt(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!==typeof t)return;if(Ot.get(t))return Ot.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,a=Nt.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!a&&!It.includes(n))return;const i=async function(e){const t=this.transaction(e,a?"readwrite":"readonly");let i=t.store;for(var s=arguments.length,o=new Array(s>1?s-1:0),l=1;l<s;l++)o[l-1]=arguments[l];return r&&(i=i.index(o.shift())),(await Promise.all([i[n](...o),a&&t.done]))[0]};return Ot.set(t,i),i}xt=(e=>({...e,get:(t,n,r)=>Rt(t,n)||e.get(t,n,r),has:(t,n)=>!!Rt(t,n)||e.has(t,n)}))(xt);class Dt{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map((e=>{if(function(e){const t=e.getComponent();return"VERSION"===(null===t||void 0===t?void 0:t.type)}(e)){const t=e.getImmediate();return"".concat(t.library,"/").concat(t.version)}return null})).filter((e=>e)).join(" ")}}const jt="@firebase/app",Pt="0.10.6",Lt=new mt("@firebase/app"),Mt="@firebase/app-compat",Ft="@firebase/analytics-compat",Ut="@firebase/analytics",Vt="@firebase/app-check-compat",Bt="@firebase/app-check",zt="@firebase/auth",Ht="@firebase/auth-compat",Wt="@firebase/database",Gt="@firebase/database-compat",qt="@firebase/functions",Kt="@firebase/functions-compat",Yt="@firebase/installations",Qt="@firebase/installations-compat",Xt="@firebase/messaging",Jt="@firebase/messaging-compat",$t="@firebase/performance",Zt="@firebase/performance-compat",en="@firebase/remote-config",tn="@firebase/remote-config-compat",nn="@firebase/storage",rn="@firebase/storage-compat",an="@firebase/firestore",sn="@firebase/vertexai-preview",on="@firebase/firestore-compat",ln="firebase",cn="[DEFAULT]",un={[jt]:"fire-core",[Mt]:"fire-core-compat",[Ut]:"fire-analytics",[Ft]:"fire-analytics-compat",[Bt]:"fire-app-check",[Vt]:"fire-app-check-compat",[zt]:"fire-auth",[Ht]:"fire-auth-compat",[Wt]:"fire-rtdb",[Gt]:"fire-rtdb-compat",[qt]:"fire-fn",[Kt]:"fire-fn-compat",[Yt]:"fire-iid",[Qt]:"fire-iid-compat",[Xt]:"fire-fcm",[Jt]:"fire-fcm-compat",[$t]:"fire-perf",[Zt]:"fire-perf-compat",[en]:"fire-rc",[tn]:"fire-rc-compat",[nn]:"fire-gcs",[rn]:"fire-gcs-compat",[an]:"fire-fst",[on]:"fire-fst-compat",[sn]:"fire-vertex","fire-js":"fire-js",[ln]:"fire-js-all"},hn=new Map,dn=new Map,fn=new Map;function pn(e,t){try{e.container.addComponent(t)}catch(YE){Lt.debug("Component ".concat(t.name," failed to register with FirebaseApp ").concat(e.name),YE)}}function mn(e){const t=e.name;if(fn.has(t))return Lt.debug("There were multiple attempts to register component ".concat(t,".")),!1;fn.set(t,e);for(const n of hn.values())pn(n,e);for(const n of dn.values())pn(n,e);return!0}function gn(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}function vn(e){return void 0!==e.settings}const yn=new Qe("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."});class bn{constructor(e,t,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new it("app",(()=>this),"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw yn.create("app-deleted",{appName:this._name})}}const wn="10.12.3";function Sn(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e;if("object"!==typeof t){t={name:t}}const r=Object.assign({name:cn,automaticDataCollectionEnabled:!1},t),a=r.name;if("string"!==typeof a||!a)throw yn.create("bad-app-name",{appName:String(a)});if(n||(n=ze()),!n)throw yn.create("no-options");const i=hn.get(a);if(i){if(Je(n,i.options)&&Je(r,i.config))return i;throw yn.create("duplicate-app",{appName:a})}const s=new lt(a);for(const l of fn.values())s.addComponent(l);const o=new bn(n,r,s);return hn.set(a,o),o}function Tn(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:cn;const t=hn.get(e);if(!t&&e===cn&&ze())return Sn();if(!t)throw yn.create("no-app",{appName:e});return t}function En(e,t,n){var r;let a=null!==(r=un[e])&&void 0!==r?r:e;n&&(a+="-".concat(n));const i=a.match(/\s|\//),s=t.match(/\s|\//);if(i||s){const e=['Unable to register library "'.concat(a,'" with version "').concat(t,'":')];return i&&e.push('library name "'.concat(a,'" contains illegal characters (whitespace or "/")')),i&&s&&e.push("and"),s&&e.push('version name "'.concat(t,'" contains illegal characters (whitespace or "/")')),void Lt.warn(e.join(" "))}mn(new it("".concat(a,"-version"),(()=>({library:a,version:t})),"VERSION"))}const xn="firebase-heartbeat-database",_n=1,An="firebase-heartbeat-store";let kn=null;function Cn(){return kn||(kn=function(e,t){let{blocked:n,upgrade:r,blocking:a,terminated:i}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const s=indexedDB.open(e,t),o=kt(s);return r&&s.addEventListener("upgradeneeded",(e=>{r(kt(s.result),e.oldVersion,e.newVersion,kt(s.transaction),e)})),n&&s.addEventListener("blocked",(e=>n(e.oldVersion,e.newVersion,e))),o.then((e=>{i&&e.addEventListener("close",(()=>i())),a&&e.addEventListener("versionchange",(e=>a(e.oldVersion,e.newVersion,e)))})).catch((()=>{})),o}(xn,_n,{upgrade:(e,t)=>{if(0===t)try{e.createObjectStore(An)}catch(YE){console.warn(YE)}}}).catch((e=>{throw yn.create("idb-open",{originalErrorMessage:e.message})}))),kn}async function In(e,t){try{const n=(await Cn()).transaction(An,"readwrite"),r=n.objectStore(An);await r.put(t,Nn(e)),await n.done}catch(YE){if(YE instanceof Ye)Lt.warn(YE.message);else{const t=yn.create("idb-set",{originalErrorMessage:null===YE||void 0===YE?void 0:YE.message});Lt.warn(t.message)}}}function Nn(e){return"".concat(e.name,"!").concat(e.options.appId)}class On{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new Dn(t),this._heartbeatsCachePromise=this._storage.read().then((e=>(this._heartbeatsCache=e,e)))}async triggerHeartbeat(){var e,t;const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=Rn();if((null!=(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)||(this._heartbeatsCache=await this._heartbeatsCachePromise,null!=(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats)))&&this._heartbeatsCache.lastSentHeartbeatDate!==r&&!this._heartbeatsCache.heartbeats.some((e=>e.date===r)))return this._heartbeatsCache.heartbeats.push({date:r,agent:n}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter((e=>{const t=new Date(e.date).valueOf();return Date.now()-t<=2592e6})),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){var e;if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)||0===this._heartbeatsCache.heartbeats.length)return"";const t=Rn(),{heartbeatsToSend:n,unsentEntries:r}=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024;const n=[];let r=e.slice();for(const a of e){const e=n.find((e=>e.agent===a.agent));if(e){if(e.dates.push(a.date),jn(n)>t){e.dates.pop();break}}else if(n.push({agent:a.agent,dates:[a.date]}),jn(n)>t){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}(this._heartbeatsCache.heartbeats),a=Me(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=t,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),a}}function Rn(){return(new Date).toISOString().substring(0,10)}class Dn{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!Ke()&&new Promise(((e,t)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",a=self.indexedDB.open(r);a.onsuccess=()=>{a.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},a.onupgradeneeded=()=>{n=!1},a.onerror=()=>{var e;t((null===(e=a.error)||void 0===e?void 0:e.message)||"")}}catch(n){t(n)}})).then((()=>!0)).catch((()=>!1))}async read(){if(await this._canUseIndexedDBPromise){const e=await async function(e){try{const t=(await Cn()).transaction(An),n=await t.objectStore(An).get(Nn(e));return await t.done,n}catch(YE){if(YE instanceof Ye)Lt.warn(YE.message);else{const t=yn.create("idb-get",{originalErrorMessage:null===YE||void 0===YE?void 0:YE.message});Lt.warn(t.message)}}}(this.app);return(null===e||void 0===e?void 0:e.heartbeats)?e:{heartbeats:[]}}return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return In(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return In(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}}}function jn(e){return Me(JSON.stringify({version:2,heartbeats:e})).length}var Pn;Pn="",mn(new it("platform-logger",(e=>new Dt(e)),"PRIVATE")),mn(new it("heartbeat",(e=>new On(e)),"PRIVATE")),En(jt,Pt,Pn),En(jt,Pt,"esm2017"),En("fire-js","");function Ln(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n}Object.create;Object.create;"function"===typeof SuppressedError&&SuppressedError;function Mn(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const Fn=Mn,Un=new Qe("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),Vn=new mt("@firebase/auth");function Bn(e){if(Vn.logLevel<=ut.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];Vn.error("Auth (".concat(wn,"): ").concat(e),...n)}}function zn(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];throw qn(e,...n)}function Hn(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return qn(e,...n)}function Wn(e,t,n){const r=Object.assign(Object.assign({},Fn()),{[t]:n});return new Qe("auth","Firebase",r).create(t,{appName:e.name})}function Gn(e){return Wn(e,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function qn(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if("string"!==typeof e){const t=n[0],r=[...n.slice(1)];return r[0]&&(r[0].appName=e.name),e._errorFactory.create(t,...r)}return Un.create(e,...n)}function Kn(e,t){if(!e){for(var n=arguments.length,r=new Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];throw qn(t,...r)}}function Yn(e){const t="INTERNAL ASSERTION FAILED: "+e;throw Bn(t),new Error(t)}function Qn(e,t){e||Yn(t)}function Xn(){var e;return"undefined"!==typeof self&&(null===(e=self.location)||void 0===e?void 0:e.href)||""}function Jn(){return"http:"===$n()||"https:"===$n()}function $n(){var e;return"undefined"!==typeof self&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}function Zn(){return!("undefined"!==typeof navigator&&navigator&&"onLine"in navigator&&"boolean"===typeof navigator.onLine&&(Jn()||function(){const e="object"===typeof chrome?chrome.runtime:"object"===typeof browser?browser.runtime:void 0;return"object"===typeof e&&void 0!==e.id}()||"connection"in navigator))||navigator.onLine}class er{constructor(e,t){this.shortDelay=e,this.longDelay=t,Qn(t>e,"Short delay should be less than long delay!"),this.isMobile="undefined"!==typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Ge())||"object"===typeof navigator&&"ReactNative"===navigator.product}get(){return Zn()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function tr(e,t){Qn(e.emulator,"Emulator should always be set here");const{url:n}=e.emulator;return t?"".concat(n).concat(t.startsWith("/")?t.slice(1):t):n}class nr{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!==typeof self&&"fetch"in self?self.fetch:"undefined"!==typeof globalThis&&globalThis.fetch?globalThis.fetch:"undefined"!==typeof fetch?fetch:void Yn("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!==typeof self&&"Headers"in self?self.Headers:"undefined"!==typeof globalThis&&globalThis.Headers?globalThis.Headers:"undefined"!==typeof Headers?Headers:void Yn("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!==typeof self&&"Response"in self?self.Response:"undefined"!==typeof globalThis&&globalThis.Response?globalThis.Response:"undefined"!==typeof Response?Response:void Yn("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const rr={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},ar=new er(3e4,6e4);function ir(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}async function sr(e,t,n,r){return or(e,arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},(async()=>{let a={},i={};r&&("GET"===t?i=r:a={body:JSON.stringify(r)});const s=Ze(Object.assign({key:e.config.apiKey},i)).slice(1),o=await e._getAdditionalHeaders();return o["Content-Type"]="application/json",e.languageCode&&(o["X-Firebase-Locale"]=e.languageCode),nr.fetch()(cr(e,e.config.apiHost,n,s),Object.assign({method:t,headers:o,referrerPolicy:"no-referrer"},a))}))}async function or(e,t,n){e._canInitEmulator=!1;const r=Object.assign(Object.assign({},rr),t);try{const t=new hr(e),a=await Promise.race([n(),t.promise]);t.clearNetworkTimeout();const i=await a.json();if("needConfirmation"in i)throw dr(e,"account-exists-with-different-credential",i);if(a.ok&&!("errorMessage"in i))return i;{const t=a.ok?i.errorMessage:i.error.message,[n,s]=t.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw dr(e,"credential-already-in-use",i);if("EMAIL_EXISTS"===n)throw dr(e,"email-already-in-use",i);if("USER_DISABLED"===n)throw dr(e,"user-disabled",i);const o=r[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(s)throw Wn(e,o,s);zn(e,o)}}catch(YE){if(YE instanceof Ye)throw YE;zn(e,"network-request-failed",{message:String(YE)})}}async function lr(e,t,n,r){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};const i=await sr(e,t,n,r,a);return"mfaPendingCredential"in i&&zn(e,"multi-factor-auth-required",{_serverResponse:i}),i}function cr(e,t,n,r){const a="".concat(t).concat(n,"?").concat(r);return e.config.emulator?tr(e.config,a):"".concat(e.config.apiScheme,"://").concat(a)}function ur(e){switch(e){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class hr{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise(((e,t)=>{this.timer=setTimeout((()=>t(Hn(this.auth,"network-request-failed"))),ar.get())}))}clearNetworkTimeout(){clearTimeout(this.timer)}}function dr(e,t,n){const r={appName:e.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const a=Hn(e,t,r);return a.customData._tokenResponse=n,a}function fr(e){return void 0!==e&&void 0!==e.enterprise}class pr{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],void 0===e.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||0===this.recaptchaEnforcementState.length)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return ur(t.enforcementState);return null}isProviderEnabled(e){return"ENFORCE"===this.getProviderEnforcementState(e)||"AUDIT"===this.getProviderEnforcementState(e)}}async function mr(e,t){return sr(e,"GET","/v2/recaptchaConfig",ir(e,t))}async function gr(e,t){return sr(e,"POST","/v1/accounts:lookup",t)}function vr(e){if(e)try{const t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(YE){}}function yr(e){return 1e3*Number(e)}function br(e){const[t,n,r]=e.split(".");if(void 0===t||void 0===n||void 0===r)return Bn("JWT malformed, contained fewer than 3 sections"),null;try{const e=Fe(n);return e?JSON.parse(e):(Bn("Failed to decode base64 JWT payload"),null)}catch(YE){return Bn("Caught error parsing JWT payload as JSON",null===YE||void 0===YE?void 0:YE.toString()),null}}function wr(e){const t=br(e);return Kn(t,"internal-error"),Kn("undefined"!==typeof t.exp,"internal-error"),Kn("undefined"!==typeof t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}async function Sr(e,t){if(arguments.length>2&&void 0!==arguments[2]&&arguments[2])return t;try{return await t}catch(YE){throw YE instanceof Ye&&function(e){let{code:t}=e;return t==="auth/".concat("user-disabled")||t==="auth/".concat("user-token-expired")}(YE)&&e.auth.currentUser===e&&await e.auth.signOut(),YE}}class Tr{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const e=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),e}{this.errorBackoff=3e4;const e=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,e)}}schedule(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout((async()=>{await this.iteration()}),t)}async iteration(){try{await this.user.getIdToken(!0)}catch(YE){return void((null===YE||void 0===YE?void 0:YE.code)==="auth/".concat("network-request-failed")&&this.schedule(!0))}this.schedule()}}class Er{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=vr(this.lastLoginAt),this.creationTime=vr(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function xr(e){var t;const n=e.auth,r=await e.getIdToken(),a=await Sr(e,gr(n,{idToken:r}));Kn(null===a||void 0===a?void 0:a.users.length,n,"internal-error");const i=a.users[0];e._notifyReloadListener(i);const s=(null===(t=i.providerUserInfo)||void 0===t?void 0:t.length)?_r(i.providerUserInfo):[],o=(l=e.providerData,c=s,[...l.filter((e=>!c.some((t=>t.providerId===e.providerId)))),...c]);var l,c;const u=e.isAnonymous,h=!(e.email&&i.passwordHash)&&!(null===o||void 0===o?void 0:o.length),d=!!u&&h,f={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new Er(i.createdAt,i.lastLoginAt),isAnonymous:d};Object.assign(e,f)}function _r(e){return e.map((e=>{var{providerId:t}=e,n=Ln(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}}))}class Ar{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Kn(e.idToken,"internal-error"),Kn("undefined"!==typeof e.idToken,"internal-error"),Kn("undefined"!==typeof e.refreshToken,"internal-error");const t="expiresIn"in e&&"undefined"!==typeof e.expiresIn?Number(e.expiresIn):wr(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Kn(0!==e.length,"internal-error");const t=wr(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]||!this.accessToken||this.isExpired?(Kn(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null):this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:r,expiresIn:a}=await async function(e,t){const n=await or(e,{},(async()=>{const n=Ze({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:r,apiKey:a}=e.config,i=cr(e,r,"/v1/token","key=".concat(a)),s=await e._getAdditionalHeaders();return s["Content-Type"]="application/x-www-form-urlencoded",nr.fetch()(i,{method:"POST",headers:s,body:n})}));return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}(e,t);this.updateTokensAndExpiration(n,r,Number(a))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(e,t){const{refreshToken:n,accessToken:r,expirationTime:a}=t,i=new Ar;return n&&(Kn("string"===typeof n,"internal-error",{appName:e}),i.refreshToken=n),r&&(Kn("string"===typeof r,"internal-error",{appName:e}),i.accessToken=r),a&&(Kn("number"===typeof a,"internal-error",{appName:e}),i.expirationTime=a),i}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Ar,this.toJSON())}_performRefresh(){return Yn("not implemented")}}function kr(e,t){Kn("string"===typeof e||"undefined"===typeof e,"internal-error",{appName:t})}class Cr{constructor(e){var{uid:t,auth:n,stsTokenManager:r}=e,a=Ln(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Tr(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=a.displayName||null,this.email=a.email||null,this.emailVerified=a.emailVerified||!1,this.phoneNumber=a.phoneNumber||null,this.photoURL=a.photoURL||null,this.isAnonymous=a.isAnonymous||!1,this.tenantId=a.tenantId||null,this.providerData=a.providerData?[...a.providerData]:[],this.metadata=new Er(a.createdAt||void 0,a.lastLoginAt||void 0)}async getIdToken(e){const t=await Sr(this,this.stsTokenManager.getToken(this.auth,e));return Kn(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return async function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=at(e),r=await n.getIdToken(t),a=br(r);Kn(a&&a.exp&&a.auth_time&&a.iat,n.auth,"internal-error");const i="object"===typeof a.firebase?a.firebase:void 0,s=null===i||void 0===i?void 0:i.sign_in_provider;return{claims:a,token:r,authTime:vr(yr(a.auth_time)),issuedAtTime:vr(yr(a.iat)),expirationTime:vr(yr(a.exp)),signInProvider:s||null,signInSecondFactor:(null===i||void 0===i?void 0:i.sign_in_second_factor)||null}}(this,e)}reload(){return async function(e){const t=at(e);await xr(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}(this)}_assign(e){this!==e&&(Kn(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map((e=>Object.assign({},e))),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Cr(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){Kn(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await xr(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(vn(this.auth.app))return Promise.reject(Gn(this.auth));const e=await this.getIdToken();return await Sr(this,async function(e,t){return sr(e,"POST","/v1/accounts:delete",t)}(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map((e=>Object.assign({},e))),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var n,r,a,i,s,o,l,c;const u=null!==(n=t.displayName)&&void 0!==n?n:void 0,h=null!==(r=t.email)&&void 0!==r?r:void 0,d=null!==(a=t.phoneNumber)&&void 0!==a?a:void 0,f=null!==(i=t.photoURL)&&void 0!==i?i:void 0,p=null!==(s=t.tenantId)&&void 0!==s?s:void 0,m=null!==(o=t._redirectEventId)&&void 0!==o?o:void 0,g=null!==(l=t.createdAt)&&void 0!==l?l:void 0,v=null!==(c=t.lastLoginAt)&&void 0!==c?c:void 0,{uid:y,emailVerified:b,isAnonymous:w,providerData:S,stsTokenManager:T}=t;Kn(y&&T,e,"internal-error");const E=Ar.fromJSON(this.name,T);Kn("string"===typeof y,e,"internal-error"),kr(u,e.name),kr(h,e.name),Kn("boolean"===typeof b,e,"internal-error"),Kn("boolean"===typeof w,e,"internal-error"),kr(d,e.name),kr(f,e.name),kr(p,e.name),kr(m,e.name),kr(g,e.name),kr(v,e.name);const x=new Cr({uid:y,auth:e,email:h,emailVerified:b,displayName:u,isAnonymous:w,photoURL:f,phoneNumber:d,tenantId:p,stsTokenManager:E,createdAt:g,lastLoginAt:v});return S&&Array.isArray(S)&&(x.providerData=S.map((e=>Object.assign({},e)))),m&&(x._redirectEventId=m),x}static async _fromIdTokenResponse(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=new Ar;r.updateFromServerResponse(t);const a=new Cr({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:n});return await xr(a),a}static async _fromGetAccountInfoResponse(e,t,n){const r=t.users[0];Kn(void 0!==r.localId,"internal-error");const a=void 0!==r.providerUserInfo?_r(r.providerUserInfo):[],i=!(r.email&&r.passwordHash)&&!(null===a||void 0===a?void 0:a.length),s=new Ar;s.updateFromIdToken(n);const o=new Cr({uid:r.localId,auth:e,stsTokenManager:s,isAnonymous:i}),l={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:a,metadata:new Er(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash)&&!(null===a||void 0===a?void 0:a.length)};return Object.assign(o,l),o}}const Ir=new Map;function Nr(e){Qn(e instanceof Function,"Expected a class definition");let t=Ir.get(e);return t?(Qn(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,Ir.set(e,t),t)}class Or{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return void 0===t?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}Or.type="NONE";const Rr=Or;function Dr(e,t,n){return"firebase".concat(":",e,":").concat(t,":").concat(n)}class jr{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:r,name:a}=this.auth;this.fullUserKey=Dr(this.userKey,r.apiKey,a),this.fullPersistenceKey=Dr("persistence",r.apiKey,a),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Cr._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=e,t?this.setCurrentUser(t):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"authUser";if(!t.length)return new jr(Nr(Rr),e,n);const r=(await Promise.all(t.map((async e=>{if(await e._isAvailable())return e})))).filter((e=>e));let a=r[0]||Nr(Rr);const i=Dr(n,e.config.apiKey,e.name);let s=null;for(const c of t)try{const t=await c._get(i);if(t){const n=Cr._fromJSON(e,t);c!==a&&(s=n),a=c;break}}catch(l){}const o=r.filter((e=>e._shouldAllowMigration));return a._shouldAllowMigration&&o.length?(a=o[0],s&&await a._set(i,s.toJSON()),await Promise.all(t.map((async e=>{if(e!==a)try{await e._remove(i)}catch(l){}}))),new jr(a,e,n)):new jr(a,e,n)}}function Pr(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(Ur(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(Lr(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(Br(t))return"Blackberry";if(zr(t))return"Webos";if(Mr(t))return"Safari";if((t.includes("chrome/")||Fr(t))&&!t.includes("edge/"))return"Chrome";if(Vr(t))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=e.match(t);if(2===(null===n||void 0===n?void 0:n.length))return n[1]}return"Other"}function Lr(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ge();return/firefox\//i.test(e)}function Mr(){const e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ge()).toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Fr(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ge();return/crios\//i.test(e)}function Ur(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ge();return/iemobile/i.test(e)}function Vr(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ge();return/android/i.test(e)}function Br(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ge();return/blackberry/i.test(e)}function zr(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ge();return/webos/i.test(e)}function Hr(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ge();return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function Wr(){return function(){const e=Ge();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}()&&10===document.documentMode}function Gr(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ge();return Hr(e)||Vr(e)||zr(e)||Br(e)||/windows phone/i.test(e)||Ur(e)}function qr(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];switch(e){case"Browser":t=Pr(Ge());break;case"Worker":t="".concat(Pr(Ge()),"-").concat(e);break;default:t=e}const r=n.length?n.join(","):"FirebaseCore-web";return"".concat(t,"/","JsCore","/").concat(wn,"/").concat(r)}class Kr{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=t=>new Promise(((n,r)=>{try{n(e(t))}catch(YE){r(YE)}}));n.onAbort=t,this.queue.push(n);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const n of this.queue)await n(e),n.onAbort&&t.push(n.onAbort)}catch(YE){t.reverse();for(const r of t)try{r()}catch(n){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:null===YE||void 0===YE?void 0:YE.message})}}}class Yr{constructor(e){var t,n,r,a;const i=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=null!==(t=i.minPasswordLength)&&void 0!==t?t:6,i.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=i.maxPasswordLength),void 0!==i.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=i.containsLowercaseCharacter),void 0!==i.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=i.containsUppercaseCharacter),void 0!==i.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=i.containsNumericCharacter),void 0!==i.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=i.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=null!==(r=null===(n=e.allowedNonAlphanumericCharacters)||void 0===n?void 0:n.join(""))&&void 0!==r?r:"",this.forceUpgradeOnSignin=null!==(a=e.forceUpgradeOnSignin)&&void 0!==a&&a,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,n,r,a,i,s;const o={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,o),this.validatePasswordCharacterOptions(e,o),o.isValid&&(o.isValid=null===(t=o.meetsMinPasswordLength)||void 0===t||t),o.isValid&&(o.isValid=null===(n=o.meetsMaxPasswordLength)||void 0===n||n),o.isValid&&(o.isValid=null===(r=o.containsLowercaseLetter)||void 0===r||r),o.isValid&&(o.isValid=null===(a=o.containsUppercaseLetter)||void 0===a||a),o.isValid&&(o.isValid=null===(i=o.containsNumericCharacter)||void 0===i||i),o.isValid&&(o.isValid=null===(s=o.containsNonAlphanumericCharacter)||void 0===s||s),o}validatePasswordLengthOptions(e,t){const n=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;n&&(t.meetsMinPasswordLength=e.length>=n),r&&(t.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,t){let n;this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);for(let r=0;r<e.length;r++)n=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,t,n,r,a){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=a))}}class Qr{constructor(e,t,n,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Jr(this),this.idTokenSubscription=new Jr(this),this.beforeStateQueue=new Kr(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Un,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Nr(t)),this._initializationPromise=this.queue((async()=>{var n,r;if(!this._deleted&&(this.persistenceManager=await jr.create(this,e),!this._deleted)){if(null===(n=this._popupRedirectResolver)||void 0===n?void 0:n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(YE){}await this.initializeCurrentUser(t),this.lastNotifiedUid=(null===(r=this.currentUser)||void 0===r?void 0:r.uid)||null,this._deleted||(this._isInitialized=!0)}})),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();return this.currentUser||e?this.currentUser&&e&&this.currentUser.uid===e.uid?(this._currentUser._assign(e),void await this.currentUser.getIdToken()):void await this._updateCurrentUser(e,!0):void 0}async initializeCurrentUserFromIdToken(e){try{const t=await gr(this,{idToken:e}),n=await Cr._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(n)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(vn(this.app)){const e=this.app.settings.authIdToken;return e?new Promise((t=>{setTimeout((()=>this.initializeCurrentUserFromIdToken(e).then(t,t)))})):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let r=n,a=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const n=null===(t=this.redirectUser)||void 0===t?void 0:t._redirectEventId,i=null===r||void 0===r?void 0:r._redirectEventId,s=await this.tryRedirectSignIn(e);n&&n!==i||!(null===s||void 0===s?void 0:s.user)||(r=s.user,a=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(a)try{await this.beforeStateQueue.runMiddleware(r)}catch(YE){r=n,this._popupRedirectResolver._overrideRedirectResult(this,(()=>Promise.reject(YE)))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return Kn(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch(YE){await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await xr(e)}catch(YE){if((null===YE||void 0===YE?void 0:YE.code)!=="auth/".concat("network-request-failed"))return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=function(){if("undefined"===typeof navigator)return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(vn(this.app))return Promise.reject(Gn(this));const t=e?at(e):null;return t&&Kn(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!this._deleted)return e&&Kn(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue((async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()}))}async signOut(){return vn(this.app)?Promise.reject(Gn(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return vn(this.app)?Promise.reject(Gn(this)):this.queue((async()=>{await this.assertedPersistence.setPersistence(Nr(e))}))}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await async function(e){return sr(e,"GET","/v2/passwordPolicy",ir(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}))}(this),t=new Yr(e);null===this.tenantId?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Qe("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}authStateReady(){return new Promise(((e,t)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged((()=>{n(),e()}),t)}}))}async revokeAccessToken(e){if(this.currentUser){const t={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:await this.currentUser.getIdToken()};null!=this.tenantId&&(t.tenantId=this.tenantId),await async function(e,t){return sr(e,"POST","/v2/accounts:revokeToken",ir(e,t))}(this,t)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return null===e?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Nr(e)||this._popupRedirectResolver;Kn(t,this,"argument-error"),this.redirectPersistenceManager=await jr.create(this,[Nr(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,n;return this._isInitialized&&await this.queue((async()=>{})),(null===(t=this._currentUser)||void 0===t?void 0:t._redirectEventId)===e?this._currentUser:(null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue((async()=>this.directlySetCurrentUser(e)))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return"".concat(this.config.authDomain,":").concat(this.config.apiKey,":").concat(this.name)}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,r){if(this._deleted)return()=>{};const a="function"===typeof t?t:t.next.bind(t);let i=!1;const s=this._isInitialized?Promise.resolve():this._initializationPromise;if(Kn(s,this,"internal-error"),s.then((()=>{i||a(this.currentUser)})),"function"===typeof t){const a=e.addObserver(t,n,r);return()=>{i=!0,a()}}{const n=e.addObserver(t);return()=>{i=!0,n()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Kn(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){e&&!this.frameworks.includes(e)&&(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=qr(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const n=await(null===(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getHeartbeatsHeader());n&&(t["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(t["X-Firebase-AppCheck"]=r),t}async _getAppCheckToken(){var e;const t=await(null===(e=this.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getToken());return(null===t||void 0===t?void 0:t.error)&&function(e){if(Vn.logLevel<=ut.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];Vn.warn("Auth (".concat(wn,"): ").concat(e),...n)}}("Error while retrieving App Check token: ".concat(t.error)),null===t||void 0===t?void 0:t.token}}function Xr(e){return at(e)}class Jr{constructor(e){this.auth=e,this.observer=null,this.addObserver=function(e,t){const n=new nt(e,t);return n.subscribe.bind(n)}((e=>this.observer=e))}get next(){return Kn(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let $r={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Zr(e){return $r.loadJS(e)}function ea(e){return"__".concat(e).concat(Math.floor(1e6*Math.random()))}class ta{constructor(e){this.type="recaptcha-enterprise",this.auth=Xr(e)}async verify(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"verify",t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];function n(t,n,r){const a=window.grecaptcha;fr(a)?a.enterprise.ready((()=>{a.enterprise.execute(t,{action:e}).then((e=>{n(e)})).catch((()=>{n("NO_RECAPTCHA")}))})):r(Error("No reCAPTCHA enterprise script loaded."))}return new Promise(((e,r)=>{(async function(e){if(!t){if(null==e.tenantId&&null!=e._agentRecaptchaConfig)return e._agentRecaptchaConfig.siteKey;if(null!=e.tenantId&&void 0!==e._tenantRecaptchaConfigs[e.tenantId])return e._tenantRecaptchaConfigs[e.tenantId].siteKey}return new Promise((async(t,n)=>{mr(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then((r=>{if(void 0!==r.recaptchaKey){const n=new pr(r);return null==e.tenantId?e._agentRecaptchaConfig=n:e._tenantRecaptchaConfigs[e.tenantId]=n,t(n.siteKey)}n(new Error("recaptcha Enterprise site key undefined"))})).catch((e=>{n(e)}))}))})(this.auth).then((a=>{if(!t&&fr(window.grecaptcha))n(a,e,r);else{if("undefined"===typeof window)return void r(new Error("RecaptchaVerifier is only supported in browser"));let t=$r.recaptchaEnterpriseScript;0!==t.length&&(t+=a),Zr(t).then((()=>{n(a,e,r)})).catch((e=>{r(e)}))}})).catch((e=>{r(e)}))}))}}async function na(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const a=new ta(e);let i;try{i=await a.verify(n)}catch(o){i=await a.verify(n,!0)}const s=Object.assign({},t);return r?Object.assign(s,{captchaResp:i}):Object.assign(s,{captchaResponse:i}),Object.assign(s,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(s,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),s}async function ra(e,t,n,r){var a;if(null===(a=e._getRecaptchaConfig())||void 0===a?void 0:a.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const a=await na(e,t,n,"getOobCode"===n);return r(e,a)}return r(e,t).catch((async a=>{if(a.code==="auth/".concat("missing-recaptcha-token")){console.log("".concat(n," is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow."));const a=await na(e,t,n,"getOobCode"===n);return r(e,a)}return Promise.reject(a)}))}function aa(e,t,n){const r=Xr(e);Kn(r._canInitEmulator,r,"emulator-config-failed"),Kn(/^https?:\/\//.test(t),r,"invalid-emulator-scheme");const a=!!(null===n||void 0===n?void 0:n.disableWarnings),i=ia(t),{host:s,port:o}=function(e){const t=ia(e),n=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",a=/^(\[[^\]]+\])(:|$)/.exec(r);if(a){const e=a[1];return{host:e,port:sa(r.substr(e.length+1))}}{const[e,t]=r.split(":");return{host:e,port:sa(t)}}}(t),l=null===o?"":":".concat(o);r.config.emulator={url:"".concat(i,"//").concat(s).concat(l,"/")},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:s,port:o,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:a})}),a||function(){function e(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!==typeof console&&"function"===typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials.");"undefined"!==typeof window&&"undefined"!==typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}()}function ia(e){const t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function sa(e){if(!e)return null;const t=Number(e);return isNaN(t)?null:t}class oa{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Yn("not implemented")}_getIdTokenResponse(e){return Yn("not implemented")}_linkToIdToken(e,t){return Yn("not implemented")}_getReauthenticationResolver(e){return Yn("not implemented")}}async function la(e,t){return sr(e,"POST","/v1/accounts:signUp",t)}async function ca(e,t){return lr(e,"POST","/v1/accounts:signInWithPassword",ir(e,t))}async function ua(e,t){return sr(e,"POST","/v1/accounts:sendOobCode",ir(e,t))}async function ha(e,t){return ua(e,t)}class da extends oa{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;super("password",n),this._email=e,this._password=t,this._tenantId=r}static _fromEmailAndPassword(e,t){return new da(e,t,"password")}static _fromEmailAndCode(e,t){return new da(e,t,"emailLink",arguments.length>2&&void 0!==arguments[2]?arguments[2]:null)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t="string"===typeof e?JSON.parse(e):e;if((null===t||void 0===t?void 0:t.email)&&(null===t||void 0===t?void 0:t.password)){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":return ra(e,{returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signInWithPassword",ca);case"emailLink":return async function(e,t){return lr(e,"POST","/v1/accounts:signInWithEmailLink",ir(e,t))}(e,{email:this._email,oobCode:this._password});default:zn(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":return ra(e,{idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",la);case"emailLink":return async function(e,t){return lr(e,"POST","/v1/accounts:signInWithEmailLink",ir(e,t))}(e,{idToken:t,email:this._email,oobCode:this._password});default:zn(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function fa(e,t){return lr(e,"POST","/v1/accounts:signInWithIdp",ir(e,t))}class pa extends oa{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new pa(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):zn("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t="string"===typeof e?JSON.parse(e):e,{providerId:n,signInMethod:r}=t,a=Ln(t,["providerId","signInMethod"]);if(!n||!r)return null;const i=new pa(n,r);return i.idToken=a.idToken||void 0,i.accessToken=a.accessToken||void 0,i.secret=a.secret,i.nonce=a.nonce,i.pendingToken=a.pendingToken||null,i}_getIdTokenResponse(e){return fa(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,fa(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,fa(e,t)}buildRequest(){const e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Ze(t)}return e}}const ma={USER_NOT_FOUND:"user-not-found"};class ga extends oa{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new ga({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new ga({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return async function(e,t){return lr(e,"POST","/v1/accounts:signInWithPhoneNumber",ir(e,t))}(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return async function(e,t){const n=await lr(e,"POST","/v1/accounts:signInWithPhoneNumber",ir(e,t));if(n.temporaryProof)throw dr(e,"account-exists-with-different-credential",n);return n}(e,Object.assign({idToken:t},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return async function(e,t){return lr(e,"POST","/v1/accounts:signInWithPhoneNumber",ir(e,Object.assign(Object.assign({},t),{operation:"REAUTH"})),ma)}(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:n,verificationCode:r}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:n,code:r}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){"string"===typeof e&&(e=JSON.parse(e));const{verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:a}=e;return n||t||r||a?new ga({verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:a}):null}}class va{constructor(e){var t,n,r,a,i,s;const o=et(tt(e)),l=null!==(t=o.apiKey)&&void 0!==t?t:null,c=null!==(n=o.oobCode)&&void 0!==n?n:null,u=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(r=o.mode)&&void 0!==r?r:null);Kn(l&&c&&u,"argument-error"),this.apiKey=l,this.operation=u,this.code=c,this.continueUrl=null!==(a=o.continueUrl)&&void 0!==a?a:null,this.languageCode=null!==(i=o.languageCode)&&void 0!==i?i:null,this.tenantId=null!==(s=o.tenantId)&&void 0!==s?s:null}static parseLink(e){const t=function(e){const t=et(tt(e)).link,n=t?et(tt(t)).deep_link_id:null,r=et(tt(e)).deep_link_id;return(r?et(tt(r)).link:null)||r||n||t||e}(e);try{return new va(t)}catch(n){return null}}}class ya{constructor(){this.providerId=ya.PROVIDER_ID}static credential(e,t){return da._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const n=va.parseLink(t);return Kn(n,"argument-error"),da._fromEmailAndCode(e,n.code,n.tenantId)}}ya.PROVIDER_ID="password",ya.EMAIL_PASSWORD_SIGN_IN_METHOD="password",ya.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class ba{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class wa extends ba{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Sa extends wa{constructor(){super("facebook.com")}static credential(e){return pa._fromParams({providerId:Sa.PROVIDER_ID,signInMethod:Sa.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Sa.credentialFromTaggedObject(e)}static credentialFromError(e){return Sa.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return Sa.credential(t.oauthAccessToken)}catch(n){return null}}}Sa.FACEBOOK_SIGN_IN_METHOD="facebook.com",Sa.PROVIDER_ID="facebook.com";class Ta extends wa{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return pa._fromParams({providerId:Ta.PROVIDER_ID,signInMethod:Ta.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Ta.credentialFromTaggedObject(e)}static credentialFromError(e){return Ta.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{oauthIdToken:n,oauthAccessToken:r}=t;if(!n&&!r)return null;try{return Ta.credential(n,r)}catch(a){return null}}}Ta.GOOGLE_SIGN_IN_METHOD="google.com",Ta.PROVIDER_ID="google.com";class Ea extends wa{constructor(){super("github.com")}static credential(e){return pa._fromParams({providerId:Ea.PROVIDER_ID,signInMethod:Ea.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ea.credentialFromTaggedObject(e)}static credentialFromError(e){return Ea.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return Ea.credential(t.oauthAccessToken)}catch(n){return null}}}Ea.GITHUB_SIGN_IN_METHOD="github.com",Ea.PROVIDER_ID="github.com";class xa extends wa{constructor(){super("twitter.com")}static credential(e,t){return pa._fromParams({providerId:xa.PROVIDER_ID,signInMethod:xa.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return xa.credentialFromTaggedObject(e)}static credentialFromError(e){return xa.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=t;if(!n||!r)return null;try{return xa.credential(n,r)}catch(a){return null}}}async function _a(e,t){return lr(e,"POST","/v1/accounts:signUp",ir(e,t))}xa.TWITTER_SIGN_IN_METHOD="twitter.com",xa.PROVIDER_ID="twitter.com";class Aa{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const a=await Cr._fromIdTokenResponse(e,n,r),i=ka(n);return new Aa({user:a,providerId:i,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const r=ka(n);return new Aa({user:e,providerId:r,_tokenResponse:n,operationType:t})}}function ka(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}class Ca extends Ye{constructor(e,t,n,r){var a;super(t.code,t.message),this.operationType=n,this.user=r,Object.setPrototypeOf(this,Ca.prototype),this.customData={appName:e.name,tenantId:null!==(a=e.tenantId)&&void 0!==a?a:void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,r){return new Ca(e,t,n,r)}}function Ia(e,t,n,r){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch((n=>{if(n.code==="auth/".concat("multi-factor-auth-required"))throw Ca._fromErrorAndOperation(e,n,t,r);throw n}))}async function Na(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=await Sr(e,t._linkToIdToken(e.auth,await e.getIdToken()),n);return Aa._forOperation(e,"link",r)}async function Oa(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const{auth:r}=e;if(vn(r.app))return Promise.reject(Gn(r));const a="reauthenticate";try{const i=await Sr(e,Ia(r,a,t,e),n);Kn(i.idToken,r,"internal-error");const s=br(i.idToken);Kn(s,r,"internal-error");const{sub:o}=s;return Kn(e.uid===o,r,"user-mismatch"),Aa._forOperation(e,a,i)}catch(YE){throw(null===YE||void 0===YE?void 0:YE.code)==="auth/".concat("user-not-found")&&zn(r,"user-mismatch"),YE}}async function Ra(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(vn(e.app))return Promise.reject(Gn(e));const r="signIn",a=await Ia(e,r,t),i=await Aa._fromIdTokenResponse(e,r,a);return n||await e._updateCurrentUser(i.user),i}async function Da(e,t){return Ra(Xr(e),t)}function ja(e,t,n){var r;Kn((null===(r=n.url)||void 0===r?void 0:r.length)>0,e,"invalid-continue-uri"),Kn("undefined"===typeof n.dynamicLinkDomain||n.dynamicLinkDomain.length>0,e,"invalid-dynamic-link-domain"),t.continueUrl=n.url,t.dynamicLinkDomain=n.dynamicLinkDomain,t.canHandleCodeInApp=n.handleCodeInApp,n.iOS&&(Kn(n.iOS.bundleId.length>0,e,"missing-ios-bundle-id"),t.iOSBundleId=n.iOS.bundleId),n.android&&(Kn(n.android.packageName.length>0,e,"missing-android-pkg-name"),t.androidInstallApp=n.android.installApp,t.androidMinimumVersionCode=n.android.minimumVersion,t.androidPackageName=n.android.packageName)}async function Pa(e){const t=Xr(e);t._getPasswordPolicyInternal()&&await t._updatePasswordPolicy()}function La(e,t,n){return vn(e.app)?Promise.reject(Gn(e)):Da(at(e),ya.credential(t,n)).catch((async t=>{throw t.code==="auth/".concat("password-does-not-meet-requirements")&&Pa(e),t}))}new WeakMap;const Ma="__sak";class Fa{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Ma,"1"),this.storage.removeItem(Ma),Promise.resolve(!0)):Promise.resolve(!1)}catch(e){return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}class Ua extends Fa{constructor(){super((()=>window.localStorage),"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function(){const e=Ge();return Mr(e)||Hr(e)}()&&function(){try{return!(!window||window===window.top)}catch(YE){return!1}}(),this.fallbackToPolling=Gr(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),r=this.localCache[t];n!==r&&e(t,r,n)}}onStorageEvent(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e.key)return void this.forAllChangedKeys(((e,t,n)=>{this.notifyListeners(e,n)}));const n=e.key;if(t?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const r=this.storage.getItem(n);if(e.newValue!==r)null!==e.newValue?this.storage.setItem(n,e.newValue):this.storage.removeItem(n);else if(this.localCache[n]===e.newValue&&!t)return}const r=()=>{const e=this.storage.getItem(n);(t||this.localCache[n]!==e)&&this.notifyListeners(n,e)},a=this.storage.getItem(n);Wr()&&a!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,10):r()}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const r of Array.from(n))r(t?JSON.parse(t):t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((()=>{this.forAllChangedKeys(((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)}))}),1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}Ua.type="LOCAL";const Va=Ua;class Ba extends Fa{constructor(){super((()=>window.sessionStorage),"SESSION")}_addListener(e,t){}_removeListener(e,t){}}Ba.type="SESSION";const za=Ba;class Ha{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find((t=>t.isListeningto(e)));if(t)return t;const n=new Ha(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:r,data:a}=t.data,i=this.handlersMap[r];if(!(null===i||void 0===i?void 0:i.size))return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:r});const s=Array.from(i).map((async e=>e(t.origin,a))),o=await function(e){return Promise.all(e.map((async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}})))}(s);t.ports[0].postMessage({status:"done",eventId:n,eventType:r,response:o})}_subscribe(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}function Wa(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n="";for(let r=0;r<t;r++)n+=Math.floor(10*Math.random());return e+n}Ha.receivers=[];class Ga{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50;const r="undefined"!==typeof MessageChannel?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let a,i;return new Promise(((s,o)=>{const l=Wa("",20);r.port1.start();const c=setTimeout((()=>{o(new Error("unsupported_event"))}),n);i={messageChannel:r,onMessage(e){const t=e;if(t.data.eventId===l)switch(t.data.status){case"ack":clearTimeout(c),a=setTimeout((()=>{o(new Error("timeout"))}),3e3);break;case"done":clearTimeout(a),s(t.data.response);break;default:clearTimeout(c),clearTimeout(a),o(new Error("invalid_response"))}}},this.handlers.add(i),r.port1.addEventListener("message",i.onMessage),this.target.postMessage({eventType:e,eventId:l,data:t},[r.port2])})).finally((()=>{i&&this.removeMessageHandler(i)}))}}function qa(){return window}function Ka(){return"undefined"!==typeof qa().WorkerGlobalScope&&"function"===typeof qa().importScripts}const Ya="firebaseLocalStorageDb",Qa="firebaseLocalStorage",Xa="fbase_key";class Ja{constructor(e){this.request=e}toPromise(){return new Promise(((e,t)=>{this.request.addEventListener("success",(()=>{e(this.request.result)})),this.request.addEventListener("error",(()=>{t(this.request.error)}))}))}}function $a(e,t){return e.transaction([Qa],t?"readwrite":"readonly").objectStore(Qa)}function Za(){const e=indexedDB.open(Ya,1);return new Promise(((t,n)=>{e.addEventListener("error",(()=>{n(e.error)})),e.addEventListener("upgradeneeded",(()=>{const t=e.result;try{t.createObjectStore(Qa,{keyPath:Xa})}catch(YE){n(YE)}})),e.addEventListener("success",(async()=>{const n=e.result;n.objectStoreNames.contains(Qa)?t(n):(n.close(),await function(){const e=indexedDB.deleteDatabase(Ya);return new Ja(e).toPromise()}(),t(await Za()))}))}))}async function ei(e,t,n){const r=$a(e,!0).put({[Xa]:t,value:n});return new Ja(r).toPromise()}function ti(e,t){const n=$a(e,!0).delete(t);return new Ja(n).toPromise()}class ni{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then((()=>{}),(()=>{}))}async _openDb(){return this.db||(this.db=await Za()),this.db}async _withRetries(e){let t=0;for(;;)try{const t=await this._openDb();return await e(t)}catch(YE){if(t++>3)throw YE;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Ka()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Ha._getInstance(Ka()?self:null),this.receiver._subscribe("keyChanged",(async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)}))),this.receiver._subscribe("ping",(async(e,t)=>["keyChanged"]))}async initializeSender(){var e,t;if(this.activeServiceWorker=await async function(){if(!(null===navigator||void 0===navigator?void 0:navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch(e){return null}}(),!this.activeServiceWorker)return;this.sender=new Ga(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&(null===(e=n[0])||void 0===e?void 0:e.fulfilled)&&(null===(t=n[0])||void 0===t?void 0:t.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(this.sender&&this.activeServiceWorker&&function(){var e;return(null===(e=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===e?void 0:e.controller)||null}()===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch(t){}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Za();return await ei(e,Ma,"1"),await ti(e,Ma),!0}catch(e){}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite((async()=>(await this._withRetries((n=>ei(n,e,t))),this.localCache[e]=t,this.notifyServiceWorker(e))))}async _get(e){const t=await this._withRetries((t=>async function(e,t){const n=$a(e,!1).get(t),r=await new Ja(n).toPromise();return void 0===r?null:r.value}(t,e)));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite((async()=>(await this._withRetries((t=>ti(t,e))),delete this.localCache[e],this.notifyServiceWorker(e))))}async _poll(){const e=await this._withRetries((e=>{const t=$a(e,!1).getAll();return new Ja(t).toPromise()}));if(!e)return[];if(0!==this.pendingWrites)return[];const t=[],n=new Set;if(0!==e.length)for(const{fbase_key:r,value:a}of e)n.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(a)&&(this.notifyListeners(r,a),t.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!n.has(r)&&(this.notifyListeners(r,null),t.push(r));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const r of Array.from(n))r(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((async()=>this._poll()),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}ni.type="LOCAL";const ri=ni;ea("rcb"),new er(3e4,6e4);const ai="recaptcha";async function ii(e,t,n){var r;const a=await n.verify();try{let i;if(Kn("string"===typeof a,e,"argument-error"),Kn(n.type===ai,e,"argument-error"),i="string"===typeof t?{phoneNumber:t}:t,"session"in i){const t=i.session;if("phoneNumber"in i){Kn("enroll"===t.type,e,"internal-error");const n=await function(e,t){return sr(e,"POST","/v2/accounts/mfaEnrollment:start",ir(e,t))}(e,{idToken:t.credential,phoneEnrollmentInfo:{phoneNumber:i.phoneNumber,recaptchaToken:a}});return n.phoneSessionInfo.sessionInfo}{Kn("signin"===t.type,e,"internal-error");const n=(null===(r=i.multiFactorHint)||void 0===r?void 0:r.uid)||i.multiFactorUid;Kn(n,e,"missing-multi-factor-info");const s=await function(e,t){return sr(e,"POST","/v2/accounts/mfaSignIn:start",ir(e,t))}(e,{mfaPendingCredential:t.credential,mfaEnrollmentId:n,phoneSignInInfo:{recaptchaToken:a}});return s.phoneResponseInfo.sessionInfo}}{const{sessionInfo:t}=await async function(e,t){return sr(e,"POST","/v1/accounts:sendVerificationCode",ir(e,t))}(e,{phoneNumber:i.phoneNumber,recaptchaToken:a});return t}}finally{n._reset()}}class si{constructor(e){this.providerId=si.PROVIDER_ID,this.auth=Xr(e)}verifyPhoneNumber(e,t){return ii(this.auth,e,at(t))}static credential(e,t){return ga._fromVerification(e,t)}static credentialFromResult(e){const t=e;return si.credentialFromTaggedObject(t)}static credentialFromError(e){return si.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{phoneNumber:n,temporaryProof:r}=t;return n&&r?ga._fromTokenResponse(n,r):null}}function oi(e,t){return t?Nr(t):(Kn(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}si.PROVIDER_ID="phone",si.PHONE_SIGN_IN_METHOD="phone";class li extends oa{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return fa(e,this._buildIdpRequest())}_linkToIdToken(e,t){return fa(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return fa(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function ci(e){return Ra(e.auth,new li(e),e.bypassAuthState)}function ui(e){const{auth:t,user:n}=e;return Kn(n,t,"internal-error"),Oa(n,new li(e),e.bypassAuthState)}async function hi(e){const{auth:t,user:n}=e;return Kn(n,t,"internal-error"),Na(n,new li(e),e.bypassAuthState)}class di{constructor(e,t,n,r){let a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.auth=e,this.resolver=n,this.user=r,this.bypassAuthState=a,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise((async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(YE){this.reject(YE)}}))}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:r,tenantId:a,error:i,type:s}=e;if(i)return void this.reject(i);const o={auth:this.auth,requestUri:t,sessionId:n,tenantId:a||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(s)(o))}catch(YE){this.reject(YE)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return ci;case"linkViaPopup":case"linkViaRedirect":return hi;case"reauthViaPopup":case"reauthViaRedirect":return ui;default:zn(this.auth,"internal-error")}}resolve(e){Qn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Qn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const fi=new er(2e3,1e4);class pi extends di{constructor(e,t,n,r,a){super(e,t,r,a),this.provider=n,this.authWindow=null,this.pollId=null,pi.currentPopupAction&&pi.currentPopupAction.cancel(),pi.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Kn(e,this.auth,"internal-error"),e}async onExecution(){Qn(1===this.filter.length,"Popup operations only handle one event");const e=Wa();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch((e=>{this.reject(e)})),this.resolver._isIframeWebStorageSupported(this.auth,(e=>{e||this.reject(Hn(this.auth,"web-storage-unsupported"))})),this.pollUserCancellation()}get eventId(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}cancel(){this.reject(Hn(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,pi.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,n;(null===(n=null===(t=this.authWindow)||void 0===t?void 0:t.window)||void 0===n?void 0:n.closed)?this.pollId=window.setTimeout((()=>{this.pollId=null,this.reject(Hn(this.auth,"popup-closed-by-user"))}),8e3):this.pollId=window.setTimeout(e,fi.get())};e()}}pi.currentPopupAction=null;const mi="pendingRedirect",gi=new Map;class vi extends di{constructor(e,t){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,arguments.length>2&&void 0!==arguments[2]&&arguments[2]),this.eventId=null}async execute(){let e=gi.get(this.auth._key());if(!e){try{const t=await async function(e,t){const n=wi(t),r=bi(e);if(!await r._isAvailable())return!1;const a="true"===await r._get(n);return await r._remove(n),a}(this.resolver,this.auth),n=t?await super.execute():null;e=()=>Promise.resolve(n)}catch(YE){e=()=>Promise.reject(YE)}gi.set(this.auth._key(),e)}return this.bypassAuthState||gi.set(this.auth._key(),(()=>Promise.resolve(null))),e()}async onAuthEvent(e){if("signInViaRedirect"===e.type)return super.onAuthEvent(e);if("unknown"!==e.type){if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}function yi(e,t){gi.set(e._key(),t)}function bi(e){return Nr(e._redirectPersistence)}function wi(e){return Dr(mi,e.config.apiKey,e.name)}async function Si(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(vn(e.app))return Promise.reject(Gn(e));const r=Xr(e),a=oi(r,t),i=new vi(r,a,n),s=await i.execute();return s&&!n&&(delete s.user._redirectEventId,await r._persistUserIfCurrent(s.user),await r._setRedirectUser(null,t)),s}class Ti{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach((n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))})),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return xi(e);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var n;if(e.error&&!xi(e)){const r=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(Hn(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(Ei(e))}saveEventToCache(e){this.cachedEventUids.add(Ei(e)),this.lastProcessedEventTime=Date.now()}}function Ei(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter((e=>e)).join("-")}function xi(e){let{type:t,error:n}=e;return"unknown"===t&&(null===n||void 0===n?void 0:n.code)==="auth/".concat("no-auth-event")}const _i=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Ai=/^https?/;async function ki(e){if(e.config.emulator)return;const{authorizedDomains:t}=await async function(e){return sr(e,"GET","/v1/projects",arguments.length>1&&void 0!==arguments[1]?arguments[1]:{})}(e);for(const r of t)try{if(Ci(r))return}catch(n){}zn(e,"unauthorized-domain")}function Ci(e){const t=Xn(),{protocol:n,hostname:r}=new URL(t);if(e.startsWith("chrome-extension://")){const a=new URL(e);return""===a.hostname&&""===r?"chrome-extension:"===n&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===n&&a.hostname===r}if(!Ai.test(n))return!1;if(_i.test(e))return r===e;const a=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+a+"|"+a+")$","i").test(r)}const Ii=new er(3e4,6e4);function Ni(){const e=qa().___jsl;if(null===e||void 0===e?void 0:e.H)for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let n=0;n<e.CP.length;n++)e.CP[n]=null}function Oi(e){return new Promise(((t,n)=>{var r,a,i;function s(){Ni(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{Ni(),n(Hn(e,"network-request-failed"))},timeout:Ii.get()})}if(null===(a=null===(r=qa().gapi)||void 0===r?void 0:r.iframes)||void 0===a?void 0:a.Iframe)t(gapi.iframes.getContext());else{if(!(null===(i=qa().gapi)||void 0===i?void 0:i.load)){const t=ea("iframefcb");return qa()[t]=()=>{gapi.load?s():n(Hn(e,"network-request-failed"))},Zr("".concat($r.gapiScript,"?onload=").concat(t)).catch((e=>n(e)))}s()}})).catch((e=>{throw Ri=null,e}))}let Ri=null;const Di=new er(5e3,15e3),ji="__/auth/iframe",Pi="emulator/auth/iframe",Li={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Mi=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Fi(e){const t=e.config;Kn(t.authDomain,e,"auth-domain-config-required");const n=t.emulator?tr(t,Pi):"https://".concat(e.config.authDomain,"/").concat(ji),r={apiKey:t.apiKey,appName:e.name,v:wn},a=Mi.get(e.config.apiHost);a&&(r.eid=a);const i=e._getFrameworks();return i.length&&(r.fw=i.join(",")),"".concat(n,"?").concat(Ze(r).slice(1))}async function Ui(e){const t=await function(e){return Ri=Ri||Oi(e),Ri}(e),n=qa().gapi;return Kn(n,e,"internal-error"),t.open({where:document.body,url:Fi(e),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Li,dontclear:!0},(t=>new Promise((async(n,r)=>{await t.restyle({setHideOnLeave:!1});const a=Hn(e,"network-request-failed"),i=qa().setTimeout((()=>{r(a)}),Di.get());function s(){qa().clearTimeout(i),n(t)}t.ping(s).then(s,(()=>{r(a)}))}))))}const Vi={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class Bi{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(YE){}}}function zi(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:500,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:600;const i=Math.max((window.screen.availHeight-a)/2,0).toString(),s=Math.max((window.screen.availWidth-r)/2,0).toString();let o="";const l=Object.assign(Object.assign({},Vi),{width:r.toString(),height:a.toString(),top:i,left:s}),c=Ge().toLowerCase();n&&(o=Fr(c)?"_blank":n),Lr(c)&&(t=t||"http://localhost",l.scrollbars="yes");const u=Object.entries(l).reduce(((e,t)=>{let[n,r]=t;return"".concat(e).concat(n,"=").concat(r,",")}),"");if(function(){var e;return Hr(arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ge())&&!!(null===(e=window.navigator)||void 0===e?void 0:e.standalone)}(c)&&"_self"!==o)return function(e,t){const n=document.createElement("a");n.href=e,n.target=t;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}(t||"",o),new Bi(null);const h=window.open(t||"",o,u);Kn(h,e,"popup-blocked");try{h.focus()}catch(YE){}return new Bi(h)}const Hi="__/auth/handler",Wi="emulator/auth/handler",Gi=encodeURIComponent("fac");async function qi(e,t,n,r,a,i){Kn(e.config.authDomain,e,"auth-domain-config-required"),Kn(e.config.apiKey,e,"invalid-api-key");const s={apiKey:e.config.apiKey,appName:e.name,authType:n,redirectUrl:r,v:wn,eventId:a};if(t instanceof ba){t.setDefaultLanguage(e.languageCode),s.providerId=t.providerId||"",function(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}(t.getCustomParameters())||(s.customParameters=JSON.stringify(t.getCustomParameters()));for(const[e,t]of Object.entries(i||{}))s[e]=t}if(t instanceof wa){const e=t.getScopes().filter((e=>""!==e));e.length>0&&(s.scopes=e.join(","))}e.tenantId&&(s.tid=e.tenantId);const o=s;for(const u of Object.keys(o))void 0===o[u]&&delete o[u];const l=await e._getAppCheckToken(),c=l?"#".concat(Gi,"=").concat(encodeURIComponent(l)):"";return"".concat(function(e){let{config:t}=e;if(!t.emulator)return"https://".concat(t.authDomain,"/").concat(Hi);return tr(t,Wi)}(e),"?").concat(Ze(o).slice(1)).concat(c)}const Ki="webStorageSupport";const Yi=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=za,this._completeRedirectFn=Si,this._overrideRedirectResult=yi}async _openPopup(e,t,n,r){var a;Qn(null===(a=this.eventManagers[e._key()])||void 0===a?void 0:a.manager,"_initialize() not called before _openPopup()");return zi(e,await qi(e,t,n,Xn(),r),Wa())}async _openRedirect(e,t,n,r){await this._originValidation(e);return function(e){qa().location.href=e}(await qi(e,t,n,Xn(),r)),new Promise((()=>{}))}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:e,promise:n}=this.eventManagers[t];return e?Promise.resolve(e):(Qn(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch((()=>{delete this.eventManagers[t]})),n}async initAndGetManager(e){const t=await Ui(e),n=new Ti(e);return t.register("authEvent",(t=>{Kn(null===t||void 0===t?void 0:t.authEvent,e,"invalid-auth-event");return{status:n.onEvent(t.authEvent)?"ACK":"ERROR"}}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Ki,{type:Ki},(n=>{var r;const a=null===(r=null===n||void 0===n?void 0:n[0])||void 0===r?void 0:r[Ki];void 0!==a&&t(!!a),zn(e,"internal-error")}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=ki(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return Gr()||Mr()||Hr()}};var Qi="@firebase/auth",Xi="1.7.5";class Ji{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}async getToken(e){if(this.assertAuthConfigured(),await this.auth._initializationPromise,!this.auth.currentUser)return null;return{accessToken:await this.auth.currentUser.getIdToken(e)}}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged((t=>{e((null===t||void 0===t?void 0:t.stsTokenManager.accessToken)||null)}));this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Kn(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}const $i=He("authIdTokenMaxAge")||300;let Zi=null;var es;$r={loadJS:e=>new Promise(((t,n)=>{const r=document.createElement("script");r.setAttribute("src",e),r.onload=t,r.onerror=e=>{const t=Hn("internal-error");t.customData=e,n(t)},r.type="text/javascript",r.charset="UTF-8",function(){var e,t;return null!==(t=null===(e=document.getElementsByTagName("head"))||void 0===e?void 0:e[0])&&void 0!==t?t:document}().appendChild(r)})),gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="},es="Browser",mn(new it("auth",((e,t)=>{let{options:n}=t;const r=e.getProvider("app").getImmediate(),a=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:s,authDomain:o}=r.options;Kn(s&&!s.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:s,authDomain:o,clientPlatform:es,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:qr(es)},c=new Qr(r,a,i,l);return function(e,t){const n=(null===t||void 0===t?void 0:t.persistence)||[],r=(Array.isArray(n)?n:[n]).map(Nr);(null===t||void 0===t?void 0:t.errorMap)&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(r,null===t||void 0===t?void 0:t.popupRedirectResolver)}(c,n),c}),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback(((e,t,n)=>{e.getProvider("auth-internal").initialize()}))),mn(new it("auth-internal",(e=>(e=>new Ji(e))(Xr(e.getProvider("auth").getImmediate()))),"PRIVATE").setInstantiationMode("EXPLICIT")),En(Qi,Xi,function(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}(es)),En(Qi,Xi,"esm2017");En("firebase","10.12.3","app");var ts,ns,rs="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{},as={};(function(){var e;function t(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}function n(e,t,n){n||(n=0);var r=Array(16);if("string"===typeof t)for(var a=0;16>a;++a)r[a]=t.charCodeAt(n++)|t.charCodeAt(n++)<<8|t.charCodeAt(n++)<<16|t.charCodeAt(n++)<<24;else for(a=0;16>a;++a)r[a]=t[n++]|t[n++]<<8|t[n++]<<16|t[n++]<<24;t=e.g[0],n=e.g[1],a=e.g[2];var i=e.g[3],s=t+(i^n&(a^i))+r[0]+3614090360&4294967295;s=(n=(a=(i=(t=(n=(a=(i=(t=(n=(a=(i=(t=(n=(a=(i=(t=(n=(a=(i=(t=(n=(a=(i=(t=(n=(a=(i=(t=(n=(a=(i=(t=(n=(a=(i=(t=(n=(a=(i=(t=(n=(a=(i=(t=(n=(a=(i=(t=(n=(a=(i=(t=(n=(a=(i=(t=(n=(a=(i=(t=n+(s<<7&4294967295|s>>>25))+((s=i+(a^t&(n^a))+r[1]+3905402710&4294967295)<<12&4294967295|s>>>20))+((s=a+(n^i&(t^n))+r[2]+606105819&4294967295)<<17&4294967295|s>>>15))+((s=n+(t^a&(i^t))+r[3]+3250441966&4294967295)<<22&4294967295|s>>>10))+((s=t+(i^n&(a^i))+r[4]+4118548399&4294967295)<<7&4294967295|s>>>25))+((s=i+(a^t&(n^a))+r[5]+1200080426&4294967295)<<12&4294967295|s>>>20))+((s=a+(n^i&(t^n))+r[6]+2821735955&4294967295)<<17&4294967295|s>>>15))+((s=n+(t^a&(i^t))+r[7]+4249261313&4294967295)<<22&4294967295|s>>>10))+((s=t+(i^n&(a^i))+r[8]+1770035416&4294967295)<<7&4294967295|s>>>25))+((s=i+(a^t&(n^a))+r[9]+2336552879&4294967295)<<12&4294967295|s>>>20))+((s=a+(n^i&(t^n))+r[10]+4294925233&4294967295)<<17&4294967295|s>>>15))+((s=n+(t^a&(i^t))+r[11]+2304563134&4294967295)<<22&4294967295|s>>>10))+((s=t+(i^n&(a^i))+r[12]+1804603682&4294967295)<<7&4294967295|s>>>25))+((s=i+(a^t&(n^a))+r[13]+4254626195&4294967295)<<12&4294967295|s>>>20))+((s=a+(n^i&(t^n))+r[14]+2792965006&4294967295)<<17&4294967295|s>>>15))+((s=n+(t^a&(i^t))+r[15]+1236535329&4294967295)<<22&4294967295|s>>>10))+((s=t+(a^i&(n^a))+r[1]+4129170786&4294967295)<<5&4294967295|s>>>27))+((s=i+(n^a&(t^n))+r[6]+3225465664&4294967295)<<9&4294967295|s>>>23))+((s=a+(t^n&(i^t))+r[11]+643717713&4294967295)<<14&4294967295|s>>>18))+((s=n+(i^t&(a^i))+r[0]+3921069994&4294967295)<<20&4294967295|s>>>12))+((s=t+(a^i&(n^a))+r[5]+3593408605&4294967295)<<5&4294967295|s>>>27))+((s=i+(n^a&(t^n))+r[10]+38016083&4294967295)<<9&4294967295|s>>>23))+((s=a+(t^n&(i^t))+r[15]+3634488961&4294967295)<<14&4294967295|s>>>18))+((s=n+(i^t&(a^i))+r[4]+3889429448&4294967295)<<20&4294967295|s>>>12))+((s=t+(a^i&(n^a))+r[9]+568446438&4294967295)<<5&4294967295|s>>>27))+((s=i+(n^a&(t^n))+r[14]+3275163606&4294967295)<<9&4294967295|s>>>23))+((s=a+(t^n&(i^t))+r[3]+4107603335&4294967295)<<14&4294967295|s>>>18))+((s=n+(i^t&(a^i))+r[8]+1163531501&4294967295)<<20&4294967295|s>>>12))+((s=t+(a^i&(n^a))+r[13]+2850285829&4294967295)<<5&4294967295|s>>>27))+((s=i+(n^a&(t^n))+r[2]+4243563512&4294967295)<<9&4294967295|s>>>23))+((s=a+(t^n&(i^t))+r[7]+1735328473&4294967295)<<14&4294967295|s>>>18))+((s=n+(i^t&(a^i))+r[12]+2368359562&4294967295)<<20&4294967295|s>>>12))+((s=t+(n^a^i)+r[5]+4294588738&4294967295)<<4&4294967295|s>>>28))+((s=i+(t^n^a)+r[8]+2272392833&4294967295)<<11&4294967295|s>>>21))+((s=a+(i^t^n)+r[11]+1839030562&4294967295)<<16&4294967295|s>>>16))+((s=n+(a^i^t)+r[14]+4259657740&4294967295)<<23&4294967295|s>>>9))+((s=t+(n^a^i)+r[1]+2763975236&4294967295)<<4&4294967295|s>>>28))+((s=i+(t^n^a)+r[4]+1272893353&4294967295)<<11&4294967295|s>>>21))+((s=a+(i^t^n)+r[7]+4139469664&4294967295)<<16&4294967295|s>>>16))+((s=n+(a^i^t)+r[10]+3200236656&4294967295)<<23&4294967295|s>>>9))+((s=t+(n^a^i)+r[13]+681279174&4294967295)<<4&4294967295|s>>>28))+((s=i+(t^n^a)+r[0]+3936430074&4294967295)<<11&4294967295|s>>>21))+((s=a+(i^t^n)+r[3]+3572445317&4294967295)<<16&4294967295|s>>>16))+((s=n+(a^i^t)+r[6]+76029189&4294967295)<<23&4294967295|s>>>9))+((s=t+(n^a^i)+r[9]+3654602809&4294967295)<<4&4294967295|s>>>28))+((s=i+(t^n^a)+r[12]+3873151461&4294967295)<<11&4294967295|s>>>21))+((s=a+(i^t^n)+r[15]+530742520&4294967295)<<16&4294967295|s>>>16))+((s=n+(a^i^t)+r[2]+3299628645&4294967295)<<23&4294967295|s>>>9))+((s=t+(a^(n|~i))+r[0]+4096336452&4294967295)<<6&4294967295|s>>>26))+((s=i+(n^(t|~a))+r[7]+1126891415&4294967295)<<10&4294967295|s>>>22))+((s=a+(t^(i|~n))+r[14]+2878612391&4294967295)<<15&4294967295|s>>>17))+((s=n+(i^(a|~t))+r[5]+4237533241&4294967295)<<21&4294967295|s>>>11))+((s=t+(a^(n|~i))+r[12]+1700485571&4294967295)<<6&4294967295|s>>>26))+((s=i+(n^(t|~a))+r[3]+2399980690&4294967295)<<10&4294967295|s>>>22))+((s=a+(t^(i|~n))+r[10]+4293915773&4294967295)<<15&4294967295|s>>>17))+((s=n+(i^(a|~t))+r[1]+2240044497&4294967295)<<21&4294967295|s>>>11))+((s=t+(a^(n|~i))+r[8]+1873313359&4294967295)<<6&4294967295|s>>>26))+((s=i+(n^(t|~a))+r[15]+4264355552&4294967295)<<10&4294967295|s>>>22))+((s=a+(t^(i|~n))+r[6]+2734768916&4294967295)<<15&4294967295|s>>>17))+((s=n+(i^(a|~t))+r[13]+1309151649&4294967295)<<21&4294967295|s>>>11))+((i=(t=n+((s=t+(a^(n|~i))+r[4]+4149444226&4294967295)<<6&4294967295|s>>>26))+((s=i+(n^(t|~a))+r[11]+3174756917&4294967295)<<10&4294967295|s>>>22))^((a=i+((s=a+(t^(i|~n))+r[2]+718787259&4294967295)<<15&4294967295|s>>>17))|~t))+r[9]+3951481745&4294967295,e.g[0]=e.g[0]+t&4294967295,e.g[1]=e.g[1]+(a+(s<<21&4294967295|s>>>11))&4294967295,e.g[2]=e.g[2]+a&4294967295,e.g[3]=e.g[3]+i&4294967295}function r(e,t){this.h=t;for(var n=[],r=!0,a=e.length-1;0<=a;a--){var i=0|e[a];r&&i==t||(n[a]=i,r=!1)}this.g=n}!function(e,t){function n(){}n.prototype=t.prototype,e.D=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.C=function(e,n,r){for(var a=Array(arguments.length-2),i=2;i<arguments.length;i++)a[i-2]=arguments[i];return t.prototype[n].apply(e,a)}}(t,(function(){this.blockSize=-1})),t.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0},t.prototype.u=function(e,t){void 0===t&&(t=e.length);for(var r=t-this.blockSize,a=this.B,i=this.h,s=0;s<t;){if(0==i)for(;s<=r;)n(this,e,s),s+=this.blockSize;if("string"===typeof e){for(;s<t;)if(a[i++]=e.charCodeAt(s++),i==this.blockSize){n(this,a),i=0;break}}else for(;s<t;)if(a[i++]=e[s++],i==this.blockSize){n(this,a),i=0;break}}this.h=i,this.o+=t},t.prototype.v=function(){var e=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);e[0]=128;for(var t=1;t<e.length-8;++t)e[t]=0;var n=8*this.o;for(t=e.length-8;t<e.length;++t)e[t]=255&n,n/=256;for(this.u(e),e=Array(16),t=n=0;4>t;++t)for(var r=0;32>r;r+=8)e[n++]=this.g[t]>>>r&255;return e};var a={};function i(e){return-128<=e&&128>e?function(e,t){var n=a;return Object.prototype.hasOwnProperty.call(n,e)?n[e]:n[e]=t(e)}(e,(function(e){return new r([0|e],0>e?-1:0)})):new r([0|e],0>e?-1:0)}function s(e){if(isNaN(e)||!isFinite(e))return o;if(0>e)return d(s(-e));for(var t=[],n=1,a=0;e>=n;a++)t[a]=e/n|0,n*=4294967296;return new r(t,0)}var o=i(0),l=i(1),c=i(16777216);function u(e){if(0!=e.h)return!1;for(var t=0;t<e.g.length;t++)if(0!=e.g[t])return!1;return!0}function h(e){return-1==e.h}function d(e){for(var t=e.g.length,n=[],a=0;a<t;a++)n[a]=~e.g[a];return new r(n,~e.h).add(l)}function f(e,t){return e.add(d(t))}function p(e,t){for(;(65535&e[t])!=e[t];)e[t+1]+=e[t]>>>16,e[t]&=65535,t++}function m(e,t){this.g=e,this.h=t}function g(e,t){if(u(t))throw Error("division by zero");if(u(e))return new m(o,o);if(h(e))return t=g(d(e),t),new m(d(t.g),d(t.h));if(h(t))return t=g(e,d(t)),new m(d(t.g),t.h);if(30<e.g.length){if(h(e)||h(t))throw Error("slowDivide_ only works with positive integers.");for(var n=l,r=t;0>=r.l(e);)n=v(n),r=v(r);var a=y(n,1),i=y(r,1);for(r=y(r,2),n=y(n,2);!u(r);){var c=i.add(r);0>=c.l(e)&&(a=a.add(n),i=c),r=y(r,1),n=y(n,1)}return t=f(e,a.j(t)),new m(a,t)}for(a=o;0<=e.l(t);){for(n=Math.max(1,Math.floor(e.m()/t.m())),r=48>=(r=Math.ceil(Math.log(n)/Math.LN2))?1:Math.pow(2,r-48),c=(i=s(n)).j(t);h(c)||0<c.l(e);)c=(i=s(n-=r)).j(t);u(i)&&(i=l),a=a.add(i),e=f(e,c)}return new m(a,e)}function v(e){for(var t=e.g.length+1,n=[],a=0;a<t;a++)n[a]=e.i(a)<<1|e.i(a-1)>>>31;return new r(n,e.h)}function y(e,t){var n=t>>5;t%=32;for(var a=e.g.length-n,i=[],s=0;s<a;s++)i[s]=0<t?e.i(s+n)>>>t|e.i(s+n+1)<<32-t:e.i(s+n);return new r(i,e.h)}(e=r.prototype).m=function(){if(h(this))return-d(this).m();for(var e=0,t=1,n=0;n<this.g.length;n++){var r=this.i(n);e+=(0<=r?r:4294967296+r)*t,t*=4294967296}return e},e.toString=function(e){if(2>(e=e||10)||36<e)throw Error("radix out of range: "+e);if(u(this))return"0";if(h(this))return"-"+d(this).toString(e);for(var t=s(Math.pow(e,6)),n=this,r="";;){var a=g(n,t).g,i=((0<(n=f(n,a.j(t))).g.length?n.g[0]:n.h)>>>0).toString(e);if(u(n=a))return i+r;for(;6>i.length;)i="0"+i;r=i+r}},e.i=function(e){return 0>e?0:e<this.g.length?this.g[e]:this.h},e.l=function(e){return h(e=f(this,e))?-1:u(e)?0:1},e.abs=function(){return h(this)?d(this):this},e.add=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],a=0,i=0;i<=t;i++){var s=a+(65535&this.i(i))+(65535&e.i(i)),o=(s>>>16)+(this.i(i)>>>16)+(e.i(i)>>>16);a=o>>>16,s&=65535,o&=65535,n[i]=o<<16|s}return new r(n,-2147483648&n[n.length-1]?-1:0)},e.j=function(e){if(u(this)||u(e))return o;if(h(this))return h(e)?d(this).j(d(e)):d(d(this).j(e));if(h(e))return d(this.j(d(e)));if(0>this.l(c)&&0>e.l(c))return s(this.m()*e.m());for(var t=this.g.length+e.g.length,n=[],a=0;a<2*t;a++)n[a]=0;for(a=0;a<this.g.length;a++)for(var i=0;i<e.g.length;i++){var l=this.i(a)>>>16,f=65535&this.i(a),m=e.i(i)>>>16,g=65535&e.i(i);n[2*a+2*i]+=f*g,p(n,2*a+2*i),n[2*a+2*i+1]+=l*g,p(n,2*a+2*i+1),n[2*a+2*i+1]+=f*m,p(n,2*a+2*i+1),n[2*a+2*i+2]+=l*m,p(n,2*a+2*i+2)}for(a=0;a<t;a++)n[a]=n[2*a+1]<<16|n[2*a];for(a=t;a<2*t;a++)n[a]=0;return new r(n,0)},e.A=function(e){return g(this,e).h},e.and=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],a=0;a<t;a++)n[a]=this.i(a)&e.i(a);return new r(n,this.h&e.h)},e.or=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],a=0;a<t;a++)n[a]=this.i(a)|e.i(a);return new r(n,this.h|e.h)},e.xor=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],a=0;a<t;a++)n[a]=this.i(a)^e.i(a);return new r(n,this.h^e.h)},t.prototype.digest=t.prototype.v,t.prototype.reset=t.prototype.s,t.prototype.update=t.prototype.u,ns=as.Md5=t,r.prototype.add=r.prototype.add,r.prototype.multiply=r.prototype.j,r.prototype.modulo=r.prototype.A,r.prototype.compare=r.prototype.l,r.prototype.toNumber=r.prototype.m,r.prototype.toString=r.prototype.toString,r.prototype.getBits=r.prototype.i,r.fromNumber=s,r.fromString=function e(t,n){if(0==t.length)throw Error("number format error: empty string");if(2>(n=n||10)||36<n)throw Error("radix out of range: "+n);if("-"==t.charAt(0))return d(e(t.substring(1),n));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var r=s(Math.pow(n,8)),a=o,i=0;i<t.length;i+=8){var l=Math.min(8,t.length-i),c=parseInt(t.substring(i,i+l),n);8>l?(l=s(Math.pow(n,l)),a=a.j(l).add(s(c))):a=(a=a.j(r)).add(s(c))}return a},ts=as.Integer=r}).apply("undefined"!==typeof rs?rs:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{});var is,ss,os,ls,cs,us,hs,ds,fs,ps="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{},ms={};(function(){var e,t="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,n){return e==Array.prototype||e==Object.prototype||(e[t]=n.value),e};var n=function(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof ps&&ps];for(var t=0;t<e.length;++t){var n=e[t];if(n&&n.Math==Math)return n}throw Error("Cannot find global object")}(this);!function(e,r){if(r)e:{var a=n;e=e.split(".");for(var i=0;i<e.length-1;i++){var s=e[i];if(!(s in a))break e;a=a[s]}(r=r(i=a[e=e[e.length-1]]))!=i&&null!=r&&t(a,e,{configurable:!0,writable:!0,value:r})}}("Array.prototype.values",(function(e){return e||function(){return function(e,t){e instanceof String&&(e+="");var n=0,r=!1,a={next:function(){if(!r&&n<e.length){var a=n++;return{value:t(a,e[a]),done:!1}}return r=!0,{done:!0,value:void 0}}};return a[Symbol.iterator]=function(){return a},a}(this,(function(e,t){return t}))}}));var r=r||{},a=this||self;function i(e){var t=typeof e;return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function s(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}function o(e,t,n){return e.call.apply(e.bind,arguments)}function l(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function c(e,t,n){return(c=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?o:l).apply(null,arguments)}function u(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function h(e,t){function n(){}n.prototype=t.prototype,e.aa=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.Qb=function(e,n,r){for(var a=Array(arguments.length-2),i=2;i<arguments.length;i++)a[i-2]=arguments[i];return t.prototype[n].apply(e,a)}}function d(e){const t=e.length;if(0<t){const n=Array(t);for(let r=0;r<t;r++)n[r]=e[r];return n}return[]}function f(e,t){for(let n=1;n<arguments.length;n++){const t=arguments[n];if(i(t)){const n=e.length||0,r=t.length||0;e.length=n+r;for(let a=0;a<r;a++)e[n+a]=t[a]}else e.push(t)}}function p(e){return/^[\s\xa0]*$/.test(e)}function m(){var e=a.navigator;return e&&(e=e.userAgent)?e:""}function g(e){return g[" "](e),e}g[" "]=function(){};var v=-1!=m().indexOf("Gecko")&&!(-1!=m().toLowerCase().indexOf("webkit")&&-1==m().indexOf("Edge"))&&!(-1!=m().indexOf("Trident")||-1!=m().indexOf("MSIE"))&&-1==m().indexOf("Edge");function y(e,t,n){for(const r in e)t.call(n,e[r],r,e)}function b(e){const t={};for(const n in e)t[n]=e[n];return t}const w="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function S(e,t){let n,r;for(let a=1;a<arguments.length;a++){for(n in r=arguments[a],r)e[n]=r[n];for(let t=0;t<w.length;t++)n=w[t],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function T(e){var t=1;e=e.split(":");const n=[];for(;0<t&&e.length;)n.push(e.shift()),t--;return e.length&&n.push(e.join(":")),n}function E(e){a.setTimeout((()=>{throw e}),0)}function x(){var e=I;let t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var _=new class{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}((()=>new A),(e=>e.reset()));class A{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}let k,C=!1,I=new class{constructor(){this.h=this.g=null}add(e,t){const n=_.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}},N=()=>{const e=a.Promise.resolve(void 0);k=()=>{e.then(O)}};var O=()=>{for(var e;e=x();){try{e.h.call(e.g)}catch(n){E(n)}var t=_;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}C=!1};function R(){this.s=this.s,this.C=this.C}function D(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}R.prototype.s=!1,R.prototype.ma=function(){this.s||(this.s=!0,this.N())},R.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()},D.prototype.h=function(){this.defaultPrevented=!0};var j=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{const e=()=>{};a.addEventListener("test",e,t),a.removeEventListener("test",e,t)}catch(n){}return e}();function P(e,t){if(D.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(v){e:{try{g(t.nodeName);var a=!0;break e}catch(i){}a=!1}a||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"===typeof e.pointerType?e.pointerType:L[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&P.aa.h.call(this)}}h(P,D);var L={2:"touch",3:"pen",4:"mouse"};P.prototype.h=function(){P.aa.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var M="closure_listenable_"+(1e6*Math.random()|0),F=0;function U(e,t,n,r,a){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.ha=a,this.key=++F,this.da=this.fa=!1}function V(e){e.da=!0,e.listener=null,e.proxy=null,e.src=null,e.ha=null}function B(e){this.src=e,this.g={},this.h=0}function z(e,t){var n=t.type;if(n in e.g){var r,a=e.g[n],i=Array.prototype.indexOf.call(a,t,void 0);(r=0<=i)&&Array.prototype.splice.call(a,i,1),r&&(V(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function H(e,t,n,r){for(var a=0;a<e.length;++a){var i=e[a];if(!i.da&&i.listener==t&&i.capture==!!n&&i.ha==r)return a}return-1}B.prototype.add=function(e,t,n,r,a){var i=e.toString();(e=this.g[i])||(e=this.g[i]=[],this.h++);var s=H(e,t,r,a);return-1<s?(t=e[s],n||(t.fa=!1)):((t=new U(t,this.src,i,!!r,a)).fa=n,e.push(t)),t};var W="closure_lm_"+(1e6*Math.random()|0),G={};function q(e,t,n,r,a){if(r&&r.once)return Y(e,t,n,r,a);if(Array.isArray(t)){for(var i=0;i<t.length;i++)q(e,t[i],n,r,a);return null}return n=te(n),e&&e[M]?e.K(t,n,s(r)?!!r.capture:!!r,a):K(e,t,n,!1,r,a)}function K(e,t,n,r,a,i){if(!t)throw Error("Invalid event type");var o=s(a)?!!a.capture:!!a,l=Z(e);if(l||(e[W]=l=new B(e)),(n=l.add(t,n,r,o,i)).proxy)return n;if(r=function(){function e(n){return t.call(e.src,e.listener,n)}const t=$;return e}(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)j||(a=o),void 0===a&&(a=!1),e.addEventListener(t.toString(),r,a);else if(e.attachEvent)e.attachEvent(J(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}return n}function Y(e,t,n,r,a){if(Array.isArray(t)){for(var i=0;i<t.length;i++)Y(e,t[i],n,r,a);return null}return n=te(n),e&&e[M]?e.L(t,n,s(r)?!!r.capture:!!r,a):K(e,t,n,!0,r,a)}function Q(e,t,n,r,a){if(Array.isArray(t))for(var i=0;i<t.length;i++)Q(e,t[i],n,r,a);else r=s(r)?!!r.capture:!!r,n=te(n),e&&e[M]?(e=e.i,(t=String(t).toString())in e.g&&(-1<(n=H(i=e.g[t],n,r,a))&&(V(i[n]),Array.prototype.splice.call(i,n,1),0==i.length&&(delete e.g[t],e.h--)))):e&&(e=Z(e))&&(t=e.g[t.toString()],e=-1,t&&(e=H(t,n,r,a)),(n=-1<e?t[e]:null)&&X(n))}function X(e){if("number"!==typeof e&&e&&!e.da){var t=e.src;if(t&&t[M])z(t.i,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(J(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=Z(t))?(z(n,e),0==n.h&&(n.src=null,t[W]=null)):V(e)}}}function J(e){return e in G?G[e]:G[e]="on"+e}function $(e,t){if(e.da)e=!0;else{t=new P(t,this);var n=e.listener,r=e.ha||e.src;e.fa&&X(e),e=n.call(r,t)}return e}function Z(e){return(e=e[W])instanceof B?e:null}var ee="__closure_events_fn_"+(1e9*Math.random()>>>0);function te(e){return"function"===typeof e?e:(e[ee]||(e[ee]=function(t){return e.handleEvent(t)}),e[ee])}function ne(){R.call(this),this.i=new B(this),this.M=this,this.F=null}function re(e,t){var n,r=e.F;if(r)for(n=[];r;r=r.F)n.push(r);if(e=e.M,r=t.type||t,"string"===typeof t)t=new D(t,e);else if(t instanceof D)t.target=t.target||e;else{var a=t;S(t=new D(r,e),a)}if(a=!0,n)for(var i=n.length-1;0<=i;i--){var s=t.g=n[i];a=ae(s,r,!0,t)&&a}if(a=ae(s=t.g=e,r,!0,t)&&a,a=ae(s,r,!1,t)&&a,n)for(i=0;i<n.length;i++)a=ae(s=t.g=n[i],r,!1,t)&&a}function ae(e,t,n,r){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();for(var a=!0,i=0;i<t.length;++i){var s=t[i];if(s&&!s.da&&s.capture==n){var o=s.listener,l=s.ha||s.src;s.fa&&z(e.i,s),a=!1!==o.call(l,r)&&a}}return a&&!r.defaultPrevented}function ie(e,t,n){if("function"===typeof e)n&&(e=c(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=c(e.handleEvent,e)}return 2147483647<Number(t)?-1:a.setTimeout(e,t||0)}function se(e){e.g=ie((()=>{e.g=null,e.i&&(e.i=!1,se(e))}),e.l);const t=e.h;e.h=null,e.m.apply(null,t)}h(ne,R),ne.prototype[M]=!0,ne.prototype.removeEventListener=function(e,t,n,r){Q(this,e,t,n,r)},ne.prototype.N=function(){if(ne.aa.N.call(this),this.i){var e,t=this.i;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)V(n[r]);delete t.g[e],t.h--}}this.F=null},ne.prototype.K=function(e,t,n,r){return this.i.add(String(e),t,!1,n,r)},ne.prototype.L=function(e,t,n,r){return this.i.add(String(e),t,!0,n,r)};class oe extends R{constructor(e,t){super(),this.m=e,this.l=t,this.h=null,this.i=!1,this.g=null}j(e){this.h=arguments,this.g?this.i=!0:se(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function le(e){R.call(this),this.h=e,this.g={}}h(le,R);var ce=[];function ue(e){y(e.g,(function(e,t){this.g.hasOwnProperty(t)&&X(e)}),e),e.g={}}le.prototype.N=function(){le.aa.N.call(this),ue(this)},le.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var he=a.JSON.stringify,de=a.JSON.parse,fe=class{stringify(e){return a.JSON.stringify(e,void 0)}parse(e){return a.JSON.parse(e,void 0)}};function pe(){}function me(e){return e.h||(e.h=e.i())}function ge(){}pe.prototype.h=null;var ve={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function ye(){D.call(this,"d")}function be(){D.call(this,"c")}h(ye,D),h(be,D);var we={},Se=null;function Te(){return Se=Se||new ne}function Ee(e){D.call(this,we.La,e)}function xe(e){const t=Te();re(t,new Ee(t))}function _e(e,t){D.call(this,we.STAT_EVENT,e),this.stat=t}function Ae(e){const t=Te();re(t,new _e(t,e))}function ke(e,t){D.call(this,we.Ma,e),this.size=t}function Ce(e,t){if("function"!==typeof e)throw Error("Fn must not be null and must be a function");return a.setTimeout((function(){e()}),t)}function Ie(){this.g=!0}function Ne(e,t,n,r){e.info((function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{var n=JSON.parse(t);if(n)for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var r=n[e];if(!(2>r.length)){var a=r[1];if(Array.isArray(a)&&!(1>a.length)){var i=a[0];if("noop"!=i&&"stop"!=i&&"close"!=i)for(var s=1;s<a.length;s++)a[s]=""}}}return he(n)}catch(o){return t}}(e,n)+(r?" "+r:"")}))}we.La="serverreachability",h(Ee,D),we.STAT_EVENT="statevent",h(_e,D),we.Ma="timingevent",h(ke,D),Ie.prototype.xa=function(){this.g=!1},Ie.prototype.info=function(){};var Oe,Re={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},De={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"};function je(){}function Pe(e,t,n,r){this.j=e,this.i=t,this.l=n,this.R=r||1,this.U=new le(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Le}function Le(){this.i=null,this.g="",this.h=!1}h(je,pe),je.prototype.g=function(){return new XMLHttpRequest},je.prototype.i=function(){return{}},Oe=new je;var Me={},Fe={};function Ue(e,t,n){e.L=1,e.v=ht(st(t)),e.m=n,e.P=!0,Ve(e,null)}function Ve(e,t){e.F=Date.now(),He(e),e.A=st(e.v);var n=e.A,r=e.R;Array.isArray(r)||(r=[String(r)]),_t(n.i,"t",r),e.C=0,n=e.j.J,e.h=new Le,e.g=fn(e.j,n?t:null,!e.m),0<e.O&&(e.M=new oe(c(e.Y,e,e.g),e.O)),t=e.U,n=e.g,r=e.ca;var a="readystatechange";Array.isArray(a)||(a&&(ce[0]=a.toString()),a=ce);for(var i=0;i<a.length;i++){var s=q(n,a[i],r||t.handleEvent,!1,t.h||t);if(!s)break;t.g[s.key]=s}t=e.H?b(e.H):{},e.m?(e.u||(e.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ea(e.A,e.u,e.m,t)):(e.u="GET",e.g.ea(e.A,e.u,null,t)),xe(),function(e,t,n,r,a,i){e.info((function(){if(e.g)if(i)for(var s="",o=i.split("&"),l=0;l<o.length;l++){var c=o[l].split("=");if(1<c.length){var u=c[0];c=c[1];var h=u.split("_");s=2<=h.length&&"type"==h[1]?s+(u+"=")+c+"&":s+(u+"=redacted&")}}else s=null;else s=i;return"XMLHTTP REQ ("+r+") [attempt "+a+"]: "+t+"\n"+n+"\n"+s}))}(e.i,e.u,e.A,e.l,e.R,e.m)}function Be(e){return!!e.g&&("GET"==e.u&&2!=e.L&&e.j.Ca)}function ze(e,t){var n=e.C,r=t.indexOf("\n",n);return-1==r?Fe:(n=Number(t.substring(n,r)),isNaN(n)?Me:(r+=1)+n>t.length?Fe:(t=t.slice(r,r+n),e.C=r+n,t))}function He(e){e.S=Date.now()+e.I,We(e,e.I)}function We(e,t){if(null!=e.B)throw Error("WatchDog timer not null");e.B=Ce(c(e.ba,e),t)}function Ge(e){e.B&&(a.clearTimeout(e.B),e.B=null)}function qe(e){0==e.j.G||e.J||ln(e.j,e)}function Ke(e){Ge(e);var t=e.M;t&&"function"==typeof t.ma&&t.ma(),e.M=null,ue(e.U),e.g&&(t=e.g,e.g=null,t.abort(),t.ma())}function Ye(e,t){try{var n=e.j;if(0!=n.G&&(n.g==e||Ze(n.h,e)))if(!e.K&&Ze(n.h,e)&&3==n.G){try{var r=n.Da.g.parse(t)}catch(u){r=null}if(Array.isArray(r)&&3==r.length){var a=r;if(0==a[0]){e:if(!n.u){if(n.g){if(!(n.g.F+3e3<e.F))break e;on(n),Xt(n)}rn(n),Ae(18)}}else n.za=a[1],0<n.za-n.T&&37500>a[2]&&n.F&&0==n.v&&!n.C&&(n.C=Ce(c(n.Za,n),6e3));if(1>=$e(n.h)&&n.ca){try{n.ca()}catch(u){}n.ca=void 0}}else un(n,11)}else if((e.K||n.g==e)&&on(n),!p(t))for(a=n.Da.g.parse(t),t=0;t<a.length;t++){let c=a[t];if(n.T=c[0],c=c[1],2==n.G)if("c"==c[0]){n.K=c[1],n.ia=c[2];const t=c[3];null!=t&&(n.la=t,n.j.info("VER="+n.la));const a=c[4];null!=a&&(n.Aa=a,n.j.info("SVER="+n.Aa));const u=c[5];null!=u&&"number"===typeof u&&0<u&&(r=1.5*u,n.L=r,n.j.info("backChannelRequestTimeoutMs_="+r)),r=n;const h=e.g;if(h){const e=h.g?h.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(e){var i=r.h;i.g||-1==e.indexOf("spdy")&&-1==e.indexOf("quic")&&-1==e.indexOf("h2")||(i.j=i.l,i.g=new Set,i.h&&(et(i,i.h),i.h=null))}if(r.D){const e=h.g?h.g.getResponseHeader("X-HTTP-Session-Id"):null;e&&(r.ya=e,ut(r.I,r.D,e))}}n.G=3,n.l&&n.l.ua(),n.ba&&(n.R=Date.now()-e.F,n.j.info("Handshake RTT: "+n.R+"ms"));var s=e;if((r=n).qa=dn(r,r.J?r.ia:null,r.W),s.K){tt(r.h,s);var o=s,l=r.L;l&&(o.I=l),o.B&&(Ge(o),He(o)),r.g=s}else nn(r);0<n.i.length&&$t(n)}else"stop"!=c[0]&&"close"!=c[0]||un(n,7);else 3==n.G&&("stop"==c[0]||"close"==c[0]?"stop"==c[0]?un(n,7):Qt(n):"noop"!=c[0]&&n.l&&n.l.ta(c),n.v=0)}xe()}catch(u){}}Pe.prototype.ca=function(e){e=e.target;const t=this.M;t&&3==Gt(e)?t.j():this.Y(e)},Pe.prototype.Y=function(e){try{if(e==this.g)e:{const d=Gt(this.g);var t=this.g.Ba();this.g.Z();if(!(3>d)&&(3!=d||this.g&&(this.h.h||this.g.oa()||qt(this.g)))){this.J||4!=d||7==t||xe(),Ge(this);var n=this.g.Z();this.X=n;t:if(Be(this)){var r=qt(this.g);e="";var i=r.length,s=4==Gt(this.g);if(!this.h.i){if("undefined"===typeof TextDecoder){Ke(this),qe(this);var o="";break t}this.h.i=new a.TextDecoder}for(t=0;t<i;t++)this.h.h=!0,e+=this.h.i.decode(r[t],{stream:!(s&&t==i-1)});r.length=0,this.h.g+=e,this.C=0,o=this.h.g}else o=this.g.oa();if(this.o=200==n,function(e,t,n,r,a,i,s){e.info((function(){return"XMLHTTP RESP ("+r+") [ attempt "+a+"]: "+t+"\n"+n+"\n"+i+" "+s}))}(this.i,this.u,this.A,this.l,this.R,d,n),this.o){if(this.T&&!this.K){t:{if(this.g){var l,c=this.g;if((l=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!p(l)){var u=l;break t}}u=null}if(!(n=u)){this.o=!1,this.s=3,Ae(12),Ke(this),qe(this);break e}Ne(this.i,this.l,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Ye(this,n)}if(this.P){let e;for(n=!0;!this.J&&this.C<o.length;){if(e=ze(this,o),e==Fe){4==d&&(this.s=4,Ae(14),n=!1),Ne(this.i,this.l,null,"[Incomplete Response]");break}if(e==Me){this.s=4,Ae(15),Ne(this.i,this.l,o,"[Invalid Chunk]"),n=!1;break}Ne(this.i,this.l,e,null),Ye(this,e)}if(Be(this)&&0!=this.C&&(this.h.g=this.h.g.slice(this.C),this.C=0),4!=d||0!=o.length||this.h.h||(this.s=1,Ae(16),n=!1),this.o=this.o&&n,n){if(0<o.length&&!this.W){this.W=!0;var h=this.j;h.g==this&&h.ba&&!h.M&&(h.j.info("Great, no buffering proxy detected. Bytes received: "+o.length),an(h),h.M=!0,Ae(11))}}else Ne(this.i,this.l,o,"[Invalid Chunked Response]"),Ke(this),qe(this)}else Ne(this.i,this.l,o,null),Ye(this,o);4==d&&Ke(this),this.o&&!this.J&&(4==d?ln(this.j,this):(this.o=!1,He(this)))}else(function(e){const t={};e=(e.g&&2<=Gt(e)&&e.g.getAllResponseHeaders()||"").split("\r\n");for(let r=0;r<e.length;r++){if(p(e[r]))continue;var n=T(e[r]);const a=n[0];if("string"!==typeof(n=n[1]))continue;n=n.trim();const i=t[a]||[];t[a]=i,i.push(n)}!function(e,t){for(const n in e)t.call(void 0,e[n],n,e)}(t,(function(e){return e.join(", ")}))})(this.g),400==n&&0<o.indexOf("Unknown SID")?(this.s=3,Ae(12)):(this.s=0,Ae(13)),Ke(this),qe(this)}}}catch(d){}},Pe.prototype.cancel=function(){this.J=!0,Ke(this)},Pe.prototype.ba=function(){this.B=null;const e=Date.now();0<=e-this.S?(function(e,t){e.info((function(){return"TIMEOUT: "+t}))}(this.i,this.A),2!=this.L&&(xe(),Ae(17)),Ke(this),this.s=2,qe(this)):We(this,this.S-e)};var Qe=class{constructor(e,t){this.g=e,this.map=t}};function Xe(e){this.l=e||10,a.PerformanceNavigationTiming?e=0<(e=a.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):e=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Je(e){return!!e.h||!!e.g&&e.g.size>=e.j}function $e(e){return e.h?1:e.g?e.g.size:0}function Ze(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function et(e,t){e.g?e.g.add(t):e.h=t}function tt(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function nt(e){if(null!=e.h)return e.i.concat(e.h.D);if(null!=e.g&&0!==e.g.size){let t=e.i;for(const n of e.g.values())t=t.concat(n.D);return t}return d(e.i)}function rt(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(i(e)||"string"===typeof e)Array.prototype.forEach.call(e,t,void 0);else for(var n=function(e){if(e.na&&"function"==typeof e.na)return e.na();if(!e.V||"function"!=typeof e.V){if("undefined"!==typeof Map&&e instanceof Map)return Array.from(e.keys());if(!("undefined"!==typeof Set&&e instanceof Set)){if(i(e)||"string"===typeof e){var t=[];e=e.length;for(var n=0;n<e;n++)t.push(n);return t}t=[],n=0;for(const r in e)t[n++]=r;return t}}}(e),r=function(e){if(e.V&&"function"==typeof e.V)return e.V();if("undefined"!==typeof Map&&e instanceof Map||"undefined"!==typeof Set&&e instanceof Set)return Array.from(e.values());if("string"===typeof e)return e.split("");if(i(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}for(r in t=[],n=0,e)t[n++]=e[r];return t}(e),a=r.length,s=0;s<a;s++)t.call(void 0,r[s],n&&n[s],e)}Xe.prototype.cancel=function(){if(this.i=nt(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const e of this.g.values())e.cancel();this.g.clear()}};var at=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function it(e){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,e instanceof it){this.h=e.h,ot(this,e.j),this.o=e.o,this.g=e.g,lt(this,e.s),this.l=e.l;var t=e.i,n=new St;n.i=t.i,t.g&&(n.g=new Map(t.g),n.h=t.h),ct(this,n),this.m=e.m}else e&&(t=String(e).match(at))?(this.h=!1,ot(this,t[1]||"",!0),this.o=dt(t[2]||""),this.g=dt(t[3]||"",!0),lt(this,t[4]),this.l=dt(t[5]||"",!0),ct(this,t[6]||"",!0),this.m=dt(t[7]||"")):(this.h=!1,this.i=new St(null,this.h))}function st(e){return new it(e)}function ot(e,t,n){e.j=n?dt(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function lt(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.s=t}else e.s=null}function ct(e,t,n){t instanceof St?(e.i=t,function(e,t){t&&!e.j&&(Tt(e),e.i=null,e.g.forEach((function(e,t){var n=t.toLowerCase();t!=n&&(Et(this,t),_t(this,n,e))}),e)),e.j=t}(e.i,e.h)):(n||(t=ft(t,bt)),e.i=new St(t,e.h))}function ut(e,t,n){e.i.set(t,n)}function ht(e){return ut(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function dt(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function ft(e,t,n){return"string"===typeof e?(e=encodeURI(e).replace(t,pt),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function pt(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}it.prototype.toString=function(){var e=[],t=this.j;t&&e.push(ft(t,gt,!0),":");var n=this.g;return(n||"file"==t)&&(e.push("//"),(t=this.o)&&e.push(ft(t,gt,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.s)&&e.push(":",String(n))),(n=this.l)&&(this.g&&"/"!=n.charAt(0)&&e.push("/"),e.push(ft(n,"/"==n.charAt(0)?yt:vt,!0))),(n=this.i.toString())&&e.push("?",n),(n=this.m)&&e.push("#",ft(n,wt)),e.join("")};var mt,gt=/[#\/\?@]/g,vt=/[#\?:]/g,yt=/[#\?]/g,bt=/[#\?@]/g,wt=/#/g;function St(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function Tt(e){e.g||(e.g=new Map,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var r=e[n].indexOf("="),a=null;if(0<=r){var i=e[n].substring(0,r);a=e[n].substring(r+1)}else i=e[n];t(i,a?decodeURIComponent(a.replace(/\+/g," ")):"")}}}(e.i,(function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)})))}function Et(e,t){Tt(e),t=At(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function xt(e,t){return Tt(e),t=At(e,t),e.g.has(t)}function _t(e,t,n){Et(e,t),0<n.length&&(e.i=null,e.g.set(At(e,t),d(n)),e.h+=n.length)}function At(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}function kt(e,t,n,r,a){try{a&&(a.onload=null,a.onerror=null,a.onabort=null,a.ontimeout=null),r(n)}catch(i){}}function Ct(){this.g=new fe}function It(e,t,n){const r=n||"";try{rt(e,(function(e,n){let a=e;s(e)&&(a=he(e)),t.push(r+n+"="+encodeURIComponent(a))}))}catch(YE){throw t.push(r+"type="+encodeURIComponent("_badmap")),YE}}function Nt(e){this.l=e.Ub||null,this.j=e.eb||!1}function Ot(e,t){ne.call(this),this.D=e,this.o=t,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}function Rt(e){e.j.read().then(e.Pa.bind(e)).catch(e.ga.bind(e))}function Dt(e){e.readyState=4,e.l=null,e.j=null,e.v=null,jt(e)}function jt(e){e.onreadystatechange&&e.onreadystatechange.call(e)}function Pt(e){let t="";return y(e,(function(e,n){t+=n,t+=":",t+=e,t+="\r\n"})),t}function Lt(e,t,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=Pt(n),"string"===typeof e?null!=n&&encodeURIComponent(String(n)):ut(e,t,n))}function Mt(e){ne.call(this),this.headers=new Map,this.o=e||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}(e=St.prototype).add=function(e,t){Tt(this),this.i=null,e=At(this,e);var n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},e.forEach=function(e,t){Tt(this),this.g.forEach((function(n,r){n.forEach((function(n){e.call(t,n,r,this)}),this)}),this)},e.na=function(){Tt(this);const e=Array.from(this.g.values()),t=Array.from(this.g.keys()),n=[];for(let r=0;r<t.length;r++){const a=e[r];for(let e=0;e<a.length;e++)n.push(t[r])}return n},e.V=function(e){Tt(this);let t=[];if("string"===typeof e)xt(this,e)&&(t=t.concat(this.g.get(At(this,e))));else{e=Array.from(this.g.values());for(let n=0;n<e.length;n++)t=t.concat(e[n])}return t},e.set=function(e,t){return Tt(this),this.i=null,xt(this,e=At(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},e.get=function(e,t){return e&&0<(e=this.V(e)).length?String(e[0]):t},e.toString=function(){if(this.i)return this.i;if(!this.g)return"";const e=[],t=Array.from(this.g.keys());for(var n=0;n<t.length;n++){var r=t[n];const i=encodeURIComponent(String(r)),s=this.V(r);for(r=0;r<s.length;r++){var a=i;""!==s[r]&&(a+="="+encodeURIComponent(String(s[r]))),e.push(a)}}return this.i=e.join("&")},h(Nt,pe),Nt.prototype.g=function(){return new Ot(this.l,this.j)},Nt.prototype.i=(mt={},function(){return mt}),h(Ot,ne),(e=Ot.prototype).open=function(e,t){if(0!=this.readyState)throw this.abort(),Error("Error reopening a connection");this.B=e,this.A=t,this.readyState=1,jt(this)},e.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const t={headers:this.u,method:this.B,credentials:this.m,cache:void 0};e&&(t.body=e),(this.D||a).fetch(new Request(this.A,t)).then(this.Sa.bind(this),this.ga.bind(this))},e.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch((()=>{})),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,Dt(this)),this.readyState=0},e.Sa=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,jt(this)),this.g&&(this.readyState=3,jt(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if("undefined"!==typeof a.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Rt(this)}else e.text().then(this.Ra.bind(this),this.ga.bind(this))},e.Pa=function(e){if(this.g){if(this.o&&e.value)this.response.push(e.value);else if(!this.o){var t=e.value?e.value:new Uint8Array(0);(t=this.v.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?Dt(this):jt(this),3==this.readyState&&Rt(this)}},e.Ra=function(e){this.g&&(this.response=this.responseText=e,Dt(this))},e.Qa=function(e){this.g&&(this.response=e,Dt(this))},e.ga=function(){this.g&&Dt(this)},e.setRequestHeader=function(e,t){this.u.append(e,t)},e.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},e.getAllResponseHeaders=function(){if(!this.h)return"";const e=[],t=this.h.entries();for(var n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(Ot.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}}),h(Mt,ne);var Ft=/^https?$/i,Ut=["POST","PUT"];function Vt(e,t){e.h=!1,e.g&&(e.j=!0,e.g.abort(),e.j=!1),e.l=t,e.m=5,Bt(e),Ht(e)}function Bt(e){e.A||(e.A=!0,re(e,"complete"),re(e,"error"))}function zt(e){if(e.h&&"undefined"!=typeof r&&(!e.v[1]||4!=Gt(e)||2!=e.Z()))if(e.u&&4==Gt(e))ie(e.Ea,0,e);else if(re(e,"readystatechange"),4==Gt(e)){e.h=!1;try{const r=e.Z();e:switch(r){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break e;default:t=!1}var n;if(!(n=t)){var i;if(i=0===r){var s=String(e.D).match(at)[1]||null;!s&&a.self&&a.self.location&&(s=a.self.location.protocol.slice(0,-1)),i=!Ft.test(s?s.toLowerCase():"")}n=i}if(n)re(e,"complete"),re(e,"success");else{e.m=6;try{var o=2<Gt(e)?e.g.statusText:""}catch(l){o=""}e.l=o+" ["+e.Z()+"]",Bt(e)}}finally{Ht(e)}}}function Ht(e,t){if(e.g){Wt(e);const n=e.g,r=e.v[0]?()=>{}:null;e.g=null,e.v=null,t||re(e,"ready");try{n.onreadystatechange=r}catch(YE){}}}function Wt(e){e.I&&(a.clearTimeout(e.I),e.I=null)}function Gt(e){return e.g?e.g.readyState:0}function qt(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.H){case"":case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(ys){return null}}function Kt(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function Yt(e){this.Aa=0,this.i=[],this.j=new Ie,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Kt("failFast",!1,e),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Kt("baseRetryDelayMs",5e3,e),this.cb=Kt("retryDelaySeedMs",1e4,e),this.Wa=Kt("forwardChannelMaxRetries",2,e),this.wa=Kt("forwardChannelRequestTimeoutMs",2e4,e),this.pa=e&&e.xmlHttpFactory||void 0,this.Xa=e&&e.Tb||void 0,this.Ca=e&&e.useFetchStreams||!1,this.L=void 0,this.J=e&&e.supportsCrossDomainXhr||!1,this.K="",this.h=new Xe(e&&e.concurrentRequestLimit),this.Da=new Ct,this.P=e&&e.fastHandshake||!1,this.O=e&&e.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=e&&e.Rb||!1,e&&e.xa&&this.j.xa(),e&&e.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&e&&e.detectBufferingProxy||!1,this.ja=void 0,e&&e.longPollingTimeout&&0<e.longPollingTimeout&&(this.ja=e.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}function Qt(e){if(Jt(e),3==e.G){var t=e.U++,n=st(e.I);if(ut(n,"SID",e.K),ut(n,"RID",t),ut(n,"TYPE","terminate"),en(e,n),(t=new Pe(e,e.j,t)).L=2,t.v=ht(st(n)),n=!1,a.navigator&&a.navigator.sendBeacon)try{n=a.navigator.sendBeacon(t.v.toString(),"")}catch(r){}!n&&a.Image&&((new Image).src=t.v,n=!0),n||(t.g=fn(t.j,null),t.g.ea(t.v)),t.F=Date.now(),He(t)}hn(e)}function Xt(e){e.g&&(an(e),e.g.cancel(),e.g=null)}function Jt(e){Xt(e),e.u&&(a.clearTimeout(e.u),e.u=null),on(e),e.h.cancel(),e.s&&("number"===typeof e.s&&a.clearTimeout(e.s),e.s=null)}function $t(e){if(!Je(e.h)&&!e.s){e.s=!0;var t=e.Ga;k||N(),C||(k(),C=!0),I.add(t,e),e.B=0}}function Zt(e,t){var n;n=t?t.l:e.U++;const r=st(e.I);ut(r,"SID",e.K),ut(r,"RID",n),ut(r,"AID",e.T),en(e,r),e.m&&e.o&&Lt(r,e.m,e.o),n=new Pe(e,e.j,n,e.B+1),null===e.m&&(n.H=e.o),t&&(e.i=t.D.concat(e.i)),t=tn(e,n,1e3),n.I=Math.round(.5*e.wa)+Math.round(.5*e.wa*Math.random()),et(e.h,n),Ue(n,r,t)}function en(e,t){e.H&&y(e.H,(function(e,n){ut(t,n,e)})),e.l&&rt({},(function(e,n){ut(t,n,e)}))}function tn(e,t,n){n=Math.min(e.i.length,n);var r=e.l?c(e.l.Na,e.l,e):null;e:{var a=e.i;let t=-1;for(;;){const e=["count="+n];-1==t?0<n?(t=a[0].g,e.push("ofs="+t)):t=0:e.push("ofs="+t);let s=!0;for(let o=0;o<n;o++){let n=a[o].g;const l=a[o].map;if(n-=t,0>n)t=Math.max(0,a[o].g-100),s=!1;else try{It(l,e,"req"+n+"_")}catch(i){r&&r(l)}}if(s){r=e.join("&");break e}}}return e=e.i.splice(0,n),t.D=e,r}function nn(e){if(!e.g&&!e.u){e.Y=1;var t=e.Fa;k||N(),C||(k(),C=!0),I.add(t,e),e.v=0}}function rn(e){return!(e.g||e.u||3<=e.v)&&(e.Y++,e.u=Ce(c(e.Fa,e),cn(e,e.v)),e.v++,!0)}function an(e){null!=e.A&&(a.clearTimeout(e.A),e.A=null)}function sn(e){e.g=new Pe(e,e.j,"rpc",e.Y),null===e.m&&(e.g.H=e.o),e.g.O=0;var t=st(e.qa);ut(t,"RID","rpc"),ut(t,"SID",e.K),ut(t,"AID",e.T),ut(t,"CI",e.F?"0":"1"),!e.F&&e.ja&&ut(t,"TO",e.ja),ut(t,"TYPE","xmlhttp"),en(e,t),e.m&&e.o&&Lt(t,e.m,e.o),e.L&&(e.g.I=e.L);var n=e.g;e=e.ia,n.L=1,n.v=ht(st(t)),n.m=null,n.P=!0,Ve(n,e)}function on(e){null!=e.C&&(a.clearTimeout(e.C),e.C=null)}function ln(e,t){var n=null;if(e.g==t){on(e),an(e),e.g=null;var r=2}else{if(!Ze(e.h,t))return;n=t.D,tt(e.h,t),r=1}if(0!=e.G)if(t.o)if(1==r){n=t.m?t.m.length:0,t=Date.now()-t.F;var a=e.B;re(r=Te(),new ke(r,n)),$t(e)}else nn(e);else if(3==(a=t.s)||0==a&&0<t.X||!(1==r&&function(e,t){return!($e(e.h)>=e.h.j-(e.s?1:0))&&(e.s?(e.i=t.D.concat(e.i),!0):!(1==e.G||2==e.G||e.B>=(e.Va?0:e.Wa))&&(e.s=Ce(c(e.Ga,e,t),cn(e,e.B)),e.B++,!0))}(e,t)||2==r&&rn(e)))switch(n&&0<n.length&&(t=e.h,t.i=t.i.concat(n)),a){case 1:un(e,5);break;case 4:un(e,10);break;case 3:un(e,6);break;default:un(e,2)}}function cn(e,t){let n=e.Ta+Math.floor(Math.random()*e.cb);return e.isActive()||(n*=2),n*t}function un(e,t){if(e.j.info("Error code "+t),2==t){var n=c(e.fb,e),r=e.Xa;const t=!r;r=new it(r||"//www.google.com/images/cleardot.gif"),a.location&&"http"==a.location.protocol||ot(r,"https"),ht(r),t?function(e,t){const n=new Ie;if(a.Image){const r=new Image;r.onload=u(kt,n,"TestLoadImage: loaded",!0,t,r),r.onerror=u(kt,n,"TestLoadImage: error",!1,t,r),r.onabort=u(kt,n,"TestLoadImage: abort",!1,t,r),r.ontimeout=u(kt,n,"TestLoadImage: timeout",!1,t,r),a.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=e}else t(!1)}(r.toString(),n):function(e,t){new Ie;const n=new AbortController,r=setTimeout((()=>{n.abort(),kt(0,0,!1,t)}),1e4);fetch(e,{signal:n.signal}).then((e=>{clearTimeout(r),e.ok?kt(0,0,!0,t):kt(0,0,!1,t)})).catch((()=>{clearTimeout(r),kt(0,0,!1,t)}))}(r.toString(),n)}else Ae(2);e.G=0,e.l&&e.l.sa(t),hn(e),Jt(e)}function hn(e){if(e.G=0,e.ka=[],e.l){const t=nt(e.h);0==t.length&&0==e.i.length||(f(e.ka,t),f(e.ka,e.i),e.h.i.length=0,d(e.i),e.i.length=0),e.l.ra()}}function dn(e,t,n){var r=n instanceof it?st(n):new it(n);if(""!=r.g)t&&(r.g=t+"."+r.g),lt(r,r.s);else{var i=a.location;r=i.protocol,t=t?t+"."+i.hostname:i.hostname,i=+i.port;var s=new it(null);r&&ot(s,r),t&&(s.g=t),i&&lt(s,i),n&&(s.l=n),r=s}return n=e.D,t=e.ya,n&&t&&ut(r,n,t),ut(r,"VER",e.la),en(e,r),r}function fn(e,t,n){if(t&&!e.J)throw Error("Can't create secondary domain capable XhrIo object.");return(t=e.Ca&&!e.pa?new Mt(new Nt({eb:n})):new Mt(e.pa)).Ha(e.J),t}function pn(){}function mn(){}function gn(e,t){ne.call(this),this.g=new Yt(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.o=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.va&&(e?e["X-WebChannel-Client-Profile"]=t.va:e={"X-WebChannel-Client-Profile":t.va}),this.g.S=e,(e=t&&t.Sb)&&!p(e)&&(this.g.m=e),this.v=t&&t.supportsCrossDomainXhr||!1,this.u=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!p(t)&&(this.g.D=t,null!==(e=this.h)&&t in e&&(t in(e=this.h)&&delete e[t])),this.j=new bn(this)}function vn(e){ye.call(this),e.__headers__&&(this.headers=e.__headers__,this.statusCode=e.__status__,delete e.__headers__,delete e.__status__);var t=e.__sm__;if(t){e:{for(const n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function yn(){be.call(this),this.status=1}function bn(e){this.g=e}(e=Mt.prototype).Ha=function(e){this.J=e},e.ea=function(e,t,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+e);t=t?t.toUpperCase():"GET",this.D=e,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Oe.g(),this.v=this.o?me(this.o):me(Oe),this.g.onreadystatechange=c(this.Ea,this);try{this.B=!0,this.g.open(t,String(e),!0),this.B=!1}catch(s){return void Vt(this,s)}if(e=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var i in r)n.set(i,r[i]);else{if("function"!==typeof r.keys||"function"!==typeof r.get)throw Error("Unknown input type for opt_headers: "+String(r));for(const e of r.keys())n.set(e,r.get(e))}r=Array.from(n.keys()).find((e=>"content-type"==e.toLowerCase())),i=a.FormData&&e instanceof a.FormData,!(0<=Array.prototype.indexOf.call(Ut,t,void 0))||r||i||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[a,o]of n)this.g.setRequestHeader(a,o);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Wt(this),this.u=!0,this.g.send(e),this.u=!1}catch(s){Vt(this,s)}},e.abort=function(e){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=e||7,re(this,"complete"),re(this,"abort"),Ht(this))},e.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Ht(this,!0)),Mt.aa.N.call(this)},e.Ea=function(){this.s||(this.B||this.u||this.j?zt(this):this.bb())},e.bb=function(){zt(this)},e.isActive=function(){return!!this.g},e.Z=function(){try{return 2<Gt(this)?this.g.status:-1}catch(mt){return-1}},e.oa=function(){try{return this.g?this.g.responseText:""}catch(mt){return""}},e.Oa=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),de(t)}},e.Ba=function(){return this.m},e.Ka=function(){return"string"===typeof this.l?this.l:String(this.l)},(e=Yt.prototype).la=8,e.G=1,e.connect=function(e,t,n,r){Ae(0),this.W=e,this.H=t||{},n&&void 0!==r&&(this.H.OSID=n,this.H.OAID=r),this.F=this.X,this.I=dn(this,null,this.W),$t(this)},e.Ga=function(e){if(this.s)if(this.s=null,1==this.G){if(!e){this.U=Math.floor(1e5*Math.random()),e=this.U++;const a=new Pe(this,this.j,e);let i=this.o;if(this.S&&(i?(i=b(i),S(i,this.S)):i=this.S),null!==this.m||this.O||(a.H=i,i=null),this.P)e:{for(var t=0,n=0;n<this.i.length;n++){var r=this.i[n];if(void 0===(r="__data__"in r.map&&"string"===typeof(r=r.map.__data__)?r.length:void 0))break;if(4096<(t+=r)){t=n;break e}if(4096===t||n===this.i.length-1){t=n+1;break e}}t=1e3}else t=1e3;t=tn(this,a,t),ut(n=st(this.I),"RID",e),ut(n,"CVER",22),this.D&&ut(n,"X-HTTP-Session-Id",this.D),en(this,n),i&&(this.O?t="headers="+encodeURIComponent(String(Pt(i)))+"&"+t:this.m&&Lt(n,this.m,i)),et(this.h,a),this.Ua&&ut(n,"TYPE","init"),this.P?(ut(n,"$req",t),ut(n,"SID","null"),a.T=!0,Ue(a,n,null)):Ue(a,n,t),this.G=2}}else 3==this.G&&(e?Zt(this,e):0==this.i.length||Je(this.h)||Zt(this))},e.Fa=function(){if(this.u=null,sn(this),this.ba&&!(this.M||null==this.g||0>=this.R)){var e=2*this.R;this.j.info("BP detection timer enabled: "+e),this.A=Ce(c(this.ab,this),e)}},e.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Ae(10),Xt(this),sn(this))},e.Za=function(){null!=this.C&&(this.C=null,Xt(this),rn(this),Ae(19))},e.fb=function(e){e?(this.j.info("Successfully pinged google.com"),Ae(2)):(this.j.info("Failed to ping google.com"),Ae(1))},e.isActive=function(){return!!this.l&&this.l.isActive(this)},(e=pn.prototype).ua=function(){},e.ta=function(){},e.sa=function(){},e.ra=function(){},e.isActive=function(){return!0},e.Na=function(){},mn.prototype.g=function(e,t){return new gn(e,t)},h(gn,ne),gn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},gn.prototype.close=function(){Qt(this.g)},gn.prototype.o=function(e){var t=this.g;if("string"===typeof e){var n={};n.__data__=e,e=n}else this.u&&((n={}).__data__=he(e),e=n);t.i.push(new Qe(t.Ya++,e)),3==t.G&&$t(t)},gn.prototype.N=function(){this.g.l=null,delete this.j,Qt(this.g),delete this.g,gn.aa.N.call(this)},h(vn,ye),h(yn,be),h(bn,pn),bn.prototype.ua=function(){re(this.g,"a")},bn.prototype.ta=function(e){re(this.g,new vn(e))},bn.prototype.sa=function(e){re(this.g,new yn)},bn.prototype.ra=function(){re(this.g,"b")},mn.prototype.createWebChannel=mn.prototype.g,gn.prototype.send=gn.prototype.o,gn.prototype.open=gn.prototype.m,gn.prototype.close=gn.prototype.close,fs=ms.createWebChannelTransport=function(){return new mn},ds=ms.getStatEventTarget=function(){return Te()},hs=ms.Event=we,us=ms.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Re.NO_ERROR=0,Re.TIMEOUT=8,Re.HTTP_ERROR=6,cs=ms.ErrorCode=Re,De.COMPLETE="complete",ls=ms.EventType=De,ge.EventType=ve,ve.OPEN="a",ve.CLOSE="b",ve.ERROR="c",ve.MESSAGE="d",ne.prototype.listen=ne.prototype.K,os=ms.WebChannel=ge,ss=ms.FetchXmlHttpFactory=Nt,Mt.prototype.listenOnce=Mt.prototype.L,Mt.prototype.getLastError=Mt.prototype.Ka,Mt.prototype.getLastErrorCode=Mt.prototype.Ba,Mt.prototype.getStatus=Mt.prototype.Z,Mt.prototype.getResponseJson=Mt.prototype.Oa,Mt.prototype.getResponseText=Mt.prototype.oa,Mt.prototype.send=Mt.prototype.ea,Mt.prototype.setWithCredentials=Mt.prototype.Ha,is=ms.XhrIo=Mt}).apply("undefined"!==typeof ps?ps:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{});const gs="@firebase/firestore";class vs{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}vs.UNAUTHENTICATED=new vs(null),vs.GOOGLE_CREDENTIALS=new vs("google-credentials-uid"),vs.FIRST_PARTY=new vs("first-party-uid"),vs.MOCK_USER=new vs("mock-user");let ys="10.12.3";const bs=new mt("@firebase/firestore");function ws(){return bs.logLevel}function Ss(e){if(bs.logLevel<=ut.DEBUG){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const a=n.map(xs);bs.debug("Firestore (".concat(ys,"): ").concat(e),...a)}}function Ts(e){if(bs.logLevel<=ut.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const a=n.map(xs);bs.error("Firestore (".concat(ys,"): ").concat(e),...a)}}function Es(e){if(bs.logLevel<=ut.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const a=n.map(xs);bs.warn("Firestore (".concat(ys,"): ").concat(e),...a)}}function xs(e){if("string"==typeof e)return e;try{return function(e){return JSON.stringify(e)}(e)}catch(t){return e}}function _s(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Unexpected state";const t="FIRESTORE (".concat(ys,") INTERNAL ASSERTION FAILED: ")+e;throw Ts(t),new Error(t)}function As(e,t){e||_s()}function ks(e,t){return e}const Cs={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Is extends Ye{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>"".concat(this.name,": [code=").concat(this.code,"]: ").concat(this.message)}}class Ns{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class Os{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization","Bearer ".concat(e))}}class Rs{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(vs.UNAUTHENTICATED)))}shutdown(){}}class Ds{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class js{constructor(e){this.t=e,this.currentUser=vs.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){let n=this.i;const r=e=>this.i!==n?(n=this.i,t(e)):Promise.resolve();let a=new Ns;this.o=()=>{this.i++,this.currentUser=this.u(),a.resolve(),a=new Ns,e.enqueueRetryable((()=>r(this.currentUser)))};const i=()=>{const t=a;e.enqueueRetryable((async()=>{await t.promise,await r(this.currentUser)}))},s=e=>{Ss("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=e,this.auth.addAuthTokenListener(this.o),i()};this.t.onInit((e=>s(e))),setTimeout((()=>{if(!this.auth){const e=this.t.getImmediate({optional:!0});e?s(e):(Ss("FirebaseAuthCredentialsProvider","Auth not yet detected"),a.resolve(),a=new Ns)}}),0),i()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((t=>this.i!==e?(Ss("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):t?(As("string"==typeof t.accessToken),new Os(t.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return As(null===e||"string"==typeof e),new vs(e)}}class Ps{constructor(e,t,n){this.l=e,this.h=t,this.P=n,this.type="FirstParty",this.user=vs.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class Ls{constructor(e,t,n){this.l=e,this.h=t,this.P=n}getToken(){return Promise.resolve(new Ps(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable((()=>t(vs.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class Ms{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Fs{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){const n=e=>{null!=e.error&&Ss("FirebaseAppCheckTokenProvider","Error getting App Check token; using placeholder token instead. Error: ".concat(e.error.message));const n=e.token!==this.R;return this.R=e.token,Ss("FirebaseAppCheckTokenProvider","Received ".concat(n?"new":"existing"," token.")),n?t(e.token):Promise.resolve()};this.o=t=>{e.enqueueRetryable((()=>n(t)))};const r=e=>{Ss("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=e,this.appCheck.addTokenListener(this.o)};this.A.onInit((e=>r(e))),setTimeout((()=>{if(!this.appCheck){const e=this.A.getImmediate({optional:!0});e?r(e):Ss("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((e=>e?(As("string"==typeof e.token),this.R=e.token,new Ms(e.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function Us(e){const t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(let r=0;r<e;r++)n[r]=Math.floor(256*Math.random());return n}class Vs{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(256/62);let n="";for(;n.length<20;){const r=Us(40);for(let a=0;a<r.length;++a)n.length<20&&r[a]<t&&(n+=e.charAt(r[a]%62))}return n}}function Bs(e,t){return e<t?-1:e>t?1:0}function zs(e,t,n){return e.length===t.length&&e.every(((e,r)=>n(e,t[r])))}class Hs{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Is(Cs.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Is(Cs.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new Is(Cs.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Is(Cs.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Hs.fromMillis(Date.now())}static fromDate(e){return Hs.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*t));return new Hs(t,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Bs(this.nanoseconds,e.nanoseconds):Bs(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class Ws{constructor(e){this.timestamp=e}static fromTimestamp(e){return new Ws(e)}static min(){return new Ws(new Hs(0,0))}static max(){return new Ws(new Hs(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class Gs{constructor(e,t,n){void 0===t?t=0:t>e.length&&_s(),void 0===n?n=e.length-t:n>e.length-t&&_s(),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return 0===Gs.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Gs?e.forEach((e=>{t.push(e)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let r=0;r<n;r++){const n=e.get(r),a=t.get(r);if(n<a)return-1;if(n>a)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class qs extends Gs{construct(e,t,n){return new qs(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(){const e=[];for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const a of n){if(a.indexOf("//")>=0)throw new Is(Cs.INVALID_ARGUMENT,"Invalid segment (".concat(a,"). Paths must not contain // in them."));e.push(...a.split("/").filter((e=>e.length>0)))}return new qs(e)}static emptyPath(){return new qs([])}}const Ks=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Ys extends Gs{construct(e,t,n){return new Ys(e,t,n)}static isValidIdentifier(e){return Ks.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Ys.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new Ys(["__name__"])}static fromServerFormat(e){const t=[];let n="",r=0;const a=()=>{if(0===n.length)throw new Is(Cs.INVALID_ARGUMENT,"Invalid field path (".concat(e,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"));t.push(n),n=""};let i=!1;for(;r<e.length;){const t=e[r];if("\\"===t){if(r+1===e.length)throw new Is(Cs.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const t=e[r+1];if("\\"!==t&&"."!==t&&"`"!==t)throw new Is(Cs.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=t,r+=2}else"`"===t?(i=!i,r++):"."!==t||i?(n+=t,r++):(a(),r++)}if(a(),i)throw new Is(Cs.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Ys(t)}static emptyPath(){return new Ys([])}}class Qs{constructor(e){this.path=e}static fromPath(e){return new Qs(qs.fromString(e))}static fromName(e){return new Qs(qs.fromString(e).popFirst(5))}static empty(){return new Qs(qs.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===qs.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return qs.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Qs(new qs(e.slice()))}}class Xs{constructor(e,t,n,r){this.indexId=e,this.collectionGroup=t,this.fields=n,this.indexState=r}}Xs.UNKNOWN_ID=-1;function Js(e,t){const n=e.toTimestamp().seconds,r=e.toTimestamp().nanoseconds+1,a=Ws.fromTimestamp(1e9===r?new Hs(n+1,0):new Hs(n,r));return new Zs(a,Qs.empty(),t)}function $s(e){return new Zs(e.readTime,e.key,-1)}class Zs{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new Zs(Ws.min(),Qs.empty(),-1)}static max(){return new Zs(Ws.max(),Qs.empty(),-1)}}function eo(e,t){let n=e.readTime.compareTo(t.readTime);return 0!==n?n:(n=Qs.comparator(e.documentKey,t.documentKey),0!==n?n:Bs(e.largestBatchId,t.largestBatchId))}const to="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class no{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function ro(e){if(e.code!==Cs.FAILED_PRECONDITION||e.message!==to)throw e;Ss("LocalStore","Unexpectedly lost primary lease")}class ao{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)}),(e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&_s(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new ao(((n,r)=>{this.nextCallback=t=>{this.wrapSuccess(e,t).next(n,r)},this.catchCallback=e=>{this.wrapFailure(t,e).next(n,r)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof ao?t:ao.resolve(t)}catch(e){return ao.reject(e)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):ao.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):ao.reject(t)}static resolve(e){return new ao(((t,n)=>{t(e)}))}static reject(e){return new ao(((t,n)=>{n(e)}))}static waitFor(e){return new ao(((t,n)=>{let r=0,a=0,i=!1;e.forEach((e=>{++r,e.next((()=>{++a,i&&a===r&&t()}),(e=>n(e)))})),i=!0,a===r&&t()}))}static or(e){let t=ao.resolve(!1);for(const n of e)t=t.next((e=>e?ao.resolve(e):n()));return t}static forEach(e,t){const n=[];return e.forEach(((e,r)=>{n.push(t.call(this,e,r))})),this.waitFor(n)}static mapArray(e,t){return new ao(((n,r)=>{const a=e.length,i=new Array(a);let s=0;for(let o=0;o<a;o++){const l=o;t(e[l]).next((e=>{i[l]=e,++s,s===a&&n(i)}),(e=>r(e)))}}))}static doWhile(e,t){return new ao(((n,r)=>{const a=()=>{!0===e()?t().next((()=>{a()}),r):n()};a()}))}}function io(e){const t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function so(e){return"IndexedDbTransactionError"===e.name}class oo{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=e=>this.ie(e),this.se=e=>t.writeSequenceNumber(e))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}function lo(e){return null==e}function co(e){return 0===e&&1/e==-1/0}function uo(e){return"number"==typeof e&&Number.isInteger(e)&&!co(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}oo.oe=-1;const ho=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],fo=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],po=fo;function mo(e){let t=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function go(e,t){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function vo(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}class yo{constructor(e,t){this.comparator=e,this.root=t||wo.EMPTY}insert(e,t){return new yo(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,wo.BLACK,null,null))}remove(e){return new yo(this.comparator,this.root.remove(e,this.comparator).copy(null,null,wo.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,n)=>(e(t,n),!1)))}toString(){const e=[];return this.inorderTraversal(((t,n)=>(e.push("".concat(t,":").concat(n)),!1))),"{".concat(e.join(", "),"}")}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new bo(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new bo(this.root,e,this.comparator,!1)}getReverseIterator(){return new bo(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new bo(this.root,e,this.comparator,!0)}}class bo{constructor(e,t,n,r){this.isReverse=r,this.nodeStack=[];let a=1;for(;!e.isEmpty();)if(a=t?n(e.key,t):1,t&&r&&(a*=-1),a<0)e=this.isReverse?e.left:e.right;else{if(0===a){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class wo{constructor(e,t,n,r,a){this.key=e,this.value=t,this.color=null!=n?n:wo.RED,this.left=null!=r?r:wo.EMPTY,this.right=null!=a?a:wo.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,r,a){return new wo(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=a?a:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this;const a=n(e,r.key);return r=a<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===a?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp()}removeMin(){if(this.left.isEmpty())return wo.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),0===t(e,r.key)){if(r.right.isEmpty())return wo.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,wo.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,wo.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw _s();if(this.right.isRed())throw _s();const e=this.left.check();if(e!==this.right.check())throw _s();return e+(this.isRed()?0:1)}}wo.EMPTY=null,wo.RED=!0,wo.BLACK=!1,wo.EMPTY=new class{constructor(){this.size=0}get key(){throw _s()}get value(){throw _s()}get color(){throw _s()}get left(){throw _s()}get right(){throw _s()}copy(e,t,n,r,a){return this}insert(e,t,n){return new wo(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class So{constructor(e){this.comparator=e,this.data=new yo(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,n)=>(e(t),!1)))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new To(this.data.getIterator())}getIteratorFrom(e){return new To(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((e=>{t=t.add(e)})),t}isEqual(e){if(!(e instanceof So))return!1;if(this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(0!==this.comparator(e,r))return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new So(this.comparator);return t.data=e,t}}class To{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class Eo{constructor(e){this.fields=e,e.sort(Ys.comparator)}static empty(){return new Eo([])}unionWith(e){let t=new So(Ys.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new Eo(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return zs(this.fields,e.fields,((e,t)=>e.isEqual(t)))}}class xo extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class _o{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(e){try{return atob(e)}catch(e){throw"undefined"!=typeof DOMException&&e instanceof DOMException?new xo("Invalid base64 string: "+e):e}}(e);return new _o(t)}static fromUint8Array(e){const t=function(e){let t="";for(let n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e);return new _o(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Bs(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}_o.EMPTY_BYTE_STRING=new _o("");const Ao=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ko(e){if(As(!!e),"string"==typeof e){let t=0;const n=Ao.exec(e);if(As(!!n),n[1]){let e=n[1];e=(e+"000000000").substr(0,9),t=Number(e)}const r=new Date(e);return{seconds:Math.floor(r.getTime()/1e3),nanos:t}}return{seconds:Co(e.seconds),nanos:Co(e.nanos)}}function Co(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function Io(e){return"string"==typeof e?_o.fromBase64String(e):_o.fromUint8Array(e)}function No(e){var t,n;return"server_timestamp"===(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function Oo(e){const t=e.mapValue.fields.__previous_value__;return No(t)?Oo(t):t}function Ro(e){const t=ko(e.mapValue.fields.__local_write_time__.timestampValue);return new Hs(t.seconds,t.nanos)}class Do{constructor(e,t,n,r,a,i,s,o,l){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=r,this.ssl=a,this.forceLongPolling=i,this.autoDetectLongPolling=s,this.longPollingOptions=o,this.useFetchStreams=l}}class jo{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new jo("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof jo&&e.projectId===this.projectId&&e.database===this.database}}const Po={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function Lo(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?No(e)?4:Xo(e)?9007199254740991:10:_s()}function Mo(e,t){if(e===t)return!0;const n=Lo(e);if(n!==Lo(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return Ro(e).isEqual(Ro(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;const n=ko(e.timestampValue),r=ko(t.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(e,t){return Io(e.bytesValue).isEqual(Io(t.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return Co(e.geoPointValue.latitude)===Co(t.geoPointValue.latitude)&&Co(e.geoPointValue.longitude)===Co(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return Co(e.integerValue)===Co(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){const n=Co(e.doubleValue),r=Co(t.doubleValue);return n===r?co(n)===co(r):isNaN(n)&&isNaN(r)}return!1}(e,t);case 9:return zs(e.arrayValue.values||[],t.arrayValue.values||[],Mo);case 10:return function(e,t){const n=e.mapValue.fields||{},r=t.mapValue.fields||{};if(mo(n)!==mo(r))return!1;for(const a in n)if(n.hasOwnProperty(a)&&(void 0===r[a]||!Mo(n[a],r[a])))return!1;return!0}(e,t);default:return _s()}}function Fo(e,t){return void 0!==(e.values||[]).find((e=>Mo(e,t)))}function Uo(e,t){if(e===t)return 0;const n=Lo(e),r=Lo(t);if(n!==r)return Bs(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return Bs(e.booleanValue,t.booleanValue);case 2:return function(e,t){const n=Co(e.integerValue||e.doubleValue),r=Co(t.integerValue||t.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(e,t);case 3:return Vo(e.timestampValue,t.timestampValue);case 4:return Vo(Ro(e),Ro(t));case 5:return Bs(e.stringValue,t.stringValue);case 6:return function(e,t){const n=Io(e),r=Io(t);return n.compareTo(r)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){const n=e.split("/"),r=t.split("/");for(let a=0;a<n.length&&a<r.length;a++){const e=Bs(n[a],r[a]);if(0!==e)return e}return Bs(n.length,r.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){const n=Bs(Co(e.latitude),Co(t.latitude));return 0!==n?n:Bs(Co(e.longitude),Co(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return function(e,t){const n=e.values||[],r=t.values||[];for(let a=0;a<n.length&&a<r.length;++a){const e=Uo(n[a],r[a]);if(e)return e}return Bs(n.length,r.length)}(e.arrayValue,t.arrayValue);case 10:return function(e,t){if(e===Po.mapValue&&t===Po.mapValue)return 0;if(e===Po.mapValue)return 1;if(t===Po.mapValue)return-1;const n=e.fields||{},r=Object.keys(n),a=t.fields||{},i=Object.keys(a);r.sort(),i.sort();for(let s=0;s<r.length&&s<i.length;++s){const e=Bs(r[s],i[s]);if(0!==e)return e;const t=Uo(n[r[s]],a[i[s]]);if(0!==t)return t}return Bs(r.length,i.length)}(e.mapValue,t.mapValue);default:throw _s()}}function Vo(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return Bs(e,t);const n=ko(e),r=ko(t),a=Bs(n.seconds,r.seconds);return 0!==a?a:Bs(n.nanos,r.nanos)}function Bo(e){return zo(e)}function zo(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){const t=ko(e);return"time(".concat(t.seconds,",").concat(t.nanos,")")}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?function(e){return Io(e).toBase64()}(e.bytesValue):"referenceValue"in e?function(e){return Qs.fromName(e).toString()}(e.referenceValue):"geoPointValue"in e?function(e){return"geo(".concat(e.latitude,",").concat(e.longitude,")")}(e.geoPointValue):"arrayValue"in e?function(e){let t="[",n=!0;for(const r of e.values||[])n?n=!1:t+=",",t+=zo(r);return t+"]"}(e.arrayValue):"mapValue"in e?function(e){const t=Object.keys(e.fields||{}).sort();let n="{",r=!0;for(const a of t)r?r=!1:n+=",",n+="".concat(a,":").concat(zo(e.fields[a]));return n+"}"}(e.mapValue):_s()}function Ho(e,t){return{referenceValue:"projects/".concat(e.projectId,"/databases/").concat(e.database,"/documents/").concat(t.path.canonicalString())}}function Wo(e){return!!e&&"integerValue"in e}function Go(e){return!!e&&"arrayValue"in e}function qo(e){return!!e&&"nullValue"in e}function Ko(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function Yo(e){return!!e&&"mapValue"in e}function Qo(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return go(e.mapValue.fields,((e,n)=>t.mapValue.fields[e]=Qo(n))),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=Qo(e.arrayValue.values[n]);return t}return Object.assign({},e)}function Xo(e){return"__max__"===(((e.mapValue||{}).fields||{}).__type__||{}).stringValue}class Jo{constructor(e){this.value=e}static empty(){return new Jo({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!Yo(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Qo(t)}setAll(e){let t=Ys.emptyPath(),n={},r=[];e.forEach(((e,a)=>{if(!t.isImmediateParentOf(a)){const e=this.getFieldsMap(t);this.applyChanges(e,n,r),n={},r=[],t=a.popLast()}e?n[a.lastSegment()]=Qo(e):r.push(a.lastSegment())}));const a=this.getFieldsMap(t);this.applyChanges(a,n,r)}delete(e){const t=this.field(e.popLast());Yo(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Mo(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let r=t.mapValue.fields[e.get(n)];Yo(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,n){go(t,((t,n)=>e[t]=n));for(const r of n)delete e[r]}clone(){return new Jo(Qo(this.value))}}function $o(e){const t=[];return go(e.fields,((e,n)=>{const r=new Ys([e]);if(Yo(n)){const e=$o(n.mapValue).fields;if(0===e.length)t.push(r);else for(const n of e)t.push(r.child(n))}else t.push(r)})),new Eo(t)}class Zo{constructor(e,t,n,r,a,i,s){this.key=e,this.documentType=t,this.version=n,this.readTime=r,this.createTime=a,this.data=i,this.documentState=s}static newInvalidDocument(e){return new Zo(e,0,Ws.min(),Ws.min(),Ws.min(),Jo.empty(),0)}static newFoundDocument(e,t,n,r){return new Zo(e,1,t,Ws.min(),n,r,0)}static newNoDocument(e,t){return new Zo(e,2,t,Ws.min(),Ws.min(),Jo.empty(),0)}static newUnknownDocument(e,t){return new Zo(e,3,t,Ws.min(),Ws.min(),Jo.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Ws.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Jo.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Jo.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ws.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof Zo&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Zo(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return"Document(".concat(this.key,", ").concat(this.version,", ").concat(JSON.stringify(this.data.value),", {createTime: ").concat(this.createTime,"}), {documentType: ").concat(this.documentType,"}), {documentState: ").concat(this.documentState,"})")}}class el{constructor(e,t){this.position=e,this.inclusive=t}}function tl(e,t,n){let r=0;for(let a=0;a<e.position.length;a++){const i=t[a],s=e.position[a];if(r=i.field.isKeyField()?Qs.comparator(Qs.fromName(s.referenceValue),n.key):Uo(s,n.data.field(i.field)),"desc"===i.dir&&(r*=-1),0!==r)break}return r}function nl(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!Mo(e.position[n],t.position[n]))return!1;return!0}class rl{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc";this.field=e,this.dir=t}}function al(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}class il{}class sl extends il{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,n):new pl(e,t,n):"array-contains"===t?new yl(e,n):"in"===t?new bl(e,n):"not-in"===t?new wl(e,n):"array-contains-any"===t?new Sl(e,n):new sl(e,t,n)}static createKeyFieldInFilter(e,t,n){return"in"===t?new ml(e,n):new gl(e,n)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&this.matchesComparison(Uo(t,this.value)):null!==t&&Lo(this.value)===Lo(t)&&this.matchesComparison(Uo(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return _s()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class ol extends il{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new ol(e,t)}matches(e){return ll(this)?void 0===this.filters.find((t=>!t.matches(e))):void 0!==this.filters.find((t=>t.matches(e)))}getFlattenedFilters(){return null!==this.ae||(this.ae=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function ll(e){return"and"===e.op}function cl(e){return ul(e)&&ll(e)}function ul(e){for(const t of e.filters)if(t instanceof ol)return!1;return!0}function hl(e){if(e instanceof sl)return e.field.canonicalString()+e.op.toString()+Bo(e.value);if(cl(e))return e.filters.map((e=>hl(e))).join(",");{const t=e.filters.map((e=>hl(e))).join(",");return"".concat(e.op,"(").concat(t,")")}}function dl(e,t){return e instanceof sl?function(e,t){return t instanceof sl&&e.op===t.op&&e.field.isEqual(t.field)&&Mo(e.value,t.value)}(e,t):e instanceof ol?function(e,t){return t instanceof ol&&e.op===t.op&&e.filters.length===t.filters.length&&e.filters.reduce(((e,n,r)=>e&&dl(n,t.filters[r])),!0)}(e,t):void _s()}function fl(e){return e instanceof sl?function(e){return"".concat(e.field.canonicalString()," ").concat(e.op," ").concat(Bo(e.value))}(e):e instanceof ol?function(e){return e.op.toString()+" {"+e.getFilters().map(fl).join(" ,")+"}"}(e):"Filter"}class pl extends sl{constructor(e,t,n){super(e,t,n),this.key=Qs.fromName(n.referenceValue)}matches(e){const t=Qs.comparator(e.key,this.key);return this.matchesComparison(t)}}class ml extends sl{constructor(e,t){super(e,"in",t),this.keys=vl("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class gl extends sl{constructor(e,t){super(e,"not-in",t),this.keys=vl("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function vl(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map((e=>Qs.fromName(e.referenceValue)))}class yl extends sl{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Go(t)&&Fo(t.arrayValue,this.value)}}class bl extends sl{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&Fo(this.value.arrayValue,t)}}class wl extends sl{constructor(e,t){super(e,"not-in",t)}matches(e){if(Fo(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&!Fo(this.value.arrayValue,t)}}class Sl extends sl{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Go(t)||!t.arrayValue.values)&&t.arrayValue.values.some((e=>Fo(this.value.arrayValue,e)))}}class Tl{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=r,this.limit=a,this.startAt=i,this.endAt=s,this.ue=null}}function El(e){return new Tl(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,arguments.length>6&&void 0!==arguments[6]?arguments[6]:null)}function xl(e){const t=ks(e);if(null===t.ue){let e=t.path.canonicalString();null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map((e=>hl(e))).join(","),e+="|ob:",e+=t.orderBy.map((e=>function(e){return e.field.canonicalString()+e.dir}(e))).join(","),lo(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map((e=>Bo(e))).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map((e=>Bo(e))).join(",")),t.ue=e}return t.ue}function _l(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(let n=0;n<e.orderBy.length;n++)if(!al(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let n=0;n<e.filters.length;n++)if(!dl(e.filters[n],t.filters[n]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!nl(e.startAt,t.startAt)&&nl(e.endAt,t.endAt)}function Al(e){return Qs.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}class kl{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"F",s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=r,this.limit=a,this.limitType=i,this.startAt=s,this.endAt=o,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function Cl(e,t,n,r,a,i,s,o){return new kl(e,t,n,r,a,i,s,o)}function Il(e){return new kl(e)}function Nl(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}function Ol(e){return null!==e.collectionGroup}function Rl(e){const t=ks(e);if(null===t.ce){t.ce=[];const e=new Set;for(const a of t.explicitOrderBy)t.ce.push(a),e.add(a.field.canonicalString());const n=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc",r=function(e){let t=new So(Ys.comparator);return e.filters.forEach((e=>{e.getFlattenedFilters().forEach((e=>{e.isInequality()&&(t=t.add(e.field))}))})),t}(t);r.forEach((r=>{e.has(r.canonicalString())||r.isKeyField()||t.ce.push(new rl(r,n))})),e.has(Ys.keyField().canonicalString())||t.ce.push(new rl(Ys.keyField(),n))}return t.ce}function Dl(e){const t=ks(e);return t.le||(t.le=jl(t,Rl(e))),t.le}function jl(e,t){if("F"===e.limitType)return El(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map((e=>{const t="desc"===e.dir?"asc":"desc";return new rl(e.field,t)}));const n=e.endAt?new el(e.endAt.position,e.endAt.inclusive):null,r=e.startAt?new el(e.startAt.position,e.startAt.inclusive):null;return El(e.path,e.collectionGroup,t,e.filters,e.limit,n,r)}}function Pl(e,t){const n=e.filters.concat([t]);return new kl(e.path,e.collectionGroup,e.explicitOrderBy.slice(),n,e.limit,e.limitType,e.startAt,e.endAt)}function Ll(e,t,n){return new kl(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function Ml(e,t){return _l(Dl(e),Dl(t))&&e.limitType===t.limitType}function Fl(e){return"".concat(xl(Dl(e)),"|lt:").concat(e.limitType)}function Ul(e){return"Query(target=".concat(function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=", filters: [".concat(e.filters.map((e=>fl(e))).join(", "),"]")),lo(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=", orderBy: [".concat(e.orderBy.map((e=>function(e){return"".concat(e.field.canonicalString()," (").concat(e.dir,")")}(e))).join(", "),"]")),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((e=>Bo(e))).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((e=>Bo(e))).join(",")),"Target(".concat(t,")")}(Dl(e)),"; limitType=").concat(e.limitType,")")}function Vl(e,t){return t.isFoundDocument()&&function(e,t){const n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):Qs.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){for(const n of Rl(e))if(!n.field.isKeyField()&&null===t.data.field(n.field))return!1;return!0}(e,t)&&function(e,t){for(const n of e.filters)if(!n.matches(t))return!1;return!0}(e,t)&&function(e,t){return!(e.startAt&&!function(e,t,n){const r=tl(e,t,n);return e.inclusive?r<=0:r<0}(e.startAt,Rl(e),t))&&!(e.endAt&&!function(e,t,n){const r=tl(e,t,n);return e.inclusive?r>=0:r>0}(e.endAt,Rl(e),t))}(e,t)}function Bl(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function zl(e){return(t,n)=>{let r=!1;for(const a of Rl(e)){const e=Hl(a,t,n);if(0!==e)return e;r=r||a.field.isKeyField()}return 0}}function Hl(e,t,n){const r=e.field.isKeyField()?Qs.comparator(t.key,n.key):function(e,t,n){const r=t.data.field(e),a=n.data.field(e);return null!==r&&null!==a?Uo(r,a):_s()}(e.field,t,n);switch(e.dir){case"asc":return r;case"desc":return-1*r;default:return _s()}}class Wl{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n)for(const[r,a]of n)if(this.equalsFn(r,e))return a}has(e){return void 0!==this.get(e)}set(e,t){const n=this.mapKeyFn(e),r=this.inner[n];if(void 0===r)return this.inner[n]=[[e,t]],void this.innerSize++;for(let a=0;a<r.length;a++)if(this.equalsFn(r[a][0],e))return void(r[a]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return 1===n.length?delete this.inner[t]:n.splice(r,1),this.innerSize--,!0;return!1}forEach(e){go(this.inner,((t,n)=>{for(const[r,a]of n)e(r,a)}))}isEmpty(){return vo(this.inner)}size(){return this.innerSize}}const Gl=new yo(Qs.comparator);function ql(){return Gl}const Kl=new yo(Qs.comparator);function Yl(){let e=Kl;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const a of n)e=e.insert(a.key,a);return e}function Ql(e){let t=Kl;return e.forEach(((e,n)=>t=t.insert(e,n.overlayedDocument))),t}function Xl(){return $l()}function Jl(){return $l()}function $l(){return new Wl((e=>e.toString()),((e,t)=>e.isEqual(t)))}const Zl=new yo(Qs.comparator),ec=new So(Qs.comparator);function tc(){let e=ec;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const a of n)e=e.add(a);return e}const nc=new So(Bs);function rc(){return nc}function ac(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:co(t)?"-0":t}}function ic(e){return{integerValue:""+e}}function sc(e,t){return uo(t)?ic(t):ac(e,t)}class oc{constructor(){this._=void 0}}function lc(e,t,n){return e instanceof hc?function(e,t){const n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&No(t)&&(t=Oo(t)),t&&(n.fields.__previous_value__=t),{mapValue:n}}(n,t):e instanceof dc?fc(e,t):e instanceof pc?mc(e,t):function(e,t){const n=uc(e,t),r=vc(n)+vc(e.Pe);return Wo(n)&&Wo(e.Pe)?ic(r):ac(e.serializer,r)}(e,t)}function cc(e,t,n){return e instanceof dc?fc(e,t):e instanceof pc?mc(e,t):n}function uc(e,t){return e instanceof gc?function(e){return Wo(e)||function(e){return!!e&&"doubleValue"in e}(e)}(t)?t:{integerValue:0}:null}class hc extends oc{}class dc extends oc{constructor(e){super(),this.elements=e}}function fc(e,t){const n=yc(t);for(const r of e.elements)n.some((e=>Mo(e,r)))||n.push(r);return{arrayValue:{values:n}}}class pc extends oc{constructor(e){super(),this.elements=e}}function mc(e,t){let n=yc(t);for(const r of e.elements)n=n.filter((e=>!Mo(e,r)));return{arrayValue:{values:n}}}class gc extends oc{constructor(e,t){super(),this.serializer=e,this.Pe=t}}function vc(e){return Co(e.integerValue||e.doubleValue)}function yc(e){return Go(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}class bc{constructor(e,t){this.version=e,this.transformResults=t}}class wc{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new wc}static exists(e){return new wc(void 0,e)}static updateTime(e){return new wc(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Sc(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}class Tc{}function Ec(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new Dc(e.key,wc.none()):new Cc(e.key,e.data,wc.none());{const n=e.data,r=Jo.empty();let a=new So(Ys.comparator);for(let e of t.fields)if(!a.has(e)){let t=n.field(e);null===t&&e.length>1&&(e=e.popLast(),t=n.field(e)),null===t?r.delete(e):r.set(e,t),a=a.add(e)}return new Ic(e.key,r,new Eo(a.toArray()),wc.none())}}function xc(e,t,n){e instanceof Cc?function(e,t,n){const r=e.value.clone(),a=Oc(e.fieldTransforms,t,n.transformResults);r.setAll(a),t.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(e,t,n):e instanceof Ic?function(e,t,n){if(!Sc(e.precondition,t))return void t.convertToUnknownDocument(n.version);const r=Oc(e.fieldTransforms,t,n.transformResults),a=t.data;a.setAll(Nc(e)),a.setAll(r),t.convertToFoundDocument(n.version,a).setHasCommittedMutations()}(e,t,n):function(e,t,n){t.convertToNoDocument(n.version).setHasCommittedMutations()}(0,t,n)}function _c(e,t,n,r){return e instanceof Cc?function(e,t,n,r){if(!Sc(e.precondition,t))return n;const a=e.value.clone(),i=Rc(e.fieldTransforms,r,t);return a.setAll(i),t.convertToFoundDocument(t.version,a).setHasLocalMutations(),null}(e,t,n,r):e instanceof Ic?function(e,t,n,r){if(!Sc(e.precondition,t))return n;const a=Rc(e.fieldTransforms,r,t),i=t.data;return i.setAll(Nc(e)),i.setAll(a),t.convertToFoundDocument(t.version,i).setHasLocalMutations(),null===n?null:n.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map((e=>e.field)))}(e,t,n,r):function(e,t,n){return Sc(e.precondition,t)?(t.convertToNoDocument(t.version).setHasLocalMutations(),null):n}(e,t,n)}function Ac(e,t){let n=null;for(const r of e.fieldTransforms){const e=t.data.field(r.field),a=uc(r.transform,e||null);null!=a&&(null===n&&(n=Jo.empty()),n.set(r.field,a))}return n||null}function kc(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(e,t){return void 0===e&&void 0===t||!(!e||!t)&&zs(e,t,((e,t)=>function(e,t){return e.field.isEqual(t.field)&&function(e,t){return e instanceof dc&&t instanceof dc||e instanceof pc&&t instanceof pc?zs(e.elements,t.elements,Mo):e instanceof gc&&t instanceof gc?Mo(e.Pe,t.Pe):e instanceof hc&&t instanceof hc}(e.transform,t.transform)}(e,t)))}(e.fieldTransforms,t.fieldTransforms)&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class Cc extends Tc{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class Ic extends Tc{constructor(e,t,n,r){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=r,this.fieldTransforms=a,this.type=1}getFieldMask(){return this.fieldMask}}function Nc(e){const t=new Map;return e.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){const r=e.data.field(n);t.set(n,r)}})),t}function Oc(e,t,n){const r=new Map;As(e.length===n.length);for(let a=0;a<n.length;a++){const i=e[a],s=i.transform,o=t.data.field(i.field);r.set(i.field,cc(s,o,n[a]))}return r}function Rc(e,t,n){const r=new Map;for(const a of e){const e=a.transform,i=n.data.field(a.field);r.set(a.field,lc(e,i,t))}return r}class Dc extends Tc{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class jc extends Tc{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class Pc{constructor(e,t,n,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=r}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const t=this.mutations[r];t.key.isEqual(e.key)&&xc(t,e,n[r])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=_c(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=_c(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=Jl();return this.mutations.forEach((r=>{const a=e.get(r.key),i=a.overlayedDocument;let s=this.applyToLocalView(i,a.mutatedFields);s=t.has(r.key)?null:s;const o=Ec(i,s);null!==o&&n.set(r.key,o),i.isValidDocument()||i.convertToNoDocument(Ws.min())})),n}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),tc())}isEqual(e){return this.batchId===e.batchId&&zs(this.mutations,e.mutations,((e,t)=>kc(e,t)))&&zs(this.baseMutations,e.baseMutations,((e,t)=>kc(e,t)))}}class Lc{constructor(e,t,n,r){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=r}static from(e,t,n){As(e.mutations.length===n.length);let r=Zl;const a=e.mutations;for(let i=0;i<a.length;i++)r=r.insert(a[i].key,n[i].version);return new Lc(e,t,n,r)}}class Mc{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return"Overlay{\n      largestBatchId: ".concat(this.largestBatchId,",\n      mutation: ").concat(this.mutation.toString(),"\n    }")}}class Fc{constructor(e,t){this.count=e,this.unchangedNames=t}}var Uc,Vc;function Bc(e){switch(e){default:return _s();case Cs.CANCELLED:case Cs.UNKNOWN:case Cs.DEADLINE_EXCEEDED:case Cs.RESOURCE_EXHAUSTED:case Cs.INTERNAL:case Cs.UNAVAILABLE:case Cs.UNAUTHENTICATED:return!1;case Cs.INVALID_ARGUMENT:case Cs.NOT_FOUND:case Cs.ALREADY_EXISTS:case Cs.PERMISSION_DENIED:case Cs.FAILED_PRECONDITION:case Cs.ABORTED:case Cs.OUT_OF_RANGE:case Cs.UNIMPLEMENTED:case Cs.DATA_LOSS:return!0}}function zc(e){if(void 0===e)return Ts("GRPC error has no .code"),Cs.UNKNOWN;switch(e){case Uc.OK:return Cs.OK;case Uc.CANCELLED:return Cs.CANCELLED;case Uc.UNKNOWN:return Cs.UNKNOWN;case Uc.DEADLINE_EXCEEDED:return Cs.DEADLINE_EXCEEDED;case Uc.RESOURCE_EXHAUSTED:return Cs.RESOURCE_EXHAUSTED;case Uc.INTERNAL:return Cs.INTERNAL;case Uc.UNAVAILABLE:return Cs.UNAVAILABLE;case Uc.UNAUTHENTICATED:return Cs.UNAUTHENTICATED;case Uc.INVALID_ARGUMENT:return Cs.INVALID_ARGUMENT;case Uc.NOT_FOUND:return Cs.NOT_FOUND;case Uc.ALREADY_EXISTS:return Cs.ALREADY_EXISTS;case Uc.PERMISSION_DENIED:return Cs.PERMISSION_DENIED;case Uc.FAILED_PRECONDITION:return Cs.FAILED_PRECONDITION;case Uc.ABORTED:return Cs.ABORTED;case Uc.OUT_OF_RANGE:return Cs.OUT_OF_RANGE;case Uc.UNIMPLEMENTED:return Cs.UNIMPLEMENTED;case Uc.DATA_LOSS:return Cs.DATA_LOSS;default:return _s()}}(Vc=Uc||(Uc={}))[Vc.OK=0]="OK",Vc[Vc.CANCELLED=1]="CANCELLED",Vc[Vc.UNKNOWN=2]="UNKNOWN",Vc[Vc.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Vc[Vc.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Vc[Vc.NOT_FOUND=5]="NOT_FOUND",Vc[Vc.ALREADY_EXISTS=6]="ALREADY_EXISTS",Vc[Vc.PERMISSION_DENIED=7]="PERMISSION_DENIED",Vc[Vc.UNAUTHENTICATED=16]="UNAUTHENTICATED",Vc[Vc.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Vc[Vc.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Vc[Vc.ABORTED=10]="ABORTED",Vc[Vc.OUT_OF_RANGE=11]="OUT_OF_RANGE",Vc[Vc.UNIMPLEMENTED=12]="UNIMPLEMENTED",Vc[Vc.INTERNAL=13]="INTERNAL",Vc[Vc.UNAVAILABLE=14]="UNAVAILABLE",Vc[Vc.DATA_LOSS=15]="DATA_LOSS";let Hc=null;function Wc(){return new TextEncoder}const Gc=new ts([4294967295,4294967295],0);function qc(e){const t=Wc().encode(e),n=new ns;return n.update(t),new Uint8Array(n.digest())}function Kc(e){const t=new DataView(e.buffer),n=t.getUint32(0,!0),r=t.getUint32(4,!0),a=t.getUint32(8,!0),i=t.getUint32(12,!0);return[new ts([n,r],0),new ts([a,i],0)]}class Yc{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new Qc("Invalid padding: ".concat(t));if(n<0)throw new Qc("Invalid hash count: ".concat(n));if(e.length>0&&0===this.hashCount)throw new Qc("Invalid hash count: ".concat(n));if(0===e.length&&0!==t)throw new Qc("Invalid padding when bitmap length is 0: ".concat(t));this.Ie=8*e.length-t,this.Te=ts.fromNumber(this.Ie)}Ee(e,t,n){let r=e.add(t.multiply(ts.fromNumber(n)));return 1===r.compare(Gc)&&(r=new ts([r.getBits(0),r.getBits(1)],0)),r.modulo(this.Te).toNumber()}de(e){return 0!=(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(0===this.Ie)return!1;const t=qc(e),[n,r]=Kc(t);for(let a=0;a<this.hashCount;a++){const e=this.Ee(n,r,a);if(!this.de(e))return!1}return!0}static create(e,t,n){const r=e%8==0?0:8-e%8,a=new Uint8Array(Math.ceil(e/8)),i=new Yc(a,r,t);return n.forEach((e=>i.insert(e))),i}insert(e){if(0===this.Ie)return;const t=qc(e),[n,r]=Kc(t);for(let a=0;a<this.hashCount;a++){const e=this.Ee(n,r,a);this.Ae(e)}}Ae(e){const t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}class Qc extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class Xc{constructor(e,t,n,r,a){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=a}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const r=new Map;return r.set(e,Jc.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new Xc(Ws.min(),r,new yo(Bs),ql(),tc())}}class Jc{constructor(e,t,n,r,a){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=a}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new Jc(n,t,tc(),tc(),tc())}}class $c{constructor(e,t,n,r){this.Re=e,this.removedTargetIds=t,this.key=n,this.Ve=r}}class Zc{constructor(e,t){this.targetId=e,this.me=t}}class eu{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:_o.EMPTY_BYTE_STRING,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=r}}class tu{constructor(){this.fe=0,this.ge=au(),this.pe=_o.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return 0!==this.fe}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}Ce(){let e=tc(),t=tc(),n=tc();return this.ge.forEach(((r,a)=>{switch(a){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:_s()}})),new Jc(this.pe,this.ye,e,t,n)}ve(){this.we=!1,this.ge=au()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,As(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class nu{constructor(e){this.Le=e,this.Be=new Map,this.ke=ql(),this.qe=ru(),this.Qe=new yo(Bs)}Ke(e){for(const t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(const t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,(t=>{const n=this.Ge(t);switch(e.state){case 0:this.ze(t)&&n.De(e.resumeToken);break;case 1:n.Oe(),n.Se||n.ve(),n.De(e.resumeToken);break;case 2:n.Oe(),n.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(n.Ne(),n.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),n.De(e.resumeToken));break;default:_s()}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach(((e,n)=>{this.ze(n)&&t(n)}))}He(e){const t=e.targetId,n=e.me.count,r=this.Je(t);if(r){const a=r.target;if(Al(a))if(0===n){const e=new Qs(a.path);this.Ue(t,e,Zo.newNoDocument(e,Ws.min()))}else As(1===n);else{const r=this.Ye(t);if(r!==n){const n=this.Ze(e),a=n?this.Xe(n,e,r):1;if(0!==a){this.je(t);const e=2===a?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,e)}null==Hc||Hc.et(function(e,t,n,r,a){var i,s,o,l,c,u;const h={localCacheCount:e,existenceFilterCount:t.count,databaseId:n.database,projectId:n.projectId},d=t.unchangedNames;return d&&(h.bloomFilter={applied:0===a,hashCount:null!==(i=null==d?void 0:d.hashCount)&&void 0!==i?i:0,bitmapLength:null!==(l=null===(o=null===(s=null==d?void 0:d.bits)||void 0===s?void 0:s.bitmap)||void 0===o?void 0:o.length)&&void 0!==l?l:0,padding:null!==(u=null===(c=null==d?void 0:d.bits)||void 0===c?void 0:c.padding)&&void 0!==u?u:0,mightContain:e=>{var t;return null!==(t=null==r?void 0:r.mightContain(e))&&void 0!==t&&t}}),h}(r,e.me,this.Le.tt(),n,a))}}}}Ze(e){const t=e.me.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:n="",padding:r=0},hashCount:a=0}=t;let i,s;try{i=Io(n).toUint8Array()}catch(e){if(e instanceof xo)return Es("Decoding the base64 bloom filter in existence filter failed ("+e.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw e}try{s=new Yc(i,r,a)}catch(e){return Es(e instanceof Qc?"BloomFilter error: ":"Applying bloom filter failed: ",e),null}return 0===s.Ie?null:s}Xe(e,t,n){return t.me.count===n-this.nt(e,t.targetId)?0:2}nt(e,t){const n=this.Le.getRemoteKeysForTarget(t);let r=0;return n.forEach((n=>{const a=this.Le.tt(),i="projects/".concat(a.projectId,"/databases/").concat(a.database,"/documents/").concat(n.path.canonicalString());e.mightContain(i)||(this.Ue(t,n,null),r++)})),r}rt(e){const t=new Map;this.Be.forEach(((n,r)=>{const a=this.Je(r);if(a){if(n.current&&Al(a.target)){const t=new Qs(a.target.path);null!==this.ke.get(t)||this.it(r,t)||this.Ue(r,t,Zo.newNoDocument(t,e))}n.be&&(t.set(r,n.Ce()),n.ve())}}));let n=tc();this.qe.forEach(((e,t)=>{let r=!0;t.forEachWhile((e=>{const t=this.Je(e);return!t||"TargetPurposeLimboResolution"===t.purpose||(r=!1,!1)})),r&&(n=n.add(e))})),this.ke.forEach(((t,n)=>n.setReadTime(e)));const r=new Xc(e,t,this.Qe,this.ke,n);return this.ke=ql(),this.qe=ru(),this.Qe=new yo(Bs),r}$e(e,t){if(!this.ze(e))return;const n=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,n),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,n){if(!this.ze(e))return;const r=this.Ge(e);this.it(e,t)?r.Fe(t,1):r.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),n&&(this.ke=this.ke.insert(t,n))}removeTarget(e){this.Be.delete(e)}Ye(e){const t=this.Ge(e).Ce();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new tu,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new So(Bs),this.qe=this.qe.insert(e,t)),t}ze(e){const t=null!==this.Je(e);return t||Ss("WatchChangeAggregator","Detected inactive target",e),t}Je(e){const t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new tu),this.Le.getRemoteKeysForTarget(e).forEach((t=>{this.Ue(e,t,null)}))}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}}function ru(){return new yo(Qs.comparator)}function au(){return new yo(Qs.comparator)}const iu={asc:"ASCENDING",desc:"DESCENDING"},su={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},ou={and:"AND",or:"OR"};class lu{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function cu(e,t){return e.useProto3Json||lo(t)?t:{value:t}}function uu(e,t){return e.useProto3Json?"".concat(new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z",""),".").concat(("000000000"+t.nanoseconds).slice(-9),"Z"):{seconds:""+t.seconds,nanos:t.nanoseconds}}function hu(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function du(e,t){return uu(e,t.toTimestamp())}function fu(e){return As(!!e),Ws.fromTimestamp(function(e){const t=ko(e);return new Hs(t.seconds,t.nanos)}(e))}function pu(e,t){return mu(e,t).canonicalString()}function mu(e,t){const n=function(e){return new qs(["projects",e.projectId,"databases",e.database])}(e).child("documents");return void 0===t?n:n.child(t)}function gu(e){const t=qs.fromString(e);return As(Lu(t)),t}function vu(e,t){return pu(e.databaseId,t.path)}function yu(e,t){const n=gu(t);if(n.get(1)!==e.databaseId.projectId)throw new Is(Cs.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new Is(Cs.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new Qs(Tu(n))}function bu(e,t){return pu(e.databaseId,t)}function wu(e){const t=gu(e);return 4===t.length?qs.emptyPath():Tu(t)}function Su(e){return new qs(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function Tu(e){return As(e.length>4&&"documents"===e.get(4)),e.popFirst(5)}function Eu(e,t,n){return{name:vu(e,t),fields:n.value.mapValue.fields}}function xu(e,t){let n;if(t instanceof Cc)n={update:Eu(e,t.key,t.value)};else if(t instanceof Dc)n={delete:vu(e,t.key)};else if(t instanceof Ic)n={update:Eu(e,t.key,t.data),updateMask:Pu(t.fieldMask)};else{if(!(t instanceof jc))return _s();n={verify:vu(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map((e=>function(e,t){const n=t.transform;if(n instanceof hc)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof dc)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof pc)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof gc)return{fieldPath:t.field.canonicalString(),increment:n.Pe};throw _s()}(0,e)))),t.precondition.isNone||(n.currentDocument=function(e,t){return void 0!==t.updateTime?{updateTime:du(e,t.updateTime)}:void 0!==t.exists?{exists:t.exists}:_s()}(e,t.precondition)),n}function _u(e,t){return{documents:[bu(e,t.path)]}}function Au(e,t){const n={structuredQuery:{}},r=t.path;let a;null!==t.collectionGroup?(a=r,n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(a=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=bu(e,a);const i=function(e){if(0!==e.length)return ju(ol.create(e,"and"))}(t.filters);i&&(n.structuredQuery.where=i);const s=function(e){if(0!==e.length)return e.map((e=>function(e){return{field:Ru(e.field),direction:Iu(e.dir)}}(e)))}(t.orderBy);s&&(n.structuredQuery.orderBy=s);const o=cu(e,t.limit);return null!==o&&(n.structuredQuery.limit=o),t.startAt&&(n.structuredQuery.startAt=function(e){return{before:e.inclusive,values:e.position}}(t.startAt)),t.endAt&&(n.structuredQuery.endAt=function(e){return{before:!e.inclusive,values:e.position}}(t.endAt)),{_t:n,parent:a}}function ku(e){let t=wu(e.parent);const n=e.structuredQuery,r=n.from?n.from.length:0;let a=null;if(r>0){As(1===r);const e=n.from[0];e.allDescendants?a=e.collectionId:t=t.child(e.collectionId)}let i=[];n.where&&(i=function(e){const t=Cu(e);return t instanceof ol&&cl(t)?t.getFilters():[t]}(n.where));let s=[];n.orderBy&&(s=function(e){return e.map((e=>function(e){return new rl(Du(e.field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction))}(e)))}(n.orderBy));let o=null;n.limit&&(o=function(e){let t;return t="object"==typeof e?e.value:e,lo(t)?null:t}(n.limit));let l=null;n.startAt&&(l=function(e){const t=!!e.before,n=e.values||[];return new el(n,t)}(n.startAt));let c=null;return n.endAt&&(c=function(e){const t=!e.before,n=e.values||[];return new el(n,t)}(n.endAt)),Cl(t,a,s,i,o,"F",l,c)}function Cu(e){return void 0!==e.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":const t=Du(e.unaryFilter.field);return sl.create(t,"==",{doubleValue:NaN});case"IS_NULL":const n=Du(e.unaryFilter.field);return sl.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=Du(e.unaryFilter.field);return sl.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=Du(e.unaryFilter.field);return sl.create(a,"!=",{nullValue:"NULL_VALUE"});default:return _s()}}(e):void 0!==e.fieldFilter?function(e){return sl.create(Du(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return _s()}}(e.fieldFilter.op),e.fieldFilter.value)}(e):void 0!==e.compositeFilter?function(e){return ol.create(e.compositeFilter.filters.map((e=>Cu(e))),function(e){switch(e){case"AND":return"and";case"OR":return"or";default:return _s()}}(e.compositeFilter.op))}(e):_s()}function Iu(e){return iu[e]}function Nu(e){return su[e]}function Ou(e){return ou[e]}function Ru(e){return{fieldPath:e.canonicalString()}}function Du(e){return Ys.fromServerFormat(e.fieldPath)}function ju(e){return e instanceof sl?function(e){if("=="===e.op){if(Ko(e.value))return{unaryFilter:{field:Ru(e.field),op:"IS_NAN"}};if(qo(e.value))return{unaryFilter:{field:Ru(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(Ko(e.value))return{unaryFilter:{field:Ru(e.field),op:"IS_NOT_NAN"}};if(qo(e.value))return{unaryFilter:{field:Ru(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ru(e.field),op:Nu(e.op),value:e.value}}}(e):e instanceof ol?function(e){const t=e.getFilters().map((e=>ju(e)));return 1===t.length?t[0]:{compositeFilter:{op:Ou(e.op),filters:t}}}(e):_s()}function Pu(e){const t=[];return e.fields.forEach((e=>t.push(e.canonicalString()))),{fieldPaths:t}}function Lu(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}class Mu{constructor(e,t,n,r){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Ws.min(),i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:Ws.min(),s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:_o.EMPTY_BYTE_STRING,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=i,this.resumeToken=s,this.expectedCount=o}withSequenceNumber(e){return new Mu(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Mu(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Mu(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Mu(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class Fu{constructor(e){this.ct=e}}function Uu(e){const t=ku({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?Ll(t,t.limit,"L"):t}class Vu{constructor(){}Pt(e,t){this.It(e,t),t.Tt()}It(e,t){if("nullValue"in e)this.Et(t,5);else if("booleanValue"in e)this.Et(t,10),t.dt(e.booleanValue?1:0);else if("integerValue"in e)this.Et(t,15),t.dt(Co(e.integerValue));else if("doubleValue"in e){const n=Co(e.doubleValue);isNaN(n)?this.Et(t,13):(this.Et(t,15),co(n)?t.dt(0):t.dt(n))}else if("timestampValue"in e){let n=e.timestampValue;this.Et(t,20),"string"==typeof n&&(n=ko(n)),t.At("".concat(n.seconds||"")),t.dt(n.nanos||0)}else if("stringValue"in e)this.Rt(e.stringValue,t),this.Vt(t);else if("bytesValue"in e)this.Et(t,30),t.ft(Io(e.bytesValue)),this.Vt(t);else if("referenceValue"in e)this.gt(e.referenceValue,t);else if("geoPointValue"in e){const n=e.geoPointValue;this.Et(t,45),t.dt(n.latitude||0),t.dt(n.longitude||0)}else"mapValue"in e?Xo(e)?this.Et(t,Number.MAX_SAFE_INTEGER):(this.yt(e.mapValue,t),this.Vt(t)):"arrayValue"in e?(this.wt(e.arrayValue,t),this.Vt(t)):_s()}Rt(e,t){this.Et(t,25),this.St(e,t)}St(e,t){t.At(e)}yt(e,t){const n=e.fields||{};this.Et(t,55);for(const r of Object.keys(n))this.Rt(r,t),this.It(n[r],t)}wt(e,t){const n=e.values||[];this.Et(t,50);for(const r of n)this.It(r,t)}gt(e,t){this.Et(t,37),Qs.fromName(e).path.forEach((e=>{this.Et(t,60),this.St(e,t)}))}Et(e,t){e.dt(t)}Vt(e){e.dt(2)}}Vu.bt=new Vu;class Bu{constructor(){this._n=new zu}addToCollectionParentIndex(e,t){return this._n.add(t),ao.resolve()}getCollectionParents(e,t){return ao.resolve(this._n.getEntries(t))}addFieldIndex(e,t){return ao.resolve()}deleteFieldIndex(e,t){return ao.resolve()}deleteAllFieldIndexes(e){return ao.resolve()}createTargetIndexes(e,t){return ao.resolve()}getDocumentsMatchingTarget(e,t){return ao.resolve(null)}getIndexType(e,t){return ao.resolve(0)}getFieldIndexes(e,t){return ao.resolve([])}getNextCollectionGroupToUpdate(e){return ao.resolve(null)}getMinOffset(e,t){return ao.resolve(Zs.min())}getMinOffsetFromCollectionGroup(e,t){return ao.resolve(Zs.min())}updateCollectionGroup(e,t,n){return ao.resolve()}updateIndexEntries(e,t){return ao.resolve()}}class zu{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new So(qs.comparator),a=!r.has(n);return this.index[t]=r.add(n),a}has(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}getEntries(e){return(this.index[e]||new So(qs.comparator)).toArray()}}new Uint8Array(0);class Hu{constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}static withCacheSize(e){return new Hu(e,Hu.DEFAULT_COLLECTION_PERCENTILE,Hu.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}Hu.DEFAULT_COLLECTION_PERCENTILE=10,Hu.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Hu.DEFAULT=new Hu(41943040,Hu.DEFAULT_COLLECTION_PERCENTILE,Hu.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Hu.DISABLED=new Hu(-1,0,0);class Wu{constructor(e){this.On=e}next(){return this.On+=2,this.On}static Nn(){return new Wu(0)}static Ln(){return new Wu(-1)}}class Gu{constructor(){this.changes=new Wl((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Zo.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return void 0!==n?ao.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class qu{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class Ku{constructor(e,t,n,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=r}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next((r=>(n=r,this.remoteDocumentCache.getEntry(e,t)))).next((e=>(null!==n&&_c(n.mutation,e,Eo.empty(),Hs.now()),e)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((t=>this.getLocalViewOfDocuments(e,t,tc()).next((()=>t))))}getLocalViewOfDocuments(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:tc();const r=Xl();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,n).next((e=>{let t=Yl();return e.forEach(((e,n)=>{t=t.insert(e,n.overlayedDocument)})),t}))))}getOverlayedDocuments(e,t){const n=Xl();return this.populateOverlays(e,n,t).next((()=>this.computeViews(e,t,n,tc())))}populateOverlays(e,t,n){const r=[];return n.forEach((e=>{t.has(e)||r.push(e)})),this.documentOverlayCache.getOverlays(e,r).next((e=>{e.forEach(((e,n)=>{t.set(e,n)}))}))}computeViews(e,t,n,r){let a=ql();const i=$l(),s=$l();return t.forEach(((e,t)=>{const s=n.get(t.key);r.has(t.key)&&(void 0===s||s.mutation instanceof Ic)?a=a.insert(t.key,t):void 0!==s?(i.set(t.key,s.mutation.getFieldMask()),_c(s.mutation,t,s.mutation.getFieldMask(),Hs.now())):i.set(t.key,Eo.empty())})),this.recalculateAndSaveOverlays(e,a).next((e=>(e.forEach(((e,t)=>i.set(e,t))),t.forEach(((e,t)=>{var n;return s.set(e,new qu(t,null!==(n=i.get(e))&&void 0!==n?n:null))})),s)))}recalculateAndSaveOverlays(e,t){const n=$l();let r=new yo(((e,t)=>e-t)),a=tc();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((e=>{for(const a of e)a.keys().forEach((e=>{const i=t.get(e);if(null===i)return;let s=n.get(e)||Eo.empty();s=a.applyToLocalView(i,s),n.set(e,s);const o=(r.get(a.batchId)||tc()).add(e);r=r.insert(a.batchId,o)}))})).next((()=>{const i=[],s=r.getReverseIterator();for(;s.hasNext();){const r=s.getNext(),o=r.key,l=r.value,c=Jl();l.forEach((e=>{if(!a.has(e)){const r=Ec(t.get(e),n.get(e));null!==r&&c.set(e,r),a=a.add(e)}})),i.push(this.documentOverlayCache.saveOverlays(e,o,c))}return ao.waitFor(i)})).next((()=>n))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((t=>this.recalculateAndSaveOverlays(e,t)))}getDocumentsMatchingQuery(e,t,n,r){return function(e){return Qs.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Ol(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,r):this.getDocumentsMatchingCollectionQuery(e,t,n,r)}getNextDocuments(e,t,n,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,r).next((a=>{const i=r-a.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,r-a.size):ao.resolve(Xl());let s=-1,o=a;return i.next((t=>ao.forEach(t,((t,n)=>(s<n.largestBatchId&&(s=n.largestBatchId),a.get(t)?ao.resolve():this.remoteDocumentCache.getEntry(e,t).next((e=>{o=o.insert(t,e)}))))).next((()=>this.populateOverlays(e,t,a))).next((()=>this.computeViews(e,o,t,tc()))).next((e=>({batchId:s,changes:Ql(e)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Qs(t)).next((e=>{let t=Yl();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t}))}getDocumentsMatchingCollectionGroupQuery(e,t,n,r){const a=t.collectionGroup;let i=Yl();return this.indexManager.getCollectionParents(e,a).next((s=>ao.forEach(s,(s=>{const o=function(e,t){return new kl(t,null,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(t,s.child(a));return this.getDocumentsMatchingCollectionQuery(e,o,n,r).next((e=>{e.forEach(((e,t)=>{i=i.insert(e,t)}))}))})).next((()=>i))))}getDocumentsMatchingCollectionQuery(e,t,n,r){let a;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next((i=>(a=i,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,a,r)))).next((e=>{a.forEach(((t,n)=>{const r=n.getKey();null===e.get(r)&&(e=e.insert(r,Zo.newInvalidDocument(r)))}));let n=Yl();return e.forEach(((e,r)=>{const i=a.get(e);void 0!==i&&_c(i.mutation,r,Eo.empty(),Hs.now()),Vl(t,r)&&(n=n.insert(e,r))})),n}))}}class Yu{constructor(e){this.serializer=e,this.cr=new Map,this.lr=new Map}getBundleMetadata(e,t){return ao.resolve(this.cr.get(t))}saveBundleMetadata(e,t){return this.cr.set(t.id,function(e){return{id:e.id,version:e.version,createTime:fu(e.createTime)}}(t)),ao.resolve()}getNamedQuery(e,t){return ao.resolve(this.lr.get(t))}saveNamedQuery(e,t){return this.lr.set(t.name,function(e){return{name:e.name,query:Uu(e.bundledQuery),readTime:fu(e.readTime)}}(t)),ao.resolve()}}class Qu{constructor(){this.overlays=new yo(Qs.comparator),this.hr=new Map}getOverlay(e,t){return ao.resolve(this.overlays.get(t))}getOverlays(e,t){const n=Xl();return ao.forEach(t,(t=>this.getOverlay(e,t).next((e=>{null!==e&&n.set(t,e)})))).next((()=>n))}saveOverlays(e,t,n){return n.forEach(((n,r)=>{this.ht(e,t,r)})),ao.resolve()}removeOverlaysForBatchId(e,t,n){const r=this.hr.get(n);return void 0!==r&&(r.forEach((e=>this.overlays=this.overlays.remove(e))),this.hr.delete(n)),ao.resolve()}getOverlaysForCollection(e,t,n){const r=Xl(),a=t.length+1,i=new Qs(t.child("")),s=this.overlays.getIteratorFrom(i);for(;s.hasNext();){const e=s.getNext().value,i=e.getKey();if(!t.isPrefixOf(i.path))break;i.path.length===a&&e.largestBatchId>n&&r.set(e.getKey(),e)}return ao.resolve(r)}getOverlaysForCollectionGroup(e,t,n,r){let a=new yo(((e,t)=>e-t));const i=this.overlays.getIterator();for(;i.hasNext();){const e=i.getNext().value;if(e.getKey().getCollectionGroup()===t&&e.largestBatchId>n){let t=a.get(e.largestBatchId);null===t&&(t=Xl(),a=a.insert(e.largestBatchId,t)),t.set(e.getKey(),e)}}const s=Xl(),o=a.getIterator();for(;o.hasNext()&&(o.getNext().value.forEach(((e,t)=>s.set(e,t))),!(s.size()>=r)););return ao.resolve(s)}ht(e,t,n){const r=this.overlays.get(n.key);if(null!==r){const e=this.hr.get(r.largestBatchId).delete(n.key);this.hr.set(r.largestBatchId,e)}this.overlays=this.overlays.insert(n.key,new Mc(t,n));let a=this.hr.get(t);void 0===a&&(a=tc(),this.hr.set(t,a)),this.hr.set(t,a.add(n.key))}}class Xu{constructor(){this.Pr=new So(Ju.Ir),this.Tr=new So(Ju.Er)}isEmpty(){return this.Pr.isEmpty()}addReference(e,t){const n=new Ju(e,t);this.Pr=this.Pr.add(n),this.Tr=this.Tr.add(n)}dr(e,t){e.forEach((e=>this.addReference(e,t)))}removeReference(e,t){this.Ar(new Ju(e,t))}Rr(e,t){e.forEach((e=>this.removeReference(e,t)))}Vr(e){const t=new Qs(new qs([])),n=new Ju(t,e),r=new Ju(t,e+1),a=[];return this.Tr.forEachInRange([n,r],(e=>{this.Ar(e),a.push(e.key)})),a}mr(){this.Pr.forEach((e=>this.Ar(e)))}Ar(e){this.Pr=this.Pr.delete(e),this.Tr=this.Tr.delete(e)}gr(e){const t=new Qs(new qs([])),n=new Ju(t,e),r=new Ju(t,e+1);let a=tc();return this.Tr.forEachInRange([n,r],(e=>{a=a.add(e.key)})),a}containsKey(e){const t=new Ju(e,0),n=this.Pr.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}class Ju{constructor(e,t){this.key=e,this.pr=t}static Ir(e,t){return Qs.comparator(e.key,t.key)||Bs(e.pr,t.pr)}static Er(e,t){return Bs(e.pr,t.pr)||Qs.comparator(e.key,t.key)}}class $u{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.yr=1,this.wr=new So(Ju.Ir)}checkEmpty(e){return ao.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,n,r){const a=this.yr;this.yr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const i=new Pc(a,t,n,r);this.mutationQueue.push(i);for(const s of r)this.wr=this.wr.add(new Ju(s.key,a)),this.indexManager.addToCollectionParentIndex(e,s.key.path.popLast());return ao.resolve(i)}lookupMutationBatch(e,t){return ao.resolve(this.Sr(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,r=this.br(n),a=r<0?0:r;return ao.resolve(this.mutationQueue.length>a?this.mutationQueue[a]:null)}getHighestUnacknowledgedBatchId(){return ao.resolve(0===this.mutationQueue.length?-1:this.yr-1)}getAllMutationBatches(e){return ao.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new Ju(t,0),r=new Ju(t,Number.POSITIVE_INFINITY),a=[];return this.wr.forEachInRange([n,r],(e=>{const t=this.Sr(e.pr);a.push(t)})),ao.resolve(a)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new So(Bs);return t.forEach((e=>{const t=new Ju(e,0),r=new Ju(e,Number.POSITIVE_INFINITY);this.wr.forEachInRange([t,r],(e=>{n=n.add(e.pr)}))})),ao.resolve(this.Dr(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1;let a=n;Qs.isDocumentKey(a)||(a=a.child(""));const i=new Ju(new Qs(a),0);let s=new So(Bs);return this.wr.forEachWhile((e=>{const t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(s=s.add(e.pr)),!0)}),i),ao.resolve(this.Dr(s))}Dr(e){const t=[];return e.forEach((e=>{const n=this.Sr(e);null!==n&&t.push(n)})),t}removeMutationBatch(e,t){As(0===this.Cr(t.batchId,"removed")),this.mutationQueue.shift();let n=this.wr;return ao.forEach(t.mutations,(r=>{const a=new Ju(r.key,t.batchId);return n=n.delete(a),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)})).next((()=>{this.wr=n}))}Mn(e){}containsKey(e,t){const n=new Ju(t,0),r=this.wr.firstAfterOrEqual(n);return ao.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,ao.resolve()}Cr(e,t){return this.br(e)}br(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}Sr(e){const t=this.br(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class Zu{constructor(e){this.vr=e,this.docs=new yo(Qs.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,r=this.docs.get(n),a=r?r.size:0,i=this.vr(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:i}),this.size+=i-a,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return ao.resolve(n?n.document.mutableCopy():Zo.newInvalidDocument(t))}getEntries(e,t){let n=ql();return t.forEach((e=>{const t=this.docs.get(e);n=n.insert(e,t?t.document.mutableCopy():Zo.newInvalidDocument(e))})),ao.resolve(n)}getDocumentsMatchingQuery(e,t,n,r){let a=ql();const i=t.path,s=new Qs(i.child("")),o=this.docs.getIteratorFrom(s);for(;o.hasNext();){const{key:e,value:{document:s}}=o.getNext();if(!i.isPrefixOf(e.path))break;e.path.length>i.length+1||eo($s(s),n)<=0||(r.has(s.key)||Vl(t,s))&&(a=a.insert(s.key,s.mutableCopy()))}return ao.resolve(a)}getAllFromCollectionGroup(e,t,n,r){_s()}Fr(e,t){return ao.forEach(this.docs,(e=>t(e)))}newChangeBuffer(e){return new eh(this)}getSize(e){return ao.resolve(this.size)}}class eh extends Gu{constructor(e){super(),this.ar=e}applyChanges(e){const t=[];return this.changes.forEach(((n,r)=>{r.isValidDocument()?t.push(this.ar.addEntry(e,r)):this.ar.removeEntry(n)})),ao.waitFor(t)}getFromCache(e,t){return this.ar.getEntry(e,t)}getAllFromCache(e,t){return this.ar.getEntries(e,t)}}class th{constructor(e){this.persistence=e,this.Mr=new Wl((e=>xl(e)),_l),this.lastRemoteSnapshotVersion=Ws.min(),this.highestTargetId=0,this.Or=0,this.Nr=new Xu,this.targetCount=0,this.Lr=Wu.Nn()}forEachTarget(e,t){return this.Mr.forEach(((e,n)=>t(n))),ao.resolve()}getLastRemoteSnapshotVersion(e){return ao.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ao.resolve(this.Or)}allocateTargetId(e){return this.highestTargetId=this.Lr.next(),ao.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.Or&&(this.Or=t),ao.resolve()}qn(e){this.Mr.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.Lr=new Wu(t),this.highestTargetId=t),e.sequenceNumber>this.Or&&(this.Or=e.sequenceNumber)}addTargetData(e,t){return this.qn(t),this.targetCount+=1,ao.resolve()}updateTargetData(e,t){return this.qn(t),ao.resolve()}removeTargetData(e,t){return this.Mr.delete(t.target),this.Nr.Vr(t.targetId),this.targetCount-=1,ao.resolve()}removeTargets(e,t,n){let r=0;const a=[];return this.Mr.forEach(((i,s)=>{s.sequenceNumber<=t&&null===n.get(s.targetId)&&(this.Mr.delete(i),a.push(this.removeMatchingKeysForTargetId(e,s.targetId)),r++)})),ao.waitFor(a).next((()=>r))}getTargetCount(e){return ao.resolve(this.targetCount)}getTargetData(e,t){const n=this.Mr.get(t)||null;return ao.resolve(n)}addMatchingKeys(e,t,n){return this.Nr.dr(t,n),ao.resolve()}removeMatchingKeys(e,t,n){this.Nr.Rr(t,n);const r=this.persistence.referenceDelegate,a=[];return r&&t.forEach((t=>{a.push(r.markPotentiallyOrphaned(e,t))})),ao.waitFor(a)}removeMatchingKeysForTargetId(e,t){return this.Nr.Vr(t),ao.resolve()}getMatchingKeysForTargetId(e,t){const n=this.Nr.gr(t);return ao.resolve(n)}containsKey(e,t){return ao.resolve(this.Nr.containsKey(t))}}class nh{constructor(e,t){this.Br={},this.overlays={},this.kr=new oo(0),this.qr=!1,this.qr=!0,this.referenceDelegate=e(this),this.Qr=new th(this),this.indexManager=new Bu,this.remoteDocumentCache=function(e){return new Zu(e)}((e=>this.referenceDelegate.Kr(e))),this.serializer=new Fu(t),this.$r=new Yu(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.qr=!1,Promise.resolve()}get started(){return this.qr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new Qu,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.Br[e.toKey()];return n||(n=new $u(t,this.referenceDelegate),this.Br[e.toKey()]=n),n}getTargetCache(){return this.Qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.$r}runTransaction(e,t,n){Ss("MemoryPersistence","Starting transaction:",e);const r=new rh(this.kr.next());return this.referenceDelegate.Ur(),n(r).next((e=>this.referenceDelegate.Wr(r).next((()=>e)))).toPromise().then((e=>(r.raiseOnCommittedEvent(),e)))}Gr(e,t){return ao.or(Object.values(this.Br).map((n=>()=>n.containsKey(e,t))))}}class rh extends no{constructor(e){super(),this.currentSequenceNumber=e}}class ah{constructor(e){this.persistence=e,this.zr=new Xu,this.jr=null}static Hr(e){return new ah(e)}get Jr(){if(this.jr)return this.jr;throw _s()}addReference(e,t,n){return this.zr.addReference(n,t),this.Jr.delete(n.toString()),ao.resolve()}removeReference(e,t,n){return this.zr.removeReference(n,t),this.Jr.add(n.toString()),ao.resolve()}markPotentiallyOrphaned(e,t){return this.Jr.add(t.toString()),ao.resolve()}removeTarget(e,t){this.zr.Vr(t.targetId).forEach((e=>this.Jr.add(e.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next((e=>{e.forEach((e=>this.Jr.add(e.toString())))})).next((()=>n.removeTargetData(e,t)))}Ur(){this.jr=new Set}Wr(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ao.forEach(this.Jr,(n=>{const r=Qs.fromPath(n);return this.Yr(e,r).next((e=>{e||t.removeEntry(r,Ws.min())}))})).next((()=>(this.jr=null,t.apply(e))))}updateLimboDocument(e,t){return this.Yr(e,t).next((e=>{e?this.Jr.delete(t.toString()):this.Jr.add(t.toString())}))}Kr(e){return 0}Yr(e,t){return ao.or([()=>ao.resolve(this.zr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Gr(e,t)])}}class ih{constructor(e,t,n,r){this.targetId=e,this.fromCache=t,this.qi=n,this.Qi=r}static Ki(e,t){let n=tc(),r=tc();for(const a of t.docChanges)switch(a.type){case 0:n=n.add(a.doc.key);break;case 1:r=r.add(a.doc.key)}return new ih(e,t.fromCache,n,r)}}class sh{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class oh{constructor(){this.$i=!1,this.Ui=!1,this.Wi=100,this.Gi=qe()?8:io(Ge())>0?6:4}initialize(e,t){this.zi=e,this.indexManager=t,this.$i=!0}getDocumentsMatchingQuery(e,t,n,r){const a={result:null};return this.ji(e,t).next((e=>{a.result=e})).next((()=>{if(!a.result)return this.Hi(e,t,r,n).next((e=>{a.result=e}))})).next((()=>{if(a.result)return;const n=new sh;return this.Ji(e,t,n).next((r=>{if(a.result=r,this.Ui)return this.Yi(e,t,n,r.size)}))})).next((()=>a.result))}Yi(e,t,n,r){return n.documentReadCount<this.Wi?(ws()<=ut.DEBUG&&Ss("QueryEngine","SDK will not create cache indexes for query:",Ul(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Wi,"documents"),ao.resolve()):(ws()<=ut.DEBUG&&Ss("QueryEngine","Query:",Ul(t),"scans",n.documentReadCount,"local documents and returns",r,"documents as results."),n.documentReadCount>this.Gi*r?(ws()<=ut.DEBUG&&Ss("QueryEngine","The SDK decides to create cache indexes for query:",Ul(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Dl(t))):ao.resolve())}ji(e,t){if(Nl(t))return ao.resolve(null);let n=Dl(t);return this.indexManager.getIndexType(e,n).next((r=>0===r?null:(null!==t.limit&&1===r&&(t=Ll(t,null,"F"),n=Dl(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next((r=>{const a=tc(...r);return this.zi.getDocuments(e,a).next((r=>this.indexManager.getMinOffset(e,n).next((n=>{const i=this.Zi(t,r);return this.Xi(t,i,a,n.readTime)?this.ji(e,Ll(t,null,"F")):this.es(e,i,t,n)}))))})))))}Hi(e,t,n,r){return Nl(t)||r.isEqual(Ws.min())?ao.resolve(null):this.zi.getDocuments(e,n).next((a=>{const i=this.Zi(t,a);return this.Xi(t,i,n,r)?ao.resolve(null):(ws()<=ut.DEBUG&&Ss("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),Ul(t)),this.es(e,i,t,Js(r,-1)).next((e=>e)))}))}Zi(e,t){let n=new So(zl(e));return t.forEach(((t,r)=>{Vl(e,r)&&(n=n.add(r))})),n}Xi(e,t,n,r){if(null===e.limit)return!1;if(n.size!==t.size)return!0;const a="F"===e.limitType?t.last():t.first();return!!a&&(a.hasPendingWrites||a.version.compareTo(r)>0)}Ji(e,t,n){return ws()<=ut.DEBUG&&Ss("QueryEngine","Using full collection scan to execute query:",Ul(t)),this.zi.getDocumentsMatchingQuery(e,t,Zs.min(),n)}es(e,t,n,r){return this.zi.getDocumentsMatchingQuery(e,n,r).next((e=>(t.forEach((t=>{e=e.insert(t.key,t)})),e)))}}class lh{constructor(e,t,n,r){this.persistence=e,this.ts=t,this.serializer=r,this.ns=new yo(Bs),this.rs=new Wl((e=>xl(e)),_l),this.ss=new Map,this.os=e.getRemoteDocumentCache(),this.Qr=e.getTargetCache(),this.$r=e.getBundleCache(),this._s(n)}_s(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Ku(this.os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.os.setIndexManager(this.indexManager),this.ts.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.ns)))}}function ch(e,t,n,r){return new lh(e,t,n,r)}async function uh(e,t){const n=ks(e);return await n.persistence.runTransaction("Handle user change","readonly",(e=>{let r;return n.mutationQueue.getAllMutationBatches(e).next((a=>(r=a,n._s(t),n.mutationQueue.getAllMutationBatches(e)))).next((t=>{const a=[],i=[];let s=tc();for(const e of r){a.push(e.batchId);for(const t of e.mutations)s=s.add(t.key)}for(const e of t){i.push(e.batchId);for(const t of e.mutations)s=s.add(t.key)}return n.localDocuments.getDocuments(e,s).next((e=>({us:e,removedBatchIds:a,addedBatchIds:i})))}))}))}function hh(e){const t=ks(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",(e=>t.Qr.getLastRemoteSnapshotVersion(e)))}function dh(e,t,n){let r=tc(),a=tc();return n.forEach((e=>r=r.add(e))),t.getEntries(e,r).next((e=>{let r=ql();return n.forEach(((n,i)=>{const s=e.get(n);i.isFoundDocument()!==s.isFoundDocument()&&(a=a.add(n)),i.isNoDocument()&&i.version.isEqual(Ws.min())?(t.removeEntry(n,i.readTime),r=r.insert(n,i)):!s.isValidDocument()||i.version.compareTo(s.version)>0||0===i.version.compareTo(s.version)&&s.hasPendingWrites?(t.addEntry(i),r=r.insert(n,i)):Ss("LocalStore","Ignoring outdated watch update for ",n,". Current version:",s.version," Watch version:",i.version)})),{cs:r,ls:a}}))}function fh(e,t){const n=ks(e);return n.persistence.runTransaction("Get next mutation batch","readonly",(e=>(void 0===t&&(t=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(e,t))))}function ph(e,t){const n=ks(e);return n.persistence.runTransaction("Allocate target","readwrite",(e=>{let r;return n.Qr.getTargetData(e,t).next((a=>a?(r=a,ao.resolve(r)):n.Qr.allocateTargetId(e).next((a=>(r=new Mu(t,a,"TargetPurposeListen",e.currentSequenceNumber),n.Qr.addTargetData(e,r).next((()=>r)))))))})).then((e=>{const r=n.ns.get(e.targetId);return(null===r||e.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.ns=n.ns.insert(e.targetId,e),n.rs.set(t,e.targetId)),e}))}async function mh(e,t,n){const r=ks(e),a=r.ns.get(t),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,(e=>r.persistence.referenceDelegate.removeTarget(e,a)))}catch(e){if(!so(e))throw e;Ss("LocalStore","Failed to update sequence numbers for target ".concat(t,": ").concat(e))}r.ns=r.ns.remove(t),r.rs.delete(a.target)}function gh(e,t,n){const r=ks(e);let a=Ws.min(),i=tc();return r.persistence.runTransaction("Execute query","readwrite",(e=>function(e,t,n){const r=ks(e),a=r.rs.get(n);return void 0!==a?ao.resolve(r.ns.get(a)):r.Qr.getTargetData(t,n)}(r,e,Dl(t)).next((t=>{if(t)return a=t.lastLimboFreeSnapshotVersion,r.Qr.getMatchingKeysForTargetId(e,t.targetId).next((e=>{i=e}))})).next((()=>r.ts.getDocumentsMatchingQuery(e,t,n?a:Ws.min(),n?i:tc()))).next((e=>(vh(r,Bl(t),e),{documents:e,hs:i})))))}function vh(e,t,n){let r=e.ss.get(t)||Ws.min();n.forEach(((e,t)=>{t.readTime.compareTo(r)>0&&(r=t.readTime)})),e.ss.set(t,r)}class yh{constructor(){this.activeTargetIds=rc()}As(e){this.activeTargetIds=this.activeTargetIds.add(e)}Rs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}ds(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class bh{constructor(){this.no=new yh,this.ro={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e){return this.no.As(e),this.ro[e]||"not-current"}updateQueryState(e,t,n){this.ro[e]=t}removeLocalQueryTarget(e){this.no.Rs(e)}isLocalQueryTarget(e){return this.no.activeTargetIds.has(e)}clearQueryState(e){delete this.ro[e]}getAllActiveQueryTargets(){return this.no.activeTargetIds}isActiveQueryTarget(e){return this.no.activeTargetIds.has(e)}start(){return this.no=new yh,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class wh{io(e){}shutdown(){}}class Sh{constructor(){this.so=()=>this.oo(),this._o=()=>this.ao(),this.uo=[],this.co()}io(e){this.uo.push(e)}shutdown(){window.removeEventListener("online",this.so),window.removeEventListener("offline",this._o)}co(){window.addEventListener("online",this.so),window.addEventListener("offline",this._o)}oo(){Ss("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.uo)e(0)}ao(){Ss("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.uo)e(1)}static D(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let Th=null;function Eh(){return null===Th?Th=268435456+Math.round(2147483648*Math.random()):Th++,"0x"+Th.toString(16)}const xh={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class _h{constructor(e){this.lo=e.lo,this.ho=e.ho}Po(e){this.Io=e}To(e){this.Eo=e}Ao(e){this.Ro=e}onMessage(e){this.Vo=e}close(){this.ho()}send(e){this.lo(e)}mo(){this.Io()}fo(){this.Eo()}po(e){this.Ro(e)}yo(e){this.Vo(e)}}const Ah="WebChannelConnection";class kh extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.wo=t+"://"+e.host,this.So="projects/".concat(n,"/databases/").concat(r),this.bo="(default)"===this.databaseId.database?"project_id=".concat(n):"project_id=".concat(n,"&database_id=").concat(r)}get Do(){return!1}Co(e,t,n,r,a){const i=Eh(),s=this.vo(e,t.toUriEncodedString());Ss("RestConnection","Sending RPC '".concat(e,"' ").concat(i,":"),s,n);const o={"google-cloud-resource-prefix":this.So,"x-goog-request-params":this.bo};return this.Fo(o,r,a),this.Mo(e,s,o,n).then((t=>(Ss("RestConnection","Received RPC '".concat(e,"' ").concat(i,": "),t),t)),(t=>{throw Es("RestConnection","RPC '".concat(e,"' ").concat(i," failed with error: "),t,"url: ",s,"request:",n),t}))}xo(e,t,n,r,a,i){return this.Co(e,t,n,r,a)}Fo(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+ys,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((t,n)=>e[n]=t)),n&&n.headers.forEach(((t,n)=>e[n]=t))}vo(e,t){const n=xh[e];return"".concat(this.wo,"/v1/").concat(t,":").concat(n)}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Mo(e,t,n,r){const a=Eh();return new Promise(((i,s)=>{const o=new is;o.setWithCredentials(!0),o.listenOnce(ls.COMPLETE,(()=>{try{switch(o.getLastErrorCode()){case cs.NO_ERROR:const t=o.getResponseJson();Ss(Ah,"XHR for RPC '".concat(e,"' ").concat(a," received:"),JSON.stringify(t)),i(t);break;case cs.TIMEOUT:Ss(Ah,"RPC '".concat(e,"' ").concat(a," timed out")),s(new Is(Cs.DEADLINE_EXCEEDED,"Request time out"));break;case cs.HTTP_ERROR:const n=o.getStatus();if(Ss(Ah,"RPC '".concat(e,"' ").concat(a," failed with status:"),n,"response text:",o.getResponseText()),n>0){let e=o.getResponseJson();Array.isArray(e)&&(e=e[0]);const t=null==e?void 0:e.error;if(t&&t.status&&t.message){const e=function(e){const t=e.toLowerCase().replace(/_/g,"-");return Object.values(Cs).indexOf(t)>=0?t:Cs.UNKNOWN}(t.status);s(new Is(e,t.message))}else s(new Is(Cs.UNKNOWN,"Server responded with status "+o.getStatus()))}else s(new Is(Cs.UNAVAILABLE,"Connection failed."));break;default:_s()}}finally{Ss(Ah,"RPC '".concat(e,"' ").concat(a," completed."))}}));const l=JSON.stringify(r);Ss(Ah,"RPC '".concat(e,"' ").concat(a," sending request:"),r),o.send(t,"POST",l,n,15)}))}Oo(e,t,n){const r=Eh(),a=[this.wo,"/","google.firestore.v1.Firestore","/",e,"/channel"],i=fs(),s=ds(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/".concat(this.databaseId.projectId,"/databases/").concat(this.databaseId.database)},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;void 0!==l&&(o.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(o.xmlHttpFactory=new ss({})),this.Fo(o.initMessageHeaders,t,n),o.encodeInitMessageHeaders=!0;const c=a.join("");Ss(Ah,"Creating RPC '".concat(e,"' stream ").concat(r,": ").concat(c),o);const u=i.createWebChannel(c,o);let h=!1,d=!1;const f=new _h({lo:t=>{d?Ss(Ah,"Not sending because RPC '".concat(e,"' stream ").concat(r," is closed:"),t):(h||(Ss(Ah,"Opening RPC '".concat(e,"' stream ").concat(r," transport.")),u.open(),h=!0),Ss(Ah,"RPC '".concat(e,"' stream ").concat(r," sending:"),t),u.send(t))},ho:()=>u.close()}),p=(e,t,n)=>{e.listen(t,(e=>{try{n(e)}catch(e){setTimeout((()=>{throw e}),0)}}))};return p(u,os.EventType.OPEN,(()=>{d||(Ss(Ah,"RPC '".concat(e,"' stream ").concat(r," transport opened.")),f.mo())})),p(u,os.EventType.CLOSE,(()=>{d||(d=!0,Ss(Ah,"RPC '".concat(e,"' stream ").concat(r," transport closed")),f.po())})),p(u,os.EventType.ERROR,(t=>{d||(d=!0,Es(Ah,"RPC '".concat(e,"' stream ").concat(r," transport errored:"),t),f.po(new Is(Cs.UNAVAILABLE,"The operation could not be completed")))})),p(u,os.EventType.MESSAGE,(t=>{var n;if(!d){const a=t.data[0];As(!!a);const i=a,s=i.error||(null===(n=i[0])||void 0===n?void 0:n.error);if(s){Ss(Ah,"RPC '".concat(e,"' stream ").concat(r," received error:"),s);const t=s.status;let n=function(e){const t=Uc[e];if(void 0!==t)return zc(t)}(t),a=s.message;void 0===n&&(n=Cs.INTERNAL,a="Unknown error status: "+t+" with message "+s.message),d=!0,f.po(new Is(n,a)),u.close()}else Ss(Ah,"RPC '".concat(e,"' stream ").concat(r," received:"),a),f.yo(a)}})),p(s,hs.STAT_EVENT,(t=>{t.stat===us.PROXY?Ss(Ah,"RPC '".concat(e,"' stream ").concat(r," detected buffering proxy")):t.stat===us.NOPROXY&&Ss(Ah,"RPC '".concat(e,"' stream ").concat(r," detected no buffering proxy"))})),setTimeout((()=>{f.fo()}),0),f}}function Ch(){return"undefined"!=typeof document?document:null}function Ih(e){return new lu(e,!0)}class Nh{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1.5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:6e4;this.oi=e,this.timerId=t,this.No=n,this.Lo=r,this.Bo=a,this.ko=0,this.qo=null,this.Qo=Date.now(),this.reset()}reset(){this.ko=0}Ko(){this.ko=this.Bo}$o(e){this.cancel();const t=Math.floor(this.ko+this.Uo()),n=Math.max(0,Date.now()-this.Qo),r=Math.max(0,t-n);r>0&&Ss("ExponentialBackoff","Backing off for ".concat(r," ms (base delay: ").concat(this.ko," ms, delay with jitter: ").concat(t," ms, last attempt: ").concat(n," ms ago)")),this.qo=this.oi.enqueueAfterDelay(this.timerId,r,(()=>(this.Qo=Date.now(),e()))),this.ko*=this.Lo,this.ko<this.No&&(this.ko=this.No),this.ko>this.Bo&&(this.ko=this.Bo)}Wo(){null!==this.qo&&(this.qo.skipDelay(),this.qo=null)}cancel(){null!==this.qo&&(this.qo.cancel(),this.qo=null)}Uo(){return(Math.random()-.5)*this.ko}}class Oh{constructor(e,t,n,r,a,i,s,o){this.oi=e,this.Go=n,this.zo=r,this.connection=a,this.authCredentialsProvider=i,this.appCheckCredentialsProvider=s,this.listener=o,this.state=0,this.jo=0,this.Ho=null,this.Jo=null,this.stream=null,this.Yo=new Nh(e,t)}Zo(){return 1===this.state||5===this.state||this.Xo()}Xo(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.e_()}async stop(){this.Zo()&&await this.close(0)}t_(){this.state=0,this.Yo.reset()}n_(){this.Xo()&&null===this.Ho&&(this.Ho=this.oi.enqueueAfterDelay(this.Go,6e4,(()=>this.r_())))}i_(e){this.s_(),this.stream.send(e)}async r_(){if(this.Xo())return this.close(0)}s_(){this.Ho&&(this.Ho.cancel(),this.Ho=null)}o_(){this.Jo&&(this.Jo.cancel(),this.Jo=null)}async close(e,t){this.s_(),this.o_(),this.Yo.cancel(),this.jo++,4!==e?this.Yo.reset():t&&t.code===Cs.RESOURCE_EXHAUSTED?(Ts(t.toString()),Ts("Using maximum backoff delay to prevent overloading the backend."),this.Yo.Ko()):t&&t.code===Cs.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.__(),this.stream.close(),this.stream=null),this.state=e,await this.listener.Ao(t)}__(){}auth(){this.state=1;const e=this.a_(this.jo),t=this.jo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((e=>{let[n,r]=e;this.jo===t&&this.u_(n,r)}),(t=>{e((()=>{const e=new Is(Cs.UNKNOWN,"Fetching auth token failed: "+t.message);return this.c_(e)}))}))}u_(e,t){const n=this.a_(this.jo);this.stream=this.l_(e,t),this.stream.Po((()=>{n((()=>this.listener.Po()))})),this.stream.To((()=>{n((()=>(this.state=2,this.Jo=this.oi.enqueueAfterDelay(this.zo,1e4,(()=>(this.Xo()&&(this.state=3),Promise.resolve()))),this.listener.To())))})),this.stream.Ao((e=>{n((()=>this.c_(e)))})),this.stream.onMessage((e=>{n((()=>this.onMessage(e)))}))}e_(){this.state=5,this.Yo.$o((async()=>{this.state=0,this.start()}))}c_(e){return Ss("PersistentStream","close with error: ".concat(e)),this.stream=null,this.close(4,e)}a_(e){return t=>{this.oi.enqueueAndForget((()=>this.jo===e?t():(Ss("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class Rh extends Oh{constructor(e,t,n,r,a,i){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,r,i),this.serializer=a}l_(e,t){return this.connection.Oo("Listen",e,t)}onMessage(e){this.Yo.reset();const t=function(e,t){let n;if("targetChange"in t){t.targetChange;const r=function(e){return"NO_CHANGE"===e?0:"ADD"===e?1:"REMOVE"===e?2:"CURRENT"===e?3:"RESET"===e?4:_s()}(t.targetChange.targetChangeType||"NO_CHANGE"),a=t.targetChange.targetIds||[],i=function(e,t){return e.useProto3Json?(As(void 0===t||"string"==typeof t),_o.fromBase64String(t||"")):(As(void 0===t||t instanceof Buffer||t instanceof Uint8Array),_o.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),s=t.targetChange.cause,o=s&&function(e){const t=void 0===e.code?Cs.UNKNOWN:zc(e.code);return new Is(t,e.message||"")}(s);n=new eu(r,a,i,o||null)}else if("documentChange"in t){t.documentChange;const r=t.documentChange;r.document,r.document.name,r.document.updateTime;const a=yu(e,r.document.name),i=fu(r.document.updateTime),s=r.document.createTime?fu(r.document.createTime):Ws.min(),o=new Jo({mapValue:{fields:r.document.fields}}),l=Zo.newFoundDocument(a,i,s,o),c=r.targetIds||[],u=r.removedTargetIds||[];n=new $c(c,u,l.key,l)}else if("documentDelete"in t){t.documentDelete;const r=t.documentDelete;r.document;const a=yu(e,r.document),i=r.readTime?fu(r.readTime):Ws.min(),s=Zo.newNoDocument(a,i),o=r.removedTargetIds||[];n=new $c([],o,s.key,s)}else if("documentRemove"in t){t.documentRemove;const r=t.documentRemove;r.document;const a=yu(e,r.document),i=r.removedTargetIds||[];n=new $c([],i,a,null)}else{if(!("filter"in t))return _s();{t.filter;const e=t.filter;e.targetId;const{count:r=0,unchangedNames:a}=e,i=new Fc(r,a),s=e.targetId;n=new Zc(s,i)}}return n}(this.serializer,e),n=function(e){if(!("targetChange"in e))return Ws.min();const t=e.targetChange;return t.targetIds&&t.targetIds.length?Ws.min():t.readTime?fu(t.readTime):Ws.min()}(e);return this.listener.h_(t,n)}P_(e){const t={};t.database=Su(this.serializer),t.addTarget=function(e,t){let n;const r=t.target;if(n=Al(r)?{documents:_u(e,r)}:{query:Au(e,r)._t},n.targetId=t.targetId,t.resumeToken.approximateByteSize()>0){n.resumeToken=hu(e,t.resumeToken);const r=cu(e,t.expectedCount);null!==r&&(n.expectedCount=r)}else if(t.snapshotVersion.compareTo(Ws.min())>0){n.readTime=uu(e,t.snapshotVersion.toTimestamp());const r=cu(e,t.expectedCount);null!==r&&(n.expectedCount=r)}return n}(this.serializer,e);const n=function(e,t){const n=function(e){switch(e){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return _s()}}(t.purpose);return null==n?null:{"goog-listen-tags":n}}(this.serializer,e);n&&(t.labels=n),this.i_(t)}I_(e){const t={};t.database=Su(this.serializer),t.removeTarget=e,this.i_(t)}}class Dh extends Oh{constructor(e,t,n,r,a,i){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,r,i),this.serializer=a,this.T_=!1}get E_(){return this.T_}start(){this.T_=!1,this.lastStreamToken=void 0,super.start()}__(){this.T_&&this.d_([])}l_(e,t){return this.connection.Oo("Write",e,t)}onMessage(e){if(As(!!e.streamToken),this.lastStreamToken=e.streamToken,this.T_){this.Yo.reset();const t=function(e,t){return e&&e.length>0?(As(void 0!==t),e.map((e=>function(e,t){let n=e.updateTime?fu(e.updateTime):fu(t);return n.isEqual(Ws.min())&&(n=fu(t)),new bc(n,e.transformResults||[])}(e,t)))):[]}(e.writeResults,e.commitTime),n=fu(e.commitTime);return this.listener.A_(n,t)}return As(!e.writeResults||0===e.writeResults.length),this.T_=!0,this.listener.R_()}V_(){const e={};e.database=Su(this.serializer),this.i_(e)}d_(e){const t={streamToken:this.lastStreamToken,writes:e.map((e=>xu(this.serializer,e)))};this.i_(t)}}class jh extends class{}{constructor(e,t,n,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=r,this.m_=!1}f_(){if(this.m_)throw new Is(Cs.FAILED_PRECONDITION,"The client has already been terminated.")}Co(e,t,n,r){return this.f_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((a=>{let[i,s]=a;return this.connection.Co(e,mu(t,n),r,i,s)})).catch((e=>{throw"FirebaseError"===e.name?(e.code===Cs.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new Is(Cs.UNKNOWN,e.toString())}))}xo(e,t,n,r,a){return this.f_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((i=>{let[s,o]=i;return this.connection.xo(e,mu(t,n),r,s,o,a)})).catch((e=>{throw"FirebaseError"===e.name?(e.code===Cs.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new Is(Cs.UNKNOWN,e.toString())}))}terminate(){this.m_=!0,this.connection.terminate()}}class Ph{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.g_=0,this.p_=null,this.y_=!0}w_(){0===this.g_&&(this.S_("Unknown"),this.p_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this.p_=null,this.b_("Backend didn't respond within 10 seconds."),this.S_("Offline"),Promise.resolve()))))}D_(e){"Online"===this.state?this.S_("Unknown"):(this.g_++,this.g_>=1&&(this.C_(),this.b_("Connection failed 1 times. Most recent error: ".concat(e.toString())),this.S_("Offline")))}set(e){this.C_(),this.g_=0,"Online"===e&&(this.y_=!1),this.S_(e)}S_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}b_(e){const t="Could not reach Cloud Firestore backend. ".concat(e,"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.");this.y_?(Ts(t),this.y_=!1):Ss("OnlineStateTracker",t)}C_(){null!==this.p_&&(this.p_.cancel(),this.p_=null)}}class Lh{constructor(e,t,n,r,a){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.v_=[],this.F_=new Map,this.M_=new Set,this.x_=[],this.O_=a,this.O_.io((e=>{n.enqueueAndForget((async()=>{Gh(this)&&(Ss("RemoteStore","Restarting streams for network reachability change."),await async function(e){const t=ks(e);t.M_.add(4),await Fh(t),t.N_.set("Unknown"),t.M_.delete(4),await Mh(t)}(this))}))})),this.N_=new Ph(n,r)}}async function Mh(e){if(Gh(e))for(const t of e.x_)await t(!0)}async function Fh(e){for(const t of e.x_)await t(!1)}function Uh(e,t){const n=ks(e);n.F_.has(t.targetId)||(n.F_.set(t.targetId,t),Wh(n)?Hh(n):ud(n).Xo()&&Bh(n,t))}function Vh(e,t){const n=ks(e),r=ud(n);n.F_.delete(t),r.Xo()&&zh(n,t),0===n.F_.size&&(r.Xo()?r.n_():Gh(n)&&n.N_.set("Unknown"))}function Bh(e,t){if(e.L_.xe(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(Ws.min())>0){const n=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(n)}ud(e).P_(t)}function zh(e,t){e.L_.xe(t),ud(e).I_(t)}function Hh(e){e.L_=new nu({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),ot:t=>e.F_.get(t)||null,tt:()=>e.datastore.serializer.databaseId}),ud(e).start(),e.N_.w_()}function Wh(e){return Gh(e)&&!ud(e).Zo()&&e.F_.size>0}function Gh(e){return 0===ks(e).M_.size}function qh(e){e.L_=void 0}async function Kh(e){e.N_.set("Online")}async function Yh(e){e.F_.forEach(((t,n)=>{Bh(e,t)}))}async function Qh(e,t){qh(e),Wh(e)?(e.N_.D_(t),Hh(e)):e.N_.set("Unknown")}async function Xh(e,t,n){if(e.N_.set("Online"),t instanceof eu&&2===t.state&&t.cause)try{await async function(e,t){const n=t.cause;for(const r of t.targetIds)e.F_.has(r)&&(await e.remoteSyncer.rejectListen(r,n),e.F_.delete(r),e.L_.removeTarget(r))}(e,t)}catch(n){Ss("RemoteStore","Failed to remove targets %s: %s ",t.targetIds.join(","),n),await Jh(e,n)}else if(t instanceof $c?e.L_.Ke(t):t instanceof Zc?e.L_.He(t):e.L_.We(t),!n.isEqual(Ws.min()))try{const t=await hh(e.localStore);n.compareTo(t)>=0&&await function(e,t){const n=e.L_.rt(t);return n.targetChanges.forEach(((n,r)=>{if(n.resumeToken.approximateByteSize()>0){const a=e.F_.get(r);a&&e.F_.set(r,a.withResumeToken(n.resumeToken,t))}})),n.targetMismatches.forEach(((t,n)=>{const r=e.F_.get(t);if(!r)return;e.F_.set(t,r.withResumeToken(_o.EMPTY_BYTE_STRING,r.snapshotVersion)),zh(e,t);const a=new Mu(r.target,t,n,r.sequenceNumber);Bh(e,a)})),e.remoteSyncer.applyRemoteEvent(n)}(e,n)}catch(t){Ss("RemoteStore","Failed to raise snapshot:",t),await Jh(e,t)}}async function Jh(e,t,n){if(!so(t))throw t;e.M_.add(1),await Fh(e),e.N_.set("Offline"),n||(n=()=>hh(e.localStore)),e.asyncQueue.enqueueRetryable((async()=>{Ss("RemoteStore","Retrying IndexedDB access"),await n(),e.M_.delete(1),await Mh(e)}))}function $h(e,t){return t().catch((n=>Jh(e,n,t)))}async function Zh(e){const t=ks(e),n=hd(t);let r=t.v_.length>0?t.v_[t.v_.length-1].batchId:-1;for(;ed(t);)try{const e=await fh(t.localStore,r);if(null===e){0===t.v_.length&&n.n_();break}r=e.batchId,td(t,e)}catch(e){await Jh(t,e)}nd(t)&&rd(t)}function ed(e){return Gh(e)&&e.v_.length<10}function td(e,t){e.v_.push(t);const n=hd(e);n.Xo()&&n.E_&&n.d_(t.mutations)}function nd(e){return Gh(e)&&!hd(e).Zo()&&e.v_.length>0}function rd(e){hd(e).start()}async function ad(e){hd(e).V_()}async function id(e){const t=hd(e);for(const n of e.v_)t.d_(n.mutations)}async function sd(e,t,n){const r=e.v_.shift(),a=Lc.from(r,t,n);await $h(e,(()=>e.remoteSyncer.applySuccessfulWrite(a))),await Zh(e)}async function od(e,t){t&&hd(e).E_&&await async function(e,t){if(function(e){return Bc(e)&&e!==Cs.ABORTED}(t.code)){const n=e.v_.shift();hd(e).t_(),await $h(e,(()=>e.remoteSyncer.rejectFailedWrite(n.batchId,t))),await Zh(e)}}(e,t),nd(e)&&rd(e)}async function ld(e,t){const n=ks(e);n.asyncQueue.verifyOperationInProgress(),Ss("RemoteStore","RemoteStore received new credentials");const r=Gh(n);n.M_.add(3),await Fh(n),r&&n.N_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(t),n.M_.delete(3),await Mh(n)}async function cd(e,t){const n=ks(e);t?(n.M_.delete(2),await Mh(n)):t||(n.M_.add(2),await Fh(n),n.N_.set("Unknown"))}function ud(e){return e.B_||(e.B_=function(e,t,n){const r=ks(e);return r.f_(),new Rh(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{Po:Kh.bind(null,e),To:Yh.bind(null,e),Ao:Qh.bind(null,e),h_:Xh.bind(null,e)}),e.x_.push((async t=>{t?(e.B_.t_(),Wh(e)?Hh(e):e.N_.set("Unknown")):(await e.B_.stop(),qh(e))}))),e.B_}function hd(e){return e.k_||(e.k_=function(e,t,n){const r=ks(e);return r.f_(),new Dh(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{Po:()=>Promise.resolve(),To:ad.bind(null,e),Ao:od.bind(null,e),R_:id.bind(null,e),A_:sd.bind(null,e)}),e.x_.push((async t=>{t?(e.k_.t_(),await Zh(e)):(await e.k_.stop(),e.v_.length>0&&(Ss("RemoteStore","Stopping write stream with ".concat(e.v_.length," pending writes")),e.v_=[]))}))),e.k_}class dd{constructor(e,t,n,r,a){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=r,this.removalCallback=a,this.deferred=new Ns,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((e=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,r,a){const i=Date.now()+n,s=new dd(e,t,i,r,a);return s.start(n),s}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Is(Cs.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function fd(e,t){if(Ts("AsyncQueue","".concat(t,": ").concat(e)),so(e))return new Is(Cs.UNAVAILABLE,"".concat(t,": ").concat(e));throw e}class pd{constructor(e){this.comparator=e?(t,n)=>e(t,n)||Qs.comparator(t.key,n.key):(e,t)=>Qs.comparator(e.key,t.key),this.keyedMap=Yl(),this.sortedSet=new yo(this.comparator)}static emptySet(e){return new pd(e.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,n)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof pd))return!1;if(this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(!e.isEqual(r))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const n=new pd;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}class md{constructor(){this.q_=new yo(Qs.comparator)}track(e){const t=e.doc.key,n=this.q_.get(t);n?0!==e.type&&3===n.type?this.q_=this.q_.insert(t,e):3===e.type&&1!==n.type?this.q_=this.q_.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.q_=this.q_.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.q_=this.q_.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.q_=this.q_.remove(t):1===e.type&&2===n.type?this.q_=this.q_.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.q_=this.q_.insert(t,{type:2,doc:e.doc}):_s():this.q_=this.q_.insert(t,e)}Q_(){const e=[];return this.q_.inorderTraversal(((t,n)=>{e.push(n)})),e}}class gd{constructor(e,t,n,r,a,i,s,o,l){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=a,this.fromCache=i,this.syncStateChanged=s,this.excludesMetadataChanges=o,this.hasCachedResults=l}static fromInitialDocuments(e,t,n,r,a){const i=[];return t.forEach((e=>{i.push({type:0,doc:e})})),new gd(e,t,pd.emptySet(t),i,n,r,!0,!1,a)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Ml(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==n[r].type||!t[r].doc.isEqual(n[r].doc))return!1;return!0}}class vd{constructor(){this.K_=void 0,this.U_=[]}W_(){return this.U_.some((e=>e.G_()))}}class yd{constructor(){this.queries=new Wl((e=>Fl(e)),Ml),this.onlineState="Unknown",this.z_=new Set}}async function bd(e,t){const n=ks(e);let r=3;const a=t.query;let i=n.queries.get(a);i?!i.W_()&&t.G_()&&(r=2):(i=new vd,r=t.G_()?0:1);try{switch(r){case 0:i.K_=await n.onListen(a,!0);break;case 1:i.K_=await n.onListen(a,!1);break;case 2:await n.onFirstRemoteStoreListen(a)}}catch(e){const n=fd(e,"Initialization of query '".concat(Ul(t.query),"' failed"));return void t.onError(n)}n.queries.set(a,i),i.U_.push(t),t.j_(n.onlineState),i.K_&&t.H_(i.K_)&&Ed(n)}async function wd(e,t){const n=ks(e),r=t.query;let a=3;const i=n.queries.get(r);if(i){const e=i.U_.indexOf(t);e>=0&&(i.U_.splice(e,1),0===i.U_.length?a=t.G_()?0:1:!i.W_()&&t.G_()&&(a=2))}switch(a){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function Sd(e,t){const n=ks(e);let r=!1;for(const a of t){const e=a.query,t=n.queries.get(e);if(t){for(const e of t.U_)e.H_(a)&&(r=!0);t.K_=a}}r&&Ed(n)}function Td(e,t,n){const r=ks(e),a=r.queries.get(t);if(a)for(const i of a.U_)i.onError(n);r.queries.delete(t)}function Ed(e){e.z_.forEach((e=>{e.next()}))}var xd,_d;(_d=xd||(xd={})).J_="default",_d.Cache="cache";class Ad{constructor(e,t,n){this.query=e,this.Y_=t,this.Z_=!1,this.X_=null,this.onlineState="Unknown",this.options=n||{}}H_(e){if(!this.options.includeMetadataChanges){const t=[];for(const n of e.docChanges)3!==n.type&&t.push(n);e=new gd(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Z_?this.ea(e)&&(this.Y_.next(e),t=!0):this.ta(e,this.onlineState)&&(this.na(e),t=!0),this.X_=e,t}onError(e){this.Y_.error(e)}j_(e){this.onlineState=e;let t=!1;return this.X_&&!this.Z_&&this.ta(this.X_,e)&&(this.na(this.X_),t=!0),t}ta(e,t){if(!e.fromCache)return!0;if(!this.G_())return!0;const n="Offline"!==t;return(!this.options.ra||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}ea(e){if(e.docChanges.length>0)return!0;const t=this.X_&&this.X_.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}na(e){e=gd.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Z_=!0,this.Y_.next(e)}G_(){return this.options.source!==xd.Cache}}class kd{constructor(e){this.key=e}}class Cd{constructor(e){this.key=e}}class Id{constructor(e,t){this.query=e,this.la=t,this.ha=null,this.hasCachedResults=!1,this.current=!1,this.Pa=tc(),this.mutatedKeys=tc(),this.Ia=zl(e),this.Ta=new pd(this.Ia)}get Ea(){return this.la}da(e,t){const n=t?t.Aa:new md,r=t?t.Ta:this.Ta;let a=t?t.mutatedKeys:this.mutatedKeys,i=r,s=!1;const o="F"===this.query.limitType&&r.size===this.query.limit?r.last():null,l="L"===this.query.limitType&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal(((e,t)=>{const c=r.get(e),u=Vl(this.query,t)?t:null,h=!!c&&this.mutatedKeys.has(c.key),d=!!u&&(u.hasLocalMutations||this.mutatedKeys.has(u.key)&&u.hasCommittedMutations);let f=!1;c&&u?c.data.isEqual(u.data)?h!==d&&(n.track({type:3,doc:u}),f=!0):this.Ra(c,u)||(n.track({type:2,doc:u}),f=!0,(o&&this.Ia(u,o)>0||l&&this.Ia(u,l)<0)&&(s=!0)):!c&&u?(n.track({type:0,doc:u}),f=!0):c&&!u&&(n.track({type:1,doc:c}),f=!0,(o||l)&&(s=!0)),f&&(u?(i=i.add(u),a=d?a.add(e):a.delete(e)):(i=i.delete(e),a=a.delete(e)))})),null!==this.query.limit)for(;i.size>this.query.limit;){const e="F"===this.query.limitType?i.last():i.first();i=i.delete(e.key),a=a.delete(e.key),n.track({type:1,doc:e})}return{Ta:i,Aa:n,Xi:s,mutatedKeys:a}}Ra(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n,r){const a=this.Ta;this.Ta=e.Ta,this.mutatedKeys=e.mutatedKeys;const i=e.Aa.Q_();i.sort(((e,t)=>function(e,t){const n=e=>{switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return _s()}};return n(e)-n(t)}(e.type,t.type)||this.Ia(e.doc,t.doc))),this.Va(n),r=null!=r&&r;const s=t&&!r?this.ma():[],o=0===this.Pa.size&&this.current&&!r?1:0,l=o!==this.ha;return this.ha=o,0!==i.length||l?{snapshot:new gd(this.query,e.Ta,a,i,e.mutatedKeys,0===o,l,!1,!!n&&n.resumeToken.approximateByteSize()>0),fa:s}:{fa:s}}j_(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({Ta:this.Ta,Aa:new md,mutatedKeys:this.mutatedKeys,Xi:!1},!1)):{fa:[]}}ga(e){return!this.la.has(e)&&!!this.Ta.has(e)&&!this.Ta.get(e).hasLocalMutations}Va(e){e&&(e.addedDocuments.forEach((e=>this.la=this.la.add(e))),e.modifiedDocuments.forEach((e=>{})),e.removedDocuments.forEach((e=>this.la=this.la.delete(e))),this.current=e.current)}ma(){if(!this.current)return[];const e=this.Pa;this.Pa=tc(),this.Ta.forEach((e=>{this.ga(e.key)&&(this.Pa=this.Pa.add(e.key))}));const t=[];return e.forEach((e=>{this.Pa.has(e)||t.push(new Cd(e))})),this.Pa.forEach((n=>{e.has(n)||t.push(new kd(n))})),t}pa(e){this.la=e.hs,this.Pa=tc();const t=this.da(e.documents);return this.applyChanges(t,!0)}ya(){return gd.fromInitialDocuments(this.query,this.Ta,this.mutatedKeys,0===this.ha,this.hasCachedResults)}}class Nd{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class Od{constructor(e){this.key=e,this.wa=!1}}class Rd{constructor(e,t,n,r,a,i){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=r,this.currentUser=a,this.maxConcurrentLimboResolutions=i,this.Sa={},this.ba=new Wl((e=>Fl(e)),Ml),this.Da=new Map,this.Ca=new Set,this.va=new yo(Qs.comparator),this.Fa=new Map,this.Ma=new Xu,this.xa={},this.Oa=new Map,this.Na=Wu.Ln(),this.onlineState="Unknown",this.La=void 0}get isPrimaryClient(){return!0===this.La}}async function Dd(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const r=ef(e);let a;const i=r.ba.get(t);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),a=i.view.ya()):a=await Pd(r,t,n,!0),a}async function jd(e,t){const n=ef(e);await Pd(n,t,!0,!1)}async function Pd(e,t,n,r){const a=await ph(e.localStore,Dl(t)),i=a.targetId,s=n?e.sharedClientState.addLocalQueryTarget(i):"not-current";let o;return r&&(o=await Ld(e,t,i,"current"===s,a.resumeToken)),e.isPrimaryClient&&n&&Uh(e.remoteStore,a),o}async function Ld(e,t,n,r,a){e.Ba=(t,n,r)=>async function(e,t,n,r){let a=t.view.da(n);a.Xi&&(a=await gh(e.localStore,t.query,!1).then((e=>{let{documents:n}=e;return t.view.da(n,a)})));const i=r&&r.targetChanges.get(t.targetId),s=r&&null!=r.targetMismatches.get(t.targetId),o=t.view.applyChanges(a,e.isPrimaryClient,i,s);return Yd(e,t.targetId,o.fa),o.snapshot}(e,t,n,r);const i=await gh(e.localStore,t,!0),s=new Id(t,i.hs),o=s.da(i.documents),l=Jc.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==e.onlineState,a),c=s.applyChanges(o,e.isPrimaryClient,l);Yd(e,n,c.fa);const u=new Nd(t,n,s);return e.ba.set(t,u),e.Da.has(n)?e.Da.get(n).push(t):e.Da.set(n,[t]),c.snapshot}async function Md(e,t,n){const r=ks(e),a=r.ba.get(t),i=r.Da.get(a.targetId);if(i.length>1)return r.Da.set(a.targetId,i.filter((e=>!Ml(e,t)))),void r.ba.delete(t);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(a.targetId),r.sharedClientState.isActiveQueryTarget(a.targetId)||await mh(r.localStore,a.targetId,!1).then((()=>{r.sharedClientState.clearQueryState(a.targetId),n&&Vh(r.remoteStore,a.targetId),qd(r,a.targetId)})).catch(ro)):(qd(r,a.targetId),await mh(r.localStore,a.targetId,!0))}async function Fd(e,t){const n=ks(e),r=n.ba.get(t),a=n.Da.get(r.targetId);n.isPrimaryClient&&1===a.length&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),Vh(n.remoteStore,r.targetId))}async function Ud(e,t){const n=ks(e);try{const e=await function(e,t){const n=ks(e),r=t.snapshotVersion;let a=n.ns;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(e=>{const i=n.os.newChangeBuffer({trackRemovals:!0});a=n.ns;const s=[];t.targetChanges.forEach(((i,o)=>{const l=a.get(o);if(!l)return;s.push(n.Qr.removeMatchingKeys(e,i.removedDocuments,o).next((()=>n.Qr.addMatchingKeys(e,i.addedDocuments,o))));let c=l.withSequenceNumber(e.currentSequenceNumber);null!==t.targetMismatches.get(o)?c=c.withResumeToken(_o.EMPTY_BYTE_STRING,Ws.min()).withLastLimboFreeSnapshotVersion(Ws.min()):i.resumeToken.approximateByteSize()>0&&(c=c.withResumeToken(i.resumeToken,r)),a=a.insert(o,c),function(e,t,n){return 0===e.resumeToken.approximateByteSize()||t.snapshotVersion.toMicroseconds()-e.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0}(l,c,i)&&s.push(n.Qr.updateTargetData(e,c))}));let o=ql(),l=tc();if(t.documentUpdates.forEach((r=>{t.resolvedLimboDocuments.has(r)&&s.push(n.persistence.referenceDelegate.updateLimboDocument(e,r))})),s.push(dh(e,i,t.documentUpdates).next((e=>{o=e.cs,l=e.ls}))),!r.isEqual(Ws.min())){const t=n.Qr.getLastRemoteSnapshotVersion(e).next((t=>n.Qr.setTargetsMetadata(e,e.currentSequenceNumber,r)));s.push(t)}return ao.waitFor(s).next((()=>i.apply(e))).next((()=>n.localDocuments.getLocalViewOfDocuments(e,o,l))).next((()=>o))})).then((e=>(n.ns=a,e)))}(n.localStore,t);t.targetChanges.forEach(((e,t)=>{const r=n.Fa.get(t);r&&(As(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1),e.addedDocuments.size>0?r.wa=!0:e.modifiedDocuments.size>0?As(r.wa):e.removedDocuments.size>0&&(As(r.wa),r.wa=!1))})),await Jd(n,e,t)}catch(e){await ro(e)}}function Vd(e,t,n){const r=ks(e);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){const e=[];r.ba.forEach(((n,r)=>{const a=r.view.j_(t);a.snapshot&&e.push(a.snapshot)})),function(e,t){const n=ks(e);n.onlineState=t;let r=!1;n.queries.forEach(((e,n)=>{for(const a of n.U_)a.j_(t)&&(r=!0)})),r&&Ed(n)}(r.eventManager,t),e.length&&r.Sa.h_(e),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}async function Bd(e,t,n){const r=ks(e);r.sharedClientState.updateQueryState(t,"rejected",n);const a=r.Fa.get(t),i=a&&a.key;if(i){let e=new yo(Qs.comparator);e=e.insert(i,Zo.newNoDocument(i,Ws.min()));const n=tc().add(i),a=new Xc(Ws.min(),new Map,new yo(Bs),e,n);await Ud(r,a),r.va=r.va.remove(i),r.Fa.delete(t),Xd(r)}else await mh(r.localStore,t,!1).then((()=>qd(r,t,n))).catch(ro)}async function zd(e,t){const n=ks(e),r=t.batch.batchId;try{const e=await function(e,t){const n=ks(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(e=>{const r=t.batch.keys(),a=n.os.newChangeBuffer({trackRemovals:!0});return function(e,t,n,r){const a=n.batch,i=a.keys();let s=ao.resolve();return i.forEach((e=>{s=s.next((()=>r.getEntry(t,e))).next((t=>{const i=n.docVersions.get(e);As(null!==i),t.version.compareTo(i)<0&&(a.applyToRemoteDocument(t,n),t.isValidDocument()&&(t.setReadTime(n.commitVersion),r.addEntry(t)))}))})),s.next((()=>e.mutationQueue.removeMutationBatch(t,a)))}(n,e,t,a).next((()=>a.apply(e))).next((()=>n.mutationQueue.performConsistencyCheck(e))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t.batch.batchId))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){let t=tc();for(let n=0;n<e.mutationResults.length;++n)e.mutationResults[n].transformResults.length>0&&(t=t.add(e.batch.mutations[n].key));return t}(t)))).next((()=>n.localDocuments.getDocuments(e,r)))}))}(n.localStore,t);Gd(n,r,null),Wd(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Jd(n,e)}catch(e){await ro(e)}}async function Hd(e,t,n){const r=ks(e);try{const e=await function(e,t){const n=ks(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",(e=>{let r;return n.mutationQueue.lookupMutationBatch(e,t).next((t=>(As(null!==t),r=t.keys(),n.mutationQueue.removeMutationBatch(e,t)))).next((()=>n.mutationQueue.performConsistencyCheck(e))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,r))).next((()=>n.localDocuments.getDocuments(e,r)))}))}(r.localStore,t);Gd(r,t,n),Wd(r,t),r.sharedClientState.updateMutationState(t,"rejected",n),await Jd(r,e)}catch(n){await ro(n)}}function Wd(e,t){(e.Oa.get(t)||[]).forEach((e=>{e.resolve()})),e.Oa.delete(t)}function Gd(e,t,n){const r=ks(e);let a=r.xa[r.currentUser.toKey()];if(a){const e=a.get(t);e&&(n?e.reject(n):e.resolve(),a=a.remove(t)),r.xa[r.currentUser.toKey()]=a}}function qd(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e.sharedClientState.removeLocalQueryTarget(t);for(const r of e.Da.get(t))e.ba.delete(r),n&&e.Sa.ka(r,n);e.Da.delete(t),e.isPrimaryClient&&e.Ma.Vr(t).forEach((t=>{e.Ma.containsKey(t)||Kd(e,t)}))}function Kd(e,t){e.Ca.delete(t.path.canonicalString());const n=e.va.get(t);null!==n&&(Vh(e.remoteStore,n),e.va=e.va.remove(t),e.Fa.delete(n),Xd(e))}function Yd(e,t,n){for(const r of n)r instanceof kd?(e.Ma.addReference(r.key,t),Qd(e,r)):r instanceof Cd?(Ss("SyncEngine","Document no longer in limbo: "+r.key),e.Ma.removeReference(r.key,t),e.Ma.containsKey(r.key)||Kd(e,r.key)):_s()}function Qd(e,t){const n=t.key,r=n.path.canonicalString();e.va.get(n)||e.Ca.has(r)||(Ss("SyncEngine","New document in limbo: "+n),e.Ca.add(r),Xd(e))}function Xd(e){for(;e.Ca.size>0&&e.va.size<e.maxConcurrentLimboResolutions;){const t=e.Ca.values().next().value;e.Ca.delete(t);const n=new Qs(qs.fromString(t)),r=e.Na.next();e.Fa.set(r,new Od(n)),e.va=e.va.insert(n,r),Uh(e.remoteStore,new Mu(Dl(Il(n.path)),r,"TargetPurposeLimboResolution",oo.oe))}}async function Jd(e,t,n){const r=ks(e),a=[],i=[],s=[];r.ba.isEmpty()||(r.ba.forEach(((e,o)=>{s.push(r.Ba(o,t,n).then((e=>{var t;if((e||n)&&r.isPrimaryClient){const a=e?!e.fromCache:null===(t=null==n?void 0:n.targetChanges.get(o.targetId))||void 0===t?void 0:t.current;r.sharedClientState.updateQueryState(o.targetId,a?"current":"not-current")}if(e){a.push(e);const t=ih.Ki(o.targetId,e);i.push(t)}})))})),await Promise.all(s),r.Sa.h_(a),await async function(e,t){const n=ks(e);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(e=>ao.forEach(t,(t=>ao.forEach(t.qi,(r=>n.persistence.referenceDelegate.addReference(e,t.targetId,r))).next((()=>ao.forEach(t.Qi,(r=>n.persistence.referenceDelegate.removeReference(e,t.targetId,r)))))))))}catch(e){if(!so(e))throw e;Ss("LocalStore","Failed to update sequence numbers: "+e)}for(const r of t){const e=r.targetId;if(!r.fromCache){const t=n.ns.get(e),r=t.snapshotVersion,a=t.withLastLimboFreeSnapshotVersion(r);n.ns=n.ns.insert(e,a)}}}(r.localStore,i))}async function $d(e,t){const n=ks(e);if(!n.currentUser.isEqual(t)){Ss("SyncEngine","User change. New user:",t.toKey());const e=await uh(n.localStore,t);n.currentUser=t,function(e,t){e.Oa.forEach((e=>{e.forEach((e=>{e.reject(new Is(Cs.CANCELLED,t))}))})),e.Oa.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(t,e.removedBatchIds,e.addedBatchIds),await Jd(n,e.us)}}function Zd(e,t){const n=ks(e),r=n.Fa.get(t);if(r&&r.wa)return tc().add(r.key);{let e=tc();const r=n.Da.get(t);if(!r)return e;for(const t of r){const r=n.ba.get(t);e=e.unionWith(r.view.Ea)}return e}}function ef(e){const t=ks(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=Ud.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=Zd.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=Bd.bind(null,t),t.Sa.h_=Sd.bind(null,t.eventManager),t.Sa.ka=Td.bind(null,t.eventManager),t}function tf(e){const t=ks(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=zd.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=Hd.bind(null,t),t}class nf{constructor(){this.synchronizeTabs=!1}async initialize(e){this.serializer=Ih(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),await this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)}createGarbageCollectionScheduler(e,t){return null}createIndexBackfillerScheduler(e,t){return null}createLocalStore(e){return ch(this.persistence,new oh,e.initialUser,this.serializer)}createPersistence(e){return new nh(ah.Hr,this.serializer)}createSharedClientState(e){return new bh}async terminate(){var e,t;null===(e=this.gcScheduler)||void 0===e||e.stop(),null===(t=this.indexBackfillerScheduler)||void 0===t||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class rf{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=e=>Vd(this.syncEngine,e,1),this.remoteStore.remoteSyncer.handleCredentialChange=$d.bind(null,this.syncEngine),await cd(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new yd}createDatastore(e){const t=Ih(e.databaseInfo.databaseId),n=function(e){return new kh(e)}(e.databaseInfo);return function(e,t,n,r){return new jh(e,t,n,r)}(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return function(e,t,n,r,a){return new Lh(e,t,n,r,a)}(this.localStore,this.datastore,e.asyncQueue,(e=>Vd(this.syncEngine,e,0)),Sh.D()?new Sh:new wh)}createSyncEngine(e,t){return function(e,t,n,r,a,i,s){const o=new Rd(e,t,n,r,a,i);return s&&(o.La=!0),o}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e;await async function(e){const t=ks(e);Ss("RemoteStore","RemoteStore shutting down."),t.M_.add(5),await Fh(t),t.O_.shutdown(),t.N_.set("Unknown")}(this.remoteStore),null===(e=this.datastore)||void 0===e||e.terminate()}}class af{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Ka(this.observer.next,e)}error(e){this.observer.error?this.Ka(this.observer.error,e):Ts("Uncaught Error in snapshot listener:",e.toString())}$a(){this.muted=!0}Ka(e,t){this.muted||setTimeout((()=>{this.muted||e(t)}),0)}}class sf{constructor(e,t,n,r){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=r,this.user=vs.UNAUTHENTICATED,this.clientId=Vs.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(n,(async e=>{Ss("FirestoreClient","Received user=",e.uid),await this.authCredentialListener(e),this.user=e})),this.appCheckCredentials.start(n,(e=>(Ss("FirestoreClient","Received new app check token=",e),this.appCheckCredentialListener(e,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new Is(Cs.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Ns;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=fd(t,"Failed to shutdown persistence");e.reject(n)}})),e.promise}}async function of(e,t){e.asyncQueue.verifyOperationInProgress(),Ss("FirestoreClient","Initializing OfflineComponentProvider");const n=e.configuration;await t.initialize(n);let r=n.initialUser;e.setCredentialChangeListener((async e=>{r.isEqual(e)||(await uh(t.localStore,e),r=e)})),t.persistence.setDatabaseDeletedListener((()=>e.terminate())),e._offlineComponents=t}async function lf(e,t){e.asyncQueue.verifyOperationInProgress();const n=await uf(e);Ss("FirestoreClient","Initializing OnlineComponentProvider"),await t.initialize(n,e.configuration),e.setCredentialChangeListener((e=>ld(t.remoteStore,e))),e.setAppCheckTokenChangeListener(((e,n)=>ld(t.remoteStore,n))),e._onlineComponents=t}function cf(e){return"FirebaseError"===e.name?e.code===Cs.FAILED_PRECONDITION||e.code===Cs.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||22===e.code||20===e.code||11===e.code}async function uf(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){Ss("FirestoreClient","Using user provided OfflineComponentProvider");try{await of(e,e._uninitializedComponentsProvider._offline)}catch(t){const n=t;if(!cf(n))throw n;Es("Error using user provided cache. Falling back to memory cache: "+n),await of(e,new nf)}}else Ss("FirestoreClient","Using default OfflineComponentProvider"),await of(e,new nf);return e._offlineComponents}async function hf(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(Ss("FirestoreClient","Using user provided OnlineComponentProvider"),await lf(e,e._uninitializedComponentsProvider._online)):(Ss("FirestoreClient","Using default OnlineComponentProvider"),await lf(e,new rf))),e._onlineComponents}function df(e){return hf(e).then((e=>e.syncEngine))}async function ff(e){const t=await hf(e),n=t.eventManager;return n.onListen=Dd.bind(null,t.syncEngine),n.onUnlisten=Md.bind(null,t.syncEngine),n.onFirstRemoteStoreListen=jd.bind(null,t.syncEngine),n.onLastRemoteStoreUnlisten=Fd.bind(null,t.syncEngine),n}function pf(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=new Ns;return e.asyncQueue.enqueueAndForget((async()=>function(e,t,n,r,a){const i=new af({next:i=>{t.enqueueAndForget((()=>wd(e,s)));const o=i.docs.has(n);!o&&i.fromCache?a.reject(new Is(Cs.UNAVAILABLE,"Failed to get document because the client is offline.")):o&&i.fromCache&&r&&"server"===r.source?a.reject(new Is(Cs.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):a.resolve(i)},error:e=>a.reject(e)}),s=new Ad(Il(n.path),i,{includeMetadataChanges:!0,ra:!0});return bd(e,s)}(await ff(e),e.asyncQueue,t,n,r))),r.promise}function mf(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=new Ns;return e.asyncQueue.enqueueAndForget((async()=>function(e,t,n,r,a){const i=new af({next:n=>{t.enqueueAndForget((()=>wd(e,s))),n.fromCache&&"server"===r.source?a.reject(new Is(Cs.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):a.resolve(n)},error:e=>a.reject(e)}),s=new Ad(n,i,{includeMetadataChanges:!0,ra:!0});return bd(e,s)}(await ff(e),e.asyncQueue,t,n,r))),r.promise}function gf(e){const t={};return void 0!==e.timeoutSeconds&&(t.timeoutSeconds=e.timeoutSeconds),t}const vf=new Map;function yf(e,t,n){if(!n)throw new Is(Cs.INVALID_ARGUMENT,"Function ".concat(e,"() cannot be called with an empty ").concat(t,"."))}function bf(e){if(!Qs.isDocumentKey(e))throw new Is(Cs.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but ".concat(e," has ").concat(e.length,"."))}function wf(e){if(Qs.isDocumentKey(e))throw new Is(Cs.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but ".concat(e," has ").concat(e.length,"."))}function Sf(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e="".concat(e.substring(0,20),"...")),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";{const t=function(e){return e.constructor?e.constructor.name:null}(e);return t?"a custom ".concat(t," object"):"an object"}}return"function"==typeof e?"a function":_s()}function Tf(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new Is(Cs.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Sf(e);throw new Is(Cs.INVALID_ARGUMENT,"Expected type '".concat(t.name,"', but it was: ").concat(n))}}return e}function Ef(e,t){if(t<=0)throw new Is(Cs.INVALID_ARGUMENT,"Function ".concat(e,"() requires a positive number, but it was: ").concat(t,"."))}class xf{constructor(e){var t,n;if(void 0===e.host){if(void 0!==e.ssl)throw new Is(Cs.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new Is(Cs.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}(function(e,t,n,r){if(!0===t&&!0===r)throw new Is(Cs.INVALID_ARGUMENT,"".concat(e," and ").concat(n," cannot be used together."))})("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===e.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=gf(null!==(n=e.experimentalLongPollingOptions)&&void 0!==n?n:{}),function(e){if(void 0!==e.timeoutSeconds){if(isNaN(e.timeoutSeconds))throw new Is(Cs.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(e.timeoutSeconds," (must not be NaN)"));if(e.timeoutSeconds<5)throw new Is(Cs.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(e.timeoutSeconds," (minimum allowed value is 5)"));if(e.timeoutSeconds>30)throw new Is(Cs.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(e.timeoutSeconds," (maximum allowed value is 30)"))}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(e,t){return e.timeoutSeconds===t.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class _f{constructor(e,t,n,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new xf({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new Is(Cs.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new Is(Cs.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new xf(e),void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new Rs;switch(e.type){case"firstParty":return new Ls(e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new Is(Cs.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=vf.get(e);t&&(Ss("ComponentProvider","Removing Datastore"),vf.delete(e),t.terminate())}(this),Promise.resolve()}}function Af(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};var a;const i=(e=Tf(e,_f))._getSettings(),s="".concat(t,":").concat(n);if("firestore.googleapis.com"!==i.host&&i.host!==s&&Es("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),e._setSettings(Object.assign(Object.assign({},i),{host:s,ssl:!1})),r.mockUserToken){let t,n;if("string"==typeof r.mockUserToken)t=r.mockUserToken,n=vs.MOCK_USER;else{t=function(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=t||"demo-project",r=e.iat||0,a=e.sub||e.user_id;if(!a)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const i=Object.assign({iss:"https://securetoken.google.com/".concat(n),aud:n,iat:r,exp:r+3600,auth_time:r,sub:a,user_id:a,firebase:{sign_in_provider:"custom",identities:{}}},e);return[Me(JSON.stringify({alg:"none",type:"JWT"})),Me(JSON.stringify(i)),""].join(".")}(r.mockUserToken,null===(a=e._app)||void 0===a?void 0:a.options.projectId);const i=r.mockUserToken.sub||r.mockUserToken.user_id;if(!i)throw new Is(Cs.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");n=new vs(i)}e._authCredentials=new Ds(new Os(t,n))}}class kf{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new kf(this.firestore,e,this._query)}}class Cf{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new If(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Cf(this.firestore,e,this._key)}}class If extends kf{constructor(e,t,n){super(e,t,Il(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Cf(this.firestore,null,new Qs(e))}withConverter(e){return new If(this.firestore,e,this._path)}}function Nf(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];if(e=at(e),yf("collection","path",t),e instanceof _f){const n=qs.fromString(t,...r);return wf(n),new If(e,null,n)}{if(!(e instanceof Cf||e instanceof If))throw new Is(Cs.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child(qs.fromString(t,...r));return wf(n),new If(e.firestore,null,n)}}function Of(e,t){if(e=Tf(e,_f),yf("collectionGroup","collection id",t),t.indexOf("/")>=0)throw new Is(Cs.INVALID_ARGUMENT,"Invalid collection ID '".concat(t,"' passed to function collectionGroup(). Collection IDs must not contain '/'."));return new kf(e,null,function(e){return new kl(qs.emptyPath(),e)}(t))}function Rf(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];if(e=at(e),1===arguments.length&&(t=Vs.newId()),yf("doc","path",t),e instanceof _f){const n=qs.fromString(t,...r);return bf(n),new Cf(e,null,new Qs(n))}{if(!(e instanceof Cf||e instanceof If))throw new Is(Cs.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child(qs.fromString(t,...r));return bf(n),new Cf(e.firestore,e instanceof If?e.converter:null,new Qs(n))}}class Df{constructor(){this.iu=Promise.resolve(),this.su=[],this.ou=!1,this._u=[],this.au=null,this.uu=!1,this.cu=!1,this.lu=[],this.Yo=new Nh(this,"async_queue_retry"),this.hu=()=>{const e=Ch();e&&Ss("AsyncQueue","Visibility state changed to "+e.visibilityState),this.Yo.Wo()};const e=Ch();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.hu)}get isShuttingDown(){return this.ou}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Pu(),this.Iu(e)}enterRestrictedMode(e){if(!this.ou){this.ou=!0,this.cu=e||!1;const t=Ch();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.hu)}}enqueue(e){if(this.Pu(),this.ou)return new Promise((()=>{}));const t=new Ns;return this.Iu((()=>this.ou&&this.cu?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.su.push(e),this.Tu())))}async Tu(){if(0!==this.su.length){try{await this.su[0](),this.su.shift(),this.Yo.reset()}catch(YE){if(!so(YE))throw YE;Ss("AsyncQueue","Operation failed with retryable error: "+YE)}this.su.length>0&&this.Yo.$o((()=>this.Tu()))}}Iu(e){const t=this.iu.then((()=>(this.uu=!0,e().catch((e=>{this.au=e,this.uu=!1;const t=function(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}(e);throw Ts("INTERNAL UNHANDLED ERROR: ",t),e})).then((e=>(this.uu=!1,e))))));return this.iu=t,t}enqueueAfterDelay(e,t,n){this.Pu(),this.lu.indexOf(e)>-1&&(t=0);const r=dd.createAndSchedule(this,e,t,n,(e=>this.Eu(e)));return this._u.push(r),r}Pu(){this.au&&_s()}verifyOperationInProgress(){}async du(){let e;do{e=this.iu,await e}while(e!==this.iu)}Au(e){for(const t of this._u)if(t.timerId===e)return!0;return!1}Ru(e){return this.du().then((()=>{this._u.sort(((e,t)=>e.targetTimeMs-t.targetTimeMs));for(const t of this._u)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.du()}))}Vu(e){this.lu.push(e)}Eu(e){const t=this._u.indexOf(e);this._u.splice(t,1)}}class jf extends _f{constructor(e,t,n,r){super(e,t,n,r),this.type="firestore",this._queue=new Df,this._persistenceKey=(null==r?void 0:r.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||Lf(this),this._firestoreClient.terminate()}}function Pf(e){return e._firestoreClient||Lf(e),e._firestoreClient.verifyNotTerminated(),e._firestoreClient}function Lf(e){var t,n,r;const a=e._freezeSettings(),i=function(e,t,n,r){return new Do(e,t,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,gf(r.experimentalLongPollingOptions),r.useFetchStreams)}(e._databaseId,(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",e._persistenceKey,a);e._firestoreClient=new sf(e._authCredentials,e._appCheckCredentials,e._queue,i),(null===(n=a.localCache)||void 0===n?void 0:n._offlineComponentProvider)&&(null===(r=a.localCache)||void 0===r?void 0:r._onlineComponentProvider)&&(e._firestoreClient._uninitializedComponentsProvider={_offlineKind:a.localCache.kind,_offline:a.localCache._offlineComponentProvider,_online:a.localCache._onlineComponentProvider})}class Mf{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Mf(_o.fromBase64String(e))}catch(e){throw new Is(Cs.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(e){return new Mf(_o.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class Ff{constructor(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(let r=0;r<t.length;++r)if(0===t[r].length)throw new Is(Cs.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ys(t)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Uf{constructor(e){this._methodName=e}}class Vf{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Is(Cs.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Is(Cs.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Bs(this._lat,e._lat)||Bs(this._long,e._long)}}const Bf=/^__.*__$/;class zf{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return null!==this.fieldMask?new Ic(e,this.data,this.fieldMask,t,this.fieldTransforms):new Cc(e,this.data,t,this.fieldTransforms)}}class Hf{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new Ic(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function Wf(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw _s()}}class Gf{constructor(e,t,n,r,a,i){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===a&&this.mu(),this.fieldTransforms=a||[],this.fieldMask=i||[]}get path(){return this.settings.path}get fu(){return this.settings.fu}gu(e){return new Gf(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}pu(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.gu({path:n,yu:!1});return r.wu(e),r}Su(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.gu({path:n,yu:!1});return r.mu(),r}bu(e){return this.gu({path:void 0,yu:!0})}Du(e){return sp(e,this.settings.methodName,this.settings.Cu||!1,this.path,this.settings.vu)}contains(e){return void 0!==this.fieldMask.find((t=>e.isPrefixOf(t)))||void 0!==this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))}mu(){if(this.path)for(let e=0;e<this.path.length;e++)this.wu(this.path.get(e))}wu(e){if(0===e.length)throw this.Du("Document fields must not be empty");if(Wf(this.fu)&&Bf.test(e))throw this.Du('Document fields cannot begin and end with "__"')}}class qf{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||Ih(e)}Fu(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return new Gf({fu:e,methodName:t,vu:n,path:Ys.emptyPath(),yu:!1,Cu:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Kf(e){const t=e._freezeSettings(),n=Ih(e._databaseId);return new qf(e._databaseId,!!t.ignoreUndefinedProperties,n)}function Yf(e,t,n,r,a){let i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};const s=e.Fu(i.merge||i.mergeFields?2:0,t,n,a);np("Data must be an object, but it was:",s,r);const o=ep(r,s);let l,c;if(i.merge)l=new Eo(s.fieldMask),c=s.fieldTransforms;else if(i.mergeFields){const e=[];for(const r of i.mergeFields){const a=rp(t,r,n);if(!s.contains(a))throw new Is(Cs.INVALID_ARGUMENT,"Field '".concat(a,"' is specified in your field mask but missing from your input data."));op(e,a)||e.push(a)}l=new Eo(e),c=s.fieldTransforms.filter((e=>l.covers(e.field)))}else l=null,c=s.fieldTransforms;return new zf(new Jo(o),l,c)}class Qf extends Uf{_toFieldTransform(e){if(2!==e.fu)throw 1===e.fu?e.Du("".concat(this._methodName,"() can only appear at the top level of your update data")):e.Du("".concat(this._methodName,"() cannot be used with set() unless you pass {merge:true}"));return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Qf}}function Xf(e,t,n,r){const a=e.Fu(1,t,n);np("Data must be an object, but it was:",a,r);const i=[],s=Jo.empty();go(r,((e,r)=>{const o=ip(t,e,n);r=at(r);const l=a.Su(o);if(r instanceof Qf)i.push(o);else{const e=Zf(r,l);null!=e&&(i.push(o),s.set(o,e))}}));const o=new Eo(i);return new Hf(s,o,a.fieldTransforms)}function Jf(e,t,n,r,a,i){const s=e.Fu(1,t,n),o=[rp(t,r,n)],l=[a];if(i.length%2!=0)throw new Is(Cs.INVALID_ARGUMENT,"Function ".concat(t,"() needs to be called with an even number of arguments that alternate between field names and values."));for(let d=0;d<i.length;d+=2)o.push(rp(t,i[d])),l.push(i[d+1]);const c=[],u=Jo.empty();for(let d=o.length-1;d>=0;--d)if(!op(c,o[d])){const e=o[d];let t=l[d];t=at(t);const n=s.Su(e);if(t instanceof Qf)c.push(e);else{const r=Zf(t,n);null!=r&&(c.push(e),u.set(e,r))}}const h=new Eo(c);return new Hf(u,h,s.fieldTransforms)}function $f(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return Zf(n,e.Fu(r?4:3,t))}function Zf(e,t){if(tp(e=at(e)))return np("Unsupported field value:",t,e),ep(e,t);if(e instanceof Uf)return function(e,t){if(!Wf(t.fu))throw t.Du("".concat(e._methodName,"() can only be used with update() and set()"));if(!t.path)throw t.Du("".concat(e._methodName,"() is not currently supported inside arrays"));const n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.yu&&4!==t.fu)throw t.Du("Nested arrays are not supported");return function(e,t){const n=[];let r=0;for(const a of e){let e=Zf(a,t.bu(r));null==e&&(e={nullValue:"NULL_VALUE"}),n.push(e),r++}return{arrayValue:{values:n}}}(e,t)}return function(e,t){if(null===(e=at(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return sc(t.serializer,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){const n=Hs.fromDate(e);return{timestampValue:uu(t.serializer,n)}}if(e instanceof Hs){const n=new Hs(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:uu(t.serializer,n)}}if(e instanceof Vf)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof Mf)return{bytesValue:hu(t.serializer,e._byteString)};if(e instanceof Cf){const n=t.databaseId,r=e.firestore._databaseId;if(!r.isEqual(n))throw t.Du("Document reference is for database ".concat(r.projectId,"/").concat(r.database," but should be for database ").concat(n.projectId,"/").concat(n.database));return{referenceValue:pu(e.firestore._databaseId||t.databaseId,e._key.path)}}throw t.Du("Unsupported field value: ".concat(Sf(e)))}(e,t)}function ep(e,t){const n={};return vo(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):go(e,((e,r)=>{const a=Zf(r,t.pu(e));null!=a&&(n[e]=a)})),{mapValue:{fields:n}}}function tp(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof Hs||e instanceof Vf||e instanceof Mf||e instanceof Cf||e instanceof Uf)}function np(e,t,n){if(!tp(n)||!function(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}(n)){const r=Sf(n);throw"an object"===r?t.Du(e+" a custom object"):t.Du(e+" "+r)}}function rp(e,t,n){if((t=at(t))instanceof Ff)return t._internalPath;if("string"==typeof t)return ip(e,t);throw sp("Field path arguments must be of type string or ",e,!1,void 0,n)}const ap=new RegExp("[~\\*/\\[\\]]");function ip(e,t,n){if(t.search(ap)>=0)throw sp("Invalid field path (".concat(t,"). Paths must not contain '~', '*', '/', '[', or ']'"),e,!1,void 0,n);try{return new Ff(...t.split("."))._internalPath}catch(r){throw sp("Invalid field path (".concat(t,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"),e,!1,void 0,n)}}function sp(e,t,n,r,a){const i=r&&!r.isEmpty(),s=void 0!==a;let o="Function ".concat(t,"() called with invalid data");n&&(o+=" (via `toFirestore()`)"),o+=". ";let l="";return(i||s)&&(l+=" (found",i&&(l+=" in field ".concat(r)),s&&(l+=" in document ".concat(a)),l+=")"),new Is(Cs.INVALID_ARGUMENT,o+e+l)}function op(e,t){return e.some((e=>e.isEqual(t)))}class lp{constructor(e,t,n,r,a){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=r,this._converter=a}get id(){return this._key.path.lastSegment()}get ref(){return new Cf(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new cp(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(up("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class cp extends lp{data(){return super.data()}}function up(e,t){return"string"==typeof t?ip(e,t):t instanceof Ff?t._internalPath:t._delegate._internalPath}function hp(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new Is(Cs.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class dp{}class fp extends dp{}function pp(e,t){let n=[];for(var r=arguments.length,a=new Array(r>2?r-2:0),i=2;i<r;i++)a[i-2]=arguments[i];t instanceof dp&&n.push(t),n=n.concat(a),function(e){const t=e.filter((e=>e instanceof vp)).length,n=e.filter((e=>e instanceof mp)).length;if(t>1||t>0&&n>0)throw new Is(Cs.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const s of n)e=s._apply(e);return e}class mp extends fp{constructor(e,t,n){super(),this._field=e,this._op=t,this._value=n,this.type="where"}static _create(e,t,n){return new mp(e,t,n)}_apply(e){const t=this._parse(e);return kp(e._query,t),new kf(e.firestore,e.converter,Pl(e._query,t))}_parse(e){const t=Kf(e.firestore),n=function(e,t,n,r,a,i,s){let o;if(a.isKeyField()){if("array-contains"===i||"array-contains-any"===i)throw new Is(Cs.INVALID_ARGUMENT,"Invalid Query. You can't perform '".concat(i,"' queries on documentId()."));if("in"===i||"not-in"===i){Ap(s,i);const t=[];for(const n of s)t.push(_p(r,e,n));o={arrayValue:{values:t}}}else o=_p(r,e,s)}else"in"!==i&&"not-in"!==i&&"array-contains-any"!==i||Ap(s,i),o=$f(n,t,s,"in"===i||"not-in"===i);return sl.create(a,i,o)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value);return n}}function gp(e,t,n){const r=t,a=up("where",e);return mp._create(a,r,n)}class vp extends dp{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new vp(e,t)}_parse(e){const t=this._queryConstraints.map((t=>t._parse(e))).filter((e=>e.getFilters().length>0));return 1===t.length?t[0]:ol.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return 0===t.getFilters().length?e:(function(e,t){let n=e;const r=t.getFlattenedFilters();for(const a of r)kp(n,a),n=Pl(n,a)}(e._query,t),new kf(e.firestore,e.converter,Pl(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class yp extends fp{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new yp(e,t)}_apply(e){const t=function(e,t,n){if(null!==e.startAt)throw new Is(Cs.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==e.endAt)throw new Is(Cs.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new rl(t,n)}(e._query,this._field,this._direction);return new kf(e.firestore,e.converter,function(e,t){const n=e.explicitOrderBy.concat([t]);return new kl(e.path,e.collectionGroup,n,e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(e._query,t))}}function bp(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc",n=up("orderBy",e);return yp._create(n,t)}class wp extends fp{constructor(e,t,n){super(),this.type=e,this._limit=t,this._limitType=n}static _create(e,t,n){return new wp(e,t,n)}_apply(e){return new kf(e.firestore,e.converter,Ll(e._query,this._limit,this._limitType))}}function Sp(e){return Ef("limit",e),wp._create("limit",e,"F")}class Tp extends fp{constructor(e,t,n){super(),this.type=e,this._docOrFields=t,this._inclusive=n}static _create(e,t,n){return new Tp(e,t,n)}_apply(e){const t=xp(e,this.type,this._docOrFields,this._inclusive);return new kf(e.firestore,e.converter,function(e,t){return new kl(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,t,e.endAt)}(e._query,t))}}function Ep(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Tp._create("startAfter",t,!1)}function xp(e,t,n,r){if(n[0]=at(n[0]),n[0]instanceof lp)return function(e,t,n,r,a){if(!r)throw new Is(Cs.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for ".concat(n,"()."));const i=[];for(const s of Rl(e))if(s.field.isKeyField())i.push(Ho(t,r.key));else{const e=r.data.field(s.field);if(No(e))throw new Is(Cs.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+s.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===e){const e=s.field.canonicalString();throw new Is(Cs.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '".concat(e,"' (used as the orderBy) does not exist."))}i.push(e)}return new el(i,a)}(e._query,e.firestore._databaseId,t,n[0]._document,r);{const a=Kf(e.firestore);return function(e,t,n,r,a,i){const s=e.explicitOrderBy;if(a.length>s.length)throw new Is(Cs.INVALID_ARGUMENT,"Too many arguments provided to ".concat(r,"(). The number of arguments must be less than or equal to the number of orderBy() clauses"));const o=[];for(let l=0;l<a.length;l++){const i=a[l];if(s[l].field.isKeyField()){if("string"!=typeof i)throw new Is(Cs.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in ".concat(r,"(), but got a ").concat(typeof i));if(!Ol(e)&&-1!==i.indexOf("/"))throw new Is(Cs.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by documentId(), the value passed to ".concat(r,"() must be a plain document ID, but '").concat(i,"' contains a slash."));const n=e.path.child(qs.fromString(i));if(!Qs.isDocumentKey(n))throw new Is(Cs.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by documentId(), the value passed to ".concat(r,"() must result in a valid document path, but '").concat(n,"' is not because it contains an odd number of segments."));const a=new Qs(n);o.push(Ho(t,a))}else{const e=$f(n,r,i);o.push(e)}}return new el(o,i)}(e._query,e.firestore._databaseId,a,t,n,r)}}function _p(e,t,n){if("string"==typeof(n=at(n))){if(""===n)throw new Is(Cs.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Ol(t)&&-1!==n.indexOf("/"))throw new Is(Cs.INVALID_ARGUMENT,"Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '".concat(n,"' contains a '/' character."));const r=t.path.child(qs.fromString(n));if(!Qs.isDocumentKey(r))throw new Is(Cs.INVALID_ARGUMENT,"Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '".concat(r,"' is not because it has an odd number of segments (").concat(r.length,")."));return Ho(e,new Qs(r))}if(n instanceof Cf)return Ho(e,n._key);throw new Is(Cs.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ".concat(Sf(n),"."))}function Ap(e,t){if(!Array.isArray(e)||0===e.length)throw new Is(Cs.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '".concat(t.toString(),"' filters."))}function kp(e,t){const n=function(e,t){for(const n of e)for(const e of n.getFlattenedFilters())if(t.indexOf(e.op)>=0)return e.op;return null}(e.filters,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==n)throw n===t.op?new Is(Cs.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '".concat(t.op.toString(),"' filter.")):new Is(Cs.INVALID_ARGUMENT,"Invalid query. You cannot use '".concat(t.op.toString(),"' filters with '").concat(n.toString(),"' filters."))}class Cp{convertValue(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";switch(Lo(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Co(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Io(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw _s()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";const n={};return go(e,((e,r)=>{n[e]=this.convertValue(r,t)})),n}convertGeoPoint(e){return new Vf(Co(e.latitude),Co(e.longitude))}convertArray(e,t){return(e.values||[]).map((e=>this.convertValue(e,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const n=Oo(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(Ro(e));default:return null}}convertTimestamp(e){const t=ko(e);return new Hs(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=qs.fromString(e);As(Lu(n));const r=new jo(n.get(1),n.get(3)),a=new Qs(n.popFirst(5));return r.isEqual(t)||Ts("Document ".concat(a," contains a document reference within a different database (").concat(r.projectId,"/").concat(r.database,") which is not supported. It will be treated as a reference in the current database (").concat(t.projectId,"/").concat(t.database,") instead.")),a}}function Ip(e,t,n){let r;return r=e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t,r}class Np{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Op extends lp{constructor(e,t,n,r,a,i){super(e,t,n,r,i),this._firestore=e,this._firestoreImpl=e,this.metadata=a}exists(){return super.exists()}data(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._document){if(this._converter){const t=new Rp(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this._document){const n=this._document.data.field(up("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}class Rp extends Op{data(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return super.data(e)}}class Dp{constructor(e,t,n,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new Np(r.hasPendingWrites,r.fromCache),this.query=n}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach((n=>{e.call(t,new Rp(this._firestore,this._userDataWriter,n.key,n,new Np(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(){const e=!!(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new Is(Cs.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){let t=0;return e._snapshot.docChanges.map((n=>{const r=new Rp(e._firestore,e._userDataWriter,n.doc.key,n.doc,new Np(e._snapshot.mutatedKeys.has(n.doc.key),e._snapshot.fromCache),e.query.converter);return n.doc,{type:"added",doc:r,oldIndex:-1,newIndex:t++}}))}{let n=e._snapshot.oldDocs;return e._snapshot.docChanges.filter((e=>t||3!==e.type)).map((t=>{const r=new Rp(e._firestore,e._userDataWriter,t.doc.key,t.doc,new Np(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter);let a=-1,i=-1;return 0!==t.type&&(a=n.indexOf(t.doc.key),n=n.delete(t.doc.key)),1!==t.type&&(n=n.add(t.doc),i=n.indexOf(t.doc.key)),{type:jp(t.type),doc:r,oldIndex:a,newIndex:i}}))}}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}}function jp(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return _s()}}function Pp(e){e=Tf(e,Cf);const t=Tf(e.firestore,jf);return pf(Pf(t),e._key).then((n=>Hp(t,e,n)))}class Lp extends Cp{constructor(e){super(),this.firestore=e}convertBytes(e){return new Mf(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Cf(this.firestore,null,t)}}function Mp(e){e=Tf(e,kf);const t=Tf(e.firestore,jf),n=Pf(t),r=new Lp(t);return hp(e._query),mf(n,e._query).then((n=>new Dp(t,r,e,n)))}function Fp(e,t,n){e=Tf(e,Cf);const r=Tf(e.firestore,jf),a=Ip(e.converter,t,n);return zp(r,[Yf(Kf(r),"setDoc",e._key,a,null!==e.converter,n).toMutation(e._key,wc.none())])}function Up(e,t,n){e=Tf(e,Cf);const r=Tf(e.firestore,jf),a=Kf(r);let i;for(var s=arguments.length,o=new Array(s>3?s-3:0),l=3;l<s;l++)o[l-3]=arguments[l];return i="string"==typeof(t=at(t))||t instanceof Ff?Jf(a,"updateDoc",e._key,t,n,o):Xf(a,"updateDoc",e._key,t),zp(r,[i.toMutation(e._key,wc.exists(!0))])}function Vp(e){return zp(Tf(e.firestore,jf),[new Dc(e._key,wc.none())])}function Bp(e,t){const n=Tf(e.firestore,jf),r=Rf(e),a=Ip(e.converter,t);return zp(n,[Yf(Kf(e.firestore),"addDoc",r._key,a,null!==e.converter,{}).toMutation(r._key,wc.exists(!1))]).then((()=>r))}function zp(e,t){return function(e,t){const n=new Ns;return e.asyncQueue.enqueueAndForget((async()=>async function(e,t,n){const r=tf(e);try{const e=await function(e,t){const n=ks(e),r=Hs.now(),a=t.reduce(((e,t)=>e.add(t.key)),tc());let i,s;return n.persistence.runTransaction("Locally write mutations","readwrite",(e=>{let o=ql(),l=tc();return n.os.getEntries(e,a).next((e=>{o=e,o.forEach(((e,t)=>{t.isValidDocument()||(l=l.add(e))}))})).next((()=>n.localDocuments.getOverlayedDocuments(e,o))).next((a=>{i=a;const s=[];for(const e of t){const t=Ac(e,i.get(e.key).overlayedDocument);null!=t&&s.push(new Ic(e.key,t,$o(t.value.mapValue),wc.exists(!0)))}return n.mutationQueue.addMutationBatch(e,r,s,t)})).next((t=>{s=t;const r=t.applyToLocalDocumentSet(i,l);return n.documentOverlayCache.saveOverlays(e,t.batchId,r)}))})).then((()=>({batchId:s.batchId,changes:Ql(i)})))}(r.localStore,t);r.sharedClientState.addPendingMutation(e.batchId),function(e,t,n){let r=e.xa[e.currentUser.toKey()];r||(r=new yo(Bs)),r=r.insert(t,n),e.xa[e.currentUser.toKey()]=r}(r,e.batchId,n),await Jd(r,e.changes),await Zh(r.remoteStore)}catch(e){const t=fd(e,"Failed to persist write");n.reject(t)}}(await df(e),t,n))),n.promise}(Pf(e),t)}function Hp(e,t,n){const r=n.docs.get(t._key),a=new Lp(e);return new Op(e,a,t._key,r,new Np(n.hasPendingWrites,n.fromCache),t.converter)}new WeakMap;!function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];!function(e){ys=e}(wn),mn(new it("firestore",((e,n)=>{let{instanceIdentifier:r,options:a}=n;const i=e.getProvider("app").getImmediate(),s=new jf(new js(e.getProvider("auth-internal")),new Fs(e.getProvider("app-check-internal")),function(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new Is(Cs.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new jo(e.options.projectId,t)}(i,r),i);return a=Object.assign({useFetchStreams:t},a),s._setSettings(a),s}),"PUBLIC").setMultipleInstances(!0)),En(gs,"4.6.4",e),En(gs,"4.6.4","esm2017")}();const Wp=Sn({apiKey:"AIzaSyDaw_dmAdCtOrYavwTmLiV9UGMZtvvgDI8",authDomain:"webapp-e610b.firebaseapp.com",projectId:"webapp-e610b",storageBucket:"webapp-e610b.appspot.com",messagingSenderId:"541829448237",appId:"1:541829448237:web:0a04b7f539750b4e60aea4"}),Gp=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Tn();const t=gn(e,"auth");if(t.isInitialized())return t.getImmediate();const n=function(e,t){const n=gn(e,"auth");if(n.isInitialized()){const e=n.getImmediate();if(Je(n.getOptions(),null!==t&&void 0!==t?t:{}))return e;zn(e,"already-initialized")}return n.initialize({options:t})}(e,{popupRedirectResolver:Yi,persistence:[ri,Va,za]}),r=He("authTokenSyncURL");if(r&&"boolean"===typeof isSecureContext&&isSecureContext){const e=new URL(r,location.origin);if(location.origin===e.origin){const t=(a=e.toString(),async e=>{const t=e&&await e.getIdTokenResult(),n=t&&((new Date).getTime()-Date.parse(t.issuedAtTime))/1e3;if(n&&n>$i)return;const r=null===t||void 0===t?void 0:t.token;Zi!==r&&(Zi=r,await fetch(a,{method:r?"POST":"DELETE",headers:r?{Authorization:"Bearer ".concat(r)}:{}}))});!function(e,t,n){at(e).beforeAuthStateChanged(t,n)}(n,t,(()=>t(n.currentUser))),function(e,t,n,r){at(e).onIdTokenChanged(t,n,r)}(n,(e=>t(e)))}}var a;const i=Be("auth");return i&&aa(n,"http://".concat(i)),n}(Wp),qp=function(e,t){const n="string"==typeof e?e:t||"(default)",r=gn("object"==typeof e?e:Tn(),"firestore").getImmediate({identifier:n});if(!r._initialized){const e=(e=>{const t=Be(e);if(!t)return;const n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw new Error("Invalid host ".concat(t," with no separate hostname and port!"));const r=parseInt(t.substring(n+1),10);return"["===t[0]?[t.substring(1,n-1),r]:[t.substring(0,n),r]})("firestore");e&&Af(r,...e)}return r}(Wp),Kp=n.p+"static/media/MC_logo_dark.5a8bb7f067c1cc14badb.png";var Yp=n(579);const Qp=()=>{const[e,t]=(0,a.useState)(""),[n,r]=(0,a.useState)(""),[i,s]=(0,a.useState)(null),o=re();return(0,Yp.jsx)("div",{className:"login-container",children:(0,Yp.jsxs)("div",{className:"login-box",children:[(0,Yp.jsx)("img",{src:Kp,alt:"Logga"}),(0,Yp.jsxs)("form",{onSubmit:async t=>{t.preventDefault(),s(null);try{var r;const t=await La(Gp,e,n);console.log("Inloggning lyckades");const a=t.user,i=null===(r=(await Pp(Rf(qp,"users",a.uid))).data())||void 0===r?void 0:r.role;console.log("Anv\xe4ndarroll:",i),"admin"===i?o("/admin/dashboard"):"user"===i?o("/user/dashboard"):"sales-manager"===i?o("/sales-manager/dashboard"):"quality"===i?o("/quality/dashboard"):"uppdragsgivare"===i?o("/uppdragsgivare/dashboard"):(s("Ingen giltig roll hittades f\xf6r anv\xe4ndaren."),console.error("Ingen giltig roll hittades f\xf6r anv\xe4ndaren."))}catch(i){s("Fel vid inloggning: "+i.message),console.error("Fel vid inloggning:",i)}},children:[(0,Yp.jsx)("label",{htmlFor:"email",children:"E-post"}),(0,Yp.jsx)("input",{type:"email",id:"email",value:e,onChange:e=>t(e.target.value),placeholder:"Enter your email address"}),(0,Yp.jsx)("label",{htmlFor:"password",children:"L\xf6senord"}),(0,Yp.jsx)("input",{type:"password",id:"password",value:n,onChange:e=>r(e.target.value),placeholder:"Enter your password"}),(0,Yp.jsx)("button",{type:"submit",children:"Logga in"})]}),i&&(0,Yp.jsx)("p",{style:{color:"red"},children:i}),(0,Yp.jsx)("a",{href:"/forgot-password",className:"forgot-password",children:"Gl\xf6mt ditt l\xf6senord?"})]})})},Xp=()=>{const[e,t]=(0,a.useState)(0),[n,r]=(0,a.useState)(0),[i,s]=(0,a.useState)([]),[o,l]=(0,a.useState)([]),[c,u]=(0,a.useState)([]),[h,d]=(0,a.useState)([]),[f,p]=(0,a.useState)(!0),m=()=>{const e=new Date;let t,n;return e.getDate()>=18?(t=new Date(e.getFullYear(),e.getMonth(),18),n=new Date(e.getFullYear(),e.getMonth()+1,17)):(t=new Date(e.getFullYear(),e.getMonth()-1,18),n=new Date(e.getFullYear(),e.getMonth(),17)),t.setHours(0,0,0,0),n.setHours(23,59,59,999),{start:t,end:n}};(0,a.useEffect)((()=>{g()}),[]);const g=async()=>{p(!0),await Promise.all([y(),b(),w(),S(),v()]),p(!1)},v=async()=>{const{start:e,end:t}=(()=>{const e=new Date,t=new Date(e),n=new Date(e);return t.setDate(e.getDate()-1),t.setHours(0,0,0,0),n.setDate(e.getDate()-1),n.setHours(23,59,59,999),{start:t,end:n}})();try{const n=(await Mp(Nf(qp,"finalReports"))).docs.map((e=>e.data())).filter((n=>{const r=new Date(n.date);return r>=e&&r<=t})),r={};n.forEach((e=>{const t=e.managerName||"Ok\xe4nt team";r[t]||(r[t]=0),r[t]+=parseFloat(e.totalSales||0)}));const a=Object.entries(r).map((e=>{let[t,n]=e;return{team:t,totalSales:n}}));a.sort(((e,t)=>t.totalSales-e.totalSales)),d(a)}catch(n){console.error("Error fetching yesterday's stats:",n)}},y=async()=>{const{start:e,end:n}=m();try{const a=(await Mp(Nf(qp,"finalReports"))).docs.map((e=>e.data())).filter((t=>{const r=new Date(t.date);return r>=e&&r<=n})),i=a.reduce(((e,t)=>e+parseFloat(t.totalSales||0)),0),s=a.length>0?i/a.length:0;t(i),r(s)}catch(a){console.error("Error fetching total sales:",a)}},b=async()=>{const{start:e,end:t}=m();try{const n=Nf(qp,"users"),r=(await Mp(n)).docs.map((async n=>{const r=n.id,a=n.data(),i="".concat(a.firstName," ").concat(a.lastName),s=pp(Nf(qp,"users/".concat(r,"/reports")),gp("date",">=",e.toISOString()),gp("date","<=",t.toISOString())),o=(await Mp(s)).docs.reduce(((e,t)=>{const n=t.data();return e+parseFloat(n.sales||0)}),0);return{userName:i,totalSales:o}})),a=(await Promise.all(r)).filter((e=>e.totalSales>0)).sort(((e,t)=>t.totalSales-e.totalSales)).slice(0,10);s(a)}catch(n){console.error("Error fetching top users:",n)}},w=async()=>{const{start:e,end:t}=m();try{const n=(await Mp(Nf(qp,"finalReports"))).docs.map((e=>e.data())).filter((n=>{const r=new Date(n.date);return r>=e&&r<=t})),r={};n.forEach((e=>{const t=e.managerUid;r[t]||(r[t]=0),r[t]+=parseFloat(e.totalSales||0)}));const a=Object.entries(r).map((async e=>{var t;let[n,r]=e;const a=null===(t=(await Mp(pp(Nf(qp,"users"),gp("__name__","==",n)))).docs[0])||void 0===t?void 0:t.data();return{managerName:a?"".concat(a.firstName," ").concat(a.lastName):n,totalSales:r}})),i=(await Promise.all(a)).sort(((e,t)=>t.totalSales-e.totalSales)).slice(0,5);l(i)}catch(n){console.error("Error fetching top teams:",n)}},S=async()=>{const{start:e,end:t}=m();try{const n=(await Mp(Nf(qp,"finalReports"))).docs.map((e=>e.data())).filter((n=>{const r=new Date(n.date);return r>=e&&r<=t})),r={};n.forEach((e=>{const t=e.organisation;r[t]||(r[t]={totalSales:0,reportCount:0}),r[t].totalSales+=parseFloat(e.totalSales||0),r[t].reportCount+=1}));const a=Object.entries(r).map((e=>{let[t,n]=e;return{orgName:t,totalSales:n.totalSales,avgSales:n.reportCount>0?n.totalSales/n.reportCount:0}}));u(a)}catch(n){console.error("Error fetching organization stats:",n)}};return(0,Yp.jsxs)("div",{className:"dashboard-content",children:[(0,Yp.jsx)("h1",{className:"dashboard-title",children:"Dashboard"}),(0,Yp.jsx)("button",{className:"refresh-btn",onClick:g,children:"Uppdatera Data"}),f?(0,Yp.jsx)("p",{children:"Laddar..."}):(0,Yp.jsxs)("div",{className:"dashboard-grid",children:[(0,Yp.jsxs)("div",{className:"total-sales-stats",children:[(0,Yp.jsx)("h2",{children:"Total Statistik"}),(0,Yp.jsxs)("p",{children:[(0,Yp.jsx)("strong",{children:"Totalt antal Avtal:"})," ",e]}),(0,Yp.jsxs)("p",{children:[(0,Yp.jsx)("strong",{children:"Genomsnittlig Avtal per rapport:"})," ",n.toFixed(2)]})]}),(0,Yp.jsxs)("div",{className:"top-users",children:[(0,Yp.jsx)("h2",{children:"Top 10 s\xe4ljare"}),(0,Yp.jsx)("ul",{children:i.map(((e,t)=>(0,Yp.jsxs)("li",{children:[t+1,". ",e.userName,": ",e.totalSales," Avtal"]},t)))})]}),(0,Yp.jsxs)("div",{className:"top-sales-managers",children:[(0,Yp.jsx)("h2",{children:"B\xe4sta team"}),(0,Yp.jsx)("ul",{children:o.map(((e,t)=>(0,Yp.jsxs)("li",{children:[t+1,". ",e.managerName,": ",e.totalSales," Avtal"]},t)))})]}),(0,Yp.jsxs)("div",{className:"org-sales-stats",children:[(0,Yp.jsx)("h2",{children:"Organisation Statistik"}),(0,Yp.jsx)("ul",{children:c.map(((e,t)=>(0,Yp.jsxs)("li",{children:[t+1,". ",e.orgName,": ",e.totalSales," Avtal (Genomsnitt: ",e.avgSales.toFixed(2),")"]},t)))})]}),(0,Yp.jsxs)("div",{className:"yesterday-stats",children:[(0,Yp.jsx)("h2",{children:"G\xe5rdagens Statistik"}),(0,Yp.jsx)("ul",{children:h.map(((e,t)=>(0,Yp.jsxs)("li",{children:[t+1,". ",e.team,": ",e.totalSales," Avtal"]},t)))})]})]})]})},Jp=(0,a.createContext)(),$p=()=>(0,a.useContext)(Jp),Zp=e=>{let{children:t}=e;const[n,r]=(0,a.useState)(null),[i,s]=(0,a.useState)(null),[o,l]=(0,a.useState)(!0),[c,u]=(0,a.useState)(!1),h=async e=>{try{const t=await Pp(Rf(qp,"users",e.uid));if(t.exists()){const n=t.data();console.log("User data fetched from Firestore: ",n),r({...e,salesId:n.salesId||null,role:n.role||null}),["user","sales-manager","admin","quality","uppdragsgivare"].includes(n.role)?s(n.role):(console.log("Ogiltig roll hittades f\xf6r anv\xe4ndaren."),s(null))}else console.log("Ingen giltig roll eller salesId hittades f\xf6r anv\xe4ndaren.")}catch(t){console.error("Fel vid h\xe4mtning av anv\xe4ndardata:",t)}};return(0,a.useEffect)((()=>{const e=function(e,t,n,r){return at(e).onAuthStateChanged(t,n,r)}(Gp,(async e=>{console.log("onAuthStateChanged har anropats"),c?console.log("L\xe4gger till en ny anv\xe4ndare. Undviker att uppdatera autentiseringsstatus."):(e?(console.log("Inloggning lyckades, h\xe4mtar anv\xe4ndarens data..."),r(e),await h(e)):(console.log("Ingen anv\xe4ndare inloggad."),r(null),s(null)),l(!1))}));return e}),[c]),o?(0,Yp.jsx)("div",{children:"Laddar anv\xe4ndardata..."}):(0,Yp.jsx)(Jp.Provider,{value:{currentUser:n,currentUserRole:i,fetchUserData:h,isAddingUser:c,setIsAddingUser:u},children:t})},em=()=>{const[e,t]=(0,a.useState)([]),[n,r]=(0,a.useState)(0),[i,s]=(0,a.useState)(0),[o,l]=(0,a.useState)([]),[c,u]=(0,a.useState)([]),[h,d]=(0,a.useState)(!0),{currentUser:f}=$p(),p=()=>{const e=new Date;let t,n;return e.getDate()>=18?(t=new Date(e.getFullYear(),e.getMonth(),18),n=new Date(e.getFullYear(),e.getMonth()+1,17)):(t=new Date(e.getFullYear(),e.getMonth()-1,18),n=new Date(e.getFullYear(),e.getMonth(),17)),t.setHours(0,0,0,0),n.setHours(23,59,59,999),{start:t,end:n}};(0,a.useEffect)((()=>{f&&m()}),[f]);const m=async()=>{d(!0),await Promise.all([g(),v(),y()]),d(!1)},g=async()=>{if(!f)return;const{start:e,end:n}=p();try{const a=(await Mp(Nf(qp,"users/".concat(f.uid,"/reports")))).docs.map((e=>e.data())).filter((t=>{const r=new Date(t.date);return r>=e&&r<=n})),i=a.reduce(((e,t)=>e+parseFloat(t.sales||0)),0),o=a.length>0?i/a.length:0;t(a),r(i),s(o)}catch(a){console.error("Error fetching user reports:",a)}},v=async()=>{const{start:e,end:t}=p();try{const n=Nf(qp,"users"),r=(await Mp(n)).docs.map((async n=>{const r=n.id,a=n.data(),i="".concat(a.firstName," ").concat(a.lastName),s=pp(Nf(qp,"users/".concat(r,"/reports")),gp("date",">=",e.toISOString()),gp("date","<=",t.toISOString())),o=(await Mp(s)).docs.reduce(((e,t)=>{const n=t.data();return e+parseFloat(n.sales||0)}),0);return{userName:i,totalSales:o}})),a=(await Promise.all(r)).filter((e=>e.totalSales>0)).sort(((e,t)=>t.totalSales-e.totalSales)).slice(0,10);l(a)}catch(n){console.error("Error fetching top users:",n)}},y=async()=>{const{start:e,end:t}=p();try{const n=(await Mp(Nf(qp,"finalReports"))).docs.map((e=>e.data())).filter((n=>{const r=new Date(n.date);return r>=e&&r<=t})),r={};for(const e of n){const t=e.managerUid;r[t]||(r[t]=0),r[t]+=parseFloat(e.totalSales||0)}const a=Object.entries(r).map((async e=>{var t;let[n,r]=e;const a=null===(t=(await Mp(pp(Nf(qp,"users"),gp("__name__","==",n)))).docs[0])||void 0===t?void 0:t.data();return{managerName:a?"".concat(a.firstName," ").concat(a.lastName):n,totalSales:r}})),i=(await Promise.all(a)).sort(((e,t)=>t.totalSales-e.totalSales)).slice(0,5);u(i)}catch(n){console.error("Error fetching top teams:",n)}};return(0,Yp.jsxs)("div",{className:"dashboard-content",children:[(0,Yp.jsx)("h1",{className:"dashboard-title",children:"My Sales Dashboard"}),(0,Yp.jsx)("button",{className:"refresh-btn",onClick:m,children:h?"Laddar...":"Uppdatera Data"}),h?(0,Yp.jsx)("p",{children:"Laddar..."}):(0,Yp.jsxs)("div",{className:"dashboard-grid",children:[(0,Yp.jsxs)("div",{className:"total-sales-stats",children:[(0,Yp.jsx)("h2",{children:"Mina f\xf6rs\xe4ljningsstatistik"}),(0,Yp.jsxs)("p",{children:[(0,Yp.jsx)("strong",{children:"Totalt antal Avtal:"})," ",n]}),(0,Yp.jsxs)("p",{children:[(0,Yp.jsx)("strong",{children:"Genomsnittlig Avtal per rapport:"})," ",i.toFixed(2)]})]}),(0,Yp.jsxs)("div",{className:"top-users",children:[(0,Yp.jsx)("h2",{children:"Top 10 s\xe4ljare"}),(0,Yp.jsx)("ul",{children:o.map(((e,t)=>(0,Yp.jsxs)("li",{children:[t+1,". ",e.userName,": ",e.totalSales," Avtal"]},t)))})]}),(0,Yp.jsxs)("div",{className:"top-sales-managers",children:[(0,Yp.jsx)("h2",{children:"B\xe4sta team (Sales Managers)"}),(0,Yp.jsx)("ul",{children:c.map(((e,t)=>(0,Yp.jsxs)("li",{children:[t+1,". ",e.managerName,": ",e.totalSales," Avtal"]},t)))})]})]})]})},tm=()=>{const[e,t]=(0,a.useState)([]),[n,r]=(0,a.useState)(0),[i,s]=(0,a.useState)(0),[o,l]=(0,a.useState)(0),[c,u]=(0,a.useState)(0),[h,d]=(0,a.useState)([]),[f,p]=(0,a.useState)([]),[m,g]=(0,a.useState)([]),[v,y]=(0,a.useState)([]),[b,w]=(0,a.useState)(!0),{currentUser:S}=$p(),T=()=>{const e=new Date;let t,n;return e.getDate()>=18?(t=new Date(e.getFullYear(),e.getMonth(),18),n=new Date(e.getFullYear(),e.getMonth()+1,17)):(t=new Date(e.getFullYear(),e.getMonth()-1,18),n=new Date(e.getFullYear(),e.getMonth(),17)),t.setHours(0,0,0,0),n.setHours(23,59,59,999),{start:t,end:n}};(0,a.useEffect)((()=>{S&&E()}),[S]);const E=async()=>{w(!0),await Promise.all([_(),A(),k(),C(),x()]),w(!1)},x=async()=>{const{start:e,end:t}=(()=>{const e=new Date,t=new Date(e),n=new Date(e);return t.setDate(e.getDate()-1),t.setHours(0,0,0,0),n.setDate(e.getDate()-1),n.setHours(23,59,59,999),{start:t,end:n}})();try{const n=(await Mp(Nf(qp,"finalReports"))).docs.map((e=>e.data())).filter((n=>{const r=new Date(n.date);return r>=e&&r<=t})),r={};n.forEach((e=>{const t=e.managerName||"Ok\xe4nt team";r[t]||(r[t]=0),r[t]+=parseFloat(e.totalSales||0)}));const a=Object.entries(r).map((e=>{let[t,n]=e;return{team:t,totalSales:n}}));a.sort(((e,t)=>t.totalSales-e.totalSales)),y(a)}catch(n){console.error("Error fetching yesterday's stats:",n)}},_=async()=>{if(!S)return;const{start:e,end:n}=T();try{const a=(await Mp(Nf(qp,"users/".concat(S.uid,"/reports")))).docs.map((e=>e.data())).filter((t=>{const r=new Date(t.date);return r>=e&&r<=n})),i=a.reduce(((e,t)=>e+parseFloat(t.sales||0)),0),o=a.length>0?i/a.length:0;t(a),r(i),s(o)}catch(a){console.error("Error fetching user reports:",a)}},A=async()=>{if(!S)return;const{start:e,end:t}=T();try{const n=pp(Nf(qp,"users"),gp("managerUid","==",S.uid)),r=await Mp(n),a=await Promise.all(r.docs.map((async n=>{const r=n.id,a="".concat(n.data().firstName," ").concat(n.data().lastName),i=pp(Nf(qp,"users/".concat(r,"/reports")),gp("date",">=",e.toISOString()),gp("date","<=",t.toISOString())),s=(await Mp(i)).docs.reduce(((e,t)=>{const n=t.data();return e+parseFloat(n.sales||0)}),0);return{userName:a,totalSales:s}}))),i=a.reduce(((e,t)=>e+t.totalSales),0),s=a.length>0?i/a.length:0;d(a),l(i),u(s)}catch(n){console.error("Error fetching team data:",n)}},k=async()=>{const{start:e,end:t}=T();try{const n=(await Mp(Nf(qp,"users"))).docs.map((async n=>{const r=n.id,a=n.data(),i="".concat(a.firstName," ").concat(a.lastName),s=pp(Nf(qp,"users/".concat(r,"/reports")),gp("date",">=",e.toISOString()),gp("date","<=",t.toISOString())),o=(await Mp(s)).docs.reduce(((e,t)=>{const n=t.data();return e+parseFloat(n.sales||0)}),0);return{userName:i,totalSales:o}})),r=(await Promise.all(n)).filter((e=>e.totalSales>0)).sort(((e,t)=>t.totalSales-e.totalSales)).slice(0,10);p(r)}catch(n){console.error("Error fetching top users:",n)}},C=async()=>{const{start:e,end:t}=T();try{const n=(await Mp(Nf(qp,"finalReports"))).docs.map((e=>e.data())).filter((n=>{const r=new Date(n.date);return r>=e&&r<=t})),r={};for(const e of n){const t=e.managerUid;r[t]||(r[t]=0),r[t]+=parseFloat(e.totalSales||0)}const a=Object.entries(r).map((async e=>{var t;let[n,r]=e;const a=null===(t=(await Mp(pp(Nf(qp,"users"),gp("__name__","==",n)))).docs[0])||void 0===t?void 0:t.data();return{managerName:a?"".concat(a.firstName," ").concat(a.lastName):n,totalSales:r}})),i=(await Promise.all(a)).sort(((e,t)=>t.totalSales-e.totalSales)).slice(0,5);g(i)}catch(n){console.error("Error fetching top teams:",n)}};return(0,Yp.jsxs)("div",{className:"sales-manager-dashboard",children:[(0,Yp.jsx)("h1",{className:"dashboard-title",children:"Dashboard"}),(0,Yp.jsx)("button",{className:"refresh-btn",onClick:E,children:"Uppdatera Data"}),b?(0,Yp.jsx)("p",{children:"Laddar..."}):(0,Yp.jsxs)(Yp.Fragment,{children:[(0,Yp.jsxs)("div",{className:"team-sales-stats",children:[(0,Yp.jsx)("h2",{children:"Team Statistik"}),(0,Yp.jsxs)("p",{children:[(0,Yp.jsx)("strong",{children:"Totalt antal avtal f\xf6r teamet:"})," ",o]}),(0,Yp.jsxs)("p",{children:[(0,Yp.jsx)("strong",{children:"Genomsnittlig f\xf6rs\xe4ljning per medlem:"})," ",c.toFixed(2)]})]}),(0,Yp.jsxs)("div",{className:"my-sales-stats",children:[(0,Yp.jsx)("h2",{children:"Mina f\xf6rs\xe4ljningsstatistik"}),(0,Yp.jsxs)("p",{children:[(0,Yp.jsx)("strong",{children:"Totalt antal avtal:"})," ",n]}),(0,Yp.jsxs)("p",{children:[(0,Yp.jsx)("strong",{children:"Genomsnittlig avtal per rapport:"})," ",i.toFixed(2)]})]}),(0,Yp.jsxs)("div",{className:"top-users",children:[(0,Yp.jsx)("h2",{children:"Top 10 s\xe4ljare"}),(0,Yp.jsx)("ul",{children:f.map(((e,t)=>(0,Yp.jsxs)("li",{children:[t+1,". ",e.userName,": ",e.totalSales," avtal"]},t)))})]}),(0,Yp.jsxs)("div",{className:"top-sales-managers",children:[(0,Yp.jsx)("h2",{children:"B\xe4sta team"}),(0,Yp.jsx)("ul",{children:m.map(((e,t)=>(0,Yp.jsxs)("li",{children:[t+1,". ",e.managerName,": ",e.totalSales," avtal"]},t)))})]}),(0,Yp.jsxs)("div",{className:"yesterday-stats",children:[(0,Yp.jsx)("h2",{children:"G\xe5rdagens Statistik"}),(0,Yp.jsx)("ul",{children:v.map(((e,t)=>(0,Yp.jsxs)("li",{children:[t+1,". ",e.team,": ",e.totalSales," avtal"]},t)))})]})]})]})},nm=()=>{const[e,t]=(0,a.useState)({regSales:0,invalidAmount:0,outOfTarget:0,pending:0}),[n,r]=(0,a.useState)([]),[i,s]=(0,a.useState)("");(0,a.useEffect)((()=>{o()}),[]);const o=async()=>{try{const e=new Date,n=new Date((e.getDate(),e.getFullYear()),e.getDate()>=18?e.getMonth():e.getMonth()-1,18),a=new Date(n.getFullYear(),n.getMonth()+1,17,23,59,59),i=pp(Nf(qp,"qualityReports"),gp("createdAt",">=",n.toISOString()),gp("createdAt","<=",a.toISOString())),s=await Mp(i),o={regSales:0,invalidAmount:0,outOfTarget:0,pending:0},l={};s.docs.forEach((e=>{const t=e.data(),n=t.organisation||"Ok\xe4nd Organisation";l[n]||(l[n]={regSales:0,invalidAmount:0,outOfTarget:0,pending:0}),Object.values(t.members||{}).forEach((e=>{o.regSales+=e.regSales||0,o.invalidAmount+=e.invalidAmount||0,o.outOfTarget+=e.outOfTarget||0,o.pending+=e.pending||0,l[n].regSales+=e.regSales||0,l[n].invalidAmount+=e.invalidAmount||0,l[n].outOfTarget+=e.outOfTarget||0,l[n].pending+=e.pending||0}))})),t(o),r(Object.entries(l))}catch(e){s("Fel vid h\xe4mtning av data."),console.error("Error fetching period totals:",e)}};return(0,Yp.jsxs)("div",{className:"quality-dashboard",children:[(0,Yp.jsx)("h1",{children:"Dashboard"}),(0,Yp.jsx)("button",{className:"update-button",onClick:o,children:"Uppdatera Data"}),i&&(0,Yp.jsx)("p",{className:"error-message",children:i}),(0,Yp.jsxs)("div",{className:"summary-cards",children:[(0,Yp.jsxs)("div",{className:"summary-card",children:[(0,Yp.jsx)("h3",{children:"Reg S\xe4lj"}),(0,Yp.jsx)("p",{children:e.regSales})]}),(0,Yp.jsxs)("div",{className:"summary-card",children:[(0,Yp.jsx)("h3",{children:"Ogiltigt Belopp"}),(0,Yp.jsx)("p",{children:e.invalidAmount})]}),(0,Yp.jsxs)("div",{className:"summary-card",children:[(0,Yp.jsx)("h3",{children:"Utanf\xf6r m\xe5lgrupp"}),(0,Yp.jsx)("p",{children:e.outOfTarget})]}),(0,Yp.jsxs)("div",{className:"summary-card",children:[(0,Yp.jsx)("h3",{children:"Pending"}),(0,Yp.jsx)("p",{children:e.pending})]})]}),(0,Yp.jsx)("h2",{children:"Statistik per Organisation"}),(0,Yp.jsx)("div",{className:"organization-stats",children:n.map((e=>{let[t,n]=e;return(0,Yp.jsxs)("div",{className:"organization-card",children:[(0,Yp.jsx)("h3",{children:t}),(0,Yp.jsxs)("p",{children:[(0,Yp.jsx)("strong",{children:"Reg S\xe4lj:"})," ",n.regSales]}),(0,Yp.jsxs)("p",{children:[(0,Yp.jsx)("strong",{children:"Ogiltigt Belopp:"})," ",n.invalidAmount]}),(0,Yp.jsxs)("p",{children:[(0,Yp.jsx)("strong",{children:"Utanf\xf6r m\xe5lgrupp:"})," ",n.outOfTarget]}),(0,Yp.jsxs)("p",{children:[(0,Yp.jsx)("strong",{children:"Pending:"})," ",n.pending]})]},t)}))})]})},rm=()=>{const[e,t]=(0,a.useState)([]),[n,r]=(0,a.useState)([]),[i,s]=(0,a.useState)(null),[o,l]=(0,a.useState)([]),[c,u]=(0,a.useState)(""),[h,d]=(0,a.useState)(""),[f,p]=(0,a.useState)({}),[m,g]=(0,a.useState)(""),[v,y]=(0,a.useState)([]),[b,w]=(0,a.useState)(null),[S,T]=(0,a.useState)({}),[E,x]=(0,a.useState)([]),[_,A]=(0,a.useState)(null);(0,a.useEffect)((()=>{k(),N(),I()}),[]),(0,a.useEffect)((()=>{i?C(i):r([])}),[i]);const k=async()=>{try{const e=pp(Nf(qp,"users"),gp("role","==","sales-manager")),n=(await Mp(e)).docs.map((e=>({id:e.id,...e.data()})));t(n)}catch(e){console.error("Fel vid h\xe4mtning av Sales Managers:",e)}},C=async e=>{try{const t=pp(Nf(qp,"users"),gp("managerUid","==",e)),n=(await Mp(t)).docs.map((e=>({id:e.id,...e.data()})));r(n)}catch(t){console.error("Fel vid h\xe4mtning av teammedlemmar:",t)}},I=async()=>{try{const e=Nf(qp,"organizations"),t=(await Mp(e)).docs.map((e=>({id:e.id,...e.data()})));x(t)}catch(e){console.error("Fel vid h\xe4mtning av organisationer:",e)}},N=async()=>{try{const e=pp(Nf(qp,"qualityReports"),bp("createdAt","desc"),Sp(10)),t=(await Mp(e)).docs.map((e=>({id:e.id,...e.data()})));y(t)}catch(e){console.error("Fel vid h\xe4mtning av senaste rapporter:",e)}};(0,a.useEffect)((()=>{(async()=>{if(c&&i&&h)try{const e=pp(Nf(qp,"finalReports"),gp("date","==",c),gp("managerUid","==",i),gp("organisation","==",h)),t=await Mp(e);if(t.empty)A(null);else{const e=t.docs[0].data();A(e.salesData||{})}}catch(e){console.error("Fel vid h\xe4mtning av finalReport:",e),A(null)}else A(null)})()}),[c,i,h]);const O=(e,t,n)=>{p((r=>{const a={...r[e],[t]:parseFloat(n)||0};return a.total=a.regSales-a.invalidAmount-a.outOfTarget-a.pending,{...r,[e]:a}}))},R=(e,t,n)=>{T((r=>{const a={...r[e],[t]:parseFloat(n)||0};return a.total=a.regSales-a.invalidAmount-a.outOfTarget-a.pending,{...r,[e]:a}}))};return(0,Yp.jsxs)("div",{className:"final-report-container",children:[(0,Yp.jsx)("h1",{children:"Rapportering Kvalit\xe9"}),(0,Yp.jsxs)("div",{className:"filter-container",children:[(0,Yp.jsx)("label",{children:"Datum:"}),(0,Yp.jsx)("input",{type:"date",value:c,onChange:e=>u(e.target.value),required:!0}),(0,Yp.jsx)("label",{children:"Organisation:"}),(0,Yp.jsxs)("select",{value:h,onChange:e=>d(e.target.value),required:!0,children:[(0,Yp.jsx)("option",{value:"",children:"V\xe4lj organisation"}),E.map((e=>(0,Yp.jsx)("option",{value:e.name,children:e.name},e.id)))]})]}),!b&&(0,Yp.jsxs)(Yp.Fragment,{children:[(0,Yp.jsxs)("div",{className:"filter-container",children:[(0,Yp.jsx)("label",{children:"V\xe4lj Sales Manager:"}),(0,Yp.jsxs)("select",{onChange:e=>s(e.target.value),value:i||"",children:[(0,Yp.jsx)("option",{value:"",children:"V\xe4lj en Sales Manager"}),e.map((e=>(0,Yp.jsxs)("option",{value:e.id,children:[e.firstName," ",e.lastName]},e.id)))]})]}),n.length>0&&(0,Yp.jsxs)("div",{className:"dropdown-container",children:[(0,Yp.jsx)("label",{children:"L\xe4gg till teammedlem:"}),(0,Yp.jsxs)("select",{onChange:e=>{const t=e.target.value;if(t&&!o.find((e=>e.id===t))){const e=n.find((e=>e.id===t));l([...o,e]),p((e=>({...e,[t]:{regSales:0,invalidAmount:0,outOfTarget:0,pending:0,total:0}})))}},children:[(0,Yp.jsx)("option",{value:"",children:"V\xe4lj teammedlem"}),n.filter((e=>!o.find((t=>t.id===e.id)))).map((e=>(0,Yp.jsxs)("option",{value:e.id,children:[e.firstName," ",e.lastName]},e.id)))]}),(0,Yp.jsx)("button",{onClick:()=>{const e=[...o],t={...f};n.forEach((n=>{e.some((e=>e.id===n.id))||(e.push(n),t[n.id]={regSales:0,invalidAmount:0,outOfTarget:0,pending:0,total:0})})),l(e),p(t)},className:"add-all-button",children:"L\xe4gg till alla medlemmar"})]}),(0,Yp.jsxs)("table",{className:"report-table",children:[(0,Yp.jsx)("thead",{children:(0,Yp.jsxs)("tr",{children:[(0,Yp.jsx)("th",{children:"Teammedlem"}),(0,Yp.jsx)("th",{children:"Sales ID"}),(0,Yp.jsx)("th",{children:"Reg S\xe4lj"}),(0,Yp.jsx)("th",{children:"Ogiltigt Belopp"}),(0,Yp.jsx)("th",{children:"Utanf\xf6r m\xe5lgrupp"}),(0,Yp.jsx)("th",{children:"Pending"}),(0,Yp.jsx)("th",{children:"Total"}),(0,Yp.jsx)("th",{children:"Status"}),(0,Yp.jsx)("th",{children:"\xc5tg\xe4rder"})]})}),(0,Yp.jsx)("tbody",{children:o.map((e=>{var t,n,r,a,i,s;return(0,Yp.jsxs)("tr",{children:[(0,Yp.jsxs)("td",{"data-label":"Teammedlem",children:[e.firstName," ",e.lastName]}),(0,Yp.jsx)("td",{"data-label":"Sales ID",children:e.salesId||"N/A"}),(0,Yp.jsx)("td",{"data-label":"Reg S\xe4lj",children:(0,Yp.jsx)("input",{type:"number",value:(null===(t=f[e.id])||void 0===t?void 0:t.regSales)||0,onChange:t=>O(e.id,"regSales",t.target.value)})}),(0,Yp.jsx)("td",{"data-label":"Ogiltigt Belopp",children:(0,Yp.jsx)("input",{type:"number",value:(null===(n=f[e.id])||void 0===n?void 0:n.invalidAmount)||0,onChange:t=>O(e.id,"invalidAmount",t.target.value)})}),(0,Yp.jsx)("td",{"data-label":"Utanf\xf6r m\xe5lgrupp",children:(0,Yp.jsx)("input",{type:"number",value:(null===(r=f[e.id])||void 0===r?void 0:r.outOfTarget)||0,onChange:t=>O(e.id,"outOfTarget",t.target.value)})}),(0,Yp.jsx)("td",{"data-label":"Pending",children:(0,Yp.jsx)("input",{type:"number",value:(null===(a=f[e.id])||void 0===a?void 0:a.pending)||0,onChange:t=>O(e.id,"pending",t.target.value)})}),(0,Yp.jsx)("td",{"data-label":"Total",children:(null===(i=f[e.id])||void 0===i?void 0:i.total)||0}),(0,Yp.jsx)("td",{"data-label":"Status",children:_?(null===(s=_[e.id])||void 0===s?void 0:s.status)||"Ingen status":"\u2013"}),(0,Yp.jsx)("td",{"data-label":"\xc5tg\xe4rder",children:(0,Yp.jsx)("button",{className:"remove-button",onClick:()=>{return t=e.id,l(o.filter((e=>e.id!==t))),void p((e=>{const{[t]:n,...r}=e;return r}));var t},children:"Ta bort"})})]},e.id)}))})]}),(0,Yp.jsx)("button",{onClick:async()=>{if(c&&h)if(i||0!==o.length)try{const e=o.map((e=>e.id)),t=Object.fromEntries(o.map((e=>{var t;const n=_&&null!==(t=_[e.id])&&void 0!==t&&t.status?_[e.id].status:"Ingen status";return[e.id,{...f[e.id],name:"".concat(e.firstName," ").concat(e.lastName),salesId:e.salesId||"N/A",status:n}]}))),n={date:c,organisation:h,members:t,assignedTo:i?[i,...e]:e,managerUid:i,createdAt:(new Date).toISOString()},r=await Bp(Nf(qp,"qualityReports"),n);for(const[a,i]of Object.entries(t)){const e=Nf(Rf(qp,"users",a),"qualityReports"),t={date:c,organisation:h,...i,createdAt:(new Date).toISOString(),reportId:r.id};await Bp(e,t)}g("Rapporten har skapats framg\xe5ngsrikt."),u(""),d(""),l([]),p({}),N()}catch(e){console.error("Fel vid skapande av rapport:",e),g("Ett fel uppstod vid skapandet av rapporten.")}else alert("V\xe4lj minst en Sales Manager eller en Teammedlem.");else alert("Datum och organisation \xe4r obligatoriska.")},className:"submit-button",children:"Spara Rapport"})]}),b&&(0,Yp.jsxs)("div",{className:"edit-report",children:[(0,Yp.jsx)("h2",{children:"\xc4ndra Rapport"}),(0,Yp.jsxs)("table",{className:"report-table",children:[(0,Yp.jsx)("thead",{children:(0,Yp.jsxs)("tr",{children:[(0,Yp.jsx)("th",{children:"Teammedlem"}),(0,Yp.jsx)("th",{children:"Sales ID"}),(0,Yp.jsx)("th",{children:"Reg S\xe4lj"}),(0,Yp.jsx)("th",{children:"Ogiltigt Belopp"}),(0,Yp.jsx)("th",{children:"Utanf\xf6r m\xe5lgrupp"}),(0,Yp.jsx)("th",{children:"Pending"}),(0,Yp.jsx)("th",{children:"Total"})]})}),(0,Yp.jsx)("tbody",{children:Object.entries(S).map((e=>{let[t,n]=e;return(0,Yp.jsxs)("tr",{children:[(0,Yp.jsx)("td",{"data-label":"Teammedlem",children:n.name||"N/A"}),(0,Yp.jsx)("td",{"data-label":"Sales ID",children:n.salesId||"N/A"}),(0,Yp.jsx)("td",{"data-label":"Reg S\xe4lj",children:(0,Yp.jsx)("input",{type:"number",value:n.regSales||0,onChange:e=>R(t,"regSales",e.target.value)})}),(0,Yp.jsx)("td",{"data-label":"Ogiltigt Belopp",children:(0,Yp.jsx)("input",{type:"number",value:n.invalidAmount||0,onChange:e=>R(t,"invalidAmount",e.target.value)})}),(0,Yp.jsx)("td",{"data-label":"Utanf\xf6r m\xe5lgrupp",children:(0,Yp.jsx)("input",{type:"number",value:n.outOfTarget||0,onChange:e=>R(t,"outOfTarget",e.target.value)})}),(0,Yp.jsx)("td",{"data-label":"Pending",children:(0,Yp.jsx)("input",{type:"number",value:n.pending||0,onChange:e=>R(t,"pending",e.target.value)})}),(0,Yp.jsx)("td",{"data-label":"Total",children:n.total||0})]},t)}))})]}),(0,Yp.jsx)("button",{onClick:async()=>{if(b)try{const e={...b,date:c,organisation:h,members:S,updatedAt:(new Date).toISOString()};await Fp(Rf(qp,"qualityReports",b.id),e);for(const[t,n]of Object.entries(S)){const r=Nf(Rf(qp,"users",t),"qualityReports"),a=pp(r,gp("reportId","==",b.id));(await Mp(a)).forEach((async t=>{await Fp(Rf(r,t.id),{date:e.date,organisation:e.organisation,...n,updatedAt:(new Date).toISOString(),reportId:b.id})}))}y((t=>t.map((t=>t.id===b.id?e:t)))),g("Rapporten har uppdaterats framg\xe5ngsrikt."),w(null),T({}),u(""),d("")}catch(e){console.error("Fel vid uppdatering av rapport:",e),g("Ett fel uppstod vid uppdateringen av rapporten.")}},className:"submit-button",children:"Spara \xc4ndringar"}),(0,Yp.jsx)("button",{onClick:()=>w(null),className:"cancel-button",children:"Avbryt"})]}),m&&(0,Yp.jsx)("p",{className:"message",children:m}),(0,Yp.jsxs)("div",{className:"recent-reports",children:[(0,Yp.jsx)("h2",{children:"Senaste Rapporter"}),v.map((e=>(0,Yp.jsxs)("div",{className:"report-log",children:[(0,Yp.jsxs)("h3",{children:[e.date," - ",e.organisation]}),(0,Yp.jsx)("button",{onClick:()=>(e=>{w(e),T(e.members),u(e.date),d(e.organisation)})(e),className:"edit-button",children:"\xc4ndra"}),(0,Yp.jsx)("button",{onClick:()=>(async e=>{try{await Vp(Rf(qp,"qualityReports",e)),y(v.filter((t=>t.id!==e))),g("Rapporten har tagits bort framg\xe5ngsrikt.")}catch(t){console.error("Fel vid borttagning av rapport:",t),g("Ett fel uppstod vid borttagningen av rapporten.")}})(e.id),className:"delete-button",children:"Ta bort"}),(0,Yp.jsxs)("table",{className:"report-table",children:[(0,Yp.jsx)("thead",{children:(0,Yp.jsxs)("tr",{children:[(0,Yp.jsx)("th",{children:"Teammedlem"}),(0,Yp.jsx)("th",{children:"Sales ID"}),(0,Yp.jsx)("th",{children:"Reg S\xe4lj"}),(0,Yp.jsx)("th",{children:"Ogiltigt Belopp"}),(0,Yp.jsx)("th",{children:"Utanf\xf6r m\xe5lgrupp"}),(0,Yp.jsx)("th",{children:"Pending"}),(0,Yp.jsx)("th",{children:"Total"})]})}),(0,Yp.jsx)("tbody",{children:Object.entries(e.members||{}).map((e=>{let[t,n]=e;return(0,Yp.jsxs)("tr",{children:[(0,Yp.jsx)("td",{"data-label":"Teammedlem",children:n.name||"N/A"}),(0,Yp.jsx)("td",{"data-label":"Sales ID",children:n.salesId||"N/A"}),(0,Yp.jsx)("td",{"data-label":"Reg S\xe4lj",children:n.regSales||0}),(0,Yp.jsx)("td",{"data-label":"Ogiltigt Belopp",children:n.invalidAmount||0}),(0,Yp.jsx)("td",{"data-label":"Utanf\xf6r m\xe5lgrupp",children:n.outOfTarget||0}),(0,Yp.jsx)("td",{"data-label":"Pending",children:n.pending||0}),(0,Yp.jsx)("td",{"data-label":"Total",children:n.total||0})]},t)}))})]})]},e.id)))]})]})},am=()=>{const[e,t]=(0,a.useState)([]),[n,r]=(0,a.useState)([]),[i,s]=(0,a.useState)(""),[o,l]=(0,a.useState)(""),[c,u]=(0,a.useState)([]),[h,d]=(0,a.useState)([]),[f,p]=(0,a.useState)(""),[m,g]=(0,a.useState)(""),[v,y]=(0,a.useState)({totalSales:0,invalidAmount:0,outOfTarget:0,pending:0});(0,a.useEffect)((()=>{b(),S()}),[]),(0,a.useEffect)((()=>{i?w(i):(r([]),l(""))}),[i]);const b=async()=>{const e=pp(Nf(qp,"users"),gp("role","==","sales-manager")),n=(await Mp(e)).docs.map((e=>({id:e.id,...e.data()})));t(n)},w=async e=>{const t=pp(Nf(qp,"users"),gp("managerUid","==",e)),n=(await Mp(t)).docs.map((e=>({id:e.id,...e.data()})));r(n)},S=async()=>{const e=pp(Nf(qp,"qualityReports"),bp("date","desc")),t=(await Mp(e)).docs.map((e=>({id:e.id,...e.data()})));u(t),d(t),T(t)},T=e=>{const t=e.reduce(((e,t)=>(Object.values(t.members||{}).forEach((t=>{e.totalSales+=t.total||0,e.invalidAmount+=t.invalidAmount||0,e.outOfTarget+=t.outOfTarget||0,e.pending+=t.pending||0})),e)),{totalSales:0,invalidAmount:0,outOfTarget:0,pending:0});y(t)};return(0,Yp.jsxs)("div",{className:"statistics-container",children:[(0,Yp.jsx)("h1",{children:"Kvalit\xe9 Statistik"}),(0,Yp.jsx)("table",{className:"filter-table",children:(0,Yp.jsx)("tbody",{children:(0,Yp.jsxs)("tr",{children:[(0,Yp.jsxs)("td",{children:[(0,Yp.jsx)("label",{children:"Sales Manager:"}),(0,Yp.jsxs)("select",{value:i,onChange:e=>s(e.target.value),children:[(0,Yp.jsx)("option",{value:"",children:"V\xe4lj Sales Manager"}),e.map((e=>(0,Yp.jsxs)("option",{value:e.id,children:[e.firstName," ",e.lastName]},e.id)))]})]}),(0,Yp.jsxs)("td",{children:[(0,Yp.jsx)("label",{children:"Anv\xe4ndare:"}),(0,Yp.jsxs)("select",{value:o,onChange:e=>l(e.target.value),disabled:!n.length,children:[(0,Yp.jsx)("option",{value:"",children:"V\xe4lj Anv\xe4ndare"}),n.map((e=>(0,Yp.jsxs)("option",{value:e.id,children:[e.firstName," ",e.lastName]},e.id)))]})]}),(0,Yp.jsxs)("td",{children:[(0,Yp.jsx)("label",{children:"Startdatum:"}),(0,Yp.jsx)("input",{type:"date",value:f,onChange:e=>p(e.target.value)})]}),(0,Yp.jsxs)("td",{children:[(0,Yp.jsx)("label",{children:"Slutdatum:"}),(0,Yp.jsx)("input",{type:"date",value:m,onChange:e=>g(e.target.value)})]}),(0,Yp.jsxs)("td",{children:[(0,Yp.jsx)("button",{className:"filter-button",onClick:()=>{let e=c;i&&(e=e.filter((e=>e.assignedTo.includes(i)))),o&&(e=e.filter((e=>Object.keys(e.members||{}).includes(o)))),f&&(e=e.filter((e=>e.date>=f))),m&&(e=e.filter((e=>e.date<=m))),d(e),T(e)},children:"Filtrera"}),(0,Yp.jsx)("button",{className:"reset-button",onClick:()=>{s(""),l(""),p(""),g(""),d(c),T(c)},children:"\xc5terst\xe4ll"})]})]})})}),(0,Yp.jsxs)("div",{className:"total-sales",children:[(0,Yp.jsxs)("p",{children:["Total F\xf6rs\xe4ljning: ",v.totalSales," "]}),(0,Yp.jsxs)("p",{children:["Ogiltigt Belopp: ",v.invalidAmount," "]}),(0,Yp.jsxs)("p",{children:["Utanf\xf6r m\xe5lgrupp: ",v.outOfTarget," "]}),(0,Yp.jsxs)("p",{children:["Pending: ",v.pending," "]})]}),(0,Yp.jsx)("div",{className:"table-container",children:(0,Yp.jsxs)("table",{className:"statistics-table",children:[(0,Yp.jsx)("thead",{children:(0,Yp.jsxs)("tr",{children:[(0,Yp.jsx)("th",{children:"Datum"}),(0,Yp.jsx)("th",{children:"Organisation"}),(0,Yp.jsx)("th",{children:"Teammedlem"}),(0,Yp.jsx)("th",{children:"Sales ID"}),(0,Yp.jsx)("th",{children:"Reg S\xe4lj"}),(0,Yp.jsx)("th",{children:"Ogiltigt Belopp"}),(0,Yp.jsx)("th",{children:"Utanf\xf6r m\xe5lgrupp"}),(0,Yp.jsx)("th",{children:"Pending"}),(0,Yp.jsx)("th",{children:"Total"})]})}),(0,Yp.jsx)("tbody",{children:h.map((e=>Object.entries(e.members||{}).map((t=>{let[n,r]=t;return(0,Yp.jsxs)("tr",{children:[(0,Yp.jsx)("td",{children:e.date}),(0,Yp.jsx)("td",{children:e.organisation}),(0,Yp.jsx)("td",{children:r.name||"N/A"}),(0,Yp.jsx)("td",{children:r.salesId||"N/A"}),(0,Yp.jsx)("td",{children:r.regSales||0}),(0,Yp.jsx)("td",{children:r.invalidAmount||0}),(0,Yp.jsx)("td",{children:r.outOfTarget||0}),(0,Yp.jsx)("td",{children:r.pending||0}),(0,Yp.jsx)("td",{children:r.total||0})]},"".concat(e.id,"-").concat(n))}))))})]})})]})},im=()=>{const{currentUser:e,currentUserRole:t,setIsAddingUser:n}=$p(),[r,i]=(0,a.useState)({firstName:"",lastName:"",email:"",password:"",role:"user",salesId:"",managerUid:"",menuComponents:[]}),[s,o]=(0,a.useState)([]),[l,c]=(0,a.useState)("");(0,a.useEffect)((()=>{(async()=>{try{const e=pp(Nf(qp,"users"),gp("role","==","sales-manager")),t=(await Mp(e)).docs.map((e=>({uid:e.id,name:"".concat(e.data().firstName," ").concat(e.data().lastName)})));o(t)}catch(e){console.error("Error fetching sales managers:",e)}})()}),[]);const u=e=>{const{name:t,value:n}=e.target;i((e=>({...e,[t]:n})))};return(0,Yp.jsxs)("div",{className:"add-user-container",children:[(0,Yp.jsx)("h1",{children:"admin"===t?"L\xe4gg till anv\xe4ndare":"L\xe4gg till teammedlem"}),(0,Yp.jsxs)("form",{onSubmit:async a=>{a.preventDefault(),n(!0);try{if(!e)return console.error("Ingen anv\xe4ndare \xe4r inloggad."),void c("Fel: Ingen anv\xe4ndare \xe4r inloggad.");const n=e.email,a=prompt("Ange ditt l\xf6senord igen f\xf6r att forts\xe4tta"),s=await async function(e,t,n){if(vn(e.app))return Promise.reject(Gn(e));const r=Xr(e),a=ra(r,{returnSecureToken:!0,email:t,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",_a),i=await a.catch((t=>{throw t.code==="auth/".concat("password-does-not-meet-requirements")&&Pa(e),t})),s=await Aa._fromIdTokenResponse(r,"signIn",i);return await r._updateCurrentUser(s.user),s}(Gp,r.email,r.password),o=s.user,l={firstName:r.firstName,lastName:r.lastName,email:r.email,role:r.role,salesId:r.salesId||null,managerUid:r.managerUid||null,menuComponents:r.menuComponents};"sales-manager"===t&&(l.managerUid=e.uid),await Fp(Rf(qp,"users",o.uid),l),await La(Gp,n,a),c("Anv\xe4ndare har lagts till framg\xe5ngsrikt."),i({firstName:"",lastName:"",email:"",password:"",role:"user",salesId:"",managerUid:"",menuComponents:[]})}catch(s){console.error("Fel vid till\xe4gg av anv\xe4ndare:",s),c("Ett fel uppstod vid till\xe4gg av anv\xe4ndaren.")}finally{n(!1)}},className:"add-user-form",children:[(0,Yp.jsxs)("div",{className:"form-group",children:[(0,Yp.jsx)("label",{children:"F\xf6rnamn:"}),(0,Yp.jsx)("input",{type:"text",name:"firstName",value:r.firstName,onChange:u,required:!0})]}),(0,Yp.jsxs)("div",{className:"form-group",children:[(0,Yp.jsx)("label",{children:"Efternamn:"}),(0,Yp.jsx)("input",{type:"text",name:"lastName",value:r.lastName,onChange:u,required:!0})]}),(0,Yp.jsxs)("div",{className:"form-group",children:[(0,Yp.jsx)("label",{children:"E-post:"}),(0,Yp.jsx)("input",{type:"email",name:"email",value:r.email,onChange:u,required:!0})]}),(0,Yp.jsxs)("div",{className:"form-group",children:[(0,Yp.jsx)("label",{children:"L\xf6senord:"}),(0,Yp.jsx)("input",{type:"password",name:"password",value:r.password,onChange:u,required:!0})]}),("admin"===t||"sales-manager"===t)&&(0,Yp.jsxs)("div",{className:"form-group",children:[(0,Yp.jsx)("label",{children:"Sales ID:"}),(0,Yp.jsx)("input",{type:"text",name:"salesId",value:r.salesId,onChange:u,placeholder:"Ange Sales ID (valfritt)"})]}),(0,Yp.jsxs)("div",{className:"form-group",children:[(0,Yp.jsx)("label",{children:"Roll:"}),"sales-manager"===t?(0,Yp.jsx)("select",{name:"role",value:r.role,onChange:u,required:!0,children:(0,Yp.jsx)("option",{value:"user",children:"User"})}):(0,Yp.jsxs)("select",{name:"role",value:r.role,onChange:u,required:!0,children:[(0,Yp.jsx)("option",{value:"user",children:"User"}),(0,Yp.jsx)("option",{value:"sales-manager",children:"Sales Manager"}),"admin"===t&&(0,Yp.jsx)("option",{value:"admin",children:"Admin"}),(0,Yp.jsx)("option",{value:"quality",children:"Kvalit\xe9"}),(0,Yp.jsx)("option",{value:"uppdragsgivare",children:"Uppdragsgivare"})]})]}),"admin"===t&&(0,Yp.jsxs)("div",{className:"form-group",children:[(0,Yp.jsx)("label",{children:"V\xe4lj Sales Manager:"}),(0,Yp.jsxs)("select",{name:"managerUid",value:r.managerUid,onChange:u,children:[(0,Yp.jsx)("option",{value:"",children:"V\xe4lj en sales manager (valfritt)"}),s.map((e=>(0,Yp.jsx)("option",{value:e.uid,children:e.name},e.uid)))]})]}),"uppdragsgivare"===r.role&&(0,Yp.jsxs)("div",{className:"form-group",children:[(0,Yp.jsx)("label",{children:"V\xe4lj menykomponenter:"}),(0,Yp.jsx)("div",{children:[{value:"dashboard",label:"Dashboard"},{value:"projects",label:"Mina Projekt"},{value:"reports",label:"Rapporter"},{value:"factor-dashboard",label:"Factor Dashboard"},{value:"hellofresh",label:"HelloFresh"}].map((e=>(0,Yp.jsxs)("label",{children:[(0,Yp.jsx)("input",{type:"checkbox",value:e.value,checked:r.menuComponents.includes(e.value),onChange:()=>{return t=e.value,void i((e=>({...e,menuComponents:e.menuComponents.includes(t)?e.menuComponents.filter((e=>e!==t)):[...e.menuComponents,t]})));var t}}),e.label]},e.value)))})]}),(0,Yp.jsx)("button",{type:"submit",children:"admin"===t?"L\xe4gg till anv\xe4ndare":"L\xe4gg till teammedlem"})]}),l&&(0,Yp.jsx)("p",{className:"message",children:l})]})},sm=()=>{const[e,t]=(0,a.useState)("salesId"),[n,r]=(0,a.useState)(""),[i,s]=(0,a.useState)(null),[o,l]=(0,a.useState)(""),[c,u]=(0,a.useState)(""),[h,d]=(0,a.useState)(""),[f,p]=(0,a.useState)(!1),[m,g]=(0,a.useState)({}),[v,y]=(0,a.useState)(!1),b=e=>{t(e.target.value),r(""),s(null),l(""),u(""),p(!1)};return(0,Yp.jsxs)("div",{className:"sales-info-container",children:[(0,Yp.jsx)("h1",{children:"H\xe4mta anv\xe4ndarinformation"}),(0,Yp.jsxs)("form",{onSubmit:async t=>{t.preventDefault();try{let t;if("salesId"===e)t=pp(Nf(qp,"users"),gp("salesId","==",n));else if("name"===e){const[e,r]=n.split(" ");t=pp(Nf(qp,"users"),gp("firstName","==",e),gp("lastName","==",r))}const r=await Mp(t);if(r.empty)u("Ingen anv\xe4ndare hittades med den angivna informationen."),s(null),l("");else{const e=r.docs[0];s(e.data()),d(e.id),u(""),l(""),p(!1)}}catch(r){u("Ett fel uppstod: ".concat(r.message))}},children:[(0,Yp.jsxs)("div",{className:"search-type",children:[(0,Yp.jsxs)("label",{children:[(0,Yp.jsx)("input",{type:"radio",value:"salesId",checked:"salesId"===e,onChange:b}),"S\xf6k med S\xe4lj ID"]}),(0,Yp.jsxs)("label",{children:[(0,Yp.jsx)("input",{type:"radio",value:"name",checked:"name"===e,onChange:b}),"S\xf6k med Namn"]})]}),(0,Yp.jsx)("label",{htmlFor:"searchValue",children:"salesId"===e?"S\xe4lj ID":"Namn"}),(0,Yp.jsx)("input",{type:"text",id:"searchValue",value:n,onChange:e=>r(e.target.value),placeholder:"salesId"===e?"Ange S\xe4lj ID":"Ange F\xf6rnamn Efternamn"}),(0,Yp.jsx)("button",{type:"submit",children:"H\xe4mta information"})]}),c&&(0,Yp.jsx)("p",{children:c}),i&&(0,Yp.jsxs)("div",{className:"user-info",children:[(0,Yp.jsxs)("p",{children:[(0,Yp.jsx)("strong",{children:"F\xf6rnamn:"})," ",i.firstName]}),(0,Yp.jsxs)("p",{children:[(0,Yp.jsx)("strong",{children:"Efternamn:"})," ",i.lastName]}),(0,Yp.jsxs)("p",{children:[(0,Yp.jsx)("strong",{children:"E-post:"})," ",i.email]}),(0,Yp.jsxs)("p",{children:[(0,Yp.jsx)("strong",{children:"Roll:"})," ",i.role]}),(0,Yp.jsxs)("p",{children:[(0,Yp.jsx)("strong",{children:"S\xe4lj ID:"})," ",i.salesId]}),(0,Yp.jsx)("button",{onClick:async()=>{if(h)try{y(!0);const e=Rf(qp,"users",h),t=await Pp(e);t.exists()?(g(t.data()),p(!0)):u("Kunde inte h\xe4mta anv\xe4ndarprofil.")}catch(e){u("Ett fel uppstod vid h\xe4mtning av anv\xe4ndarprofilen: ".concat(e.message))}finally{y(!1)}},children:"Anv\xe4ndarprofil"}),(0,Yp.jsx)("br",{}),i.salesSpecifications&&Object.keys(i.salesSpecifications).length>0&&(0,Yp.jsxs)(Yp.Fragment,{children:[(0,Yp.jsx)("label",{htmlFor:"menuOption",children:"V\xe4lj en period:"}),(0,Yp.jsxs)("select",{id:"menuOption",value:o,onChange:e=>{l(e.target.value)},children:[(0,Yp.jsx)("option",{value:"",children:"V\xe4lj en period"}),Object.keys(i.salesSpecifications).map(((e,t)=>(0,Yp.jsx)("option",{value:e,children:e},t)))]})]}),o&&i.salesSpecifications&&i.salesSpecifications[o]&&(0,Yp.jsxs)("div",{className:"specification-details",children:[(0,Yp.jsxs)("h2",{children:["S\xe4ljspecifikation f\xf6r ",o]}),(0,Yp.jsxs)("p",{children:[(0,Yp.jsx)("strong",{children:"Totalt inl\xe4sta:"})," ",i.salesSpecifications[o].totalProcessed]}),(0,Yp.jsxs)("p",{children:[(0,Yp.jsx)("strong",{children:"Godk\xe4nda:"})," ",i.salesSpecifications[o].approved]}),(0,Yp.jsxs)("p",{children:[(0,Yp.jsx)("strong",{children:"T\xe4ckning saknas:"})," ",i.salesSpecifications[o].missingCoverage]}),(0,Yp.jsxs)("p",{children:[(0,Yp.jsx)("strong",{children:"Ogiltiga:"})," ",i.salesSpecifications[o].invalid]}),(0,Yp.jsxs)("p",{children:[(0,Yp.jsx)("strong",{children:"Felaktiga:"})," ",i.salesSpecifications[o].incorrect]}),(0,Yp.jsxs)("p",{children:[(0,Yp.jsx)("strong",{children:"\xc5nger:"})," ",i.salesSpecifications[o].withdrawal]}),(0,Yp.jsxs)("p",{children:[(0,Yp.jsx)("strong",{children:"L\xf6negrundade avtal:"})," ",i.salesSpecifications[o].totalApproved]}),(0,Yp.jsxs)("p",{children:[(0,Yp.jsx)("strong",{children:"Provision:"})," ",i.salesSpecifications[o].commission," kr"]}),(0,Yp.jsxs)("p",{children:[(0,Yp.jsx)("strong",{children:"L\xf6n:"})," ",i.salesSpecifications[o].salary," kr"]}),(0,Yp.jsx)("button",{onClick:async()=>{if(o&&h)try{const e=Rf(qp,"users",h),t={...i.salesSpecifications};delete t[o],await Up(e,{salesSpecifications:t}),s((e=>({...e,salesSpecifications:t}))),l(""),u("L\xf6neperioden har tagits bort.")}catch(e){u("Ett fel uppstod vid borttagningen: ".concat(e.message))}},children:"Ta bort denna period"})]})]}),f&&(0,Yp.jsxs)("div",{className:"user-profile",children:[(0,Yp.jsx)("h2",{children:"Anv\xe4ndarprofil"}),v?(0,Yp.jsx)("p",{children:"Laddar anv\xe4ndarprofil..."}):(0,Yp.jsxs)(Yp.Fragment,{children:[(0,Yp.jsxs)("p",{children:[(0,Yp.jsx)("strong",{children:"Namn:"})," ",m.name]}),(0,Yp.jsxs)("p",{children:[(0,Yp.jsx)("strong",{children:"Personnummer:"})," ",m.personnummer]}),(0,Yp.jsxs)("p",{children:[(0,Yp.jsx)("strong",{children:"Startdatum:"})," ",m.startDatum]}),(0,Yp.jsxs)("p",{children:[(0,Yp.jsx)("strong",{children:"Sista arbetsdag:"})," ",m.sistaArbetsdag||"Ej angiven"]}),(0,Yp.jsxs)("p",{children:[(0,Yp.jsx)("strong",{children:"Gatuadress:"})," ",m.gatuadress]}),(0,Yp.jsxs)("p",{children:[(0,Yp.jsx)("strong",{children:"Postnummer och ort:"})," ",m.postnummerOrt]}),(0,Yp.jsxs)("p",{children:[(0,Yp.jsx)("strong",{children:"Telefon:"})," ",m.telefon]}),(0,Yp.jsxs)("p",{children:[(0,Yp.jsx)("strong",{children:"Anh\xf6rig:"})," ",m.anhorig]}),(0,Yp.jsxs)("p",{children:[(0,Yp.jsx)("strong",{children:"Tel. anh\xf6rig:"})," ",m.anhorigTelefon]})]})]})]})},om=()=>{const[e,t]=(0,a.useState)((new Date).getFullYear()),[n,r]=(0,a.useState)(""),[i,s]=(0,a.useState)(""),[o,l]=(0,a.useState)([]),[c,u]=(0,a.useState)({totalProcessed:"",approved:"",missingCoverage:"",invalid:"",incorrect:"",withdrawal:"",previousAdjustment:"",totalApproved:"",commission:"",salary:""}),[h,d]=(0,a.useState)([]),[f,p]=(0,a.useState)([]);(0,a.useEffect)((()=>{d((e=>{const t=["Januari","Februari","Mars","April","Maj","Juni","Juli","Augusti","September","Oktober","November","December"],n=[];for(let r=0;r<t.length;r++){const a=t[r],i=t[(r+1)%t.length];n.push("18 ".concat(a," - 17 ").concat(i," ").concat(e))}return n})(e));(async()=>{const e=await Mp(Nf(qp,"users")),t=e.docs.map((e=>({id:e.id,...e.data()})));l(t);const n=new Set;e.docs.forEach((e=>{const t=e.data().salesSpecifications||{};Object.keys(t).forEach((e=>{const t=e.split(" ").pop();n.add(t)}))})),p([...n].sort(((e,t)=>t-e)))})()}),[e]);const m=e=>{const{name:t,value:n}=e.target;u((e=>{const r={...e,[t]:n};if(["totalProcessed","missingCoverage","invalid","incorrect","withdrawal"].includes(t)){const e=(parseInt(r.totalProcessed)||0)-((parseInt(r.missingCoverage)||0)+(parseInt(r.invalid)||0)+(parseInt(r.incorrect)||0)+(parseInt(r.withdrawal)||0));r.approved=e>=0?e:0}if(["approved","previousAdjustment"].includes(t)){const e=(parseInt(r.approved)||0)+(parseInt(r.previousAdjustment)||0);r.totalApproved=e>=0?e:0}if(["totalApproved","commission"].includes(t)){const e=(parseInt(r.totalApproved)||0)*(parseFloat(r.commission)||0);r.salary=e>=0?e:0}return r}))};return(0,Yp.jsxs)("div",{className:"sales-specification-container",children:[(0,Yp.jsx)("h1",{children:"S\xe4ljspecifikation"}),(0,Yp.jsxs)("form",{onSubmit:async t=>{if(t.preventDefault(),i&&n)try{const t="".concat(n," ").concat(e);console.log("Selected Employee ID:",i),console.log("Period With Year:",t),console.log("Form Data:",c);const r=Rf(qp,"users",i,"salesSpecifications",t);console.log("Dokumentv\xe4gen som skapas:",r.path),await Fp(r,c),console.log("S\xe4ljspecifikationen sparades framg\xe5ngsrikt!"),alert("S\xe4ljspecifikation sparad!")}catch(r){console.error("Fel vid sparning av s\xe4ljspecifikation:",r),alert("Kunde inte spara s\xe4ljspecifikationen.")}else alert("V\xe4nligen v\xe4lj en anst\xe4lld och en l\xf6neperiod.")},children:[(0,Yp.jsx)("label",{htmlFor:"year",children:"V\xe4lj \xc5r"}),(0,Yp.jsx)("select",{id:"year",value:e,onChange:e=>t(parseInt(e.target.value)),children:[...new Set([(new Date).getFullYear(),...f])].map((e=>(0,Yp.jsx)("option",{value:e,children:e},e)))}),(0,Yp.jsx)("label",{htmlFor:"period",children:"L\xf6neperiod"}),(0,Yp.jsxs)("select",{id:"period",value:n,onChange:e=>r(e.target.value),children:[(0,Yp.jsx)("option",{value:"",children:"V\xe4lj en period"}),h.map(((e,t)=>(0,Yp.jsx)("option",{value:e,children:e},t)))]}),(0,Yp.jsx)("label",{htmlFor:"employee",children:"Anst\xe4lld"}),(0,Yp.jsxs)("select",{id:"employee",value:i,onChange:e=>s(e.target.value),children:[(0,Yp.jsx)("option",{value:"",children:"V\xe4lj en anst\xe4lld"}),o.map((e=>(0,Yp.jsxs)("option",{value:e.id,children:[e.firstName," ",e.lastName]},e.id)))]}),(0,Yp.jsx)("h2",{children:"Behandlade avtal"}),(0,Yp.jsx)("label",{htmlFor:"totalProcessed",children:"Totalt inl\xe4sta:"}),(0,Yp.jsx)("input",{type:"number",id:"totalProcessed",name:"totalProcessed",value:c.totalProcessed,onChange:m}),(0,Yp.jsx)("label",{htmlFor:"missingCoverage",children:"T\xe4ckning saknas:"}),(0,Yp.jsx)("input",{type:"number",id:"missingCoverage",name:"missingCoverage",value:c.missingCoverage,onChange:m}),(0,Yp.jsx)("label",{htmlFor:"invalid",children:"Ogiltiga:"}),(0,Yp.jsx)("input",{type:"number",id:"invalid",name:"invalid",value:c.invalid,onChange:m}),(0,Yp.jsx)("label",{htmlFor:"incorrect",children:"Felaktiga:"}),(0,Yp.jsx)("input",{type:"number",id:"incorrect",name:"incorrect",value:c.incorrect,onChange:m}),(0,Yp.jsx)("label",{htmlFor:"withdrawal",children:"\xc5nger:"}),(0,Yp.jsx)("input",{type:"number",id:"withdrawal",name:"withdrawal",value:c.withdrawal,onChange:m}),(0,Yp.jsx)("label",{htmlFor:"approved",children:"Godk\xe4nda:"}),(0,Yp.jsx)("input",{type:"number",id:"approved",name:"approved",value:c.approved,readOnly:!0}),(0,Yp.jsx)("h2",{children:"L\xf6neber\xe4kning"}),(0,Yp.jsx)("label",{htmlFor:"previousAdjustment",children:"Justering tidigare period:"}),(0,Yp.jsx)("input",{type:"number",id:"previousAdjustment",name:"previousAdjustment",value:c.previousAdjustment,onChange:m}),(0,Yp.jsx)("label",{htmlFor:"totalApproved",children:"L\xf6negrundade avtal:"}),(0,Yp.jsx)("input",{type:"number",id:"totalApproved",name:"totalApproved",value:c.totalApproved,readOnly:!0}),(0,Yp.jsx)("label",{htmlFor:"commission",children:"Provision:"}),(0,Yp.jsx)("input",{type:"number",id:"commission",name:"commission",value:c.commission,onChange:m}),(0,Yp.jsx)("label",{htmlFor:"salary",children:"L\xf6n:"}),(0,Yp.jsx)("input",{type:"number",id:"salary",name:"salary",value:c.salary,readOnly:!0}),(0,Yp.jsx)("button",{type:"submit",children:"Spara"})]})]})},lm=()=>{const{currentUser:e}=$p(),[t,n]=(0,a.useState)(null),[r,i]=(0,a.useState)({}),[s,o]=(0,a.useState)("");(0,a.useEffect)((()=>{(async()=>{if(e)try{const t=Rf(qp,"users",e.uid),r=(await Pp(t)).data();r&&(n(r),console.log("H\xe4mtade anv\xe4ndardata:",r));const a=Nf(qp,"users",e.uid,"salesSpecifications"),s=await Mp(a),o={};s.forEach((e=>{console.log("Hittade s\xe4ljspecifikation:",e.id,e.data()),o[e.id]=e.data()})),i(o),console.log("Alla h\xe4mtade s\xe4ljspecifikationer:",o)}catch(t){console.error("Fel vid h\xe4mtning av anv\xe4ndardata eller s\xe4ljspecifikationer:",t)}})()}),[e]);return(0,Yp.jsxs)("div",{className:"user-sales-specification-container",children:[(0,Yp.jsx)("h1",{children:"S\xe4ljspecifikation"}),t?(0,Yp.jsxs)(Yp.Fragment,{children:[(0,Yp.jsxs)("p",{children:[(0,Yp.jsx)("strong",{children:"S\xe4ljare:"})," ",t.firstName?"".concat(t.firstName," ").concat(t.lastName):"N/A"]}),(0,Yp.jsxs)("p",{children:[(0,Yp.jsx)("strong",{children:"S\xe4ljid:"})," ",t.salesId||"N/A"]}),(0,Yp.jsx)("br",{}),(0,Yp.jsx)("label",{htmlFor:"period",children:"V\xe4lj L\xf6neperiod"}),(0,Yp.jsxs)("select",{id:"period",value:s,onChange:e=>{o(e.target.value),console.log("Vald period:",e.target.value)},children:[(0,Yp.jsx)("option",{value:"",children:"V\xe4lj en period"}),Object.keys(r).length>0&&Object.keys(r).map(((e,t)=>(0,Yp.jsx)("option",{value:e,children:e},t)))]}),s&&r[s]&&(0,Yp.jsxs)("div",{className:"specification-details",children:[(0,Yp.jsx)("h2",{children:"L\xd6NESPECIFIKATION"}),(0,Yp.jsxs)("p",{children:[(0,Yp.jsx)("strong",{children:"F\xf6rs\xe4ljningsperiod:"})," ",s]}),(0,Yp.jsx)("h3",{children:"Behandlade avtal"}),(0,Yp.jsxs)("p",{children:[(0,Yp.jsx)("strong",{children:"Totalt inl\xe4sta:"})," ",r[s].totalProcessed]}),(0,Yp.jsxs)("p",{children:[(0,Yp.jsx)("strong",{children:"Godk\xe4nda:"})," ",r[s].approved]}),(0,Yp.jsxs)("p",{children:[(0,Yp.jsx)("strong",{children:"T\xe4ckning saknas:"})," ",r[s].missingCoverage]}),(0,Yp.jsxs)("p",{children:[(0,Yp.jsx)("strong",{children:"Ogiltiga:"})," ",r[s].invalid]}),(0,Yp.jsxs)("p",{children:[(0,Yp.jsx)("strong",{children:"Felaktiga:"})," ",r[s].incorrect]}),(0,Yp.jsxs)("p",{children:[(0,Yp.jsx)("strong",{children:"\xc5nger:"})," ",r[s].withdrawal]}),(0,Yp.jsx)("h3",{children:"L\xf6neber\xe4kning"}),(0,Yp.jsxs)("p",{children:[(0,Yp.jsx)("strong",{children:"Justering tidigare period:"})," ",r[s].previousAdjustment]}),(0,Yp.jsxs)("p",{children:[(0,Yp.jsx)("strong",{children:"L\xf6negrundade avtal:"})," ",r[s].totalApproved]}),(0,Yp.jsxs)("p",{children:[(0,Yp.jsx)("strong",{children:"Provision:"})," ",r[s].commission," kr"]}),(0,Yp.jsx)("br",{}),(0,Yp.jsxs)("p",{children:[(0,Yp.jsx)("strong",{children:"L\xf6n:"})," ",r[s].salary," kr"]})]})]}):(0,Yp.jsx)("p",{children:"H\xe4mtar anv\xe4ndarinformation..."})]})},cm=()=>{const{id:e}=function(){let{matches:e}=a.useContext(J),t=e[e.length-1];return t?t.params:{}}(),{currentUser:t,currentUserRole:n,fetchUserData:r}=$p(),[i,s]=(0,a.useState)({name:"",personnummer:"",gatuadress:"",postnummerOrt:"",bank:"",clearingnummer:"",kontonummer:"",email:"",telefon:"",anhorig:"",anhorigTelefon:"",startDatum:"",sistaArbetsdag:"",salesId:""}),[o,l]=(0,a.useState)(!0),[c,u]=(0,a.useState)(""),h=re(),d=e||(null===t||void 0===t?void 0:t.uid);(0,a.useEffect)((()=>{(async()=>{if(d)try{const e=Rf(qp,"users",d),t=await Pp(e);t.exists()?s(t.data()):console.error("Anv\xe4ndare hittades inte.")}catch(e){console.error("Fel vid h\xe4mtning av anv\xe4ndardata:",e)}finally{l(!1)}})()}),[d]);const f=e=>{const{name:t,value:n}=e.target;s((e=>({...e,[t]:n})))};return o?(0,Yp.jsx)("p",{children:"H\xe4mtar anv\xe4ndarinformation..."}):(0,Yp.jsxs)("div",{className:"user-profile-container",children:[(0,Yp.jsx)("h1",{children:"Anv\xe4ndarprofil"}),(0,Yp.jsxs)("form",{onSubmit:async e=>{e.preventDefault();try{const e=Rf(qp,"users",d);await Up(e,i),u("Anv\xe4ndarens profil har uppdaterats!"),await r(d),("user"===n||"sales-manager"===n)&&i.name&&i.personnummer?h("/sales-specification",{replace:!0}):h("/user/dashboard",{replace:!0})}catch(t){console.error("Fel vid uppdatering av anv\xe4ndarens data:",t),u("Ett fel uppstod vid sparande av profilen.")}},className:"user-profile-form",children:[(0,Yp.jsxs)("div",{className:"form-group",children:[(0,Yp.jsx)("label",{children:"Arbetstagarens namn:"}),(0,Yp.jsx)("input",{type:"text",name:"name",value:i.name,onChange:f,required:!0})]}),(0,Yp.jsxs)("div",{className:"form-group",children:[(0,Yp.jsx)("label",{children:"Personnummer:"}),(0,Yp.jsx)("input",{type:"text",name:"personnummer",value:i.personnummer,onChange:f,required:!0})]}),"admin"===n&&(0,Yp.jsxs)("div",{className:"form-group",children:[(0,Yp.jsx)("label",{children:"S\xe4lj ID:"}),(0,Yp.jsx)("input",{type:"text",name:"salesId",value:i.salesId,onChange:f,placeholder:"Ange S\xe4lj ID"})]}),(0,Yp.jsxs)("div",{className:"form-group",children:[(0,Yp.jsx)("label",{children:"Startdatum:"}),(0,Yp.jsx)("input",{type:"date",name:"startDatum",value:i.startDatum,onChange:f,required:!0})]}),(0,Yp.jsxs)("div",{className:"form-group",children:[(0,Yp.jsx)("label",{children:"Sista arbetsdag:"}),(0,Yp.jsx)("input",{type:"date",name:"sistaArbetsdag",value:i.sistaArbetsdag,onChange:f})]}),(0,Yp.jsxs)("div",{className:"form-group",children:[(0,Yp.jsx)("label",{children:"Gatuadress:"}),(0,Yp.jsx)("input",{type:"text",name:"gatuadress",value:i.gatuadress,onChange:f,required:!0})]}),(0,Yp.jsxs)("div",{className:"form-group",children:[(0,Yp.jsx)("label",{children:"Postnummer och ort:"}),(0,Yp.jsx)("input",{type:"text",name:"postnummerOrt",value:i.postnummerOrt,onChange:f,required:!0})]}),(0,Yp.jsxs)("div",{className:"form-group",children:[(0,Yp.jsx)("label",{children:"Bank:"}),(0,Yp.jsx)("input",{type:"text",name:"bank",value:i.bank,onChange:f,required:!0})]}),(0,Yp.jsxs)("div",{className:"form-group",children:[(0,Yp.jsx)("label",{children:"Clearingnummer:"}),(0,Yp.jsx)("input",{type:"text",name:"clearingnummer",value:i.clearingnummer,onChange:f,required:!0})]}),(0,Yp.jsxs)("div",{className:"form-group",children:[(0,Yp.jsx)("label",{children:"Kontonummer:"}),(0,Yp.jsx)("input",{type:"text",name:"kontonummer",value:i.kontonummer,onChange:f,required:!0})]}),(0,Yp.jsxs)("div",{className:"form-group",children:[(0,Yp.jsx)("label",{children:"E-post:"}),(0,Yp.jsx)("input",{type:"email",name:"email",value:i.email,onChange:f,required:!0})]}),(0,Yp.jsxs)("div",{className:"form-group",children:[(0,Yp.jsx)("label",{children:"Telefon:"}),(0,Yp.jsx)("input",{type:"text",name:"telefon",value:i.telefon,onChange:f,required:!0})]}),(0,Yp.jsxs)("div",{className:"form-group",children:[(0,Yp.jsx)("label",{children:"Anh\xf6rig:"}),(0,Yp.jsx)("input",{type:"text",name:"anhorig",value:i.anhorig,onChange:f,required:!0})]}),(0,Yp.jsxs)("div",{className:"form-group",children:[(0,Yp.jsx)("label",{children:"Tel. anh\xf6rig:"}),(0,Yp.jsx)("input",{type:"text",name:"anhorigTelefon",value:i.anhorigTelefon,onChange:f,required:!0})]}),(0,Yp.jsx)("button",{type:"submit",children:"Spara"})]}),c&&(0,Yp.jsx)("p",{className:"message",children:c})]})},um=()=>{const[e,t]=(0,a.useState)(!1),[n,r]=(0,a.useState)([]),{currentUserRole:i,currentUser:s}=$p(),o=re(),l=()=>{t(!1)};(0,a.useEffect)((()=>{(async()=>{if("uppdragsgivare"===i&&s)try{const e=await Pp(Rf(qp,"users",s.uid));e.exists()&&r(e.data().menuComponents||[])}catch(e){console.error("Error fetching user menu components:",e)}})()}),[s,i]);const c={admin:[{path:"/admin/dashboard",label:"Dashboard"},{path:"/quality/dashboard",label:"Kvalit\xe9 Dashboard"},{path:"/add-user",label:"L\xe4gg till anv\xe4ndare"},{path:"/admin/manage-users",label:"Hantera anv\xe4ndare"},{path:"/sales-info",label:"F\xf6rs\xe4ljningsinfo"},{path:"/sales-specification",label:"F\xf6rs\xe4ljningsspecifikation"},{path:"/admin/salary-statistics",label:"L\xf6nestatistik"},{path:"/admin/statistics",label:"Statistik"},{path:"/manage-organizations",label:"Hantera Organisationer"},{path:"/uppdragsgivare/hellofresh",label:"HelloFresh"},{path:"/uppdragsgivare/factor-dashboard",label:"Factor Dashboard"}],"sales-manager":[{path:"/sales-manager/dashboard",label:"Dashboard"},{path:"/add-user",label:"L\xe4gg till teammedlem"},{path:"/user/sales-specification",label:"S\xe4ljspecifikation"},{path:"/sales-manager/manage-users",label:"Hantera teammedlemmar"},{path:"/sales-manager/final-report",label:"Slutrapport"},{path:"/sales-manager/statistics",label:"Statistik"}],quality:[{path:"/quality/dashboard",label:"Kvalit\xe9 Dashboard"},{path:"/quality/reporting",label:"Rapportering"},{path:"/quality/statistics",label:"Kvalit\xe9 Statistik"},{path:"/manage-organizations",label:"Hantera Organisationer"}],user:[{path:"/user/dashboard",label:"Start"},{path:"/user/sales-specification",label:"S\xe4ljspecifikation"},{path:"/user/statistics",label:"Min Statistik"}],uppdragsgivare:[{path:"/uppdragsgivare/dashboard",label:"Dashboard"},{path:"/uppdragsgivare/projects",label:"Mina Projekt"},{path:"/uppdragsgivare/reports",label:"Rapporter"},{path:"/uppdragsgivare/factor-dashboard",label:"Factor Dashboard"},{path:"/uppdragsgivare/hellofresh",label:"HelloFresh"}]},u="uppdragsgivare"===i?c.uppdragsgivare.filter((e=>n.includes(e.path.split("/")[2]))):c[i]||[];return(0,Yp.jsxs)("div",{className:"layout",children:[(0,Yp.jsxs)("header",{className:"header",children:[(0,Yp.jsx)("span",{className:"menu-icon",onClick:()=>{t(!e)},children:"\u2630"}),(0,Yp.jsx)("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABmCAYAAAA9KjRfAAAAAXNSR0IArs4c6QAAAJBlWElmTU0AKgAAAAgABgEGAAMAAAABAAIAAAESAAMAAAABAAEAAAEaAAUAAAABAAAAVgEbAAUAAAABAAAAXgEoAAMAAAABAAIAAIdpAAQAAAABAAAAZgAAAAAAAABIAAAAAQAAAEgAAAABAAOgAQADAAAAAQABAACgAgAEAAAAAQAAAGSgAwAEAAAAAQAAAGYAAAAA7iFdBgAAAAlwSFlzAAALEwAACxMBAJqcGAAAAxppVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IlhNUCBDb3JlIDYuMC4wIj4KICAgPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICAgICAgPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIKICAgICAgICAgICAgeG1sbnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iCiAgICAgICAgICAgIHhtbG5zOmV4aWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20vZXhpZi8xLjAvIj4KICAgICAgICAgPHRpZmY6Q29tcHJlc3Npb24+MTwvdGlmZjpDb21wcmVzc2lvbj4KICAgICAgICAgPHRpZmY6UmVzb2x1dGlvblVuaXQ+MjwvdGlmZjpSZXNvbHV0aW9uVW5pdD4KICAgICAgICAgPHRpZmY6WFJlc29sdXRpb24+NzI8L3RpZmY6WFJlc29sdXRpb24+CiAgICAgICAgIDx0aWZmOllSZXNvbHV0aW9uPjcyPC90aWZmOllSZXNvbHV0aW9uPgogICAgICAgICA8dGlmZjpQaG90b21ldHJpY0ludGVycHJldGF0aW9uPjI8L3RpZmY6UGhvdG9tZXRyaWNJbnRlcnByZXRhdGlvbj4KICAgICAgICAgPHRpZmY6T3JpZW50YXRpb24+MTwvdGlmZjpPcmllbnRhdGlvbj4KICAgICAgICAgPGV4aWY6UGl4ZWxYRGltZW5zaW9uPjE0NDY8L2V4aWY6UGl4ZWxYRGltZW5zaW9uPgogICAgICAgICA8ZXhpZjpQaXhlbFlEaW1lbnNpb24+MTQ3NTwvZXhpZjpQaXhlbFlEaW1lbnNpb24+CiAgICAgIDwvcmRmOkRlc2NyaXB0aW9uPgogICA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgqFIvKHAAAYdUlEQVR4Ae1dC5AcxXnuntnXPfUGJCQk7EMoIuYRYR7moVWcBJuHRUHuChnsgHGgKglOpZxgQ2LfCmJsFxW7Cjs2Akfi6di6Mo9SkClM0IlXKIwoMJYiZAUE3OmQTtLpbu+5O9Od7/97Znf2bu9ud29kS8d21c3O9HT/3fP//T/7nzkhqqWKgSoGqhioYqCKgSoGqhioYqCKgSoGqhiYLhhIaUto/pPT5ZGOzedIpazmjRvt4OSTW3QExKkSJoiU38s5cYVXTt/85sJPbPrNsqbNv4v7dcktWyL+efW3OAZyCCx+u4xacIZISXXqky82nLn5zTYh1DtSujtqsundf/zE618hSO2rVjkC3NO8URdwUBmjTPum4YkREklS6jOefuO56OzjVmW692uhlBR2VFixGuH0Hd4pHPf237ac+zhhlbilfWtSERGnPZbLeMBQCEIrvq1Fumf+6q2klajd4qbTGa11VGghtKtBGO3KaAyUiQi3v3+LUJmvbb/mgl/TPFesey267aYVDhGzjHlP26ahiKzueYIJCxY5CYgVuAJcnBhFbuE6qjMjrhrqd6za2lUyWvvqH/30lQebHnll4babz84SMYgw0xbLZTxYKATxx1NaQ/wUZzosfxscE1FDA45ysirS0PjFqNS7lz38UmrJhi0JJgwImEx9tBV/qASRrmMTg0xYQBQIMsvtT2elZcUjDbNaE1Z897L/eP564pT21CqHiRKw2CaEN81uhkoQ4GYycgTRF9VgKTfdm5XR6IlW48wNp65/8dVl929JElFI2bMY+4j5L6ESBIp8QniaFHchyaB2oF+yWaUG0lkrUfNJkajfcsr9z7c1rfvvj/v65aMkxiZEYHA5l3IODVKIbr8T2U+QZdKsdsev5l++R0aAiLrDQ67KDLt2bcNfShl9u+ne5+9qumdznDlmlPdfAGMaXYRKEEsW0yDAOFUr5YCDhF3XgDAKDGEYxKPxiFak+G012J/FPTtS13ibiNS9c8q97X8uWlpccipH95lu16ESREg4gmOLlrYtlOMMOvu7/tQd6P+ZVVNr2YlaQm4W5CrmGJIJrN2B3gz0ywJhxZ9p+uGz538UiBIqQbSjisIjqWRZlh54pP2V7c2fXKMH+j6thgd+bdc3RK1oFFFhJgw1yxfSNlrEdDYzIm2KTdr/xDd3zCtG9Hy/Y/ysKALLfab0rm0GScU5hBULsO3WX3tRLcHe/vkLntux5vxznHTf9Sqb6bQbZkQh7QgGeez4KaBNRDvwHbX+GPUVZIGVZ81xt2PlEApB/IfVqpgO8e7CwhrOStYbvjm787rzHxx2Rprc9OG1YIEMwi6sXwrxjY5KCUTK5i783ss1DA26aLqWUAkClYwyvkSxausZk37sigiz54ZVwzv/6oIUYl4nq8H0M1YsZhE35REOUihcajG7VgzN5vq1a8cfJN/xmDwLlyBFzd5g0LCnAEl+uIRW/ts3XrjX7dn/bWHZRNI8C0CXwDrTqK/JajmXAWxfXiVIASbHubAo3F5ugUTq6Dt/hLppWZNWI8PEZOA1jyYMUSsrGhO27Z5A7ZKnTV/FHiqHwBM3BCGPvKyyllvbw4MfatcZEtICnDwMuJQKXolQ0lrADVeWBfyYahwqQSp+8lQrE3DwYMch2LqHJMQWSgFRidYg0Yl0I72rwRCeLqZZCXePeyKRNSHXANUIq3RIOXTK/Vv3W7YNxBeaUqRGUJggDV3pAmJNgSZSNG+0BIvAo2P3MlyCcEgK6CmGrsmitm1txK2uVHqfUezQ5TlAsLQQKEMFE6R9eXexEcqjC4X3afu4DSEZZABwSaUIH9hWThWLHniNjuxPqATRvmNYgUBJzpsn282zdsCtL2AQYB/5Erz3xUpdNDdPDWE+MTDeCbc8ttJV6nilnbcOpq75X57CTeui4r6b4IDm9ZiZ2pE/hkqQcKarOykmDxKQGPNA4oJ8ESHmrQCytkmZJRHHbcod1CPG/K/+YrHK6ie0HTvTAigxMijm3dy2QUn9jYP3tnQKcbMQTJibs+UOMZX24Sr1ycRSKTNVqtPTFwE+00wQVMzuXbJoJoOp1DkkMYWiHPmEVTPjTJEdzujMoEPEl/HaGyxX7Z775Z+3ils2x8V9IAalNyVZlJUy+ym3CZcgvg6pZFpbvU5SdgoX+KFgSa7gFBwCfml0YvYcU92au1vySbMJ3y/46mMXWtH4me5gL0WbY+hPkkLrkX74nlZCxutScwYO755z/aNfYH3SnsIOJvb6iThHuIQrsiaysiZ5EF9RK213yWwGrSUpEq8XE0dZsTiFVY5D5U6xvC1AsEmA+7dn9RBCXVfpiy1kJcGoy0tFDIh7SF1CpsZw2pFWdKGIxB6a/cVH/ga+0T/2pFa9xGCOsH4Jl+ITQZvQ7MWj7tjB2Ac2Dmg3O8LRXwrAo3iYV5KS7lw9n+qSlYThe2axuJLSutjsjxULhsK9BWG0wrbyyIAjozXnyUjti7M+//Ajs699ZCGLMVL2ySOTHTMRCum5Kyv+wvZ7l7KWW1u5V6K7twcnhxEnwWINWjk4h/WlpFpIYNPzd5UC1Z8BfsFlMHHn3vpkA87P0g5x4QQ5ABgNlIno7LCj3REFMXat67q7Z7Y88C/wXWzkxTpHQrccGYIE0FDyqcdB21Mt/eCLboksRyzE0aSFmPHCJ2JFyaC5YTP7OSKWcU6Xduw4iCHilsLnHzMa96SJWDozkMXYcZlouHOGGPpdY/PDnxGsW8LVK4UTKu8Rw2/t7ZnDnt0nbCQ85j1DjIUVTvTRguNZZXvrRn8IZVsXyCgn5MOOHsVk5pLsa8StR93z9QsUP3YwT7YiiV82Xr3+71jpe8ZCGAgJlSAQMWOeopxJ5vWC6pKS4lkFS9b4Ih5B2gVCHeUUT3+gy4Xs03AgtAA+DaehM2wkiNPLRvB1AhOgpuT5CBkFdzk6O0hr5Aezmh86ib39kCywUAnC+JkCSXJ6QetOs0KDOgQc4tKilmRlYSuX/YnSRiP/CPpj4T9spB3HFaw/gjlkUjhWvA4I1g/DwrpKqOx+K9FAZhjBH+UYMhEjoFVWRmrgz7jn0nRE+8pQcBkKEJ6Qfxi16PzqUn4bli41vaXd4XEHI9yrRDiLpcycptTmRoY3VsUUH6bF6A83Gj8NumkB/ByADHCzN2fIxGcPrr/ucaEGm+CT3AmkZ2SsDhkwwYURGAKWOZIvT+aapeUaGQE4gdPwCULAS1u3gWl4p1vNL1yBvbSPzsVDFq9WqtN6hhMfKW8r19MfUrmfondVANIB8v1Z0ggRmLhaRexXacwD629MH1i/5psYs0lnB35Gomp8ooiP8Tx3eYuJLyo/hOsY0jz8x6xgTjnn0HU+lDBLEcygVxmwUA3y+CQSjVkqMQ/g94jlJW7lLjDIgiV7EUWNC2cJ4JGY1NmRXQd+3LyLp036YO98+9B9az7A9ZpZ1z5UA05ZrYcRYhHa4IzTlKD7fQ6ZF0IEGoOFzyH+iuYnK/Owo5l7y4jYh3wsF0IF8/MAMlGQ1xJBpENGj2fIJTmHICZShygoCeKeLUBorBny+L1Cu5G4pQW4A0cTIlHsAN5yD5tjaPhbDhzkzHBQA1yjNYV45CIGRGH8KS1HM53wCWLgVnZsNdjPuDHsHMpeDsMHIAFdlOwAhjGmbzJwb9xTz//YN+v4ZfAjlsBCAi0C+sPrCEZ8YQyMtz5BSCZpuYcXRqEVabJhhDh+5pUbTMDTXzxjAJVecWQIkl9+pc+EWnri7v0tXX3AvdnKxUlOCpLzSBe6DG/dS4hwXXkeorlAGeUUeyBNJMBGtBeeh3yFJ7s9IHo8MSSVtQfmFOaXnwoAgYYk/uQs182YfZrU2txUGVYFh/AJMqUpkciA/Ab7A8x+ygkGCgrJS1eW8dYbuspQpJa+yMNPHh6EDuJjGEq/u0/07OT7bYHNr9M8EWqpDyBCqR+cI8yRCxPHJf2DlBgO54gQ0pPCJ0j+cc28yzwmhbHnsQC7eCuXxJRfvFUJGnGA0TcC/NtFfzn1lGSNPIf8D/Qlj9NjRmxxRki1iNfM3gcFDH2Eo1HKjJ1V1n5c9YgCZ5XoCOEJhWcpvZhgiu6ppyeFTxCeWeWH9HyTUYK3q7qMIs0TBBLG2zmUpW3l0u4gyom3PX4KfpYah5BSjPxCjgz5EvJ5rtk72pcwxOn96bUghtpH2TDoYBYIQfFEqLY8XyQ9ur8/Tum/Rx1B8lNXnflz74w4BN46mGbektSGBCPE1wdjGlNFOz+fUvY5VqKOUIhkbqMHAIq0E6K5tCei/oe758MrfMmHXJxKfkAcCypAcXg0JcuPnVN7Cbdt6DLE4ovKDkcdQRqWeik+UnSw0iQi+AXmDnnrED+zZHTRDK4uQZECwMVsWAXRRSasHSF4nYkDYgfDCuoPf8xclqR8zxNZeSgUWuHXxvRJ3DyJoOQUy1FHkPbuJD+wJewumKi0GANCHU8LIwk0qndtZ/I8X/PqAlH0PHqlASVPXKx08mkA/PWOtpYh3uMYNRTjNifG1Lt87R94lp4IJauPNqxM+lBgDL9x6b9HHUFEm0mScrIj+/GxAZLYecuGnUPpyhgQaUvjHDaP87Be9PWErz++BGRYZjakyNH0ChQy/BLaonqBa7zwin879+uFROCjvuOZuUC4xyRkK5AVLa25dY27vb3+1DQjyGlmK1dZkW68lzhgnEMPAcASYYO2cm1pT7KVa6w1vDh/Nnb7osA/9Ad1zxVbO0Rw92WuKaY/6IYfEnH1B9jWBQAyFDymJWiwPnDdgCQMz9AoMZzDg4495FfM2Ht/mBpvK1fUYhtXyh7yRXIIwBlZmqQP8MsbVZNNkuNXlHhXWJC3HbG0m+l2ZPYtvrUx4H8E2+YWiIVsGGRfEFvlC5EEoRdk5lsR44t07wgSPd+yxLMg8BK7HOFmQDYxAb3IA6wfMJYNmzJmYG+rF20MAsabTmuSwx54wPOBSGqVR5Q0+gNVbxz6wXV9rD9ycEcB9BLB67NR+CKymxV7LqZFbTE3WF9KWEaxi5WjAJR3efQRBE8oNpr9C/DCh2T7A5M4NQXCgi0b0OxEqmlfnszd85rAoYO3DwQvvv3p+TBMT4OXTTByzwruMjExMYn+YIAknpAITopfwDci09eEXMxwHiGxXbAkN/4UTnKTnAKMwq75dVhYX8ZVbitXi72sQwIoJ+cQugWLVRuZvWNt4K4/iNEfjnD+xIrV1gJZxC25mRFxIK5gZ7kvcY8/M+lBfu8xv8m1JDcBwHqXky9ogfjQPF8EFvAi02/rmO7lVIRPkCLoKWdC1Nb31iGtO8nUx8PnoQIVvHNICXPECcUy1T1TVVrqInrRByDy/gGFYvC+g8hmeqJR8QbPbbLk7aXzGf0AspvpWiCySKExeLNApuiLhE8QekJ/9fDTVnLYZjop7eX5BgAShWhvXYu5J8XPNs4hm8OBcXIWk/wUku6ImsHn9PZUxJsd3285JCi8Mp7+8EF6G1xYCWYDC1+i8G/hWXFO5puGSEOZYoAxONHcGH/ok1wUFxxicnrJ1MwXfEMIYlw2atvytnIDS4BCHYgWL0htqgWiziD9gZKjKAk8EjsQfS8aiO0FsPOjBM+2MgGirvu0yvQPy0g8DiITYKJ2lMxwMO567jHtrCw8lR/FRQz+Qw+hQaRhMeIl0EjUthwvA8XP8yUR5pmvlqO/g/yrRhCU9EeuPygD/ZElM/V5RqDYan4mOpJYBKG72274EKy5GvqnBxknMfwhVIzgZCbd2r/pxl+wCKXkuSmU3ESnAKOwa24tFlaXdeXn+TqqG+GTDKQUZILnjAEQLjyxo4wvQlu5vj5Bu0Wtm35s1c28hb4shMaskHl80h8w21R25LCMua9zXWsrEWzyQlu0IErvz69/xo7aS6QzfCUCk2vw0bZT+p/80h0AQHPIi7LJIRZtYTbsi96qsJLUb14FVwaEnMNUSsQG+g+59TMOQwkfB1+CoBpyk5KHs4cv0rHp2zR7yN79FbMyF6WeWo/3Pm5Q/fgwGiVNB2cA7YM00oh0h9/o/PZVBz39UToSPaIcerSlD2CfzIEmMUl7Ie3k++QXTu5+GSdHJ4eAIai8/bXVaXDGAX4rl4gwptjMIbsPfZY9v8V3bP5Pqw7EGKD3PvBV1FHcCs5yJNKA4GxvMqBK0R+jBiWiBF/gSWIboK1FcfI1EwNaagrlyHDIFCbkdQWHQJGnaO9B70cm/PICcpAXQM6774yh3Un/+vQTsqZhtdvfS15grKA9U0ZlkCid0AOHt3R978rv8zipVaWJq+DzGKPBSVz6k8URW9wttHOuuPx+7O/qxwZqZt4u2uh7LkSUyjglVA6B+C6yioNPU/p50ttcglG5lzmEBWFg8dFQUrCVtfiup5/DV+hWgzPI8qE3okzh2bBJmrFqGmJIE31h77+t/jRukkikZy9vvtQHHFJ71br5EUtsk9H6ZojTk/A94iYrMfvWuuHDeTHmTaHcn1AJkhs8gDeu48fGofBTJ7nmRU9WmlqstQ7IGFzkVxxWo0X7Gwi0Ni2+879esWobV6nBPgr85YlB3XkeSAdlYvQ/13X3lRczHFrllShgL3/Xylj/LGP1c3QmPQgrTiEXWOnhQyNWpP6yxss3XMpjBMWaeZSSjkeGICUNPXGj9C6zPw3dPXYrF+oc+xsaXw46GV8YOtcdTCPZCsQYu97BGY0xPdS/ee93mTMEBxJJD1RSksYfQdez8BIPQaBEOuAQti9HgeExSi/5Om28e2pUTgmZIIGEwHJmUaRtzjl0EPbmUNQYZUkhFA3Tlr54A11YSA3UZYkYaqjvsc7vfO4yHsLI/8qIQQA8LxwM2+fjPzd18t5xA5L0UK6ugpOQCTKOBcmio7zZ+c6hjqq9+IwsdcZcC5GOS3JRitVnZW1jFGLs0c67Pnc1jzxVYhAQzwuHyNxAeyAYHYEyfl0hg+s43rIa0bH4Rh7viq6KCB8uQQLOG08qeACt/A+YBavHPffyfJHHu185GTh4LBZGUSTYG1THAoUKz1p1RIzen3R864rruAVZbJWKqeAQ3its/Ztu2gj90QpfCCSpjeJb9jEB7x3fhbx88LEvdLFYrERHYaxwCeIzSBG0YSUXqQ0+7ajzVsMOTixzEEg+zJbWuEacIQZuu7K2IeoO9t3TcecVfw2O8jx4Mp9DKoxoLfs3ffkO6TiniszQjXib6prosDp54KkvPTslHYUphuqHkAjlxy4qouhWGeLVI+Ce65O9H//RVnIOkUQQ8NYL8QspIugDzBE10PfdjrWXfd2YtWtpsyo8YuTGxOKCCEy3texCFf2ZEoJYDJkg3kocHQ4309X2UEN5XGJC40r+sH0f9tZPBZgx/VEBZQo7uKaeiNH6fuuld7BTSRxWLld6eC3ph0Qg+SVsCm9FRBQxMXYKS+o9bqNQCaLwbV5OthwznBEpkfqRMQgd07Sgop1EKn0Fey+rEPgixAqBwqsfWYm26k/f+v43L72bv37dAiKlyhSRAaAlnxru8zgwVXK3iRqGq0NGYatgYNzD93kLsFlwv8hFcqWpBGr3cCY8J0GZOoAjRY83x+ssfJT5b9/7xmfv5o/2tyCuFHAii4A9qqtCIUjD0hWMaOBnXHmNDSUdHeKU/pIRwv+jCq0xyQfh/OF/WSXiMPTxfiDemo3EbBlL4GPAgze8d9slP6JPzvJH+4uItZIHPAoahkIQ/zmwXsclCCwlFRuYUxaHcHARHxPYdcuqnZBUl+I9wG4rXhMBIehr1/tlZuSKPbf9xQMr1uEbWvSvk6ZBCVWHaNt8uXoMXrCksXB116xydQi6ef8V4f9akr9csO61JfH04QsIGoJIL++79ZIBeidw282rpgUx6LlCJcj4IospourqjhuXg2gy4xYmirb3tki8eyZ+lWvHL2jyt+BzVcf6SbgEsSPjhwss6SYOvGhEFtOnTNTh3/KByaRY2262ZCkzUcop7V+XOYPfS/NQCYLlX5geEnwEmEW5gGGwvpxz41cYIqTK6XjstA1JqbfzEyOyM6Q5yYMux+jvTLuXb0tBp2opjoFQCDIvmWTsu8rFu3gAGUwkg7+AZASKjPaz51zJTl3xuU/L2lAIgq8fsrL+zSVnbMF/W9sWmTUnBh5wEbtAUhq+dZTA++HK/XfCoP+W7bTEZggPFQpB2DM2nzvSdjzxmWzPoa1ITEAuGt7BUO5Qtvfg32+/+pwHKPbjOW8hTL0KYnIMBL5Bddbm15ef/tSb5y7d9Jp5F9CIqslhVFuEjAGK0I6K9lb/sX3IOK4IHLilmb6hWOWMitBX7VTFQBUDVQxUMVDFQBUDVQxUMVDFQBUDVQxUMfARxcD/A44ZthiipDlVAAAAAElFTkSuQmCC",alt:"Logga"})]}),(0,Yp.jsx)("aside",{className:"sidebar ".concat(e?"open":""),children:(0,Yp.jsx)("nav",{children:(0,Yp.jsxs)("ul",{children:[u.map(((e,t)=>(0,Yp.jsx)("li",{children:(0,Yp.jsx)(Oe,{to:e.path,onClick:l,children:e.label})},t))),"uppdragsgivare"!==i&&(0,Yp.jsx)("li",{children:(0,Yp.jsx)(Oe,{to:"/profile",onClick:l,children:"Min Profil"})}),(0,Yp.jsx)("li",{children:(0,Yp.jsx)("button",{onClick:async()=>{try{await function(e){return at(e).signOut()}(Gp),l(),o("/login")}catch(e){console.error("Error logging out: ",e)}},className:"logout-button",children:"Logga ut"})})]})})}),(0,Yp.jsx)("main",{className:"content",children:(0,Yp.jsx)(be,{})})]})},hm=e=>{let{children:t,role:n}=e;const{currentUser:r,currentUserRole:i,isAddingUser:s}=$p(),[o,l]=(0,a.useState)(!0),[c,u]=(0,a.useState)(!1),h=te();if((0,a.useEffect)((()=>{s?l(!1):(async()=>{if(r&&["user","sales-manager","admin","quality"].includes(i))try{const e=Rf(qp,"users",r.uid),t=await Pp(e);if(t.exists()){const e=t.data();console.log("User data:",e);const n=!!(e.name&&e.personnummer&&e.gatuadress&&e.postnummerOrt&&e.bank&&e.clearingnummer&&e.kontonummer&&e.email&&e.telefon&&e.anhorig&&e.anhorigTelefon);console.log("Is profile complete:",n),u(n)}else console.log("Anv\xe4ndardokument saknas.")}catch(e){console.error("Fel vid h\xe4mtning av anv\xe4ndardata:",e)}else u(!0);l(!1)})()}),[r,i,h.pathname,s]),!r)return console.log("Ingen anv\xe4ndare inloggad. Omdirigerar till inloggningssidan."),(0,Yp.jsx)(ye,{to:"/login"});if(o||!i)return console.log("Laddar anv\xe4ndardata..."),(0,Yp.jsx)("div",{children:"Laddar..."});if(s)return console.log("L\xe4gger till en ny anv\xe4ndare. Undviker omdirigering."),null;if("/profile"===h.pathname)return console.log("Tillg\xe5ng till profilsidan."),t;if(["user","sales-manager","admin","quality"].includes(i)&&!c)return console.log("Anv\xe4ndarens profil \xe4r inte komplett. Omdirigerar till profilsidan."),(0,Yp.jsx)(ye,{to:"/profile"});if("admin"===i)return console.log("Admin-anv\xe4ndare. Fullst\xe4ndig \xe5tkomst beviljad."),t;if(Array.isArray(n)){if(console.log("Till\xe5tna roller:",n),console.log("Anv\xe4ndarens roll:",i),!n.includes(i))return console.log("Obeh\xf6rig \xe5tkomst - anv\xe4ndarens roll matchar inte de till\xe5tna rollerna."),(0,Yp.jsx)(ye,{to:"/unauthorized"})}else if(console.log("F\xf6rv\xe4ntad roll:",n),console.log("Anv\xe4ndarens roll:",i),n&&i!==n)return console.log("Obeh\xf6rig \xe5tkomst - anv\xe4ndarens roll matchar inte."),(0,Yp.jsx)(ye,{to:"/unauthorized"});return console.log("Anv\xe4ndaren har beh\xf6righet. Renderar inneh\xe5ll."),t};var dm={version:"0.18.5"},fm=1200,pm=1252,mm=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],gm={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},vm=function(e){-1!=mm.indexOf(e)&&(pm=gm[0]=e)};var ym=function(e){fm=e,vm(e)};function bm(){ym(1200),vm(1252)}function wm(e){for(var t=[],n=0;n<e.length>>1;++n)t[n]=String.fromCharCode(e.charCodeAt(2*n+1)+(e.charCodeAt(2*n)<<8));return t.join("")}var Sm,Tm=function(e){return String.fromCharCode(e)},Em=function(e){return String.fromCharCode(e)};var xm=null,_m="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Am(e){for(var t="",n=0,r=0,a=0,i=0,s=0,o=0,l=0,c=0;c<e.length;)i=(n=e.charCodeAt(c++))>>2,s=(3&n)<<4|(r=e.charCodeAt(c++))>>4,o=(15&r)<<2|(a=e.charCodeAt(c++))>>6,l=63&a,isNaN(r)?o=l=64:isNaN(a)&&(l=64),t+=_m.charAt(i)+_m.charAt(s)+_m.charAt(o)+_m.charAt(l);return t}function km(e){var t="",n=0,r=0,a=0,i=0,s=0,o=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var l=0;l<e.length;)n=_m.indexOf(e.charAt(l++))<<2|(i=_m.indexOf(e.charAt(l++)))>>4,t+=String.fromCharCode(n),r=(15&i)<<4|(s=_m.indexOf(e.charAt(l++)))>>2,64!==s&&(t+=String.fromCharCode(r)),a=(3&s)<<6|(o=_m.indexOf(e.charAt(l++))),64!==o&&(t+=String.fromCharCode(a));return t}var Cm=function(){return"undefined"!==typeof Buffer&&"undefined"!==typeof process&&"undefined"!==typeof process.versions&&!!process.versions.node}(),Im=function(){if("undefined"!==typeof Buffer){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch(YE){e=!0}return e?function(e,t){return t?new Buffer(e,t):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function Nm(e){return Cm?Buffer.alloc?Buffer.alloc(e):new Buffer(e):"undefined"!=typeof Uint8Array?new Uint8Array(e):new Array(e)}function Om(e){return Cm?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):"undefined"!=typeof Uint8Array?new Uint8Array(e):new Array(e)}var Rm=function(e){return Cm?Im(e,"binary"):e.split("").map((function(e){return 255&e.charCodeAt(0)}))};function Dm(e){if("undefined"===typeof ArrayBuffer)return Rm(e);for(var t=new ArrayBuffer(e.length),n=new Uint8Array(t),r=0;r!=e.length;++r)n[r]=255&e.charCodeAt(r);return t}function jm(e){if(Array.isArray(e))return e.map((function(e){return String.fromCharCode(e)})).join("");for(var t=[],n=0;n<e.length;++n)t[n]=String.fromCharCode(e[n]);return t.join("")}var Pm=Cm?function(e){return Buffer.concat(e.map((function(e){return Buffer.isBuffer(e)?e:Im(e)})))}:function(e){if("undefined"!==typeof Uint8Array){var t=0,n=0;for(t=0;t<e.length;++t)n+=e[t].length;var r=new Uint8Array(n),a=0;for(t=0,n=0;t<e.length;n+=a,++t)if(a=e[t].length,e[t]instanceof Uint8Array)r.set(e[t],n);else{if("string"==typeof e[t])throw"wtf";r.set(new Uint8Array(e[t]),n)}return r}return[].concat.apply([],e.map((function(e){return Array.isArray(e)?e:[].slice.call(e)})))};var Lm=/\u0000/g,Mm=/[\u0001-\u0006]/g;function Fm(e){for(var t="",n=e.length-1;n>=0;)t+=e.charAt(n--);return t}function Um(e,t){var n=""+e;return n.length>=t?n:Jg("0",t-n.length)+n}function Vm(e,t){var n=""+e;return n.length>=t?n:Jg(" ",t-n.length)+n}function Bm(e,t){var n=""+e;return n.length>=t?n:n+Jg(" ",t-n.length)}var zm=Math.pow(2,32);function Hm(e,t){return e>zm||e<-zm?function(e,t){var n=""+Math.round(e);return n.length>=t?n:Jg("0",t-n.length)+n}(e,t):function(e,t){var n=""+e;return n.length>=t?n:Jg("0",t-n.length)+n}(Math.round(e),t)}function Wm(e,t){return t=t||0,e.length>=7+t&&103===(32|e.charCodeAt(t))&&101===(32|e.charCodeAt(t+1))&&110===(32|e.charCodeAt(t+2))&&101===(32|e.charCodeAt(t+3))&&114===(32|e.charCodeAt(t+4))&&97===(32|e.charCodeAt(t+5))&&108===(32|e.charCodeAt(t+6))}var Gm=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],qm=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];var Km={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"\u4e0a\u5348/\u4e0b\u5348 "hh"\u6642"mm"\u5206"ss"\u79d2 "'},Ym={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},Qm={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Xm(e,t,n){for(var r=e<0?-1:1,a=e*r,i=0,s=1,o=0,l=1,c=0,u=0,h=Math.floor(a);c<t&&(o=(h=Math.floor(a))*s+i,u=h*c+l,!(a-h<5e-8));)a=1/(a-h),i=s,s=o,l=c,c=u;if(u>t&&(c>t?(u=l,o=i):(u=c,o=s)),!n)return[0,r*o,u];var d=Math.floor(r*o/u);return[d,r*o-d*u,u]}function Jm(e,t,n){if(e>2958465||e<0)return null;var r=0|e,a=Math.floor(86400*(e-r)),i=0,s=[],o={D:r,T:a,u:86400*(e-r)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(r+=1462),o.u>.9999&&(o.u=0,86400==++a&&(o.T=a=0,++r,++o.D)),60===r)s=n?[1317,10,29]:[1900,2,29],i=3;else if(0===r)s=n?[1317,8,29]:[1900,1,0],i=6;else{r>60&&--r;var l=new Date(1900,0,1);l.setDate(l.getDate()+r-1),s=[l.getFullYear(),l.getMonth()+1,l.getDate()],i=l.getDay(),r<60&&(i=(i+6)%7),n&&(i=function(e,t){t[0]-=581;var n=e.getDay();e<60&&(n=(n+6)%7);return n}(l,s))}return o.y=s[0],o.m=s[1],o.d=s[2],o.S=a%60,a=Math.floor(a/60),o.M=a%60,a=Math.floor(a/60),o.H=a,o.q=i,o}var $m=new Date(1899,11,31,0,0,0),Zm=$m.getTime(),eg=new Date(1900,2,1,0,0,0);function tg(e,t){var n=e.getTime();return t?n-=1262304e5:e>=eg&&(n+=864e5),(n-(Zm+6e4*(e.getTimezoneOffset()-$m.getTimezoneOffset())))/864e5}function ng(e){return-1==e.indexOf(".")?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function rg(e){var t,n=Math.floor(Math.log(Math.abs(e))*Math.LOG10E);return t=n>=-4&&n<=-1?e.toPrecision(10+n):Math.abs(n)<=9?function(e){var t=e<0?12:11,n=ng(e.toFixed(12));return n.length<=t||(n=e.toPrecision(10)).length<=t?n:e.toExponential(5)}(e):10===n?e.toFixed(10).substr(0,12):function(e){var t=ng(e.toFixed(11));return t.length>(e<0?12:11)||"0"===t||"-0"===t?e.toPrecision(6):t}(e),ng(function(e){return-1==e.indexOf("E")?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}(t.toUpperCase()))}function ag(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(0|e)===e?e.toString(10):rg(e);case"undefined":return"";case"object":if(null==e)return"";if(e instanceof Date)return _g(14,tg(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function ig(e,t,n,r){var a,i="",s=0,o=0,l=n.y,c=0;switch(e){case 98:l=n.y+543;case 121:switch(t.length){case 1:case 2:a=l%100,c=2;break;default:a=l%1e4,c=4}break;case 109:switch(t.length){case 1:case 2:a=n.m,c=t.length;break;case 3:return qm[n.m-1][1];case 5:return qm[n.m-1][0];default:return qm[n.m-1][2]}break;case 100:switch(t.length){case 1:case 2:a=n.d,c=t.length;break;case 3:return Gm[n.q][0];default:return Gm[n.q][1]}break;case 104:switch(t.length){case 1:case 2:a=1+(n.H+11)%12,c=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:a=n.H,c=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:a=n.M,c=t.length;break;default:throw"bad minute format: "+t}break;case 115:if("s"!=t&&"ss"!=t&&".0"!=t&&".00"!=t&&".000"!=t)throw"bad second format: "+t;return 0!==n.u||"s"!=t&&"ss"!=t?(o=r>=2?3===r?1e3:100:1===r?10:1,(s=Math.round(o*(n.S+n.u)))>=60*o&&(s=0),"s"===t?0===s?"0":""+s/o:(i=Um(s,2+r),"ss"===t?i.substr(0,2):"."+i.substr(2,t.length-1))):Um(n.S,t.length);case 90:switch(t){case"[h]":case"[hh]":a=24*n.D+n.H;break;case"[m]":case"[mm]":a=60*(24*n.D+n.H)+n.M;break;case"[s]":case"[ss]":a=60*(60*(24*n.D+n.H)+n.M)+Math.round(n.S+n.u);break;default:throw"bad abstime format: "+t}c=3===t.length?1:2;break;case 101:a=l,c=1}return c>0?Um(a,c):""}function sg(e){if(e.length<=3)return e;for(var t=e.length%3,n=e.substr(0,t);t!=e.length;t+=3)n+=(n.length>0?",":"")+e.substr(t,3);return n}var og=/%/g;function lg(e,t){var n,r=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(0==t)return"0.0E+0";if(t<0)return"-"+lg(e,-t);var a=e.indexOf(".");-1===a&&(a=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%a;if(i<0&&(i+=a),-1===(n=(t/Math.pow(10,i)).toPrecision(r+1+(a+i)%a)).indexOf("e")){var s=Math.floor(Math.log(t)*Math.LOG10E);for(-1===n.indexOf(".")?n=n.charAt(0)+"."+n.substr(1)+"E+"+(s-n.length+i):n+="E+"+(s-i);"0."===n.substr(0,2);)n=(n=n.charAt(0)+n.substr(2,a)+"."+n.substr(2+a)).replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");n=n.replace(/\+-/,"-")}n=n.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,(function(e,t,n,r){return t+n+r.substr(0,(a+i)%a)+"."+r.substr(i)+"E"}))}else n=t.toExponential(r);return e.match(/E\+00$/)&&n.match(/e[+-]\d$/)&&(n=n.substr(0,n.length-1)+"0"+n.charAt(n.length-1)),e.match(/E\-/)&&n.match(/e\+/)&&(n=n.replace(/e\+/,"e")),n.replace("e","E")}var cg=/# (\?+)( ?)\/( ?)(\d+)/;var ug=/^#*0*\.([0#]+)/,hg=/\).*[0#]/,dg=/\(###\) ###\\?-####/;function fg(e){for(var t,n="",r=0;r!=e.length;++r)switch(t=e.charCodeAt(r)){case 35:break;case 63:n+=" ";break;case 48:n+="0";break;default:n+=String.fromCharCode(t)}return n}function pg(e,t){var n=Math.pow(10,t);return""+Math.round(e*n)/n}function mg(e,t){var n=e-Math.floor(e),r=Math.pow(10,t);return t<(""+Math.round(n*r)).length?0:Math.round(n*r)}function gg(e,t,n){if(40===e.charCodeAt(0)&&!t.match(hg)){var r=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return n>=0?gg("n",r,n):"("+gg("n",r,-n)+")"}if(44===t.charCodeAt(t.length-1))return function(e,t,n){for(var r=t.length-1;44===t.charCodeAt(r-1);)--r;return bg(e,t.substr(0,r),n/Math.pow(10,3*(t.length-r)))}(e,t,n);if(-1!==t.indexOf("%"))return function(e,t,n){var r=t.replace(og,""),a=t.length-r.length;return bg(e,r,n*Math.pow(10,2*a))+Jg("%",a)}(e,t,n);if(-1!==t.indexOf("E"))return lg(t,n);if(36===t.charCodeAt(0))return"$"+gg(e,t.substr(" "==t.charAt(1)?2:1),n);var a,i,s,o,l=Math.abs(n),c=n<0?"-":"";if(t.match(/^00+$/))return c+Hm(l,t.length);if(t.match(/^[#?]+$/))return"0"===(a=Hm(n,0))&&(a=""),a.length>t.length?a:fg(t.substr(0,t.length-a.length))+a;if(i=t.match(cg))return function(e,t,n){var r=parseInt(e[4],10),a=Math.round(t*r),i=Math.floor(a/r),s=a-i*r,o=r;return n+(0===i?"":""+i)+" "+(0===s?Jg(" ",e[1].length+1+e[4].length):Vm(s,e[1].length)+e[2]+"/"+e[3]+Um(o,e[4].length))}(i,l,c);if(t.match(/^#+0+$/))return c+Hm(l,t.length-t.indexOf("0"));if(i=t.match(ug))return a=pg(n,i[1].length).replace(/^([^\.]+)$/,"$1."+fg(i[1])).replace(/\.$/,"."+fg(i[1])).replace(/\.(\d*)$/,(function(e,t){return"."+t+Jg("0",fg(i[1]).length-t.length)})),-1!==t.indexOf("0.")?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return c+pg(l,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return c+sg(Hm(l,0));if(i=t.match(/^#,##0\.([#0]*0)$/))return n<0?"-"+gg(e,t,-n):sg(""+(Math.floor(n)+function(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}(n,i[1].length)))+"."+Um(mg(n,i[1].length),i[1].length);if(i=t.match(/^#,#*,#0/))return gg(e,t.replace(/^#,#*,/,""),n);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Fm(gg(e,t.replace(/[\\-]/g,""),n)),s=0,Fm(Fm(t.replace(/\\/g,"")).replace(/[0#]/g,(function(e){return s<a.length?a.charAt(s++):"0"===e?"0":""})));if(t.match(dg))return"("+(a=gg(e,"##########",n)).substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var u="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(i[4].length,7),o=Xm(l,Math.pow(10,s)-1,!1),a=""+c," "==(u=bg("n",i[1],o[1])).charAt(u.length-1)&&(u=u.substr(0,u.length-1)+"0"),a+=u+i[2]+"/"+i[3],(u=Bm(o[2],s)).length<i[4].length&&(u=fg(i[4].substr(i[4].length-u.length))+u),a+=u;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(i[1].length,i[4].length),7),c+((o=Xm(l,Math.pow(10,s)-1,!0))[0]||(o[1]?"":"0"))+" "+(o[1]?Vm(o[1],s)+i[2]+"/"+i[3]+Bm(o[2],s):Jg(" ",2*s+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return a=Hm(n,0),t.length<=a.length?a:fg(t.substr(0,t.length-a.length))+a;if(i=t.match(/^([#0?]+)\.([#0]+)$/)){a=""+n.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),s=a.indexOf(".");var h=t.indexOf(".")-s,d=t.length-a.length-h;return fg(t.substr(0,h)+a+t.substr(t.length-d))}if(i=t.match(/^00,000\.([#0]*0)$/))return s=mg(n,i[1].length),n<0?"-"+gg(e,t,-n):sg(function(e){return e<2147483647&&e>-2147483648?""+(e>=0?0|e:e-1|0):""+Math.floor(e)}(n)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,(function(e){return"00,"+(e.length<3?Um(0,3-e.length):"")+e}))+"."+Um(s,i[1].length);switch(t){case"###,##0.00":return gg(e,"#,##0.00",n);case"###,###":case"##,###":case"#,###":var f=sg(Hm(l,0));return"0"!==f?c+f:"";case"###,###.00":return gg(e,"###,##0.00",n).replace(/^0\./,".");case"#,###.00":return gg(e,"#,##0.00",n).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function vg(e,t){var n,r=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(0==t)return"0.0E+0";if(t<0)return"-"+vg(e,-t);var a=e.indexOf(".");-1===a&&(a=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%a;if(i<0&&(i+=a),!(n=(t/Math.pow(10,i)).toPrecision(r+1+(a+i)%a)).match(/[Ee]/)){var s=Math.floor(Math.log(t)*Math.LOG10E);-1===n.indexOf(".")?n=n.charAt(0)+"."+n.substr(1)+"E+"+(s-n.length+i):n+="E+"+(s-i),n=n.replace(/\+-/,"-")}n=n.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,(function(e,t,n,r){return t+n+r.substr(0,(a+i)%a)+"."+r.substr(i)+"E"}))}else n=t.toExponential(r);return e.match(/E\+00$/)&&n.match(/e[+-]\d$/)&&(n=n.substr(0,n.length-1)+"0"+n.charAt(n.length-1)),e.match(/E\-/)&&n.match(/e\+/)&&(n=n.replace(/e\+/,"e")),n.replace("e","E")}function yg(e,t,n){if(40===e.charCodeAt(0)&&!t.match(hg)){var r=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return n>=0?yg("n",r,n):"("+yg("n",r,-n)+")"}if(44===t.charCodeAt(t.length-1))return function(e,t,n){for(var r=t.length-1;44===t.charCodeAt(r-1);)--r;return bg(e,t.substr(0,r),n/Math.pow(10,3*(t.length-r)))}(e,t,n);if(-1!==t.indexOf("%"))return function(e,t,n){var r=t.replace(og,""),a=t.length-r.length;return bg(e,r,n*Math.pow(10,2*a))+Jg("%",a)}(e,t,n);if(-1!==t.indexOf("E"))return vg(t,n);if(36===t.charCodeAt(0))return"$"+yg(e,t.substr(" "==t.charAt(1)?2:1),n);var a,i,s,o,l=Math.abs(n),c=n<0?"-":"";if(t.match(/^00+$/))return c+Um(l,t.length);if(t.match(/^[#?]+$/))return a=""+n,0===n&&(a=""),a.length>t.length?a:fg(t.substr(0,t.length-a.length))+a;if(i=t.match(cg))return function(e,t,n){return n+(0===t?"":""+t)+Jg(" ",e[1].length+2+e[4].length)}(i,l,c);if(t.match(/^#+0+$/))return c+Um(l,t.length-t.indexOf("0"));if(i=t.match(ug))return a=(a=(""+n).replace(/^([^\.]+)$/,"$1."+fg(i[1])).replace(/\.$/,"."+fg(i[1]))).replace(/\.(\d*)$/,(function(e,t){return"."+t+Jg("0",fg(i[1]).length-t.length)})),-1!==t.indexOf("0.")?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return c+sg(""+l);if(i=t.match(/^#,##0\.([#0]*0)$/))return n<0?"-"+yg(e,t,-n):sg(""+n)+"."+Jg("0",i[1].length);if(i=t.match(/^#,#*,#0/))return yg(e,t.replace(/^#,#*,/,""),n);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Fm(yg(e,t.replace(/[\\-]/g,""),n)),s=0,Fm(Fm(t.replace(/\\/g,"")).replace(/[0#]/g,(function(e){return s<a.length?a.charAt(s++):"0"===e?"0":""})));if(t.match(dg))return"("+(a=yg(e,"##########",n)).substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var u="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(i[4].length,7),o=Xm(l,Math.pow(10,s)-1,!1),a=""+c," "==(u=bg("n",i[1],o[1])).charAt(u.length-1)&&(u=u.substr(0,u.length-1)+"0"),a+=u+i[2]+"/"+i[3],(u=Bm(o[2],s)).length<i[4].length&&(u=fg(i[4].substr(i[4].length-u.length))+u),a+=u;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(i[1].length,i[4].length),7),c+((o=Xm(l,Math.pow(10,s)-1,!0))[0]||(o[1]?"":"0"))+" "+(o[1]?Vm(o[1],s)+i[2]+"/"+i[3]+Bm(o[2],s):Jg(" ",2*s+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return a=""+n,t.length<=a.length?a:fg(t.substr(0,t.length-a.length))+a;if(i=t.match(/^([#0]+)\.([#0]+)$/)){a=""+n.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),s=a.indexOf(".");var h=t.indexOf(".")-s,d=t.length-a.length-h;return fg(t.substr(0,h)+a+t.substr(t.length-d))}if(i=t.match(/^00,000\.([#0]*0)$/))return n<0?"-"+yg(e,t,-n):sg(""+n).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,(function(e){return"00,"+(e.length<3?Um(0,3-e.length):"")+e}))+"."+Um(0,i[1].length);switch(t){case"###,###":case"##,###":case"#,###":var f=sg(""+l);return"0"!==f?c+f:"";default:if(t.match(/\.[0#?]*$/))return yg(e,t.slice(0,t.lastIndexOf(".")),n)+fg(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function bg(e,t,n){return(0|n)===n?yg(e,t,n):gg(e,t,n)}var wg=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Sg(e){for(var t=0,n="",r="";t<e.length;)switch(n=e.charAt(t)){case"G":Wm(e,t)&&(t+=6),t++;break;case'"':for(;34!==e.charCodeAt(++t)&&t<e.length;);++t;break;case"\\":case"_":t+=2;break;case"@":++t;break;case"B":case"b":if("1"===e.charAt(t+1)||"2"===e.charAt(t+1))return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"\u4e0a":if("A/P"===e.substr(t,3).toUpperCase())return!0;if("AM/PM"===e.substr(t,5).toUpperCase())return!0;if("\u4e0a\u5348/\u4e0b\u5348"===e.substr(t,5).toUpperCase())return!0;++t;break;case"[":for(r=n;"]"!==e.charAt(t++)&&t<e.length;)r+=e.charAt(t);if(r.match(wg))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(n=e.charAt(++t))>-1||"\\"==n&&"-"==e.charAt(t+1)&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===n;);break;case"*":++t," "!=e.charAt(t)&&"*"!=e.charAt(t)||++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;default:++t}return!1}var Tg=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Eg(e,t){if(null==t)return!1;var n=parseFloat(t[2]);switch(t[1]){case"=":if(e==n)return!0;break;case">":if(e>n)return!0;break;case"<":if(e<n)return!0;break;case"<>":if(e!=n)return!0;break;case">=":if(e>=n)return!0;break;case"<=":if(e<=n)return!0}return!1}function xg(e,t){var n=function(e){for(var t=[],n=!1,r=0,a=0;r<e.length;++r)switch(e.charCodeAt(r)){case 34:n=!n;break;case 95:case 42:case 92:++r;break;case 59:t[t.length]=e.substr(a,r-a),a=r+1}if(t[t.length]=e.substr(a),!0===n)throw new Error("Format |"+e+"| unterminated string ");return t}(e),r=n.length,a=n[r-1].indexOf("@");if(r<4&&a>-1&&--r,n.length>4)throw new Error("cannot find right format for |"+n.join("|")+"|");if("number"!==typeof t)return[4,4===n.length||a>-1?n[n.length-1]:"@"];switch(n.length){case 1:n=a>-1?["General","General","General",n[0]]:[n[0],n[0],n[0],"@"];break;case 2:n=a>-1?[n[0],n[0],n[0],n[1]]:[n[0],n[1],n[0],"@"];break;case 3:n=a>-1?[n[0],n[1],n[0],n[2]]:[n[0],n[1],n[2],"@"]}var i=t>0?n[0]:t<0?n[1]:n[2];if(-1===n[0].indexOf("[")&&-1===n[1].indexOf("["))return[r,i];if(null!=n[0].match(/\[[=<>]/)||null!=n[1].match(/\[[=<>]/)){var s=n[0].match(Tg),o=n[1].match(Tg);return Eg(t,s)?[r,n[0]]:Eg(t,o)?[r,n[1]]:[r,n[null!=s&&null!=o?2:1]]}return[r,i]}function _g(e,t,n){null==n&&(n={});var r="";switch(typeof e){case"string":r="m/d/yy"==e&&n.dateNF?n.dateNF:e;break;case"number":null==(r=14==e&&n.dateNF?n.dateNF:(null!=n.table?n.table:Km)[e])&&(r=n.table&&n.table[Ym[e]]||Km[Ym[e]]),null==r&&(r=Qm[e]||"General")}if(Wm(r,0))return ag(t,n);t instanceof Date&&(t=tg(t,n.date1904));var a=xg(r,t);if(Wm(a[1]))return ag(t,n);if(!0===t)t="TRUE";else if(!1===t)t="FALSE";else if(""===t||null==t)return"";return function(e,t,n,r){for(var a,i,s,o=[],l="",c=0,u="",h="t",d="H";c<e.length;)switch(u=e.charAt(c)){case"G":if(!Wm(e,c))throw new Error("unrecognized character "+u+" in "+e);o[o.length]={t:"G",v:"General"},c+=7;break;case'"':for(l="";34!==(s=e.charCodeAt(++c))&&c<e.length;)l+=String.fromCharCode(s);o[o.length]={t:"t",v:l},++c;break;case"\\":var f=e.charAt(++c),p="("===f||")"===f?f:"t";o[o.length]={t:p,v:f},++c;break;case"_":o[o.length]={t:"t",v:" "},c+=2;break;case"@":o[o.length]={t:"T",v:t},++c;break;case"B":case"b":if("1"===e.charAt(c+1)||"2"===e.charAt(c+1)){if(null==a&&null==(a=Jm(t,n,"2"===e.charAt(c+1))))return"";o[o.length]={t:"X",v:e.substr(c,2)},h=u,c+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":u=u.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0)return"";if(null==a&&null==(a=Jm(t,n)))return"";for(l=u;++c<e.length&&e.charAt(c).toLowerCase()===u;)l+=u;"m"===u&&"h"===h.toLowerCase()&&(u="M"),"h"===u&&(u=d),o[o.length]={t:u,v:l},h=u;break;case"A":case"a":case"\u4e0a":var m={t:u,v:u};if(null==a&&(a=Jm(t,n)),"A/P"===e.substr(c,3).toUpperCase()?(null!=a&&(m.v=a.H>=12?"P":"A"),m.t="T",d="h",c+=3):"AM/PM"===e.substr(c,5).toUpperCase()?(null!=a&&(m.v=a.H>=12?"PM":"AM"),m.t="T",c+=5,d="h"):"\u4e0a\u5348/\u4e0b\u5348"===e.substr(c,5).toUpperCase()?(null!=a&&(m.v=a.H>=12?"\u4e0b\u5348":"\u4e0a\u5348"),m.t="T",c+=5,d="h"):(m.t="t",++c),null==a&&"T"===m.t)return"";o[o.length]=m,h=u;break;case"[":for(l=u;"]"!==e.charAt(c++)&&c<e.length;)l+=e.charAt(c);if("]"!==l.slice(-1))throw'unterminated "[" block: |'+l+"|";if(l.match(wg)){if(null==a&&null==(a=Jm(t,n)))return"";o[o.length]={t:"Z",v:l.toLowerCase()},h=l.charAt(1)}else l.indexOf("$")>-1&&(l=(l.match(/\$([^-\[\]]*)/)||[])[1]||"$",Sg(e)||(o[o.length]={t:"t",v:l}));break;case".":if(null!=a){for(l=u;++c<e.length&&"0"===(u=e.charAt(c));)l+=u;o[o.length]={t:"s",v:l};break}case"0":case"#":for(l=u;++c<e.length&&"0#?.,E+-%".indexOf(u=e.charAt(c))>-1;)l+=u;o[o.length]={t:"n",v:l};break;case"?":for(l=u;e.charAt(++c)===u;)l+=u;o[o.length]={t:u,v:l},h=u;break;case"*":++c," "!=e.charAt(c)&&"*"!=e.charAt(c)||++c;break;case"(":case")":o[o.length]={t:1===r?"t":u,v:u},++c;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(l=u;c<e.length&&"0123456789".indexOf(e.charAt(++c))>-1;)l+=e.charAt(c);o[o.length]={t:"D",v:l};break;case" ":o[o.length]={t:u,v:u},++c;break;case"$":o[o.length]={t:"t",v:"$"},++c;break;default:if(-1===",$-+/():!^&'~{}<>=\u20acacfijklopqrtuvwxzP".indexOf(u))throw new Error("unrecognized character "+u+" in "+e);o[o.length]={t:"t",v:u},++c}var g,v=0,y=0;for(c=o.length-1,h="t";c>=0;--c)switch(o[c].t){case"h":case"H":o[c].t=d,h="h",v<1&&(v=1);break;case"s":(g=o[c].v.match(/\.0+$/))&&(y=Math.max(y,g[0].length-1)),v<3&&(v=3);case"d":case"y":case"M":case"e":h=o[c].t;break;case"m":"s"===h&&(o[c].t="M",v<2&&(v=2));break;case"X":break;case"Z":v<1&&o[c].v.match(/[Hh]/)&&(v=1),v<2&&o[c].v.match(/[Mm]/)&&(v=2),v<3&&o[c].v.match(/[Ss]/)&&(v=3)}switch(v){case 0:break;case 1:a.u>=.5&&(a.u=0,++a.S),a.S>=60&&(a.S=0,++a.M),a.M>=60&&(a.M=0,++a.H);break;case 2:a.u>=.5&&(a.u=0,++a.S),a.S>=60&&(a.S=0,++a.M)}var b,w="";for(c=0;c<o.length;++c)switch(o[c].t){case"t":case"T":case" ":case"D":break;case"X":o[c].v="",o[c].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":o[c].v=ig(o[c].t.charCodeAt(0),o[c].v,a,y),o[c].t="t";break;case"n":case"?":for(b=c+1;null!=o[b]&&("?"===(u=o[b].t)||"D"===u||(" "===u||"t"===u)&&null!=o[b+1]&&("?"===o[b+1].t||"t"===o[b+1].t&&"/"===o[b+1].v)||"("===o[c].t&&(" "===u||"n"===u||")"===u)||"t"===u&&("/"===o[b].v||" "===o[b].v&&null!=o[b+1]&&"?"==o[b+1].t));)o[c].v+=o[b].v,o[b]={v:"",t:";"},++b;w+=o[c].v,c=b-1;break;case"G":o[c].t="t",o[c].v=ag(t,n)}var S,T,E="";if(w.length>0){40==w.charCodeAt(0)?(S=t<0&&45===w.charCodeAt(0)?-t:t,T=bg("n",w,S)):(T=bg("n",w,S=t<0&&r>1?-t:t),S<0&&o[0]&&"t"==o[0].t&&(T=T.substr(1),o[0].v="-"+o[0].v)),b=T.length-1;var x=o.length;for(c=0;c<o.length;++c)if(null!=o[c]&&"t"!=o[c].t&&o[c].v.indexOf(".")>-1){x=c;break}var _=o.length;if(x===o.length&&-1===T.indexOf("E")){for(c=o.length-1;c>=0;--c)null!=o[c]&&-1!=="n?".indexOf(o[c].t)&&(b>=o[c].v.length-1?(b-=o[c].v.length,o[c].v=T.substr(b+1,o[c].v.length)):b<0?o[c].v="":(o[c].v=T.substr(0,b+1),b=-1),o[c].t="t",_=c);b>=0&&_<o.length&&(o[_].v=T.substr(0,b+1)+o[_].v)}else if(x!==o.length&&-1===T.indexOf("E")){for(b=T.indexOf(".")-1,c=x;c>=0;--c)if(null!=o[c]&&-1!=="n?".indexOf(o[c].t)){for(i=o[c].v.indexOf(".")>-1&&c===x?o[c].v.indexOf(".")-1:o[c].v.length-1,E=o[c].v.substr(i+1);i>=0;--i)b>=0&&("0"===o[c].v.charAt(i)||"#"===o[c].v.charAt(i))&&(E=T.charAt(b--)+E);o[c].v=E,o[c].t="t",_=c}for(b>=0&&_<o.length&&(o[_].v=T.substr(0,b+1)+o[_].v),b=T.indexOf(".")+1,c=x;c<o.length;++c)if(null!=o[c]&&(-1!=="n?(".indexOf(o[c].t)||c===x)){for(i=o[c].v.indexOf(".")>-1&&c===x?o[c].v.indexOf(".")+1:0,E=o[c].v.substr(0,i);i<o[c].v.length;++i)b<T.length&&(E+=T.charAt(b++));o[c].v=E,o[c].t="t",_=c}}}for(c=0;c<o.length;++c)null!=o[c]&&"n?".indexOf(o[c].t)>-1&&(S=r>1&&t<0&&c>0&&"-"===o[c-1].v?-t:t,o[c].v=bg(o[c].t,o[c].v,S),o[c].t="t");var A="";for(c=0;c!==o.length;++c)null!=o[c]&&(A+=o[c].v);return A}(a[1],t,n,a[0])}function Ag(e,t){if("number"!=typeof t){t=+t||-1;for(var n=0;n<392;++n)if(void 0!=Km[n]){if(Km[n]==e){t=n;break}}else t<0&&(t=n);t<0&&(t=391)}return Km[t]=e,t}function kg(e){for(var t=0;392!=t;++t)void 0!==e[t]&&Ag(e[t],t)}function Cg(){var e;e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"\u4e0a\u5348/\u4e0b\u5348 "hh"\u6642"mm"\u5206"ss"\u79d2 "',Km=e}var Ig=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;var Ng=function(){var e={};e.version="1.2.0";var t=function(){for(var e=0,t=new Array(256),n=0;256!=n;++n)e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=n)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1,t[n]=e;return"undefined"!==typeof Int32Array?new Int32Array(t):t}();var n=function(e){var t=0,n=0,r=0,a="undefined"!==typeof Int32Array?new Int32Array(4096):new Array(4096);for(r=0;256!=r;++r)a[r]=e[r];for(r=0;256!=r;++r)for(n=e[r],t=256+r;t<4096;t+=256)n=a[t]=n>>>8^e[255&n];var i=[];for(r=1;16!=r;++r)i[r-1]="undefined"!==typeof Int32Array?a.subarray(256*r,256*r+256):a.slice(256*r,256*r+256);return i}(t),r=n[0],a=n[1],i=n[2],s=n[3],o=n[4],l=n[5],c=n[6],u=n[7],h=n[8],d=n[9],f=n[10],p=n[11],m=n[12],g=n[13],v=n[14];return e.table=t,e.bstr=function(e,n){for(var r=~n,a=0,i=e.length;a<i;)r=r>>>8^t[255&(r^e.charCodeAt(a++))];return~r},e.buf=function(e,n){for(var y=~n,b=e.length-15,w=0;w<b;)y=v[e[w++]^255&y]^g[e[w++]^y>>8&255]^m[e[w++]^y>>16&255]^p[e[w++]^y>>>24]^f[e[w++]]^d[e[w++]]^h[e[w++]]^u[e[w++]]^c[e[w++]]^l[e[w++]]^o[e[w++]]^s[e[w++]]^i[e[w++]]^a[e[w++]]^r[e[w++]]^t[e[w++]];for(b+=15;w<b;)y=y>>>8^t[255&(y^e[w++])];return~y},e.str=function(e,n){for(var r=~n,a=0,i=e.length,s=0,o=0;a<i;)(s=e.charCodeAt(a++))<128?r=r>>>8^t[255&(r^s)]:s<2048?r=(r=r>>>8^t[255&(r^(192|s>>6&31))])>>>8^t[255&(r^(128|63&s))]:s>=55296&&s<57344?(s=64+(1023&s),o=1023&e.charCodeAt(a++),r=(r=(r=(r=r>>>8^t[255&(r^(240|s>>8&7))])>>>8^t[255&(r^(128|s>>2&63))])>>>8^t[255&(r^(128|o>>6&15|(3&s)<<4))])>>>8^t[255&(r^(128|63&o))]):r=(r=(r=r>>>8^t[255&(r^(224|s>>12&15))])>>>8^t[255&(r^(128|s>>6&63))])>>>8^t[255&(r^(128|63&s))];return~r},e}(),Og=function(){var e,t={};function n(e){if("/"==e.charAt(e.length-1))return-1===e.slice(0,-1).indexOf("/")?e:n(e.slice(0,-1));var t=e.lastIndexOf("/");return-1===t?e:e.slice(0,t+1)}function r(e){if("/"==e.charAt(e.length-1))return r(e.slice(0,-1));var t=e.lastIndexOf("/");return-1===t?e:e.slice(t+1)}function a(e,t){"string"===typeof t&&(t=new Date(t));var n=t.getHours();n=(n=n<<6|t.getMinutes())<<5|t.getSeconds()>>>1,e.write_shift(2,n);var r=t.getFullYear()-1980;r=(r=r<<4|t.getMonth()+1)<<5|t.getDate(),e.write_shift(2,r)}function i(e){ly(e,0);for(var t={},n=0;e.l<=e.length-4;){var r=e.read_shift(2),a=e.read_shift(2),i=e.l+a,s={};if(21589===r)1&(n=e.read_shift(1))&&(s.mtime=e.read_shift(4)),a>5&&(2&n&&(s.atime=e.read_shift(4)),4&n&&(s.ctime=e.read_shift(4))),s.mtime&&(s.mt=new Date(1e3*s.mtime));e.l=i,t[r]=s}return t}function s(){return e||(e={})}function o(e,t){if(80==e[0]&&75==e[1])return re(e,t);if(109==(32|e[0])&&105==(32|e[1]))return function(e,t){if("mime-version:"!=T(e.slice(0,13)).toLowerCase())throw new Error("Unsupported MAD header");var n=t&&t.root||"",r=(Cm&&Buffer.isBuffer(e)?e.toString("binary"):T(e)).split("\r\n"),a=0,i="";for(a=0;a<r.length;++a)if(i=r[a],/^Content-Location:/i.test(i)&&(i=i.slice(i.indexOf("file")),n||(n=i.slice(0,i.lastIndexOf("/")+1)),i.slice(0,n.length)!=n))for(;n.length>0&&(n=(n=n.slice(0,n.length-1)).slice(0,n.lastIndexOf("/")+1),i.slice(0,n.length)!=n););var s=(r[1]||"").match(/boundary="(.*?)"/);if(!s)throw new Error("MAD cannot find boundary");var o="--"+(s[1]||""),l=[],c=[],u={FileIndex:l,FullPaths:c};d(u);var h,f=0;for(a=0;a<r.length;++a){var p=r[a];p!==o&&p!==o+"--"||(f++&&ce(u,r.slice(h,a),n),h=a)}return u}(e,t);if(e.length<512)throw new Error("CFB file size "+e.length+" < 512");var n,r,a,i,s,o,f=512,p=[],m=e.slice(0,512);ly(m,0);var g=function(e){if(80==e[e.l]&&75==e[e.l+1])return[0,0];e.chk(y,"Header Signature: "),e.l+=16;var t=e.read_shift(2,"u");return[e.read_shift(2,"u"),t]}(m);switch(n=g[0]){case 3:f=512;break;case 4:f=4096;break;case 0:if(0==g[1])return re(e,t);default:throw new Error("Major Version: Expected 3 or 4 saw "+n)}512!==f&&ly(m=e.slice(0,f),28);var b=e.slice(0,f);!function(e,t){var n=9;switch(e.l+=2,n=e.read_shift(2)){case 9:if(3!=t)throw new Error("Sector Shift: Expected 9 saw "+n);break;case 12:if(4!=t)throw new Error("Sector Shift: Expected 12 saw "+n);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+n)}e.chk("0600","Mini Sector Shift: "),e.chk("000000000000","Reserved: ")}(m,n);var w=m.read_shift(4,"i");if(3===n&&0!==w)throw new Error("# Directory Sectors: Expected 0 saw "+w);m.l+=4,i=m.read_shift(4,"i"),m.l+=4,m.chk("00100000","Mini Stream Cutoff Size: "),s=m.read_shift(4,"i"),r=m.read_shift(4,"i"),o=m.read_shift(4,"i"),a=m.read_shift(4,"i");for(var S=-1,E=0;E<109&&!((S=m.read_shift(4,"i"))<0);++E)p[E]=S;var x=function(e,t){for(var n=Math.ceil(e.length/t)-1,r=[],a=1;a<n;++a)r[a-1]=e.slice(a*t,(a+1)*t);return r[n-1]=e.slice(n*t),r}(e,f);c(o,a,x,f,p);var _=function(e,t,n,r){var a=e.length,i=[],s=[],o=[],l=[],c=r-1,u=0,h=0,d=0,f=0;for(u=0;u<a;++u)if(o=[],(d=u+t)>=a&&(d-=a),!s[d]){l=[];var p=[];for(h=d;h>=0;){p[h]=!0,s[h]=!0,o[o.length]=h,l.push(e[h]);var m=n[Math.floor(4*h/r)];if(r<4+(f=4*h&c))throw new Error("FAT boundary crossed: "+h+" 4 "+r);if(!e[m])break;if(p[h=ey(e[m],f)])break}i[d]={nodes:o,data:Iv([l])}}return i}(x,i,p,f);_[i].name="!Directory",r>0&&s!==v&&(_[s].name="!MiniFAT"),_[p[0]].name="!FAT",_.fat_addrs=p,_.ssz=f;var A=[],k=[],C=[];!function(e,t,n,r,a,i,s,o){for(var c,d=0,f=r.length?2:0,p=t[e].data,m=0,g=0;m<p.length;m+=128){var y=p.slice(m,m+128);ly(y,64),g=y.read_shift(2),c=Ov(y,0,g-f),r.push(c);var b={name:c,type:y.read_shift(1),color:y.read_shift(1),L:y.read_shift(4,"i"),R:y.read_shift(4,"i"),C:y.read_shift(4,"i"),clsid:y.read_shift(16),state:y.read_shift(4,"i"),start:0,size:0};0!==y.read_shift(2)+y.read_shift(2)+y.read_shift(2)+y.read_shift(2)&&(b.ct=h(y,y.l-8)),0!==y.read_shift(2)+y.read_shift(2)+y.read_shift(2)+y.read_shift(2)&&(b.mt=h(y,y.l-8)),b.start=y.read_shift(4,"i"),b.size=y.read_shift(4,"i"),b.size<0&&b.start<0&&(b.size=b.type=0,b.start=v,b.name=""),5===b.type?(d=b.start,a>0&&d!==v&&(t[d].name="!StreamData")):b.size>=4096?(b.storage="fat",void 0===t[b.start]&&(t[b.start]=u(n,b.start,t.fat_addrs,t.ssz)),t[b.start].name=b.name,b.content=t[b.start].data.slice(0,b.size)):(b.storage="minifat",b.size<0?b.size=0:d!==v&&b.start!==v&&t[d]&&(b.content=l(b,t[d].data,(t[o]||{}).data))),b.content&&ly(b.content,0),i[c]=b,s.push(b)}}(i,_,x,A,r,{},k,s),function(e,t,n){for(var r=0,a=0,i=0,s=0,o=0,l=n.length,c=[],u=[];r<l;++r)c[r]=u[r]=r,t[r]=n[r];for(;o<u.length;++o)a=e[r=u[o]].L,i=e[r].R,s=e[r].C,c[r]===r&&(-1!==a&&c[a]!==a&&(c[r]=c[a]),-1!==i&&c[i]!==i&&(c[r]=c[i])),-1!==s&&(c[s]=r),-1!==a&&r!=c[r]&&(c[a]=c[r],u.lastIndexOf(a)<o&&u.push(a)),-1!==i&&r!=c[r]&&(c[i]=c[r],u.lastIndexOf(i)<o&&u.push(i));for(r=1;r<l;++r)c[r]===r&&(-1!==i&&c[i]!==i?c[r]=c[i]:-1!==a&&c[a]!==a&&(c[r]=c[a]));for(r=1;r<l;++r)if(0!==e[r].type){if((o=r)!=c[o])do{o=c[o],t[r]=t[o]+"/"+t[r]}while(0!==o&&-1!==c[o]&&o!=c[o]);c[r]=-1}for(t[0]+="/",r=1;r<l;++r)2!==e[r].type&&(t[r]+="/")}(k,C,A),A.shift();var I={FileIndex:k,FullPaths:C};return t&&t.raw&&(I.raw={header:b,sectors:x}),I}function l(e,t,n){for(var r=e.start,a=e.size,i=[],s=r;n&&a>0&&s>=0;)i.push(t.slice(s*g,s*g+g)),a-=g,s=ey(n,4*s);return 0===i.length?uy(0):Pm(i).slice(0,e.size)}function c(e,t,n,r,a){var i=v;if(e===v){if(0!==t)throw new Error("DIFAT chain shorter than expected")}else if(-1!==e){var s=n[e],o=(r>>>2)-1;if(!s)return;for(var l=0;l<o&&(i=ey(s,4*l))!==v;++l)a.push(i);c(ey(s,r-4),t-1,n,r,a)}}function u(e,t,n,r,a){var i=[],s=[];a||(a=[]);var o=r-1,l=0,c=0;for(l=t;l>=0;){a[l]=!0,i[i.length]=l,s.push(e[l]);var u=n[Math.floor(4*l/r)];if(r<4+(c=4*l&o))throw new Error("FAT boundary crossed: "+l+" 4 "+r);if(!e[u])break;l=ey(e[u],c)}return{nodes:i,data:Iv([s])}}function h(e,t){return new Date(1e3*(Zv(e,t+4)/1e7*Math.pow(2,32)+Zv(e,t)/1e7-11644473600))}function d(e,t){var n=t||{},r=n.root||"Root Entry";if(e.FullPaths||(e.FullPaths=[]),e.FileIndex||(e.FileIndex=[]),e.FullPaths.length!==e.FileIndex.length)throw new Error("inconsistent CFB structure");0===e.FullPaths.length&&(e.FullPaths[0]=r+"/",e.FileIndex[0]={name:r,type:5}),n.CLSID&&(e.FileIndex[0].clsid=n.CLSID),function(e){var t="\x01Sh33tJ5";if(Og.find(e,"/"+t))return;var n=uy(4);n[0]=55,n[1]=n[3]=50,n[2]=54,e.FileIndex.push({name:t,type:2,content:n,size:4,L:69,R:69,C:69}),e.FullPaths.push(e.FullPaths[0]+t),f(e)}(e)}function f(e,t){d(e);for(var a=!1,i=!1,s=e.FullPaths.length-1;s>=0;--s){var o=e.FileIndex[s];switch(o.type){case 0:i?a=!0:(e.FileIndex.pop(),e.FullPaths.pop());break;case 1:case 2:case 5:i=!0,isNaN(o.R*o.L*o.C)&&(a=!0),o.R>-1&&o.L>-1&&o.R==o.L&&(a=!0);break;default:a=!0}}if(a||t){var l=new Date(1987,1,19),c=0,u=Object.create?Object.create(null):{},h=[];for(s=0;s<e.FullPaths.length;++s)u[e.FullPaths[s]]=!0,0!==e.FileIndex[s].type&&h.push([e.FullPaths[s],e.FileIndex[s]]);for(s=0;s<h.length;++s){var f=n(h[s][0]);(i=u[f])||(h.push([f,{name:r(f).replace("/",""),type:1,clsid:w,ct:l,mt:l,content:null}]),u[f]=!0)}for(h.sort((function(e,t){return function(e,t){for(var n=e.split("/"),r=t.split("/"),a=0,i=0,s=Math.min(n.length,r.length);a<s;++a){if(i=n[a].length-r[a].length)return i;if(n[a]!=r[a])return n[a]<r[a]?-1:1}return n.length-r.length}(e[0],t[0])})),e.FullPaths=[],e.FileIndex=[],s=0;s<h.length;++s)e.FullPaths[s]=h[s][0],e.FileIndex[s]=h[s][1];for(s=0;s<h.length;++s){var p=e.FileIndex[s],m=e.FullPaths[s];if(p.name=r(m).replace("/",""),p.L=p.R=p.C=-(p.color=1),p.size=p.content?p.content.length:0,p.start=0,p.clsid=p.clsid||w,0===s)p.C=h.length>1?1:-1,p.size=0,p.type=5;else if("/"==m.slice(-1)){for(c=s+1;c<h.length&&n(e.FullPaths[c])!=m;++c);for(p.C=c>=h.length?-1:c,c=s+1;c<h.length&&n(e.FullPaths[c])!=n(m);++c);p.R=c>=h.length?-1:c,p.type=1}else n(e.FullPaths[s+1]||"")==n(m)&&(p.R=s+1),p.type=2}}}function p(e,t){var n=t||{};if("mad"==n.fileType)return function(e,t){for(var n=t||{},r=n.boundary||"SheetJS",a=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+(r="------="+r).slice(2)+'"',"","",""],i=e.FullPaths[0],s=i,o=e.FileIndex[0],l=1;l<e.FullPaths.length;++l)if(s=e.FullPaths[l].slice(i.length),(o=e.FileIndex[l]).size&&o.content&&"\x01Sh33tJ5"!=s){s=s.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,(function(e){return"_x"+e.charCodeAt(0).toString(16)+"_"})).replace(/[\u0080-\uFFFF]/g,(function(e){return"_u"+e.charCodeAt(0).toString(16)+"_"}));for(var c=o.content,u=Cm&&Buffer.isBuffer(c)?c.toString("binary"):T(c),h=0,d=Math.min(1024,u.length),f=0,p=0;p<=d;++p)(f=u.charCodeAt(p))>=32&&f<128&&++h;var m=h>=4*d/5;a.push(r),a.push("Content-Location: "+(n.root||"file:///C:/SheetJS/")+s),a.push("Content-Transfer-Encoding: "+(m?"quoted-printable":"base64")),a.push("Content-Type: "+se(o,s)),a.push(""),a.push(m?le(u):oe(u))}return a.push(r+"--\r\n"),a.join("\r\n")}(e,n);if(f(e),"zip"===n.fileType)return function(e,t){var n=t||{},r=[],i=[],s=uy(1),o=n.compression?8:0,l=0;0;var c=0,u=0,h=0,d=0,f=e.FullPaths[0],p=f,m=e.FileIndex[0],g=[],v=0;for(c=1;c<e.FullPaths.length;++c)if(p=e.FullPaths[c].slice(f.length),(m=e.FileIndex[c]).size&&m.content&&"\x01Sh33tJ5"!=p){var y=h,b=uy(p.length);for(u=0;u<p.length;++u)b.write_shift(1,127&p.charCodeAt(u));b=b.slice(0,b.l),g[d]=Ng.buf(m.content,0);var w=m.content;8==o&&(w=E(w)),(s=uy(30)).write_shift(4,67324752),s.write_shift(2,20),s.write_shift(2,l),s.write_shift(2,o),m.mt?a(s,m.mt):s.write_shift(4,0),s.write_shift(-4,8&l?0:g[d]),s.write_shift(4,8&l?0:w.length),s.write_shift(4,8&l?0:m.content.length),s.write_shift(2,b.length),s.write_shift(2,0),h+=s.length,r.push(s),h+=b.length,r.push(b),h+=w.length,r.push(w),8&l&&((s=uy(12)).write_shift(-4,g[d]),s.write_shift(4,w.length),s.write_shift(4,m.content.length),h+=s.l,r.push(s)),(s=uy(46)).write_shift(4,33639248),s.write_shift(2,0),s.write_shift(2,20),s.write_shift(2,l),s.write_shift(2,o),s.write_shift(4,0),s.write_shift(-4,g[d]),s.write_shift(4,w.length),s.write_shift(4,m.content.length),s.write_shift(2,b.length),s.write_shift(2,0),s.write_shift(2,0),s.write_shift(2,0),s.write_shift(2,0),s.write_shift(4,0),s.write_shift(4,y),v+=s.l,i.push(s),v+=b.length,i.push(b),++d}return s=uy(22),s.write_shift(4,101010256),s.write_shift(2,0),s.write_shift(2,0),s.write_shift(2,d),s.write_shift(2,d),s.write_shift(4,v),s.write_shift(4,h),s.write_shift(2,0),Pm([Pm(r),Pm(i),s])}(e,n);var r=function(e){for(var t=0,n=0,r=0;r<e.FileIndex.length;++r){var a=e.FileIndex[r];if(a.content){var i=a.content.length;i>0&&(i<4096?t+=i+63>>6:n+=i+511>>9)}}for(var s=e.FullPaths.length+3>>2,o=t+127>>7,l=(t+7>>3)+n+s+o,c=l+127>>7,u=c<=109?0:Math.ceil((c-109)/127);l+c+u+127>>7>c;)u=++c<=109?0:Math.ceil((c-109)/127);var h=[1,u,c,o,s,n,t,0];return e.FileIndex[0].size=t<<6,h[7]=(e.FileIndex[0].start=h[0]+h[1]+h[2]+h[3]+h[4]+h[5])+(h[6]+7>>3),h}(e),i=uy(r[7]<<9),s=0,o=0;for(s=0;s<8;++s)i.write_shift(1,b[s]);for(s=0;s<8;++s)i.write_shift(2,0);for(i.write_shift(2,62),i.write_shift(2,3),i.write_shift(2,65534),i.write_shift(2,9),i.write_shift(2,6),s=0;s<3;++s)i.write_shift(2,0);for(i.write_shift(4,0),i.write_shift(4,r[2]),i.write_shift(4,r[0]+r[1]+r[2]+r[3]-1),i.write_shift(4,0),i.write_shift(4,4096),i.write_shift(4,r[3]?r[0]+r[1]+r[2]-1:v),i.write_shift(4,r[3]),i.write_shift(-4,r[1]?r[0]-1:v),i.write_shift(4,r[1]),s=0;s<109;++s)i.write_shift(-4,s<r[2]?r[1]+s:-1);if(r[1])for(o=0;o<r[1];++o){for(;s<236+127*o;++s)i.write_shift(-4,s<r[2]?r[1]+s:-1);i.write_shift(-4,o===r[1]-1?v:o+1)}var l=function(e){for(o+=e;s<o-1;++s)i.write_shift(-4,s+1);e&&(++s,i.write_shift(-4,v))};for(o=s=0,o+=r[1];s<o;++s)i.write_shift(-4,S.DIFSECT);for(o+=r[2];s<o;++s)i.write_shift(-4,S.FATSECT);l(r[3]),l(r[4]);for(var c=0,u=0,h=e.FileIndex[0];c<e.FileIndex.length;++c)(h=e.FileIndex[c]).content&&((u=h.content.length)<4096||(h.start=o,l(u+511>>9)));for(l(r[6]+7>>3);511&i.l;)i.write_shift(-4,S.ENDOFCHAIN);for(o=s=0,c=0;c<e.FileIndex.length;++c)(h=e.FileIndex[c]).content&&(!(u=h.content.length)||u>=4096||(h.start=o,l(u+63>>6)));for(;511&i.l;)i.write_shift(-4,S.ENDOFCHAIN);for(s=0;s<r[4]<<2;++s){var d=e.FullPaths[s];if(d&&0!==d.length){h=e.FileIndex[s],0===s&&(h.start=h.size?h.start-1:v);var p=0===s&&n.root||h.name;if(u=2*(p.length+1),i.write_shift(64,p,"utf16le"),i.write_shift(2,u),i.write_shift(1,h.type),i.write_shift(1,h.color),i.write_shift(-4,h.L),i.write_shift(-4,h.R),i.write_shift(-4,h.C),h.clsid)i.write_shift(16,h.clsid,"hex");else for(c=0;c<4;++c)i.write_shift(4,0);i.write_shift(4,h.state||0),i.write_shift(4,0),i.write_shift(4,0),i.write_shift(4,0),i.write_shift(4,0),i.write_shift(4,h.start),i.write_shift(4,h.size),i.write_shift(4,0)}else{for(c=0;c<17;++c)i.write_shift(4,0);for(c=0;c<3;++c)i.write_shift(4,-1);for(c=0;c<12;++c)i.write_shift(4,0)}}for(s=1;s<e.FileIndex.length;++s)if((h=e.FileIndex[s]).size>=4096)if(i.l=h.start+1<<9,Cm&&Buffer.isBuffer(h.content))h.content.copy(i,i.l,0,h.size),i.l+=h.size+511&-512;else{for(c=0;c<h.size;++c)i.write_shift(1,h.content[c]);for(;511&c;++c)i.write_shift(1,0)}for(s=1;s<e.FileIndex.length;++s)if((h=e.FileIndex[s]).size>0&&h.size<4096)if(Cm&&Buffer.isBuffer(h.content))h.content.copy(i,i.l,0,h.size),i.l+=h.size+63&-64;else{for(c=0;c<h.size;++c)i.write_shift(1,h.content[c]);for(;63&c;++c)i.write_shift(1,0)}if(Cm)i.l=i.length;else for(;i.l<i.length;)i.write_shift(1,0);return i}t.version="1.2.1";var m,g=64,v=-2,y="d0cf11e0a1b11ae1",b=[208,207,17,224,161,177,26,225],w="00000000000000000000000000000000",S={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:v,FREESECT:-1,HEADER_SIGNATURE:y,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:w,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function T(e){for(var t=new Array(e.length),n=0;n<e.length;++n)t[n]=String.fromCharCode(e[n]);return t.join("")}function E(e){return m?m.deflateRawSync(e):Y(e)}var x=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],_=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],A=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function k(e){var t=139536&(e<<1|e<<11)|558144&(e<<5|e<<15);return 255&(t>>16|t>>8|t)}for(var C="undefined"!==typeof Uint8Array,I=C?new Uint8Array(256):[],N=0;N<256;++N)I[N]=k(N);function O(e,t){var n=I[255&e];return t<=8?n>>>8-t:(n=n<<8|I[e>>8&255],t<=16?n>>>16-t:(n=n<<8|I[e>>16&255])>>>24-t)}function R(e,t){var n=7&t,r=t>>>3;return(e[r]|(n<=6?0:e[r+1]<<8))>>>n&3}function D(e,t){var n=7&t,r=t>>>3;return(e[r]|(n<=5?0:e[r+1]<<8))>>>n&7}function j(e,t){var n=7&t,r=t>>>3;return(e[r]|(n<=3?0:e[r+1]<<8))>>>n&31}function P(e,t){var n=7&t,r=t>>>3;return(e[r]|(n<=1?0:e[r+1]<<8))>>>n&127}function L(e,t,n){var r=7&t,a=t>>>3,i=(1<<n)-1,s=e[a]>>>r;return n<8-r?s&i:(s|=e[a+1]<<8-r,n<16-r?s&i:(s|=e[a+2]<<16-r,n<24-r?s&i:(s|=e[a+3]<<24-r)&i))}function M(e,t,n){var r=7&t,a=t>>>3;return r<=5?e[a]|=(7&n)<<r:(e[a]|=n<<r&255,e[a+1]=(7&n)>>8-r),t+3}function F(e,t,n){return n=(1&n)<<(7&t),e[t>>>3]|=n,t+1}function U(e,t,n){var r=t>>>3;return n<<=7&t,e[r]|=255&n,n>>>=8,e[r+1]=n,t+8}function V(e,t,n){var r=t>>>3;return n<<=7&t,e[r]|=255&n,n>>>=8,e[r+1]=255&n,e[r+2]=n>>>8,t+16}function B(e,t){var n=e.length,r=2*n>t?2*n:t+5,a=0;if(n>=t)return e;if(Cm){var i=Om(r);if(e.copy)e.copy(i);else for(;a<e.length;++a)i[a]=e[a];return i}if(C){var s=new Uint8Array(r);if(s.set)s.set(e);else for(;a<n;++a)s[a]=e[a];return s}return e.length=r,e}function z(e){for(var t=new Array(e),n=0;n<e;++n)t[n]=0;return t}function H(e,t,n){var r=1,a=0,i=0,s=0,o=0,l=e.length,c=C?new Uint16Array(32):z(32);for(i=0;i<32;++i)c[i]=0;for(i=l;i<n;++i)e[i]=0;l=e.length;var u=C?new Uint16Array(l):z(l);for(i=0;i<l;++i)c[a=e[i]]++,r<a&&(r=a),u[i]=0;for(c[0]=0,i=1;i<=r;++i)c[i+16]=o=o+c[i-1]<<1;for(i=0;i<l;++i)0!=(o=e[i])&&(u[i]=c[o+16]++);var h=0;for(i=0;i<l;++i)if(0!=(h=e[i]))for(o=O(u[i],r)>>r-h,s=(1<<r+4-h)-1;s>=0;--s)t[o|s<<h]=15&h|i<<4;return r}var W=C?new Uint16Array(512):z(512),G=C?new Uint16Array(32):z(32);if(!C){for(var q=0;q<512;++q)W[q]=0;for(q=0;q<32;++q)G[q]=0}!function(){for(var e=[],t=0;t<32;t++)e.push(5);H(e,G,32);var n=[];for(t=0;t<=143;t++)n.push(8);for(;t<=255;t++)n.push(9);for(;t<=279;t++)n.push(7);for(;t<=287;t++)n.push(8);H(n,W,288)}();var K=function(){for(var e=C?new Uint8Array(32768):[],t=0,n=0;t<A.length-1;++t)for(;n<A[t+1];++n)e[n]=t;for(;n<32768;++n)e[n]=29;var r=C?new Uint8Array(259):[];for(t=0,n=0;t<_.length-1;++t)for(;n<_[t+1];++n)r[n]=t;return function(t,n){return t.length<8?function(e,t){for(var n=0;n<e.length;){var r=Math.min(65535,e.length-n),a=n+r==e.length;for(t.write_shift(1,+a),t.write_shift(2,r),t.write_shift(2,65535&~r);r-- >0;)t[t.l++]=e[n++]}return t.l}(t,n):function(t,n){for(var a=0,i=0,s=C?new Uint16Array(32768):[];i<t.length;){var o=Math.min(65535,t.length-i);if(o<10){for(7&(a=M(n,a,+!(i+o!=t.length)))&&(a+=8-(7&a)),n.l=a/8|0,n.write_shift(2,o),n.write_shift(2,65535&~o);o-- >0;)n[n.l++]=t[i++];a=8*n.l}else{a=M(n,a,+!(i+o!=t.length)+2);for(var l=0;o-- >0;){var c=t[i],u=-1,h=0;if((u=s[l=32767&(l<<5^c)])&&((u|=-32768&i)>i&&(u-=32768),u<i))for(;t[u+h]==t[i+h]&&h<250;)++h;if(h>2){(c=r[h])<=22?a=U(n,a,I[c+1]>>1)-1:(U(n,a,3),U(n,a+=5,I[c-23]>>5),a+=3);var d=c<8?0:c-4>>2;d>0&&(V(n,a,h-_[c]),a+=d),c=e[i-u],a=U(n,a,I[c]>>3),a-=3;var f=c<4?0:c-2>>1;f>0&&(V(n,a,i-u-A[c]),a+=f);for(var p=0;p<h;++p)s[l]=32767&i,l=32767&(l<<5^t[i]),++i;o-=h-1}else c<=143?c+=48:a=F(n,a,1),a=U(n,a,I[c]),s[l]=32767&i,++i}a=U(n,a,0)-1}}return n.l=(a+7)/8|0,n.l}(t,n)}}();function Y(e){var t=uy(50+Math.floor(1.1*e.length)),n=K(e,t);return t.slice(0,n)}var Q=C?new Uint16Array(32768):z(32768),X=C?new Uint16Array(32768):z(32768),J=C?new Uint16Array(128):z(128),$=1,Z=1;function ee(e,t){var n=j(e,t)+257,r=j(e,t+=5)+1,a=function(e,t){var n=7&t,r=t>>>3;return(e[r]|(n<=4?0:e[r+1]<<8))>>>n&15}(e,t+=5)+4;t+=4;for(var i=0,s=C?new Uint8Array(19):z(19),o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],l=1,c=C?new Uint8Array(8):z(8),u=C?new Uint8Array(8):z(8),h=s.length,d=0;d<a;++d)s[x[d]]=i=D(e,t),l<i&&(l=i),c[i]++,t+=3;var f=0;for(c[0]=0,d=1;d<=l;++d)u[d]=f=f+c[d-1]<<1;for(d=0;d<h;++d)0!=(f=s[d])&&(o[d]=u[f]++);var p=0;for(d=0;d<h;++d)if(0!=(p=s[d])){f=I[o[d]]>>8-p;for(var m=(1<<7-p)-1;m>=0;--m)J[f|m<<p]=7&p|d<<3}var g=[];for(l=1;g.length<n+r;)switch(t+=7&(f=J[P(e,t)]),f>>>=3){case 16:for(i=3+R(e,t),t+=2,f=g[g.length-1];i-- >0;)g.push(f);break;case 17:for(i=3+D(e,t),t+=3;i-- >0;)g.push(0);break;case 18:for(i=11+P(e,t),t+=7;i-- >0;)g.push(0);break;default:g.push(f),l<f&&(l=f)}var v=g.slice(0,n),y=g.slice(n);for(d=n;d<286;++d)v[d]=0;for(d=r;d<30;++d)y[d]=0;return $=H(v,Q,286),Z=H(y,X,30),t}function te(e,t){var n=function(e,t){if(3==e[0]&&!(3&e[1]))return[Nm(t),2];for(var n=0,r=0,a=Om(t||1<<18),i=0,s=a.length>>>0,o=0,l=0;0==(1&r);)if(r=D(e,n),n+=3,r>>>1!=0)for(r>>1==1?(o=9,l=5):(n=ee(e,n),o=$,l=Z);;){!t&&s<i+32767&&(s=(a=B(a,i+32767)).length);var c=L(e,n,o),u=r>>>1==1?W[c]:Q[c];if(n+=15&u,0===((u>>>=4)>>>8&255))a[i++]=u;else{if(256==u)break;var h=(u-=257)<8?0:u-4>>2;h>5&&(h=0);var d=i+_[u];h>0&&(d+=L(e,n,h),n+=h),c=L(e,n,l),n+=15&(u=r>>>1==1?G[c]:X[c]);var f=(u>>>=4)<4?0:u-2>>1,p=A[u];for(f>0&&(p+=L(e,n,f),n+=f),!t&&s<d&&(s=(a=B(a,d+100)).length);i<d;)a[i]=a[i-p],++i}}else{7&n&&(n+=8-(7&n));var m=e[n>>>3]|e[1+(n>>>3)]<<8;if(n+=32,m>0)for(!t&&s<i+m&&(s=(a=B(a,i+m)).length);m-- >0;)a[i++]=e[n>>>3],n+=8}return t?[a,n+7>>>3]:[a.slice(0,i),n+7>>>3]}(e.slice(e.l||0),t);return e.l+=n[1],n[0]}function ne(e,t){if(!e)throw new Error(t);"undefined"!==typeof console&&console.error(t)}function re(e,t){var n=e;ly(n,0);var r={FileIndex:[],FullPaths:[]};d(r,{root:t.root});for(var a=n.length-4;(80!=n[a]||75!=n[a+1]||5!=n[a+2]||6!=n[a+3])&&a>=0;)--a;n.l=a+4,n.l+=4;var s=n.read_shift(2);n.l+=6;var o=n.read_shift(4);for(n.l=o,a=0;a<s;++a){n.l+=20;var l=n.read_shift(4),c=n.read_shift(4),u=n.read_shift(2),h=n.read_shift(2),f=n.read_shift(2);n.l+=8;var p=n.read_shift(4),m=i(n.slice(n.l+u,n.l+u+h));n.l+=u+h+f;var g=n.l;n.l=p+4,ae(n,l,c,r,m),n.l=g}return r}function ae(e,t,n,r,a){e.l+=2;var s=e.read_shift(2),o=e.read_shift(2),l=function(e){var t=65535&e.read_shift(2),n=65535&e.read_shift(2),r=new Date,a=31&n,i=15&(n>>>=5);n>>>=4,r.setMilliseconds(0),r.setFullYear(n+1980),r.setMonth(i-1),r.setDate(a);var s=31&t,o=63&(t>>>=5);return t>>>=6,r.setHours(t),r.setMinutes(o),r.setSeconds(s<<1),r}(e);if(8257&s)throw new Error("Unsupported ZIP encryption");e.read_shift(4);for(var c=e.read_shift(4),u=e.read_shift(4),h=e.read_shift(2),d=e.read_shift(2),f="",p=0;p<h;++p)f+=String.fromCharCode(e[e.l++]);if(d){var g=i(e.slice(e.l,e.l+d));(g[21589]||{}).mt&&(l=g[21589].mt),((a||{})[21589]||{}).mt&&(l=a[21589].mt)}e.l+=d;var v=e.slice(e.l,e.l+c);switch(o){case 8:v=function(e,t){if(!m)return te(e,t);var n=new(0,m.InflateRaw),r=n._processChunk(e.slice(e.l),n._finishFlushFlag);return e.l+=n.bytesRead,r}(e,u);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+o)}var y=!1;8&s&&(134695760==e.read_shift(4)&&(e.read_shift(4),y=!0),c=e.read_shift(4),u=e.read_shift(4)),c!=t&&ne(y,"Bad compressed size: "+t+" != "+c),u!=n&&ne(y,"Bad uncompressed size: "+n+" != "+u),ue(r,f,v,{unsafe:!0,mt:l})}var ie={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function se(e,t){if(e.ctype)return e.ctype;var n=e.name||"",r=n.match(/\.([^\.]+)$/);return r&&ie[r[1]]||t&&(r=(n=t).match(/[\.\\]([^\.\\])+$/))&&ie[r[1]]?ie[r[1]]:"application/octet-stream"}function oe(e){for(var t=Am(e),n=[],r=0;r<t.length;r+=76)n.push(t.slice(r,r+76));return n.join("\r\n")+"\r\n"}function le(e){var t=e.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,(function(e){var t=e.charCodeAt(0).toString(16).toUpperCase();return"="+(1==t.length?"0"+t:t)}));"\n"==(t=t.replace(/ $/gm,"=20").replace(/\t$/gm,"=09")).charAt(0)&&(t="=0D"+t.slice(1));for(var n=[],r=(t=t.replace(/\r(?!\n)/gm,"=0D").replace(/\n\n/gm,"\n=0A").replace(/([^\r\n])\n/gm,"$1=0A")).split("\r\n"),a=0;a<r.length;++a){var i=r[a];if(0!=i.length)for(var s=0;s<i.length;){var o=76,l=i.slice(s,s+o);"="==l.charAt(o-1)?o--:"="==l.charAt(o-2)?o-=2:"="==l.charAt(o-3)&&(o-=3),l=i.slice(s,s+o),(s+=o)<i.length&&(l+="="),n.push(l)}else n.push("")}return n.join("\r\n")}function ce(e,t,n){for(var r,a="",i="",s="",o=0;o<10;++o){var l=t[o];if(!l||l.match(/^\s*$/))break;var c=l.match(/^(.*?):\s*([^\s].*)$/);if(c)switch(c[1].toLowerCase()){case"content-location":a=c[2].trim();break;case"content-type":s=c[2].trim();break;case"content-transfer-encoding":i=c[2].trim()}}switch(++o,i.toLowerCase()){case"base64":r=Rm(km(t.slice(o).join("")));break;case"quoted-printable":r=function(e){for(var t=[],n=0;n<e.length;++n){for(var r=e[n];n<=e.length&&"="==r.charAt(r.length-1);)r=r.slice(0,r.length-1)+e[++n];t.push(r)}for(var a=0;a<t.length;++a)t[a]=t[a].replace(/[=][0-9A-Fa-f]{2}/g,(function(e){return String.fromCharCode(parseInt(e.slice(1),16))}));return Rm(t.join("\r\n"))}(t.slice(o));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+i)}var u=ue(e,a.slice(n.length),r,{unsafe:!0});s&&(u.ctype=s)}function ue(e,t,n,a){var i=a&&a.unsafe;i||d(e);var s=!i&&Og.find(e,t);if(!s){var o=e.FullPaths[0];t.slice(0,o.length)==o?o=t:("/"!=o.slice(-1)&&(o+="/"),o=(o+t).replace("//","/")),s={name:r(t),type:2},e.FileIndex.push(s),e.FullPaths.push(o),i||Og.utils.cfb_gc(e)}return s.content=n,s.size=n?n.length:0,a&&(a.CLSID&&(s.clsid=a.CLSID),a.mt&&(s.mt=a.mt),a.ct&&(s.ct=a.ct)),s}return t.find=function(e,t){var n=e.FullPaths.map((function(e){return e.toUpperCase()})),r=n.map((function(e){var t=e.split("/");return t[t.length-("/"==e.slice(-1)?2:1)]})),a=!1;47===t.charCodeAt(0)?(a=!0,t=n[0].slice(0,-1)+t):a=-1!==t.indexOf("/");var i=t.toUpperCase(),s=!0===a?n.indexOf(i):r.indexOf(i);if(-1!==s)return e.FileIndex[s];var o=!i.match(Mm);for(i=i.replace(Lm,""),o&&(i=i.replace(Mm,"!")),s=0;s<n.length;++s){if((o?n[s].replace(Mm,"!"):n[s]).replace(Lm,"")==i)return e.FileIndex[s];if((o?r[s].replace(Mm,"!"):r[s]).replace(Lm,"")==i)return e.FileIndex[s]}return null},t.read=function(t,n){var r=n&&n.type;switch(r||Cm&&Buffer.isBuffer(t)&&(r="buffer"),r||"base64"){case"file":return function(t,n){return s(),o(e.readFileSync(t),n)}(t,n);case"base64":return o(Rm(km(t)),n);case"binary":return o(Rm(t),n)}return o(t,n)},t.parse=o,t.write=function(t,n){var r=p(t,n);switch(n&&n.type||"buffer"){case"file":return s(),e.writeFileSync(n.filename,r),r;case"binary":return"string"==typeof r?r:T(r);case"base64":return Am("string"==typeof r?r:T(r));case"buffer":if(Cm)return Buffer.isBuffer(r)?r:Im(r);case"array":return"string"==typeof r?Rm(r):r}return r},t.writeFile=function(t,n,r){s();var a=p(t,r);e.writeFileSync(n,a)},t.utils={cfb_new:function(e){var t={};return d(t,e),t},cfb_add:ue,cfb_del:function(e,t){d(e);var n=Og.find(e,t);if(n)for(var r=0;r<e.FileIndex.length;++r)if(e.FileIndex[r]==n)return e.FileIndex.splice(r,1),e.FullPaths.splice(r,1),!0;return!1},cfb_mov:function(e,t,n){d(e);var a=Og.find(e,t);if(a)for(var i=0;i<e.FileIndex.length;++i)if(e.FileIndex[i]==a)return e.FileIndex[i].name=r(n),e.FullPaths[i]=n,!0;return!1},cfb_gc:function(e){f(e,!0)},ReadShift:ny,CheckField:oy,prep_blob:ly,bconcat:Pm,use_zlib:function(e){try{var t=new(0,e.InflateRaw);if(t._processChunk(new Uint8Array([3,0]),t._finishFlushFlag),!t.bytesRead)throw new Error("zlib does not expose bytesRead");m=e}catch(YE){console.error("cannot use native zlib: "+(YE.message||YE))}},_deflateRaw:Y,_inflateRaw:te,consts:S},t}();let Rg;function Dg(e){return"string"===typeof e?Dm(e):Array.isArray(e)?function(e){if("undefined"===typeof Uint8Array)throw new Error("Unsupported");return new Uint8Array(e)}(e):e}function jg(e,t,n){if("undefined"!==typeof Rg&&Rg.writeFileSync)return n?Rg.writeFileSync(e,t,n):Rg.writeFileSync(e,t);if("undefined"!==typeof Deno){if(n&&"string"==typeof t)switch(n){case"utf8":t=new TextEncoder(n).encode(t);break;case"binary":t=Dm(t);break;default:throw new Error("Unsupported encoding "+n)}return Deno.writeFileSync(e,t)}var r="utf8"==n?yv(t):t;if("undefined"!==typeof IE_SaveFile)return IE_SaveFile(r,e);if("undefined"!==typeof Blob){var a=new Blob([Dg(r)],{type:"application/octet-stream"});if("undefined"!==typeof navigator&&navigator.msSaveBlob)return navigator.msSaveBlob(a,e);if("undefined"!==typeof saveAs)return saveAs(a,e);if("undefined"!==typeof URL&&"undefined"!==typeof document&&document.createElement&&URL.createObjectURL){var i=URL.createObjectURL(a);if("object"===typeof chrome&&"function"==typeof(chrome.downloads||{}).download)return URL.revokeObjectURL&&"undefined"!==typeof setTimeout&&setTimeout((function(){URL.revokeObjectURL(i)}),6e4),chrome.downloads.download({url:i,filename:e,saveAs:!0});var s=document.createElement("a");if(null!=s.download)return s.download=e,s.href=i,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL&&"undefined"!==typeof setTimeout&&setTimeout((function(){URL.revokeObjectURL(i)}),6e4),i}}if("undefined"!==typeof $&&"undefined"!==typeof File&&"undefined"!==typeof Folder)try{var o=File(e);return o.open("w"),o.encoding="binary",Array.isArray(t)&&(t=jm(t)),o.write(t),o.close(),t}catch(YE){if(!YE.message||!YE.message.match(/onstruct/))throw YE}throw new Error("cannot save file "+e)}function Pg(e){for(var t=Object.keys(e),n=[],r=0;r<t.length;++r)Object.prototype.hasOwnProperty.call(e,t[r])&&n.push(t[r]);return n}function Lg(e,t){for(var n=[],r=Pg(e),a=0;a!==r.length;++a)null==n[e[r[a]][t]]&&(n[e[r[a]][t]]=r[a]);return n}function Mg(e){for(var t=[],n=Pg(e),r=0;r!==n.length;++r)t[e[n[r]]]=n[r];return t}function Fg(e){for(var t=[],n=Pg(e),r=0;r!==n.length;++r)t[e[n[r]]]=parseInt(n[r],10);return t}var Ug=new Date(1899,11,30,0,0,0);function Vg(e,t){var n=e.getTime();return t&&(n-=1263168e5),(n-(Ug.getTime()+6e4*(e.getTimezoneOffset()-Ug.getTimezoneOffset())))/864e5}var Bg=new Date,zg=Ug.getTime()+6e4*(Bg.getTimezoneOffset()-Ug.getTimezoneOffset()),Hg=Bg.getTimezoneOffset();function Wg(e){var t=new Date;return t.setTime(24*e*60*60*1e3+zg),t.getTimezoneOffset()!==Hg&&t.setTime(t.getTime()+6e4*(t.getTimezoneOffset()-Hg)),t}var Gg=new Date("2017-02-19T19:06:09.000Z"),qg=isNaN(Gg.getFullYear())?new Date("2/19/17"):Gg,Kg=2017==qg.getFullYear();function Yg(e,t){var n=new Date(e);if(Kg)return t>0?n.setTime(n.getTime()+60*n.getTimezoneOffset()*1e3):t<0&&n.setTime(n.getTime()-60*n.getTimezoneOffset()*1e3),n;if(e instanceof Date)return e;if(1917==qg.getFullYear()&&!isNaN(n.getFullYear())){var r=n.getFullYear();return e.indexOf(""+r)>-1||n.setFullYear(n.getFullYear()+100),n}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return e.indexOf("Z")>-1&&(i=new Date(i.getTime()-60*i.getTimezoneOffset()*1e3)),i}function Qg(e,t){if(Cm&&Buffer.isBuffer(e)){if(t){if(255==e[0]&&254==e[1])return yv(e.slice(2).toString("utf16le"));if(254==e[1]&&255==e[2])return yv(wm(e.slice(2).toString("binary")))}return e.toString("binary")}if("undefined"!==typeof TextDecoder)try{if(t){if(255==e[0]&&254==e[1])return yv(new TextDecoder("utf-16le").decode(e.slice(2)));if(254==e[0]&&255==e[1])return yv(new TextDecoder("utf-16be").decode(e.slice(2)))}var n={"\u20ac":"\x80","\u201a":"\x82","\u0192":"\x83","\u201e":"\x84","\u2026":"\x85","\u2020":"\x86","\u2021":"\x87","\u02c6":"\x88","\u2030":"\x89","\u0160":"\x8a","\u2039":"\x8b","\u0152":"\x8c","\u017d":"\x8e","\u2018":"\x91","\u2019":"\x92","\u201c":"\x93","\u201d":"\x94","\u2022":"\x95","\u2013":"\x96","\u2014":"\x97","\u02dc":"\x98","\u2122":"\x99","\u0161":"\x9a","\u203a":"\x9b","\u0153":"\x9c","\u017e":"\x9e","\u0178":"\x9f"};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[\u20ac\u201a\u0192\u201e\u2026\u2020\u2021\u02c6\u2030\u0160\u2039\u0152\u017d\u2018\u2019\u201c\u201d\u2022\u2013\u2014\u02dc\u2122\u0161\u203a\u0153\u017e\u0178]/g,(function(e){return n[e]||e}))}catch(YE){}for(var r=[],a=0;a!=e.length;++a)r.push(String.fromCharCode(e[a]));return r.join("")}function Xg(e){if("undefined"!=typeof JSON&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if("object"!=typeof e||null==e)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=Xg(e[n]));return t}function Jg(e,t){for(var n="";n.length<t;)n+=e;return n}function $g(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var n=1,r=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,(function(){return n*=100,""}));return isNaN(t=Number(r))?(r=r.replace(/[(](.*)[)]/,(function(e,t){return n=-n,t})),isNaN(t=Number(r))?t:t/n):t/n}var Zg=["january","february","march","april","may","june","july","august","september","october","november","december"];function ev(e){var t=new Date(e),n=new Date(NaN),r=t.getYear(),a=t.getMonth(),i=t.getDate();if(isNaN(i))return n;var s=e.toLowerCase();if(s.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if((s=s.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,"")).length>3&&-1==Zg.indexOf(s))return n}else if(s.match(/[a-z]/))return n;return r<0||r>8099?n:(a>0||i>1)&&101!=r?t:e.match(/[^-0-9:,\/\\]/)?n:t}function tv(e,t,n){if(e.FullPaths){var r;if("string"==typeof n)return r=Cm?Im(n):function(e){for(var t=[],n=0,r=e.length+250,a=Nm(e.length+255),i=0;i<e.length;++i){var s=e.charCodeAt(i);if(s<128)a[n++]=s;else if(s<2048)a[n++]=192|s>>6&31,a[n++]=128|63&s;else if(s>=55296&&s<57344){s=64+(1023&s);var o=1023&e.charCodeAt(++i);a[n++]=240|s>>8&7,a[n++]=128|s>>2&63,a[n++]=128|o>>6&15|(3&s)<<4,a[n++]=128|63&o}else a[n++]=224|s>>12&15,a[n++]=128|s>>6&63,a[n++]=128|63&s;n>r&&(t.push(a.slice(0,n)),n=0,a=Nm(65535),r=65530)}return t.push(a.slice(0,n)),Pm(t)}(n),Og.utils.cfb_add(e,t,r);Og.utils.cfb_add(e,t,n)}else e.file(t,n)}function nv(){return Og.utils.cfb_new()}var rv='<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r\n';var av={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},iv=Mg(av),sv=/[&<>'"]/g,ov=/[\u0000-\u0008\u000b-\u001f]/g;function lv(e){return(e+"").replace(sv,(function(e){return iv[e]})).replace(ov,(function(e){return"_x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+"_"}))}function cv(e){return lv(e).replace(/ /g,"_x0020_")}var uv=/[\u0000-\u001f]/g;function hv(e){return(e+"").replace(sv,(function(e){return iv[e]})).replace(/\n/g,"<br/>").replace(uv,(function(e){return"&#x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+";"}))}function dv(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function fv(e){for(var t="",n=0,r=0,a=0,i=0,s=0,o=0;n<e.length;)(r=e.charCodeAt(n++))<128?t+=String.fromCharCode(r):(a=e.charCodeAt(n++),r>191&&r<224?(s=(31&r)<<6,s|=63&a,t+=String.fromCharCode(s)):(i=e.charCodeAt(n++),r<240?t+=String.fromCharCode((15&r)<<12|(63&a)<<6|63&i):(o=((7&r)<<18|(63&a)<<12|(63&i)<<6|63&(s=e.charCodeAt(n++)))-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(1023&o)))));return t}function pv(e){var t,n,r,a=Nm(2*e.length),i=1,s=0,o=0;for(n=0;n<e.length;n+=i)i=1,(r=e.charCodeAt(n))<128?t=r:r<224?(t=64*(31&r)+(63&e.charCodeAt(n+1)),i=2):r<240?(t=4096*(15&r)+64*(63&e.charCodeAt(n+1))+(63&e.charCodeAt(n+2)),i=3):(i=4,t=262144*(7&r)+4096*(63&e.charCodeAt(n+1))+64*(63&e.charCodeAt(n+2))+(63&e.charCodeAt(n+3)),o=55296+((t-=65536)>>>10&1023),t=56320+(1023&t)),0!==o&&(a[s++]=255&o,a[s++]=o>>>8,o=0),a[s++]=t%256,a[s++]=t>>>8;return a.slice(0,s).toString("ucs2")}function mv(e){return Im(e,"binary").toString("utf8")}var gv="foo bar baz\xe2\x98\x83\xf0\x9f\x8d\xa3",vv=Cm&&(mv(gv)==fv(gv)&&mv||pv(gv)==fv(gv)&&pv)||fv,yv=Cm?function(e){return Im(e,"utf8").toString("binary")}:function(e){for(var t=[],n=0,r=0,a=0;n<e.length;)switch(r=e.charCodeAt(n++),!0){case r<128:t.push(String.fromCharCode(r));break;case r<2048:t.push(String.fromCharCode(192+(r>>6))),t.push(String.fromCharCode(128+(63&r)));break;case r>=55296&&r<57344:r-=55296,a=e.charCodeAt(n++)-56320+(r<<10),t.push(String.fromCharCode(240+(a>>18&7))),t.push(String.fromCharCode(144+(a>>12&63))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(63&a)));break;default:t.push(String.fromCharCode(224+(r>>12))),t.push(String.fromCharCode(128+(r>>6&63))),t.push(String.fromCharCode(128+(63&r)))}return t.join("")},bv=function(){var e=[["nbsp"," "],["middot","\xb7"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map((function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]}));return function(t){for(var n=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,"\n").replace(/<[^>]*>/g,""),r=0;r<e.length;++r)n=n.replace(e[r][0],e[r][1]);return n}}();var wv=/(^\s|\s$|\n)/;function Sv(e,t){return"<"+e+(t.match(wv)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function Tv(e){return Pg(e).map((function(t){return" "+t+'="'+e[t]+'"'})).join("")}function Ev(e,t,n){return"<"+e+(null!=n?Tv(n):"")+(null!=t?(t.match(wv)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function xv(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(YE){if(t)throw YE}return""}var _v={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Av=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],kv={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};var Cv=function(e){for(var t=[],n=0;n<e[0].length;++n)if(e[0][n])for(var r=0,a=e[0][n].length;r<a;r+=10240)t.push.apply(t,e[0][n].slice(r,r+10240));return t},Iv=Cm?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map((function(e){return Buffer.isBuffer(e)?e:Im(e)}))):Cv(e)}:Cv,Nv=function(e,t,n){for(var r=[],a=t;a<n;a+=2)r.push(String.fromCharCode(Jv(e,a)));return r.join("").replace(Lm,"")},Ov=Cm?function(e,t,n){return Buffer.isBuffer(e)?e.toString("utf16le",t,n).replace(Lm,""):Nv(e,t,n)}:Nv,Rv=function(e,t,n){for(var r=[],a=t;a<t+n;++a)r.push(("0"+e[a].toString(16)).slice(-2));return r.join("")},Dv=Cm?function(e,t,n){return Buffer.isBuffer(e)?e.toString("hex",t,t+n):Rv(e,t,n)}:Rv,jv=function(e,t,n){for(var r=[],a=t;a<n;a++)r.push(String.fromCharCode(Xv(e,a)));return r.join("")},Pv=Cm?function(e,t,n){return Buffer.isBuffer(e)?e.toString("utf8",t,n):jv(e,t,n)}:jv,Lv=function(e,t){var n=Zv(e,t);return n>0?Pv(e,t+4,t+4+n-1):""},Mv=Lv,Fv=function(e,t){var n=Zv(e,t);return n>0?Pv(e,t+4,t+4+n-1):""},Uv=Fv,Vv=function(e,t){var n=2*Zv(e,t);return n>0?Pv(e,t+4,t+4+n-1):""},Bv=Vv,zv=function(e,t){var n=Zv(e,t);return n>0?Ov(e,t+4,t+4+n):""},Hv=zv,Wv=function(e,t){var n=Zv(e,t);return n>0?Pv(e,t+4,t+4+n):""},Gv=Wv,qv=function(e,t){return function(e,t){for(var n=1-2*(e[t+7]>>>7),r=((127&e[t+7])<<4)+(e[t+6]>>>4&15),a=15&e[t+6],i=5;i>=0;--i)a=256*a+e[t+i];return 2047==r?0==a?n*(1/0):NaN:(0==r?r=-1022:(r-=1023,a+=Math.pow(2,52)),n*Math.pow(2,r-52)*a)}(e,t)},Kv=qv,Yv=function(e){return Array.isArray(e)||"undefined"!==typeof Uint8Array&&e instanceof Uint8Array};function Qv(){Ov=function(e,t,n){return Sm.utils.decode(1200,e.slice(t,n)).replace(Lm,"")},Pv=function(e,t,n){return Sm.utils.decode(65001,e.slice(t,n))},Mv=function(e,t){var n=Zv(e,t);return n>0?Sm.utils.decode(pm,e.slice(t+4,t+4+n-1)):""},Uv=function(e,t){var n=Zv(e,t);return n>0?Sm.utils.decode(fm,e.slice(t+4,t+4+n-1)):""},Bv=function(e,t){var n=2*Zv(e,t);return n>0?Sm.utils.decode(1200,e.slice(t+4,t+4+n-1)):""},Hv=function(e,t){var n=Zv(e,t);return n>0?Sm.utils.decode(1200,e.slice(t+4,t+4+n)):""},Gv=function(e,t){var n=Zv(e,t);return n>0?Sm.utils.decode(65001,e.slice(t+4,t+4+n)):""}}Cm&&(Mv=function(e,t){if(!Buffer.isBuffer(e))return Lv(e,t);var n=e.readUInt32LE(t);return n>0?e.toString("utf8",t+4,t+4+n-1):""},Uv=function(e,t){if(!Buffer.isBuffer(e))return Fv(e,t);var n=e.readUInt32LE(t);return n>0?e.toString("utf8",t+4,t+4+n-1):""},Bv=function(e,t){if(!Buffer.isBuffer(e))return Vv(e,t);var n=2*e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+n-1)},Hv=function(e,t){if(!Buffer.isBuffer(e))return zv(e,t);var n=e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+n)},Gv=function(e,t){if(!Buffer.isBuffer(e))return Wv(e,t);var n=e.readUInt32LE(t);return e.toString("utf8",t+4,t+4+n)},Kv=function(e,t){return Buffer.isBuffer(e)?e.readDoubleLE(t):qv(e,t)},Yv=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||"undefined"!==typeof Uint8Array&&e instanceof Uint8Array}),"undefined"!==typeof Sm&&Qv();var Xv=function(e,t){return e[t]},Jv=function(e,t){return 256*e[t+1]+e[t]},$v=function(e,t){var n=256*e[t+1]+e[t];return n<32768?n:-1*(65535-n+1)},Zv=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},ey=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},ty=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function ny(e,t){var n,r,a,i,s,o,l="",c=[];switch(t){case"dbcs":if(o=this.l,Cm&&Buffer.isBuffer(this))l=this.slice(this.l,this.l+2*e).toString("utf16le");else for(s=0;s<e;++s)l+=String.fromCharCode(Jv(this,o)),o+=2;e*=2;break;case"utf8":l=Pv(this,this.l,this.l+e);break;case"utf16le":e*=2,l=Ov(this,this.l,this.l+e);break;case"wstr":if("undefined"===typeof Sm)return ny.call(this,e,"dbcs");l=Sm.utils.decode(fm,this.slice(this.l,this.l+2*e)),e*=2;break;case"lpstr-ansi":l=Mv(this,this.l),e=4+Zv(this,this.l);break;case"lpstr-cp":l=Uv(this,this.l),e=4+Zv(this,this.l);break;case"lpwstr":l=Bv(this,this.l),e=4+2*Zv(this,this.l);break;case"lpp4":e=4+Zv(this,this.l),l=Hv(this,this.l),2&e&&(e+=2);break;case"8lpp4":e=4+Zv(this,this.l),l=Gv(this,this.l),3&e&&(e+=4-(3&e));break;case"cstr":for(e=0,l="";0!==(a=Xv(this,this.l+e++));)c.push(Tm(a));l=c.join("");break;case"_wstr":for(e=0,l="";0!==(a=Jv(this,this.l+e));)c.push(Tm(a)),e+=2;e+=2,l=c.join("");break;case"dbcs-cont":for(l="",o=this.l,s=0;s<e;++s){if(this.lens&&-1!==this.lens.indexOf(o))return a=Xv(this,o),this.l=o+1,i=ny.call(this,e-s,a?"dbcs-cont":"sbcs-cont"),c.join("")+i;c.push(Tm(Jv(this,o))),o+=2}l=c.join(""),e*=2;break;case"cpstr":if("undefined"!==typeof Sm){l=Sm.utils.decode(fm,this.slice(this.l,this.l+e));break}case"sbcs-cont":for(l="",o=this.l,s=0;s!=e;++s){if(this.lens&&-1!==this.lens.indexOf(o))return a=Xv(this,o),this.l=o+1,i=ny.call(this,e-s,a?"dbcs-cont":"sbcs-cont"),c.join("")+i;c.push(Tm(Xv(this,o))),o+=1}l=c.join("");break;default:switch(e){case 1:return n=Xv(this,this.l),this.l++,n;case 2:return n=("i"===t?$v:Jv)(this,this.l),this.l+=2,n;case 4:case-4:return"i"===t||0===(128&this[this.l+3])?(n=(e>0?ey:ty)(this,this.l),this.l+=4,n):(r=Zv(this,this.l),this.l+=4,r);case 8:case-8:if("f"===t)return r=8==e?Kv(this,this.l):Kv([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,r;e=8;case 16:l=Dv(this,this.l,e)}}return this.l+=e,l}var ry=function(e,t,n){e[n]=255&t,e[n+1]=t>>>8&255,e[n+2]=t>>>16&255,e[n+3]=t>>>24&255},ay=function(e,t,n){e[n]=255&t,e[n+1]=t>>8&255,e[n+2]=t>>16&255,e[n+3]=t>>24&255},iy=function(e,t,n){e[n]=255&t,e[n+1]=t>>>8&255};function sy(e,t,n){var r=0,a=0;if("dbcs"===n){for(a=0;a!=t.length;++a)iy(this,t.charCodeAt(a),this.l+2*a);r=2*t.length}else if("sbcs"===n){if("undefined"!==typeof Sm&&874==pm)for(a=0;a!=t.length;++a){var i=Sm.utils.encode(pm,t.charAt(a));this[this.l+a]=i[0]}else for(t=t.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=t.length;++a)this[this.l+a]=255&t.charCodeAt(a);r=t.length}else{if("hex"===n){for(;a<e;++a)this[this.l++]=parseInt(t.slice(2*a,2*a+2),16)||0;return this}if("utf16le"===n){var s=Math.min(this.l+e,this.length);for(a=0;a<Math.min(t.length,e);++a){var o=t.charCodeAt(a);this[this.l++]=255&o,this[this.l++]=o>>8}for(;this.l<s;)this[this.l++]=0;return this}switch(e){case 1:r=1,this[this.l]=255&t;break;case 2:r=2,this[this.l]=255&t,t>>>=8,this[this.l+1]=255&t;break;case 3:r=3,this[this.l]=255&t,t>>>=8,this[this.l+1]=255&t,t>>>=8,this[this.l+2]=255&t;break;case 4:r=4,ry(this,t,this.l);break;case 8:if(r=8,"f"===n){!function(e,t,n){var r=(t<0||1/t==-1/0?1:0)<<7,a=0,i=0,s=r?-t:t;isFinite(s)?0==s?a=i=0:(a=Math.floor(Math.log(s)/Math.LN2),i=s*Math.pow(2,52-a),a<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?a=-1022:(i-=Math.pow(2,52),a+=1023)):(a=2047,i=isNaN(t)?26985:0);for(var o=0;o<=5;++o,i/=256)e[n+o]=255&i;e[n+6]=(15&a)<<4|15&i,e[n+7]=a>>4|r}(this,t,this.l);break}case 16:break;case-4:r=4,ay(this,t,this.l)}}return this.l+=r,this}function oy(e,t){var n=Dv(this,this.l,e.length>>1);if(n!==e)throw new Error(t+"Expected "+e+" saw "+n);this.l+=e.length>>1}function ly(e,t){e.l=t,e.read_shift=ny,e.chk=oy,e.write_shift=sy}function cy(e,t){e.l+=t}function uy(e){var t=Nm(e);return ly(t,0),t}function hy(){var e=[],t=Cm?256:2048,n=function(e){var t=uy(e);return ly(t,0),t},r=n(t),a=function(){r&&(r.length>r.l&&((r=r.slice(0,r.l)).l=r.length),r.length>0&&e.push(r),r=null)},i=function(e){return r&&e<r.length-r.l?r:(a(),r=n(Math.max(e+1,t)))};return{next:i,push:function(e){a(),null==(r=e).l&&(r.l=r.length),i(t)},end:function(){return a(),Pm(e)},_bufs:e}}function dy(e,t,n,r){var a,i=+t;if(!isNaN(i)){r||(r=xT[i].p||(n||[]).length||0),a=1+(i>=128?1:0)+1,r>=128&&++a,r>=16384&&++a,r>=2097152&&++a;var s=e.next(a);i<=127?s.write_shift(1,i):(s.write_shift(1,128+(127&i)),s.write_shift(1,i>>7));for(var o=0;4!=o;++o){if(!(r>=128)){s.write_shift(1,r);break}s.write_shift(1,128+(127&r)),r>>=7}r>0&&Yv(n)&&e.push(n)}}function fy(e,t,n){var r=Xg(e);if(t.s?(r.cRel&&(r.c+=t.s.c),r.rRel&&(r.r+=t.s.r)):(r.cRel&&(r.c+=t.c),r.rRel&&(r.r+=t.r)),!n||n.biff<12){for(;r.c>=256;)r.c-=256;for(;r.r>=65536;)r.r-=65536}return r}function py(e,t,n){var r=Xg(e);return r.s=fy(r.s,t.s,n),r.e=fy(r.e,t.s,n),r}function my(e,t){if(e.cRel&&e.c<0)for(e=Xg(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Xg(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var n=Ty(e);return e.cRel||null==e.cRel||(n=n.replace(/^([A-Z])/,"$$$1")),e.rRel||null==e.rRel||(n=function(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}(n)),n}function gy(e,t){return 0!=e.s.r||e.s.rRel||e.e.r!=(t.biff>=12?1048575:t.biff>=8?65536:16384)||e.e.rRel?0!=e.s.c||e.s.cRel||e.e.c!=(t.biff>=12?16383:255)||e.e.cRel?my(e.s,t.biff)+":"+my(e.e,t.biff):(e.s.rRel?"":"$")+yy(e.s.r)+":"+(e.e.rRel?"":"$")+yy(e.e.r):(e.s.cRel?"":"$")+wy(e.s.c)+":"+(e.e.cRel?"":"$")+wy(e.e.c)}function vy(e){return parseInt(e.replace(/\$(\d+)$/,"$1"),10)-1}function yy(e){return""+(e+1)}function by(e){for(var t=e.replace(/^\$([A-Z])/,"$1"),n=0,r=0;r!==t.length;++r)n=26*n+t.charCodeAt(r)-64;return n-1}function wy(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function Sy(e){for(var t=0,n=0,r=0;r<e.length;++r){var a=e.charCodeAt(r);a>=48&&a<=57?t=10*t+(a-48):a>=65&&a<=90&&(n=26*n+(a-64))}return{c:n-1,r:t-1}}function Ty(e){for(var t=e.c+1,n="";t;t=(t-1)/26|0)n=String.fromCharCode((t-1)%26+65)+n;return n+(e.r+1)}function Ey(e){var t=e.indexOf(":");return-1==t?{s:Sy(e),e:Sy(e)}:{s:Sy(e.slice(0,t)),e:Sy(e.slice(t+1))}}function xy(e,t){return"undefined"===typeof t||"number"===typeof t?xy(e.s,e.e):("string"!==typeof e&&(e=Ty(e)),"string"!==typeof t&&(t=Ty(t)),e==t?e:e+":"+t)}function _y(e){var t={s:{c:0,r:0},e:{c:0,r:0}},n=0,r=0,a=0,i=e.length;for(n=0;r<i&&!((a=e.charCodeAt(r)-64)<1||a>26);++r)n=26*n+a;for(t.s.c=--n,n=0;r<i&&!((a=e.charCodeAt(r)-48)<0||a>9);++r)n=10*n+a;if(t.s.r=--n,r===i||10!=a)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++r,n=0;r!=i&&!((a=e.charCodeAt(r)-64)<1||a>26);++r)n=26*n+a;for(t.e.c=--n,n=0;r!=i&&!((a=e.charCodeAt(r)-48)<0||a>9);++r)n=10*n+a;return t.e.r=--n,t}function Ay(e,t){var n="d"==e.t&&t instanceof Date;if(null!=e.z)try{return e.w=_g(e.z,n?Vg(t):t)}catch(YE){}try{return e.w=_g((e.XF||{}).numFmtId||(n?14:0),n?Vg(t):t)}catch(YE){return""+t}}function ky(e,t,n){return null==e||null==e.t||"z"==e.t?"":void 0!==e.w?e.w:("d"==e.t&&!e.z&&n&&n.dateNF&&(e.z=n.dateNF),"e"==e.t?ub[e.v]||e.v:Ay(e,void 0==t?e.v:t))}function Cy(e,t){var n=t&&t.sheet?t.sheet:"Sheet1",r={};return r[n]=e,{SheetNames:[n],Sheets:r}}function Iy(e,t,n){var r=n||{},a=e?Array.isArray(e):r.dense;null!=xm&&null==a&&(a=xm);var i=e||(a?[]:{}),s=0,o=0;if(i&&null!=r.origin){if("number"==typeof r.origin)s=r.origin;else{var l="string"==typeof r.origin?Sy(r.origin):r.origin;s=l.r,o=l.c}i["!ref"]||(i["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var u=_y(i["!ref"]);c.s.c=u.s.c,c.s.r=u.s.r,c.e.c=Math.max(c.e.c,u.e.c),c.e.r=Math.max(c.e.r,u.e.r),-1==s&&(c.e.r=s=u.e.r+1)}for(var h=0;h!=t.length;++h)if(t[h]){if(!Array.isArray(t[h]))throw new Error("aoa_to_sheet expects an array of arrays");for(var d=0;d!=t[h].length;++d)if("undefined"!==typeof t[h][d]){var f={v:t[h][d]},p=s+h,m=o+d;if(c.s.r>p&&(c.s.r=p),c.s.c>m&&(c.s.c=m),c.e.r<p&&(c.e.r=p),c.e.c<m&&(c.e.c=m),!t[h][d]||"object"!==typeof t[h][d]||Array.isArray(t[h][d])||t[h][d]instanceof Date)if(Array.isArray(f.v)&&(f.f=t[h][d][1],f.v=f.v[0]),null===f.v)if(f.f)f.t="n";else if(r.nullError)f.t="e",f.v=0;else{if(!r.sheetStubs)continue;f.t="z"}else"number"===typeof f.v?f.t="n":"boolean"===typeof f.v?f.t="b":f.v instanceof Date?(f.z=r.dateNF||Km[14],r.cellDates?(f.t="d",f.w=_g(f.z,Vg(f.v))):(f.t="n",f.v=Vg(f.v),f.w=_g(f.z,f.v))):f.t="s";else f=t[h][d];if(a)i[p]||(i[p]=[]),i[p][m]&&i[p][m].z&&(f.z=i[p][m].z),i[p][m]=f;else{var g=Ty({c:m,r:p});i[g]&&i[g].z&&(f.z=i[g].z),i[g]=f}}}return c.s.c<1e7&&(i["!ref"]=xy(c)),i}function Ny(e,t){return Iy(null,e,t)}function Oy(e,t){return t||(t=uy(4)),t.write_shift(4,e),t}function Ry(e){var t=e.read_shift(4);return 0===t?"":e.read_shift(t,"dbcs")}function Dy(e,t){var n=!1;return null==t&&(n=!0,t=uy(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),n?t.slice(0,t.l):t}function jy(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function Py(e,t){var n=e.l,r=e.read_shift(1),a=Ry(e),i=[],s={t:a,h:a};if(0!==(1&r)){for(var o=e.read_shift(4),l=0;l!=o;++l)i.push(jy(e));s.r=i}else s.r=[{ich:0,ifnt:0}];return e.l=n+t,s}var Ly=Py;function My(e,t){var n=!1;return null==t&&(n=!0,t=uy(23+4*e.t.length)),t.write_shift(1,1),Dy(e.t,t),t.write_shift(4,1),function(e,t){t||(t=uy(4)),t.write_shift(2,e.ich||0),t.write_shift(2,e.ifnt||0)}({ich:0,ifnt:0},t),n?t.slice(0,t.l):t}function Fy(e){var t=e.read_shift(4),n=e.read_shift(2);return n+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:n}}function Uy(e,t){return null==t&&(t=uy(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function Vy(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function By(e,t){return null==t&&(t=uy(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var zy=Ry,Hy=Dy;function Wy(e){var t=e.read_shift(4);return 0===t||4294967295===t?"":e.read_shift(t,"dbcs")}function Gy(e,t){var n=!1;return null==t&&(n=!0,t=uy(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),n?t.slice(0,t.l):t}var qy=Ry,Ky=Wy,Yy=Gy;function Qy(e){var t=e.slice(e.l,e.l+4),n=1&t[0],r=2&t[0];e.l+=4;var a=0===r?Kv([0,0,0,0,252&t[0],t[1],t[2],t[3]],0):ey(t,0)>>2;return n?a/100:a}function Xy(e,t){null==t&&(t=uy(4));var n=0,r=0,a=100*e;if(e==(0|e)&&e>=-(1<<29)&&e<1<<29?r=1:a==(0|a)&&a>=-(1<<29)&&a<1<<29&&(r=1,n=1),!r)throw new Error("unsupported RkNumber "+e);t.write_shift(-4,((n?a:e)<<2)+(n+2))}function Jy(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}var $y=Jy,Zy=function(e,t){return t||(t=uy(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t};function eb(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function tb(e,t){return(t||uy(8)).write_shift(8,e,"f")}function nb(e,t){if(t||(t=uy(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;null!=e.index?(t.write_shift(1,2),t.write_shift(1,e.index)):null!=e.theme?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var n=e.tint||0;if(n>0?n*=32767:n<0&&(n*=32768),t.write_shift(2,n),e.rgb&&null==e.theme){var r=e.rgb||"FFFFFF";"number"==typeof r&&(r=("000000"+r.toString(16)).slice(-6)),t.write_shift(1,parseInt(r.slice(0,2),16)),t.write_shift(1,parseInt(r.slice(2,4),16)),t.write_shift(1,parseInt(r.slice(4,6),16)),t.write_shift(1,255)}else t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);return t}var rb=2,ab=3,ib=80,sb={1:{n:"CodePage",t:rb},2:{n:"Category",t:ib},3:{n:"PresentationFormat",t:ib},4:{n:"ByteCount",t:ab},5:{n:"LineCount",t:ab},6:{n:"ParagraphCount",t:ab},7:{n:"SlideCount",t:ab},8:{n:"NoteCount",t:ab},9:{n:"HiddenCount",t:ab},10:{n:"MultimediaClipCount",t:ab},11:{n:"ScaleCrop",t:11},12:{n:"HeadingPairs",t:4108},13:{n:"TitlesOfParts",t:4126},14:{n:"Manager",t:ib},15:{n:"Company",t:ib},16:{n:"LinksUpToDate",t:11},17:{n:"CharacterCount",t:ab},19:{n:"SharedDoc",t:11},22:{n:"HyperlinksChanged",t:11},23:{n:"AppVersion",t:ab,p:"version"},24:{n:"DigSig",t:65},26:{n:"ContentType",t:ib},27:{n:"ContentStatus",t:ib},28:{n:"Language",t:ib},29:{n:"Version",t:ib},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}},ob={1:{n:"CodePage",t:rb},2:{n:"Title",t:ib},3:{n:"Subject",t:ib},4:{n:"Author",t:ib},5:{n:"Keywords",t:ib},6:{n:"Comments",t:ib},7:{n:"Template",t:ib},8:{n:"LastAuthor",t:ib},9:{n:"RevNumber",t:ib},10:{n:"EditTime",t:64},11:{n:"LastPrinted",t:64},12:{n:"CreatedDate",t:64},13:{n:"ModifiedDate",t:64},14:{n:"PageCount",t:ab},15:{n:"WordCount",t:ab},16:{n:"CharCount",t:ab},17:{n:"Thumbnail",t:71},18:{n:"Application",t:ib},19:{n:"DocSecurity",t:ab},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}};function lb(e){return e.map((function(e){return[e>>16&255,e>>8&255,255&e]}))}var cb=Xg(lb([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0])),ub={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},hb={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},db={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function fb(e,t){var n,r=function(e){for(var t=[],n=Pg(e),r=0;r!==n.length;++r)null==t[e[n[r]]]&&(t[e[n[r]]]=[]),t[e[n[r]]].push(n[r]);return t}(hb),a=[];a[a.length]=rv,a[a.length]=Ev("Types",null,{xmlns:_v.CT,"xmlns:xsd":_v.xsd,"xmlns:xsi":_v.xsi}),a=a.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map((function(e){return Ev("Default",null,{Extension:e[0],ContentType:e[1]})})));var i=function(r){e[r]&&e[r].length>0&&(n=e[r][0],a[a.length]=Ev("Override",null,{PartName:("/"==n[0]?"":"/")+n,ContentType:db[r][t.bookType]||db[r].xlsx}))},s=function(n){(e[n]||[]).forEach((function(e){a[a.length]=Ev("Override",null,{PartName:("/"==e[0]?"":"/")+e,ContentType:db[n][t.bookType]||db[n].xlsx})}))},o=function(t){(e[t]||[]).forEach((function(e){a[a.length]=Ev("Override",null,{PartName:("/"==e[0]?"":"/")+e,ContentType:r[t][0]})}))};return i("workbooks"),s("sheets"),s("charts"),o("themes"),["strs","styles"].forEach(i),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),s("metadata"),o("people"),a.length>2&&(a[a.length]="</Types>",a[1]=a[1].replace("/>",">")),a.join("")}var pb={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function mb(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function gb(e){var t=[rv,Ev("Relationships",null,{xmlns:_v.RELS})];return Pg(e["!id"]).forEach((function(n){t[t.length]=Ev("Relationship",null,e["!id"][n])})),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function vb(e,t,n,r,a,i){if(a||(a={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,a.Id="rId"+t,a.Type=r,a.Target=n,i?a.TargetMode=i:[pb.HLINK,pb.XPATH,pb.XMISS].indexOf(a.Type)>-1&&(a.TargetMode="External"),e["!id"][a.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][a.Id]=a,e[("/"+a.Target).replace("//","/")]=a,t}function yb(e,t,n){return['  <rdf:Description rdf:about="'+e+'">\n','    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(n||"odf")+"#"+t+'"/>\n',"  </rdf:Description>\n"].join("")}function bb(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+dm.version+"</meta:generator></office:meta></office:document-meta>"}var wb=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function Sb(e,t,n,r,a){null==a[e]&&null!=t&&""!==t&&(a[e]=t,t=lv(t),r[r.length]=n?Ev(e,t,n):Sv(e,t))}function Tb(e,t){var n=t||{},r=[rv,Ev("cp:coreProperties",null,{"xmlns:cp":_v.CORE_PROPS,"xmlns:dc":_v.dc,"xmlns:dcterms":_v.dcterms,"xmlns:dcmitype":_v.dcmitype,"xmlns:xsi":_v.xsi})],a={};if(!e&&!n.Props)return r.join("");e&&(null!=e.CreatedDate&&Sb("dcterms:created","string"===typeof e.CreatedDate?e.CreatedDate:xv(e.CreatedDate,n.WTF),{"xsi:type":"dcterms:W3CDTF"},r,a),null!=e.ModifiedDate&&Sb("dcterms:modified","string"===typeof e.ModifiedDate?e.ModifiedDate:xv(e.ModifiedDate,n.WTF),{"xsi:type":"dcterms:W3CDTF"},r,a));for(var i=0;i!=wb.length;++i){var s=wb[i],o=n.Props&&null!=n.Props[s[1]]?n.Props[s[1]]:e?e[s[1]]:null;!0===o?o="1":!1===o?o="0":"number"==typeof o&&(o=String(o)),null!=o&&Sb(s[0],o,null,r,a)}return r.length>2&&(r[r.length]="</cp:coreProperties>",r[1]=r[1].replace("/>",">")),r.join("")}var Eb=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],xb=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function _b(e){var t=[],n=Ev;return e||(e={}),e.Application="SheetJS",t[t.length]=rv,t[t.length]=Ev("Properties",null,{xmlns:_v.EXT_PROPS,"xmlns:vt":_v.vt}),Eb.forEach((function(r){if(void 0!==e[r[1]]){var a;switch(r[2]){case"string":a=lv(String(e[r[1]]));break;case"bool":a=e[r[1]]?"true":"false"}void 0!==a&&(t[t.length]=n(r[0],a))}})),t[t.length]=n("HeadingPairs",n("vt:vector",n("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+n("vt:variant",n("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=n("TitlesOfParts",n("vt:vector",e.SheetNames.map((function(e){return"<vt:lpstr>"+lv(e)+"</vt:lpstr>"})).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}function Ab(e){var t=[rv,Ev("Properties",null,{xmlns:_v.CUST_PROPS,"xmlns:vt":_v.vt})];if(!e)return t.join("");var n=1;return Pg(e).forEach((function(r){++n,t[t.length]=Ev("property",function(e,t){switch(typeof e){case"string":var n=Ev("vt:lpwstr",lv(e));return t&&(n=n.replace(/&quot;/g,"_x0022_")),n;case"number":return Ev((0|e)==e?"vt:i4":"vt:r8",lv(String(e)));case"boolean":return Ev("vt:bool",e?"true":"false")}if(e instanceof Date)return Ev("vt:filetime",xv(e));throw new Error("Unable to serialize "+e)}(e[r],!0),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:n,name:lv(r)})})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var kb={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function Cb(e,t){var n=uy(4),r=uy(4);switch(n.write_shift(4,80==e?31:e),e){case 3:r.write_shift(-4,t);break;case 5:(r=uy(8)).write_shift(8,t,"f");break;case 11:r.write_shift(4,t?1:0);break;case 64:r=function(e){var t=("string"==typeof e?new Date(Date.parse(e)):e).getTime()/1e3+11644473600,n=t%Math.pow(2,32),r=(t-n)/Math.pow(2,32);r*=1e7;var a=(n*=1e7)/Math.pow(2,32)|0;a>0&&(n%=Math.pow(2,32),r+=a);var i=uy(8);return i.write_shift(4,n),i.write_shift(4,r),i}(t);break;case 31:case 80:for((r=uy(4+2*(t.length+1)+(t.length%2?0:2))).write_shift(4,t.length+1),r.write_shift(0,t,"dbcs");r.l!=r.length;)r.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return Pm([n,r])}var Ib=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function Nb(e){switch(typeof e){case"boolean":return 11;case"number":return(0|e)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64}return-1}function Ob(e,t,n){var r=uy(8),a=[],i=[],s=8,o=0,l=uy(8),c=uy(8);if(l.write_shift(4,2),l.write_shift(4,1200),c.write_shift(4,1),i.push(l),a.push(c),s+=8+l.length,!t){(c=uy(8)).write_shift(4,0),a.unshift(c);var u=[uy(4)];for(u[0].write_shift(4,e.length),o=0;o<e.length;++o){var h=e[o][0];for((l=uy(8+2*(h.length+1)+(h.length%2?0:2))).write_shift(4,o+2),l.write_shift(4,h.length+1),l.write_shift(0,h,"dbcs");l.l!=l.length;)l.write_shift(1,0);u.push(l)}l=Pm(u),i.unshift(l),s+=8+l.length}for(o=0;o<e.length;++o)if((!t||t[e[o][0]])&&!(Ib.indexOf(e[o][0])>-1||xb.indexOf(e[o][0])>-1)&&null!=e[o][1]){var d=e[o][1],f=0;if(t){var p=n[f=+t[e[o][0]]];if("version"==p.p&&"string"==typeof d){var m=d.split(".");d=(+m[0]<<16)+(+m[1]||0)}l=Cb(p.t,d)}else{var g=Nb(d);-1==g&&(g=31,d=String(d)),l=Cb(g,d)}i.push(l),(c=uy(8)).write_shift(4,t?f:2+o),a.push(c),s+=8+l.length}var v=8*(i.length+1);for(o=0;o<i.length;++o)a[o].write_shift(4,v),v+=i[o].length;return r.write_shift(4,s),r.write_shift(4,i.length),Pm([r].concat(a).concat(i))}function Rb(e,t,n,r,a,i){var s=uy(a?68:48),o=[s];s.write_shift(2,65534),s.write_shift(2,0),s.write_shift(4,842412599),s.write_shift(16,Og.utils.consts.HEADER_CLSID,"hex"),s.write_shift(4,a?2:1),s.write_shift(16,t,"hex"),s.write_shift(4,a?68:48);var l=Ob(e,n,r);if(o.push(l),a){var c=Ob(a,null,null);s.write_shift(16,i,"hex"),s.write_shift(4,68+l.length),o.push(c)}return Pm(o)}function Db(e,t){return 1===e.read_shift(t)}function jb(e,t){return t||(t=uy(2)),t.write_shift(2,+!!e),t}function Pb(e){return e.read_shift(2,"u")}function Lb(e,t){return t||(t=uy(2)),t.write_shift(2,e),t}function Mb(e,t,n){return n||(n=uy(2)),n.write_shift(1,"e"==t?+e:+!!e),n.write_shift(1,"e"==t?1:0),n}function Fb(e,t,n){var r=e.read_shift(n&&n.biff>=12?2:1),a="sbcs-cont",i=fm;(n&&n.biff>=8&&(fm=1200),n&&8!=n.biff)?12==n.biff&&(a="wstr"):e.read_shift(1)&&(a="dbcs-cont");n.biff>=2&&n.biff<=5&&(a="cpstr");var s=r?e.read_shift(r,a):"";return fm=i,s}function Ub(e){var t=e.t||"",n=uy(3);n.write_shift(2,t.length),n.write_shift(1,1);var r=uy(2*t.length);return r.write_shift(2*t.length,t,"utf16le"),Pm([n,r])}function Vb(e,t,n){if(n){if(n.biff>=2&&n.biff<=5)return e.read_shift(t,"cpstr");if(n.biff>=12)return e.read_shift(t,"dbcs-cont")}return 0===e.read_shift(1)?e.read_shift(t,"sbcs-cont"):e.read_shift(t,"dbcs-cont")}function Bb(e,t,n){var r=e.read_shift(n&&2==n.biff?1:2);return 0===r?(e.l++,""):Vb(e,r,n)}function zb(e,t,n){if(n.biff>5)return Bb(e,0,n);var r=e.read_shift(1);return 0===r?(e.l++,""):e.read_shift(r,n.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function Hb(e,t,n){return n||(n=uy(3+2*e.length)),n.write_shift(2,e.length),n.write_shift(1,1),n.write_shift(31,e,"utf16le"),n}function Wb(e,t){t||(t=uy(6+2*e.length)),t.write_shift(4,1+e.length);for(var n=0;n<e.length;++n)t.write_shift(2,e.charCodeAt(n));return t.write_shift(2,0),t}function Gb(e){var t=uy(512),n=0,r=e.Target;"file://"==r.slice(0,7)&&(r=r.slice(7));var a=r.indexOf("#"),i=a>-1?31:23;switch(r.charAt(0)){case"#":i=28;break;case".":i&=-3}t.write_shift(4,2),t.write_shift(4,i);var s=[8,6815827,6619237,4849780,83];for(n=0;n<s.length;++n)t.write_shift(4,s[n]);if(28==i)Wb(r=r.slice(1),t);else if(2&i){for(s="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),n=0;n<s.length;++n)t.write_shift(1,parseInt(s[n],16));var o=a>-1?r.slice(0,a):r;for(t.write_shift(4,2*(o.length+1)),n=0;n<o.length;++n)t.write_shift(2,o.charCodeAt(n));t.write_shift(2,0),8&i&&Wb(a>-1?r.slice(a+1):"",t)}else{for(s="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),n=0;n<s.length;++n)t.write_shift(1,parseInt(s[n],16));for(var l=0;"../"==r.slice(3*l,3*l+3)||"..\\"==r.slice(3*l,3*l+3);)++l;for(t.write_shift(2,l),t.write_shift(4,r.length-3*l+1),n=0;n<r.length-3*l;++n)t.write_shift(1,255&r.charCodeAt(n+3*l));for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),n=0;n<6;++n)t.write_shift(4,0)}return t.slice(0,t.l)}function qb(e,t,n,r){return r||(r=uy(6)),r.write_shift(2,e),r.write_shift(2,t),r.write_shift(2,n||0),r}function Kb(e,t,n){var r=n.biff>8?4:2;return[e.read_shift(r),e.read_shift(r,"i"),e.read_shift(r,"i")]}function Yb(e){var t=e.read_shift(2),n=e.read_shift(2);return{s:{c:e.read_shift(2),r:t},e:{c:e.read_shift(2),r:n}}}function Qb(e,t){return t||(t=uy(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function Xb(e,t,n){var r=1536,a=16;switch(n.bookType){case"biff8":case"xla":break;case"biff5":r=1280,a=8;break;case"biff4":r=4,a=6;break;case"biff3":r=3,a=6;break;case"biff2":r=2,a=4;break;default:throw new Error("unsupported BIFF version")}var i=uy(a);return i.write_shift(2,r),i.write_shift(2,t),a>4&&i.write_shift(2,29282),a>6&&i.write_shift(2,1997),a>8&&(i.write_shift(2,49161),i.write_shift(2,1),i.write_shift(2,1798),i.write_shift(2,0)),i}function Jb(e,t){var n=!t||t.biff>=8?2:1,r=uy(8+n*e.name.length);r.write_shift(4,e.pos),r.write_shift(1,e.hs||0),r.write_shift(1,e.dt),r.write_shift(1,e.name.length),t.biff>=8&&r.write_shift(1,1),r.write_shift(n*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var a=r.slice(0,r.l);return a.l=r.l,a}function $b(e,t,n,r){var a=n&&5==n.biff;r||(r=uy(a?3+t.length:5+2*t.length)),r.write_shift(2,e),r.write_shift(a?1:2,t.length),a||r.write_shift(1,1),r.write_shift((a?1:2)*t.length,t,a?"sbcs":"utf16le");var i=r.length>r.l?r.slice(0,r.l):r;return null==i.l&&(i.l=i.length),i}function Zb(e,t,n,r){var a=n&&5==n.biff;r||(r=uy(a?16:20)),r.write_shift(2,0),e.style?(r.write_shift(2,e.numFmtId||0),r.write_shift(2,65524)):(r.write_shift(2,e.numFmtId||0),r.write_shift(2,t<<4));var i=0;return e.numFmtId>0&&a&&(i|=1024),r.write_shift(4,i),r.write_shift(4,0),a||r.write_shift(4,0),r.write_shift(2,0),r}function ew(e,t,n){if(n.biff<8)return function(e,t,n){3==e[e.l+1]&&e[e.l]++;var r=Fb(e,0,n);return 3==r.charCodeAt(0)?r.slice(1):r}(e,0,n);for(var r=[],a=e.l+t,i=e.read_shift(n.biff>8?4:2);0!==i--;)r.push(Kb(e,n.biff,n));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return r}function tw(e){var t=uy(24),n=Sy(e[0]);t.write_shift(2,n.r),t.write_shift(2,n.r),t.write_shift(2,n.c),t.write_shift(2,n.c);for(var r="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<16;++a)t.write_shift(1,parseInt(r[a],16));return Pm([t,Gb(e[1])])}function nw(e){var t=e[1].Tooltip,n=uy(10+2*(t.length+1));n.write_shift(2,2048);var r=Sy(e[0]);n.write_shift(2,r.r),n.write_shift(2,r.r),n.write_shift(2,r.c),n.write_shift(2,r.c);for(var a=0;a<t.length;++a)n.write_shift(2,t.charCodeAt(a));return n.write_shift(2,0),n}function rw(e,t,n){if(!n.cellStyles)return cy(e,t);var r=n&&n.biff>=12?4:2,a=e.read_shift(r),i=e.read_shift(r),s=e.read_shift(r),o=e.read_shift(r),l=e.read_shift(2);2==r&&(e.l+=2);var c={s:a,e:i,w:s,ixfe:o,flags:l};return(n.biff>=5||!n.biff)&&(c.level=l>>8&7),c}var aw=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=Mg({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function n(t,n){var r=n||{};r.dateNF||(r.dateNF="yyyymmdd");var a=Ny(function(t,n){var r=[],a=Nm(1);switch(n.type){case"base64":a=Rm(km(t));break;case"binary":a=Rm(t);break;case"buffer":case"array":a=t}ly(a,0);var i=a.read_shift(1),s=!!(136&i),o=!1,l=!1;switch(i){case 2:case 3:case 131:case 139:case 245:break;case 48:case 49:o=!0,s=!0;break;case 140:l=!0;break;default:throw new Error("DBF Unsupported Version: "+i.toString(16))}var c=0,u=521;2==i&&(c=a.read_shift(2)),a.l+=3,2!=i&&(c=a.read_shift(4)),c>1048576&&(c=1e6),2!=i&&(u=a.read_shift(2));var h=a.read_shift(2),d=n.codepage||1252;2!=i&&(a.l+=16,a.read_shift(1),0!==a[a.l]&&(d=e[a[a.l]]),a.l+=1,a.l+=2),l&&(a.l+=36);for(var f=[],p={},m=Math.min(a.length,2==i?521:u-10-(o?264:0)),g=l?32:11;a.l<m&&13!=a[a.l];)switch((p={}).name=Sm.utils.decode(d,a.slice(a.l,a.l+g)).replace(/[\u0000\r\n].*$/g,""),a.l+=g,p.type=String.fromCharCode(a.read_shift(1)),2==i||l||(p.offset=a.read_shift(4)),p.len=a.read_shift(1),2==i&&(p.offset=a.read_shift(2)),p.dec=a.read_shift(1),p.name.length&&f.push(p),2!=i&&(a.l+=l?13:14),p.type){case"B":o&&8==p.len||!n.WTF||console.log("Skipping "+p.name+":"+p.type);break;case"G":case"P":n.WTF&&console.log("Skipping "+p.name+":"+p.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+p.type)}if(13!==a[a.l]&&(a.l=u-1),13!==a.read_shift(1))throw new Error("DBF Terminator not found "+a.l+" "+a[a.l]);a.l=u;var v=0,y=0;for(r[0]=[],y=0;y!=f.length;++y)r[0][y]=f[y].name;for(;c-- >0;)if(42!==a[a.l])for(++a.l,r[++v]=[],y=0,y=0;y!=f.length;++y){var b=a.slice(a.l,a.l+f[y].len);a.l+=f[y].len,ly(b,0);var w=Sm.utils.decode(d,b);switch(f[y].type){case"C":w.trim().length&&(r[v][y]=w.replace(/\s+$/,""));break;case"D":8===w.length?r[v][y]=new Date(+w.slice(0,4),+w.slice(4,6)-1,+w.slice(6,8)):r[v][y]=w;break;case"F":r[v][y]=parseFloat(w.trim());break;case"+":case"I":r[v][y]=l?2147483648^b.read_shift(-4,"i"):b.read_shift(4,"i");break;case"L":switch(w.trim().toUpperCase()){case"Y":case"T":r[v][y]=!0;break;case"N":case"F":r[v][y]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+w+"|")}break;case"M":if(!s)throw new Error("DBF Unexpected MEMO for type "+i.toString(16));r[v][y]="##MEMO##"+(l?parseInt(w.trim(),10):b.read_shift(4));break;case"N":(w=w.replace(/\u0000/g,"").trim())&&"."!=w&&(r[v][y]=+w||0);break;case"@":r[v][y]=new Date(b.read_shift(-8,"f")-621356832e5);break;case"T":r[v][y]=new Date(864e5*(b.read_shift(4)-2440588)+b.read_shift(4));break;case"Y":r[v][y]=b.read_shift(4,"i")/1e4+b.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":r[v][y]=-b.read_shift(-8,"f");break;case"B":if(o&&8==f[y].len){r[v][y]=b.read_shift(8,"f");break}case"G":case"P":b.l+=f[y].len;break;case"0":if("_NullFlags"===f[y].name)break;default:throw new Error("DBF Unsupported data type "+f[y].type)}}else a.l+=h;if(2!=i&&a.l<a.length&&26!=a[a.l++])throw new Error("DBF EOF Marker missing "+(a.l-1)+" of "+a.length+" "+a[a.l-1].toString(16));return n&&n.sheetRows&&(r=r.slice(0,n.sheetRows)),n.DBF=f,r}(t,r),r);return a["!cols"]=r.DBF.map((function(e){return{wch:e.len,DBF:e}})),delete r.DBF,a}var r={B:8,C:250,L:1,D:8,"?":0,"":0};return{to_workbook:function(e,t){try{return Cy(n(e,t),t)}catch(YE){if(t&&t.WTF)throw YE}return{SheetNames:[],Sheets:{}}},to_sheet:n,from_sheet:function(e,n){var a=n||{};if(+a.codepage>=0&&ym(+a.codepage),"string"==a.type)throw new Error("Cannot write DBF to JS string");var i=hy(),s=TE(e,{header:1,raw:!0,cellDates:!0}),o=s[0],l=s.slice(1),c=e["!cols"]||[],u=0,h=0,d=0,f=1;for(u=0;u<o.length;++u)if(((c[u]||{}).DBF||{}).name)o[u]=c[u].DBF.name,++d;else if(null!=o[u]){if(++d,"number"===typeof o[u]&&(o[u]=o[u].toString(10)),"string"!==typeof o[u])throw new Error("DBF Invalid column name "+o[u]+" |"+typeof o[u]+"|");if(o.indexOf(o[u])!==u)for(h=0;h<1024;++h)if(-1==o.indexOf(o[u]+"_"+h)){o[u]+="_"+h;break}}var p=_y(e["!ref"]),m=[],g=[],v=[];for(u=0;u<=p.e.c-p.s.c;++u){var y="",b="",w=0,S=[];for(h=0;h<l.length;++h)null!=l[h][u]&&S.push(l[h][u]);if(0!=S.length&&null!=o[u]){for(h=0;h<S.length;++h){switch(typeof S[h]){case"number":b="B";break;case"string":default:b="C";break;case"boolean":b="L";break;case"object":b=S[h]instanceof Date?"D":"C"}w=Math.max(w,String(S[h]).length),y=y&&y!=b?"C":b}w>250&&(w=250),"C"==(b=((c[u]||{}).DBF||{}).type)&&c[u].DBF.len>w&&(w=c[u].DBF.len),"B"==y&&"N"==b&&(y="N",v[u]=c[u].DBF.dec,w=c[u].DBF.len),g[u]="C"==y||"N"==b?w:r[y]||0,f+=g[u],m[u]=y}else m[u]="?"}var T=i.next(32);for(T.write_shift(4,318902576),T.write_shift(4,l.length),T.write_shift(2,296+32*d),T.write_shift(2,f),u=0;u<4;++u)T.write_shift(4,0);for(T.write_shift(4,(+t[pm]||3)<<8),u=0,h=0;u<o.length;++u)if(null!=o[u]){var E=i.next(32),x=(o[u].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);E.write_shift(1,x,"sbcs"),E.write_shift(1,"?"==m[u]?"C":m[u],"sbcs"),E.write_shift(4,h),E.write_shift(1,g[u]||r[m[u]]||0),E.write_shift(1,v[u]||0),E.write_shift(1,2),E.write_shift(4,0),E.write_shift(1,0),E.write_shift(4,0),E.write_shift(4,0),h+=g[u]||r[m[u]]||0}var _=i.next(264);for(_.write_shift(4,13),u=0;u<65;++u)_.write_shift(4,0);for(u=0;u<l.length;++u){var A=i.next(f);for(A.write_shift(1,0),h=0;h<o.length;++h)if(null!=o[h])switch(m[h]){case"L":A.write_shift(1,null==l[u][h]?63:l[u][h]?84:70);break;case"B":A.write_shift(8,l[u][h]||0,"f");break;case"N":var k="0";for("number"==typeof l[u][h]&&(k=l[u][h].toFixed(v[h]||0)),d=0;d<g[h]-k.length;++d)A.write_shift(1,32);A.write_shift(1,k,"sbcs");break;case"D":l[u][h]?(A.write_shift(4,("0000"+l[u][h].getFullYear()).slice(-4),"sbcs"),A.write_shift(2,("00"+(l[u][h].getMonth()+1)).slice(-2),"sbcs"),A.write_shift(2,("00"+l[u][h].getDate()).slice(-2),"sbcs")):A.write_shift(8,"00000000","sbcs");break;case"C":var C=String(null!=l[u][h]?l[u][h]:"").slice(0,g[h]);for(A.write_shift(1,C,"sbcs"),d=0;d<g[h]-C.length;++d)A.write_shift(1,32)}}return i.next(1).write_shift(1,26),i.end()}}}(),iw=function(){var e={AA:"\xc0",BA:"\xc1",CA:"\xc2",DA:195,HA:"\xc4",JA:197,AE:"\xc8",BE:"\xc9",CE:"\xca",HE:"\xcb",AI:"\xcc",BI:"\xcd",CI:"\xce",HI:"\xcf",AO:"\xd2",BO:"\xd3",CO:"\xd4",DO:213,HO:"\xd6",AU:"\xd9",BU:"\xda",CU:"\xdb",HU:"\xdc",Aa:"\xe0",Ba:"\xe1",Ca:"\xe2",Da:227,Ha:"\xe4",Ja:229,Ae:"\xe8",Be:"\xe9",Ce:"\xea",He:"\xeb",Ai:"\xec",Bi:"\xed",Ci:"\xee",Hi:"\xef",Ao:"\xf2",Bo:"\xf3",Co:"\xf4",Do:245,Ho:"\xf6",Au:"\xf9",Bu:"\xfa",Cu:"\xfb",Hu:"\xfc",KC:"\xc7",Kc:"\xe7",q:"\xe6",z:"\u0153",a:"\xc6",j:"\u0152",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1bN("+Pg(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),n=function(t,n){var r=e[n];return"number"==typeof r?Em(r):r},r=function(e,t,n){var r=t.charCodeAt(0)-32<<4|n.charCodeAt(0)-48;return 59==r?e:Em(r)};function a(e,a){var i,s=e.split(/[\n\r]+/),o=-1,l=-1,c=0,u=0,h=[],d=[],f=null,p={},m=[],g=[],v=[],y=0;for(+a.codepage>=0&&ym(+a.codepage);c!==s.length;++c){y=0;var b,w=s[c].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,r).replace(t,n),S=w.replace(/;;/g,"\0").split(";").map((function(e){return e.replace(/\u0000/g,";")})),T=S[0];if(w.length>0)switch(T){case"ID":case"E":case"B":case"O":case"W":break;case"P":"P"==S[1].charAt(0)&&d.push(w.slice(3).replace(/;;/g,";"));break;case"C":var E=!1,x=!1,_=!1,A=!1,k=-1,C=-1;for(u=1;u<S.length;++u)switch(S[u].charAt(0)){case"A":case"G":break;case"X":l=parseInt(S[u].slice(1))-1,x=!0;break;case"Y":for(o=parseInt(S[u].slice(1))-1,x||(l=0),i=h.length;i<=o;++i)h[i]=[];break;case"K":'"'===(b=S[u].slice(1)).charAt(0)?b=b.slice(1,b.length-1):"TRUE"===b?b=!0:"FALSE"===b?b=!1:isNaN($g(b))?isNaN(ev(b).getDate())||(b=Yg(b)):(b=$g(b),null!==f&&Sg(f)&&(b=Wg(b))),"undefined"!==typeof Sm&&"string"==typeof b&&"string"!=(a||{}).type&&(a||{}).codepage&&(b=Sm.utils.decode(a.codepage,b)),E=!0;break;case"E":A=!0;var I=Jw(S[u].slice(1),{r:o,c:l});h[o][l]=[h[o][l],I];break;case"S":_=!0,h[o][l]=[h[o][l],"S5S"];break;case"R":k=parseInt(S[u].slice(1))-1;break;case"C":C=parseInt(S[u].slice(1))-1;break;default:if(a&&a.WTF)throw new Error("SYLK bad record "+w)}if(E&&(h[o][l]&&2==h[o][l].length?h[o][l][0]=b:h[o][l]=b,f=null),_){if(A)throw new Error("SYLK shared formula cannot have own formula");var N=k>-1&&h[k][C];if(!N||!N[1])throw new Error("SYLK shared formula cannot find base");h[o][l][1]=eS(N[1],{r:o-k,c:l-C})}break;case"F":var O=0;for(u=1;u<S.length;++u)switch(S[u].charAt(0)){case"X":l=parseInt(S[u].slice(1))-1,++O;break;case"Y":for(o=parseInt(S[u].slice(1))-1,i=h.length;i<=o;++i)h[i]=[];break;case"M":y=parseInt(S[u].slice(1))/20;break;case"F":case"G":case"S":case"D":case"N":break;case"P":f=d[parseInt(S[u].slice(1))];break;case"W":for(v=S[u].slice(1).split(" "),i=parseInt(v[0],10);i<=parseInt(v[1],10);++i)y=parseInt(v[2],10),g[i-1]=0===y?{hidden:!0}:{wch:y},Ew(g[i-1]);break;case"C":g[l=parseInt(S[u].slice(1))-1]||(g[l]={});break;case"R":m[o=parseInt(S[u].slice(1))-1]||(m[o]={}),y>0?(m[o].hpt=y,m[o].hpx=Aw(y)):0===y&&(m[o].hidden=!0);break;default:if(a&&a.WTF)throw new Error("SYLK bad record "+w)}O<1&&(f=null);break;default:if(a&&a.WTF)throw new Error("SYLK bad record "+w)}}return m.length>0&&(p["!rows"]=m),g.length>0&&(p["!cols"]=g),a&&a.sheetRows&&(h=h.slice(0,a.sheetRows)),[h,p]}function i(e,t){var n=function(e,t){switch(t.type){case"base64":return a(km(e),t);case"binary":return a(e,t);case"buffer":return a(Cm&&Buffer.isBuffer(e)?e.toString("binary"):jm(e),t);case"array":return a(Qg(e),t)}throw new Error("Unrecognized type "+t.type)}(e,t),r=n[0],i=n[1],s=Ny(r,t);return Pg(i).forEach((function(e){s[e]=i[e]})),s}function s(e,t,n,r){var a="C;Y"+(n+1)+";X"+(r+1)+";K";switch(e.t){case"n":a+=e.v||0,e.f&&!e.F&&(a+=";E"+Zw(e.f,{r:n,c:r}));break;case"b":a+=e.v?"TRUE":"FALSE";break;case"e":a+=e.w||e.v;break;case"d":a+='"'+(e.w||e.v)+'"';break;case"s":a+='"'+e.v.replace(/"/g,"").replace(/;/g,";;")+'"'}return a}return e["|"]=254,{to_workbook:function(e,t){return Cy(i(e,t),t)},to_sheet:i,from_sheet:function(e,t){var n,r,a=["ID;PWXL;N;E"],i=[],o=_y(e["!ref"]),l=Array.isArray(e),c="\r\n";a.push("P;PGeneral"),a.push("F;P0;DG0G8;M255"),e["!cols"]&&(r=a,e["!cols"].forEach((function(e,t){var n="F;W"+(t+1)+" "+(t+1)+" ";e.hidden?n+="0":("number"!=typeof e.width||e.wpx||(e.wpx=ww(e.width)),"number"!=typeof e.wpx||e.wch||(e.wch=Sw(e.wpx)),"number"==typeof e.wch&&(n+=Math.round(e.wch)))," "!=n.charAt(n.length-1)&&r.push(n)}))),e["!rows"]&&function(e,t){t.forEach((function(t,n){var r="F;";t.hidden?r+="M0;":t.hpt?r+="M"+20*t.hpt+";":t.hpx&&(r+="M"+20*_w(t.hpx)+";"),r.length>2&&e.push(r+"R"+(n+1))}))}(a,e["!rows"]),a.push("B;Y"+(o.e.r-o.s.r+1)+";X"+(o.e.c-o.s.c+1)+";D"+[o.s.c,o.s.r,o.e.c,o.e.r].join(" "));for(var u=o.s.r;u<=o.e.r;++u)for(var h=o.s.c;h<=o.e.c;++h){var d=Ty({r:u,c:h});(n=l?(e[u]||[])[h]:e[d])&&(null!=n.v||n.f&&!n.F)&&i.push(s(n,0,u,h))}return a.join(c)+c+i.join(c)+c+"E"+c}}}(),sw=function(){function e(e,t){for(var n=e.split("\n"),r=-1,a=-1,i=0,s=[];i!==n.length;++i)if("BOT"!==n[i].trim()){if(!(r<0)){for(var o=n[i].trim().split(","),l=o[0],c=o[1],u=n[++i]||"";1&(u.match(/["]/g)||[]).length&&i<n.length-1;)u+="\n"+n[++i];switch(u=u.trim(),+l){case-1:if("BOT"===u){s[++r]=[],a=0;continue}if("EOD"!==u)throw new Error("Unrecognized DIF special command "+u);break;case 0:"TRUE"===u?s[r][a]=!0:"FALSE"===u?s[r][a]=!1:isNaN($g(c))?isNaN(ev(c).getDate())?s[r][a]=c:s[r][a]=Yg(c):s[r][a]=$g(c),++a;break;case 1:(u=(u=u.slice(1,u.length-1)).replace(/""/g,'"'))&&u.match(/^=".*"$/)&&(u=u.slice(2,-1)),s[r][a++]=""!==u?u:null}if("EOD"===u)break}}else s[++r]=[],a=0;return t&&t.sheetRows&&(s=s.slice(0,t.sheetRows)),s}function t(t,n){return Ny(function(t,n){switch(n.type){case"base64":return e(km(t),n);case"binary":return e(t,n);case"buffer":return e(Cm&&Buffer.isBuffer(t)?t.toString("binary"):jm(t),n);case"array":return e(Qg(t),n)}throw new Error("Unrecognized type "+n.type)}(t,n),n)}var n=function(){var e=function(e,t,n,r,a){e.push(t),e.push(n+","+r),e.push('"'+a.replace(/"/g,'""')+'"')},t=function(e,t,n,r){e.push(t+","+n),e.push(1==t?'"'+r.replace(/"/g,'""')+'"':r)};return function(n){var r,a=[],i=_y(n["!ref"]),s=Array.isArray(n);e(a,"TABLE",0,1,"sheetjs"),e(a,"VECTORS",0,i.e.r-i.s.r+1,""),e(a,"TUPLES",0,i.e.c-i.s.c+1,""),e(a,"DATA",0,0,"");for(var o=i.s.r;o<=i.e.r;++o){t(a,-1,0,"BOT");for(var l=i.s.c;l<=i.e.c;++l){var c=Ty({r:o,c:l});if(r=s?(n[o]||[])[l]:n[c])switch(r.t){case"n":var u=r.w;u||null==r.v||(u=r.v),null==u?r.f&&!r.F?t(a,1,0,"="+r.f):t(a,1,0,""):t(a,0,u,"V");break;case"b":t(a,0,r.v?1:0,r.v?"TRUE":"FALSE");break;case"s":t(a,1,0,isNaN(r.v)?r.v:'="'+r.v+'"');break;case"d":r.w||(r.w=_g(r.z||Km[14],Vg(Yg(r.v)))),t(a,0,r.w,"V");break;default:t(a,1,0,"")}else t(a,1,0,"")}}t(a,-1,0,"EOD");return a.join("\r\n")}}();return{to_workbook:function(e,n){return Cy(t(e,n),n)},to_sheet:t,from_sheet:n}}(),ow=function(){function e(e){return e.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(e,t){return Ny(function(e,t){for(var n=e.split("\n"),r=-1,a=-1,i=0,s=[];i!==n.length;++i){var o=n[i].trim().split(":");if("cell"===o[0]){var l=Sy(o[1]);if(s.length<=l.r)for(r=s.length;r<=l.r;++r)s[r]||(s[r]=[]);switch(r=l.r,a=l.c,o[2]){case"t":s[r][a]=o[3].replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,"\n");break;case"v":s[r][a]=+o[3];break;case"vtf":var c=o[o.length-1];case"vtc":"nl"===o[3]?s[r][a]=!!+o[4]:s[r][a]=+o[4],"vtf"==o[2]&&(s[r][a]=[s[r][a],c])}}}return t&&t.sheetRows&&(s=s.slice(0,t.sheetRows)),s}(e,t),t)}var n=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join("\n"),r=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join("\n")+"\n",a=["# SocialCalc Spreadsheet Control Save","part:sheet"].join("\n"),i="--SocialCalcSpreadsheetControlSave--";function s(t){if(!t||!t["!ref"])return"";for(var n,r=[],a=[],i="",s=Ey(t["!ref"]),o=Array.isArray(t),l=s.s.r;l<=s.e.r;++l)for(var c=s.s.c;c<=s.e.c;++c)if(i=Ty({r:l,c:c}),(n=o?(t[l]||[])[c]:t[i])&&null!=n.v&&"z"!==n.t){switch(a=["cell",i,"t"],n.t){case"s":case"str":a.push(e(n.v));break;case"n":n.f?(a[2]="vtf",a[3]="n",a[4]=n.v,a[5]=e(n.f)):(a[2]="v",a[3]=n.v);break;case"b":a[2]="vt"+(n.f?"f":"c"),a[3]="nl",a[4]=n.v?"1":"0",a[5]=e(n.f||(n.v?"TRUE":"FALSE"));break;case"d":var u=Vg(Yg(n.v));a[2]="vtc",a[3]="nd",a[4]=""+u,a[5]=n.w||_g(n.z||Km[14],u);break;case"e":continue}r.push(a.join(":"))}return r.push("sheet:c:"+(s.e.c-s.s.c+1)+":r:"+(s.e.r-s.s.r+1)+":tvf:1"),r.push("valueformat:1:text-wiki"),r.join("\n")}return{to_workbook:function(e,n){return Cy(t(e,n),n)},to_sheet:t,from_sheet:function(e){return[n,r,a,r,s(e),i].join("\n")}}}(),lw=function(){function e(e,t,n,r,a){a.raw?t[n][r]=e:""===e||("TRUE"===e?t[n][r]=!0:"FALSE"===e?t[n][r]=!1:isNaN($g(e))?isNaN(ev(e).getDate())?t[n][r]=e:t[n][r]=Yg(e):t[n][r]=$g(e))}var t={44:",",9:"\t",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function r(e){for(var r={},a=!1,i=0,s=0;i<e.length;++i)34==(s=e.charCodeAt(i))?a=!a:!a&&s in t&&(r[s]=(r[s]||0)+1);for(i in s=[],r)Object.prototype.hasOwnProperty.call(r,i)&&s.push([r[i],i]);if(!s.length)for(i in r=n)Object.prototype.hasOwnProperty.call(r,i)&&s.push([r[i],i]);return s.sort((function(e,t){return e[0]-t[0]||n[e[1]]-n[t[1]]})),t[s.pop()[1]]||44}function a(e,t){var n=t||{},a="";null!=xm&&null==n.dense&&(n.dense=xm);var i=n.dense?[]:{},s={s:{c:0,r:0},e:{c:0,r:0}};"sep="==e.slice(0,4)?13==e.charCodeAt(5)&&10==e.charCodeAt(6)?(a=e.charAt(4),e=e.slice(7)):13==e.charCodeAt(5)||10==e.charCodeAt(5)?(a=e.charAt(4),e=e.slice(6)):a=r(e.slice(0,1024)):a=n&&n.FS?n.FS:r(e.slice(0,1024));var o=0,l=0,c=0,u=0,h=0,d=a.charCodeAt(0),f=!1,p=0,m=e.charCodeAt(0);e=e.replace(/\r\n/gm,"\n");var g=null!=n.dateNF?function(e){var t="number"==typeof e?Km[e]:e;return t=t.replace(Ig,"(\\d+)"),new RegExp("^"+t+"$")}(n.dateNF):null;function v(){var t=e.slice(u,h),r={};if('"'==t.charAt(0)&&'"'==t.charAt(t.length-1)&&(t=t.slice(1,-1).replace(/""/g,'"')),0===t.length)r.t="z";else if(n.raw)r.t="s",r.v=t;else if(0===t.trim().length)r.t="s",r.v=t;else if(61==t.charCodeAt(0))34==t.charCodeAt(1)&&34==t.charCodeAt(t.length-1)?(r.t="s",r.v=t.slice(2,-1).replace(/""/g,'"')):1!=t.length?(r.t="n",r.f=t.slice(1)):(r.t="s",r.v=t);else if("TRUE"==t)r.t="b",r.v=!0;else if("FALSE"==t)r.t="b",r.v=!1;else if(isNaN(c=$g(t)))if(!isNaN(ev(t).getDate())||g&&t.match(g)){r.z=n.dateNF||Km[14];var a=0;g&&t.match(g)&&(t=function(e,t,n){var r=-1,a=-1,i=-1,s=-1,o=-1,l=-1;(t.match(Ig)||[]).forEach((function(e,t){var c=parseInt(n[t+1],10);switch(e.toLowerCase().charAt(0)){case"y":r=c;break;case"d":i=c;break;case"h":s=c;break;case"s":l=c;break;case"m":s>=0?o=c:a=c}})),l>=0&&-1==o&&a>=0&&(o=a,a=-1);var c=(""+(r>=0?r:(new Date).getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);7==c.length&&(c="0"+c),8==c.length&&(c="20"+c);var u=("00"+(s>=0?s:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return-1==s&&-1==o&&-1==l?c:-1==r&&-1==a&&-1==i?u:c+"T"+u}(0,n.dateNF,t.match(g)||[]),a=1),n.cellDates?(r.t="d",r.v=Yg(t,a)):(r.t="n",r.v=Vg(Yg(t,a))),!1!==n.cellText&&(r.w=_g(r.z,r.v instanceof Date?Vg(r.v):r.v)),n.cellNF||delete r.z}else r.t="s",r.v=t;else r.t="n",!1!==n.cellText&&(r.w=t),r.v=c;if("z"==r.t||(n.dense?(i[o]||(i[o]=[]),i[o][l]=r):i[Ty({c:l,r:o})]=r),u=h+1,m=e.charCodeAt(u),s.e.c<l&&(s.e.c=l),s.e.r<o&&(s.e.r=o),p==d)++l;else if(l=0,++o,n.sheetRows&&n.sheetRows<=o)return!0}e:for(;h<e.length;++h)switch(p=e.charCodeAt(h)){case 34:34===m&&(f=!f);break;case d:case 10:case 13:if(!f&&v())break e}return h-u>0&&v(),i["!ref"]=xy(s),i}function i(t,n){return n&&n.PRN?n.FS||"sep="==t.slice(0,4)||t.indexOf("\t")>=0||t.indexOf(",")>=0||t.indexOf(";")>=0?a(t,n):Ny(function(t,n){var r=n||{},a=[];if(!t||0===t.length)return a;for(var i=t.split(/[\r\n]/),s=i.length-1;s>=0&&0===i[s].length;)--s;for(var o=10,l=0,c=0;c<=s;++c)-1==(l=i[c].indexOf(" "))?l=i[c].length:l++,o=Math.max(o,l);for(c=0;c<=s;++c){a[c]=[];var u=0;for(e(i[c].slice(0,o).trim(),a,c,u,r),u=1;u<=(i[c].length-o)/10+1;++u)e(i[c].slice(o+10*(u-1),o+10*u).trim(),a,c,u,r)}return r.sheetRows&&(a=a.slice(0,r.sheetRows)),a}(t,n),n):a(t,n)}function s(e,t){var n="",r="string"==t.type?[0,0,0,0]:fE(e,t);switch(t.type){case"base64":n=km(e);break;case"binary":case"string":n=e;break;case"buffer":n=65001==t.codepage?e.toString("utf8"):t.codepage&&"undefined"!==typeof Sm?Sm.utils.decode(t.codepage,e):Cm&&Buffer.isBuffer(e)?e.toString("binary"):jm(e);break;case"array":n=Qg(e);break;default:throw new Error("Unrecognized type "+t.type)}return 239==r[0]&&187==r[1]&&191==r[2]?n=vv(n.slice(3)):"string"!=t.type&&"buffer"!=t.type&&65001==t.codepage?n=vv(n):"binary"==t.type&&"undefined"!==typeof Sm&&t.codepage&&(n=Sm.utils.decode(t.codepage,Sm.utils.encode(28591,n))),"socialcalc:version:"==n.slice(0,19)?ow.to_sheet("string"==t.type?n:vv(n),t):i(n,t)}return{to_workbook:function(e,t){return Cy(s(e,t),t)},to_sheet:s,from_sheet:function(e){for(var t,n=[],r=_y(e["!ref"]),a=Array.isArray(e),i=r.s.r;i<=r.e.r;++i){for(var s=[],o=r.s.c;o<=r.e.c;++o){var l=Ty({r:i,c:o});if((t=a?(e[i]||[])[o]:e[l])&&null!=t.v){for(var c=(t.w||(ky(t),t.w)||"").slice(0,10);c.length<10;)c+=" ";s.push(c+(0===o?" ":""))}else s.push("          ")}n.push(s.join(""))}return n.join("\n")}}}();var cw=function(){function e(e,t,n){if(e){ly(e,e.l||0);for(var r=n.Enum||v;e.l<e.length;){var a=e.read_shift(2),i=r[a]||r[65535],s=e.read_shift(2),o=e.l+s,l=i.f&&i.f(e,s,n);if(e.l=o,t(l,i,a))return}}}function t(t,n){if(!t)return t;var r=n||{};null!=xm&&null==r.dense&&(r.dense=xm);var a=r.dense?[]:{},i="Sheet1",s="",o=0,l={},c=[],u=[],h={s:{r:0,c:0},e:{r:0,c:0}},d=r.sheetRows||0;if(0==t[2]&&(8==t[3]||9==t[3])&&t.length>=16&&5==t[14]&&108===t[15])throw new Error("Unsupported Works 3 for Mac file");if(2==t[2])r.Enum=v,e(t,(function(e,t,n){switch(n){case 0:r.vers=e,e>=4096&&(r.qpro=!0);break;case 6:h=e;break;case 204:e&&(s=e);break;case 222:s=e;break;case 15:case 51:r.qpro||(e[1].v=e[1].v.slice(1));case 13:case 14:case 16:14==n&&112==(112&e[2])&&(15&e[2])>1&&(15&e[2])<15&&(e[1].z=r.dateNF||Km[14],r.cellDates&&(e[1].t="d",e[1].v=Wg(e[1].v))),r.qpro&&e[3]>o&&(a["!ref"]=xy(h),l[i]=a,c.push(i),a=r.dense?[]:{},h={s:{r:0,c:0},e:{r:0,c:0}},o=e[3],i=s||"Sheet"+(o+1),s="");var u=r.dense?(a[e[0].r]||[])[e[0].c]:a[Ty(e[0])];if(u){u.t=e[1].t,u.v=e[1].v,null!=e[1].z&&(u.z=e[1].z),null!=e[1].f&&(u.f=e[1].f);break}r.dense?(a[e[0].r]||(a[e[0].r]=[]),a[e[0].r][e[0].c]=e[1]):a[Ty(e[0])]=e[1]}}),r);else{if(26!=t[2]&&14!=t[2])throw new Error("Unrecognized LOTUS BOF "+t[2]);r.Enum=y,14==t[2]&&(r.qpro=!0,t.l=0),e(t,(function(e,t,n){switch(n){case 204:i=e;break;case 22:e[1].v=e[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(e[3]>o&&(a["!ref"]=xy(h),l[i]=a,c.push(i),a=r.dense?[]:{},h={s:{r:0,c:0},e:{r:0,c:0}},o=e[3],i="Sheet"+(o+1)),d>0&&e[0].r>=d)break;r.dense?(a[e[0].r]||(a[e[0].r]=[]),a[e[0].r][e[0].c]=e[1]):a[Ty(e[0])]=e[1],h.e.c<e[0].c&&(h.e.c=e[0].c),h.e.r<e[0].r&&(h.e.r=e[0].r);break;case 27:e[14e3]&&(u[e[14e3][0]]=e[14e3][1]);break;case 1537:u[e[0]]=e[1],e[0]==o&&(i=e[1])}}),r)}if(a["!ref"]=xy(h),l[s||i]=a,c.push(s||i),!u.length)return{SheetNames:c,Sheets:l};for(var f={},p=[],m=0;m<u.length;++m)l[c[m]]?(p.push(u[m]||c[m]),f[u[m]]=l[u[m]]||l[c[m]]):(p.push(u[m]),f[u[m]]={"!ref":"A1"});return{SheetNames:p,Sheets:f}}function n(e,t,n){var r=[{c:0,r:0},{t:"n",v:0},0,0];return n.qpro&&20768!=n.vers?(r[0].c=e.read_shift(1),r[3]=e.read_shift(1),r[0].r=e.read_shift(2),e.l+=2):(r[2]=e.read_shift(1),r[0].c=e.read_shift(2),r[0].r=e.read_shift(2)),r}function r(e,t,r){var a=e.l+t,i=n(e,0,r);if(i[1].t="s",20768==r.vers){e.l++;var s=e.read_shift(1);return i[1].v=e.read_shift(s,"utf8"),i}return r.qpro&&e.l++,i[1].v=e.read_shift(a-e.l,"cstr"),i}function a(e,t,n){var r=uy(7+n.length);r.write_shift(1,255),r.write_shift(2,t),r.write_shift(2,e),r.write_shift(1,39);for(var a=0;a<r.length;++a){var i=n.charCodeAt(a);r.write_shift(1,i>=128?95:i)}return r.write_shift(1,0),r}function i(e,t,n){var r=uy(7);return r.write_shift(1,255),r.write_shift(2,t),r.write_shift(2,e),r.write_shift(2,n,"i"),r}function s(e,t,n){var r=uy(13);return r.write_shift(1,255),r.write_shift(2,t),r.write_shift(2,e),r.write_shift(8,n,"f"),r}function o(e,t,n){var r=32768&t;return t=(r?e:0)+((t&=-32769)>=8192?t-16384:t),(r?"":"$")+(n?wy(t):yy(t))}var l={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},c=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function u(e){var t=[{c:0,r:0},{t:"n",v:0},0];return t[0].r=e.read_shift(2),t[3]=e[e.l++],t[0].c=e[e.l++],t}function h(e,t,n,r){var a=uy(6+r.length);a.write_shift(2,e),a.write_shift(1,n),a.write_shift(1,t),a.write_shift(1,39);for(var i=0;i<r.length;++i){var s=r.charCodeAt(i);a.write_shift(1,s>=128?95:s)}return a.write_shift(1,0),a}function d(e,t){var n=u(e),r=e.read_shift(4),a=e.read_shift(4),i=e.read_shift(2);if(65535==i)return 0===r&&3221225472===a?(n[1].t="e",n[1].v=15):0===r&&3489660928===a?(n[1].t="e",n[1].v=42):n[1].v=0,n;var s=32768&i;return i=(32767&i)-16446,n[1].v=(1-2*s)*(a*Math.pow(2,i+32)+r*Math.pow(2,i)),n}function f(e,t,n,r){var a=uy(14);if(a.write_shift(2,e),a.write_shift(1,n),a.write_shift(1,t),0==r)return a.write_shift(4,0),a.write_shift(4,0),a.write_shift(2,65535),a;var i,s=0,o=0,l=0;return r<0&&(s=1,r=-r),o=0|Math.log2(r),0==(2147483648&(l=(r/=Math.pow(2,o-31))>>>0))&&(++o,l=(r/=2)>>>0),r-=l,l|=2147483648,l>>>=0,i=(r*=Math.pow(2,32))>>>0,a.write_shift(4,i),a.write_shift(4,l),o+=16383+(s?32768:0),a.write_shift(2,o),a}function p(e,t){var n=u(e),r=e.read_shift(8,"f");return n[1].v=r,n}function m(e,t){return 0==e[e.l+t-1]?e.read_shift(t,"cstr"):""}function g(e,t){var n=uy(5+e.length);n.write_shift(2,14e3),n.write_shift(2,t);for(var r=0;r<e.length;++r){var a=e.charCodeAt(r);n[n.l++]=a>127?95:a}return n[n.l++]=0,n}var v={0:{n:"BOF",f:Pb},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:function(e,t,n){var r={s:{c:0,r:0},e:{c:0,r:0}};return 8==t&&n.qpro?(r.s.c=e.read_shift(1),e.l++,r.s.r=e.read_shift(2),r.e.c=e.read_shift(1),e.l++,r.e.r=e.read_shift(2),r):(r.s.c=e.read_shift(2),r.s.r=e.read_shift(2),12==t&&n.qpro&&(e.l+=2),r.e.c=e.read_shift(2),r.e.r=e.read_shift(2),12==t&&n.qpro&&(e.l+=2),65535==r.s.c&&(r.s.c=r.e.c=r.s.r=r.e.r=0),r)}},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:function(e,t,r){var a=n(e,0,r);return a[1].v=e.read_shift(2,"i"),a}},14:{n:"NUMBER",f:function(e,t,r){var a=n(e,0,r);return a[1].v=e.read_shift(8,"f"),a}},15:{n:"LABEL",f:r},16:{n:"FORMULA",f:function(e,t,r){var a=e.l+t,i=n(e,0,r);if(i[1].v=e.read_shift(8,"f"),r.qpro)e.l=a;else{var s=e.read_shift(2);!function(e,t){ly(e,0);var n=[],r=0,a="",i="",s="",u="";for(;e.l<e.length;){var h=e[e.l++];switch(h){case 0:n.push(e.read_shift(8,"f"));break;case 1:i=o(t[0].c,e.read_shift(2),!0),a=o(t[0].r,e.read_shift(2),!1),n.push(i+a);break;case 2:var d=o(t[0].c,e.read_shift(2),!0),f=o(t[0].r,e.read_shift(2),!1);i=o(t[0].c,e.read_shift(2),!0),a=o(t[0].r,e.read_shift(2),!1),n.push(d+f+":"+i+a);break;case 3:if(e.l<e.length)return void console.error("WK1 premature formula end");break;case 4:n.push("("+n.pop()+")");break;case 5:n.push(e.read_shift(2));break;case 6:for(var p="";h=e[e.l++];)p+=String.fromCharCode(h);n.push('"'+p.replace(/"/g,'""')+'"');break;case 8:n.push("-"+n.pop());break;case 23:n.push("+"+n.pop());break;case 22:n.push("NOT("+n.pop()+")");break;case 20:case 21:u=n.pop(),s=n.pop(),n.push(["AND","OR"][h-20]+"("+s+","+u+")");break;default:if(h<32&&c[h])u=n.pop(),s=n.pop(),n.push(s+c[h]+u);else{if(!l[h])return h<=7?console.error("WK1 invalid opcode "+h.toString(16)):h<=24?console.error("WK1 unsupported op "+h.toString(16)):h<=30?console.error("WK1 invalid opcode "+h.toString(16)):h<=115?console.error("WK1 unsupported function opcode "+h.toString(16)):console.error("WK1 unrecognized opcode "+h.toString(16));if(69==(r=l[h][1])&&(r=e[e.l++]),r>n.length)return void console.error("WK1 bad formula parse 0x"+h.toString(16)+":|"+n.join("|")+"|");var m=n.slice(-r);n.length-=r,n.push(l[h][0]+"("+m.join(",")+")")}}}1==n.length?t[1].f=""+n[0]:console.error("WK1 bad formula parse |"+n.join("|")+"|")}(e.slice(e.l,e.l+s),i),e.l+=s}return i}},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:r},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:m},222:{n:"SHEETNAMELP",f:function(e,t){var n=e[e.l++];n>t-1&&(n=t-1);for(var r="";r.length<n;)r+=String.fromCharCode(e[e.l++]);return r}},65535:{n:""}},y={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:function(e,t){var n=u(e);return n[1].t="s",n[1].v=e.read_shift(t-4,"cstr"),n}},23:{n:"NUMBER17",f:d},24:{n:"NUMBER18",f:function(e,t){var n=u(e);n[1].v=e.read_shift(2);var r=n[1].v>>1;if(1&n[1].v)switch(7&r){case 0:r=5e3*(r>>3);break;case 1:r=500*(r>>3);break;case 2:r=(r>>3)/20;break;case 3:r=(r>>3)/200;break;case 4:r=(r>>3)/2e3;break;case 5:r=(r>>3)/2e4;break;case 6:r=(r>>3)/16;break;case 7:r=(r>>3)/64}return n[1].v=r,n}},25:{n:"FORMULA19",f:function(e,t){var n=d(e);return e.l+=t-14,n}},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:function(e,t){for(var n={},r=e.l+t;e.l<r;){var a=e.read_shift(2);if(14e3==a){for(n[a]=[0,""],n[a][0]=e.read_shift(2);e[e.l];)n[a][1]+=String.fromCharCode(e[e.l]),e.l++;e.l++}}return n}},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:function(e,t){var n=u(e),r=e.read_shift(4);return n[1].v=r>>6,n}},38:{n:"??"},39:{n:"NUMBER27",f:p},40:{n:"FORMULA28",f:function(e,t){var n=p(e);return e.l+=t-10,n}},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:m},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:function(e,t,n){if(n.qpro&&!(t<21)){var r=e.read_shift(1);return e.l+=17,e.l+=1,e.l+=2,[r,e.read_shift(t-21,"cstr")]}}},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:function(e,t){var n=t||{};if(+n.codepage>=0&&ym(+n.codepage),"string"==n.type)throw new Error("Cannot write WK1 to JS string");var r=hy(),o=_y(e["!ref"]),l=Array.isArray(e),c=[];_T(r,0,function(e){var t=uy(2);return t.write_shift(2,e),t}(1030)),_T(r,6,function(e){var t=uy(8);return t.write_shift(2,e.s.c),t.write_shift(2,e.s.r),t.write_shift(2,e.e.c),t.write_shift(2,e.e.r),t}(o));for(var u=Math.min(o.e.r,8191),h=o.s.r;h<=u;++h)for(var d=yy(h),f=o.s.c;f<=o.e.c;++f){h===o.s.r&&(c[f]=wy(f));var p=c[f]+d,m=l?(e[h]||[])[f]:e[p];if(m&&"z"!=m.t)if("n"==m.t)(0|m.v)==m.v&&m.v>=-32768&&m.v<=32767?_T(r,13,i(h,f,m.v)):_T(r,14,s(h,f,m.v));else _T(r,15,a(h,f,ky(m).slice(0,239)))}return _T(r,1),r.end()},book_to_wk3:function(e,t){var n=t||{};if(+n.codepage>=0&&ym(+n.codepage),"string"==n.type)throw new Error("Cannot write WK3 to JS string");var r=hy();_T(r,0,function(e){var t=uy(26);t.write_shift(2,4096),t.write_shift(2,4),t.write_shift(4,0);for(var n=0,r=0,a=0,i=0;i<e.SheetNames.length;++i){var s=e.SheetNames[i],o=e.Sheets[s];if(o&&o["!ref"]){++a;var l=Ey(o["!ref"]);n<l.e.r&&(n=l.e.r),r<l.e.c&&(r=l.e.c)}}n>8191&&(n=8191);return t.write_shift(2,n),t.write_shift(1,a),t.write_shift(1,r),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(1,1),t.write_shift(1,2),t.write_shift(4,0),t.write_shift(4,0),t}(e));for(var a=0,i=0;a<e.SheetNames.length;++a)(e.Sheets[e.SheetNames[a]]||{})["!ref"]&&_T(r,27,g(e.SheetNames[a],i++));var s=0;for(a=0;a<e.SheetNames.length;++a){var o=e.Sheets[e.SheetNames[a]];if(o&&o["!ref"]){for(var l=_y(o["!ref"]),c=Array.isArray(o),u=[],d=Math.min(l.e.r,8191),p=l.s.r;p<=d;++p)for(var m=yy(p),v=l.s.c;v<=l.e.c;++v){p===l.s.r&&(u[v]=wy(v));var y=u[v]+m,b=c?(o[p]||[])[v]:o[y];if(b&&"z"!=b.t)if("n"==b.t)_T(r,23,f(p,v,s,b.v));else _T(r,22,h(p,v,s,ky(b).slice(0,239)))}++s}}return _T(r,1),r.end()},to_workbook:function(e,n){switch(n.type){case"base64":return t(Rm(km(e)),n);case"binary":return t(Rm(e),n);case"buffer":case"array":return t(e,n)}throw"Unsupported type "+n.type}}}();var uw=/^\s|\s$|[\t\n\r]/;function hw(e,t){if(!t.bookSST)return"";var n=[rv];n[n.length]=Ev("sst",null,{xmlns:Av[0],count:e.Count,uniqueCount:e.Unique});for(var r=0;r!=e.length;++r)if(null!=e[r]){var a=e[r],i="<si>";a.r?i+=a.r:(i+="<t",a.t||(a.t=""),a.t.match(uw)&&(i+=' xml:space="preserve"'),i+=">"+lv(a.t)+"</t>"),i+="</si>",n[n.length]=i}return n.length>2&&(n[n.length]="</sst>",n[1]=n[1].replace("/>",">")),n.join("")}var dw=function(e,t){var n=!1;return null==t&&(n=!0,t=uy(15+4*e.t.length)),t.write_shift(1,0),Dy(e.t,t),n?t.slice(0,t.l):t};function fw(e){var t=hy();dy(t,159,function(e,t){return t||(t=uy(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}(e));for(var n=0;n<e.length;++n)dy(t,19,dw(e[n]));return dy(t,160),t.end()}function pw(e){if("undefined"!==typeof Sm)return Sm.utils.encode(pm,e);for(var t=[],n=e.split(""),r=0;r<n.length;++r)t[r]=n[r].charCodeAt(0);return t}function mw(e){var t,n,r=0,a=pw(e),i=a.length+1;for((t=Nm(i))[0]=a.length,n=1;n!=i;++n)t[n]=a[n-1];for(n=i-1;n>=0;--n)r=((0===(16384&r)?0:1)|r<<1&32767)^t[n];return 52811^r}var gw=function(){function e(e,n){switch(n.type){case"base64":return t(km(e),n);case"binary":return t(e,n);case"buffer":return t(Cm&&Buffer.isBuffer(e)?e.toString("binary"):jm(e),n);case"array":return t(Qg(e),n)}throw new Error("Unrecognized type "+n.type)}function t(e,t){var n=(t||{}).dense?[]:{},r=e.match(/\\trowd.*?\\row\b/g);if(!r.length)throw new Error("RTF missing table");var a={s:{c:0,r:0},e:{c:0,r:r.length-1}};return r.forEach((function(e,t){Array.isArray(n)&&(n[t]=[]);for(var r,i=/\\\w+\b/g,s=0,o=-1;r=i.exec(e);){if("\\cell"===r[0]){var l=e.slice(s,i.lastIndex-r[0].length);if(" "==l[0]&&(l=l.slice(1)),++o,l.length){var c={v:l,t:"s"};Array.isArray(n)?n[t][o]=c:n[Ty({r:t,c:o})]=c}}s=i.lastIndex}o>a.e.c&&(a.e.c=o)})),n["!ref"]=xy(a),n}return{to_workbook:function(t,n){return Cy(e(t,n),n)},to_sheet:e,from_sheet:function(e){for(var t,n=["{\\rtf1\\ansi"],r=_y(e["!ref"]),a=Array.isArray(e),i=r.s.r;i<=r.e.r;++i){n.push("\\trowd\\trautofit1");for(var s=r.s.c;s<=r.e.c;++s)n.push("\\cellx"+(s+1));for(n.push("\\pard\\intbl"),s=r.s.c;s<=r.e.c;++s){var o=Ty({r:i,c:s});(t=a?(e[i]||[])[s]:e[o])&&(null!=t.v||t.f&&!t.F)&&(n.push(" "+(t.w||(ky(t),t.w))),n.push("\\cell"))}n.push("\\pard\\intbl\\row")}return n.join("")+"}"}}}();function vw(e){for(var t=0,n=1;3!=t;++t)n=256*n+(e[t]>255?255:e[t]<0?0:e[t]);return n.toString(16).toUpperCase().slice(1)}var yw=6,bw=yw;function ww(e){return Math.floor((e+Math.round(128/bw)/256)*bw)}function Sw(e){return Math.floor((e-5)/bw*100+.5)/100}function Tw(e){return Math.round((e*bw+5)/bw*256)/256}function Ew(e){e.width?(e.wpx=ww(e.width),e.wch=Sw(e.wpx),e.MDW=bw):e.wpx?(e.wch=Sw(e.wpx),e.width=Tw(e.wch),e.MDW=bw):"number"==typeof e.wch&&(e.width=Tw(e.wch),e.wpx=ww(e.width),e.MDW=bw),e.customWidth&&delete e.customWidth}var xw=96;function _w(e){return 96*e/xw}function Aw(e){return e*xw/96}function kw(e,t){var n,r=[rv,Ev("styleSheet",null,{xmlns:Av[0],"xmlns:vt":_v.vt})];return e.SSF&&null!=(n=function(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach((function(n){for(var r=n[0];r<=n[1];++r)null!=e[r]&&(t[t.length]=Ev("numFmt",null,{numFmtId:r,formatCode:lv(e[r])}))})),1===t.length?"":(t[t.length]="</numFmts>",t[0]=Ev("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}(e.SSF))&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=function(e){var t=[];return t[t.length]=Ev("cellXfs",null),e.forEach((function(e){t[t.length]=Ev("xf",null,e)})),t[t.length]="</cellXfs>",2===t.length?"":(t[0]=Ev("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function Cw(e,t,n){n||(n=uy(6+4*t.length)),n.write_shift(2,e),Dy(t,n);var r=n.length>n.l?n.slice(0,n.l):n;return null==n.l&&(n.l=n.length),r}function Iw(e,t){t||(t=uy(153)),t.write_shift(2,20*e.sz),function(e,t){t||(t=uy(2));var n=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);t.write_shift(1,n),t.write_shift(1,0)}(e,t),t.write_shift(2,e.bold?700:400);var n=0;"superscript"==e.vertAlign?n=1:"subscript"==e.vertAlign&&(n=2),t.write_shift(2,n),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),nb(e.color,t);var r=0;return"major"==e.scheme&&(r=1),"minor"==e.scheme&&(r=2),t.write_shift(1,r),Dy(e.name,t),t.length>t.l?t.slice(0,t.l):t}var Nw,Ow=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Rw=cy;function Dw(e,t){t||(t=uy(84)),Nw||(Nw=Mg(Ow));var n=Nw[e.patternType];null==n&&(n=40),t.write_shift(4,n);var r=0;if(40!=n)for(nb({auto:1},t),nb({auto:1},t);r<12;++r)t.write_shift(4,0);else{for(;r<4;++r)t.write_shift(4,0);for(;r<12;++r)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function jw(e,t,n){n||(n=uy(16)),n.write_shift(2,t||0),n.write_shift(2,e.numFmtId||0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(1,0),n.write_shift(1,0);return n.write_shift(1,0),n.write_shift(1,0),n.write_shift(1,0),n.write_shift(1,0),n}function Pw(e,t){return t||(t=uy(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var Lw=cy;function Mw(e){var t;dy(e,613,Oy(1)),dy(e,46,(t||(t=uy(51)),t.write_shift(1,0),Pw(0,t),Pw(0,t),Pw(0,t),Pw(0,t),Pw(0,t),t.length>t.l?t.slice(0,t.l):t)),dy(e,614)}function Fw(e){var t,n;dy(e,619,Oy(1)),dy(e,48,(t={xfId:0,builtinId:0,name:"Normal"},n||(n=uy(52)),n.write_shift(4,t.xfId),n.write_shift(2,1),n.write_shift(1,+t.builtinId),n.write_shift(1,0),Gy(t.name||"",n),n.length>n.l?n.slice(0,n.l):n)),dy(e,620)}function Uw(e){dy(e,508,function(e,t,n){var r=uy(2052);return r.write_shift(4,e),Gy(t,r),Gy(n,r),r.length>r.l?r.slice(0,r.l):r}(0,"TableStyleMedium9","PivotStyleMedium4")),dy(e,509)}function Vw(e,t){var n=hy();return dy(n,278),function(e,t){if(t){var n=0;[[5,8],[23,26],[41,44],[50,392]].forEach((function(e){for(var r=e[0];r<=e[1];++r)null!=t[r]&&++n})),0!=n&&(dy(e,615,Oy(n)),[[5,8],[23,26],[41,44],[50,392]].forEach((function(n){for(var r=n[0];r<=n[1];++r)null!=t[r]&&dy(e,44,Cw(r,t[r]))})),dy(e,616))}}(n,e.SSF),function(e){dy(e,611,Oy(1)),dy(e,43,Iw({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),dy(e,612)}(n),function(e){dy(e,603,Oy(2)),dy(e,45,Dw({patternType:"none"})),dy(e,45,Dw({patternType:"gray125"})),dy(e,604)}(n),Mw(n),function(e){dy(e,626,Oy(1)),dy(e,47,jw({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),dy(e,627)}(n),function(e,t){dy(e,617,Oy(t.length)),t.forEach((function(t){dy(e,47,jw(t,0))})),dy(e,618)}(n,t.cellXfs),Fw(n),function(e){dy(e,505,Oy(0)),dy(e,506)}(n),Uw(n),dy(n,279),n.end()}function Bw(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&"string"==typeof e.raw)return e.raw;var n=[rv];return n[n.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',n[n.length]="<a:themeElements>",n[n.length]='<a:clrScheme name="Office">',n[n.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',n[n.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',n[n.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',n[n.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',n[n.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',n[n.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',n[n.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',n[n.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',n[n.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',n[n.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',n[n.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',n[n.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',n[n.length]="</a:clrScheme>",n[n.length]='<a:fontScheme name="Office">',n[n.length]="<a:majorFont>",n[n.length]='<a:latin typeface="Cambria"/>',n[n.length]='<a:ea typeface=""/>',n[n.length]='<a:cs typeface=""/>',n[n.length]='<a:font script="Jpan" typeface="\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"/>',n[n.length]='<a:font script="Hang" typeface="\ub9d1\uc740 \uace0\ub515"/>',n[n.length]='<a:font script="Hans" typeface="\u5b8b\u4f53"/>',n[n.length]='<a:font script="Hant" typeface="\u65b0\u7d30\u660e\u9ad4"/>',n[n.length]='<a:font script="Arab" typeface="Times New Roman"/>',n[n.length]='<a:font script="Hebr" typeface="Times New Roman"/>',n[n.length]='<a:font script="Thai" typeface="Tahoma"/>',n[n.length]='<a:font script="Ethi" typeface="Nyala"/>',n[n.length]='<a:font script="Beng" typeface="Vrinda"/>',n[n.length]='<a:font script="Gujr" typeface="Shruti"/>',n[n.length]='<a:font script="Khmr" typeface="MoolBoran"/>',n[n.length]='<a:font script="Knda" typeface="Tunga"/>',n[n.length]='<a:font script="Guru" typeface="Raavi"/>',n[n.length]='<a:font script="Cans" typeface="Euphemia"/>',n[n.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',n[n.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',n[n.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',n[n.length]='<a:font script="Thaa" typeface="MV Boli"/>',n[n.length]='<a:font script="Deva" typeface="Mangal"/>',n[n.length]='<a:font script="Telu" typeface="Gautami"/>',n[n.length]='<a:font script="Taml" typeface="Latha"/>',n[n.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',n[n.length]='<a:font script="Orya" typeface="Kalinga"/>',n[n.length]='<a:font script="Mlym" typeface="Kartika"/>',n[n.length]='<a:font script="Laoo" typeface="DokChampa"/>',n[n.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',n[n.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',n[n.length]='<a:font script="Viet" typeface="Times New Roman"/>',n[n.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',n[n.length]='<a:font script="Geor" typeface="Sylfaen"/>',n[n.length]="</a:majorFont>",n[n.length]="<a:minorFont>",n[n.length]='<a:latin typeface="Calibri"/>',n[n.length]='<a:ea typeface=""/>',n[n.length]='<a:cs typeface=""/>',n[n.length]='<a:font script="Jpan" typeface="\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"/>',n[n.length]='<a:font script="Hang" typeface="\ub9d1\uc740 \uace0\ub515"/>',n[n.length]='<a:font script="Hans" typeface="\u5b8b\u4f53"/>',n[n.length]='<a:font script="Hant" typeface="\u65b0\u7d30\u660e\u9ad4"/>',n[n.length]='<a:font script="Arab" typeface="Arial"/>',n[n.length]='<a:font script="Hebr" typeface="Arial"/>',n[n.length]='<a:font script="Thai" typeface="Tahoma"/>',n[n.length]='<a:font script="Ethi" typeface="Nyala"/>',n[n.length]='<a:font script="Beng" typeface="Vrinda"/>',n[n.length]='<a:font script="Gujr" typeface="Shruti"/>',n[n.length]='<a:font script="Khmr" typeface="DaunPenh"/>',n[n.length]='<a:font script="Knda" typeface="Tunga"/>',n[n.length]='<a:font script="Guru" typeface="Raavi"/>',n[n.length]='<a:font script="Cans" typeface="Euphemia"/>',n[n.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',n[n.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',n[n.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',n[n.length]='<a:font script="Thaa" typeface="MV Boli"/>',n[n.length]='<a:font script="Deva" typeface="Mangal"/>',n[n.length]='<a:font script="Telu" typeface="Gautami"/>',n[n.length]='<a:font script="Taml" typeface="Latha"/>',n[n.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',n[n.length]='<a:font script="Orya" typeface="Kalinga"/>',n[n.length]='<a:font script="Mlym" typeface="Kartika"/>',n[n.length]='<a:font script="Laoo" typeface="DokChampa"/>',n[n.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',n[n.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',n[n.length]='<a:font script="Viet" typeface="Arial"/>',n[n.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',n[n.length]='<a:font script="Geor" typeface="Sylfaen"/>',n[n.length]="</a:minorFont>",n[n.length]="</a:fontScheme>",n[n.length]='<a:fmtScheme name="Office">',n[n.length]="<a:fillStyleLst>",n[n.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:lin ang="16200000" scaled="1"/>',n[n.length]="</a:gradFill>",n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:lin ang="16200000" scaled="0"/>',n[n.length]="</a:gradFill>",n[n.length]="</a:fillStyleLst>",n[n.length]="<a:lnStyleLst>",n[n.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]="</a:lnStyleLst>",n[n.length]="<a:effectStyleLst>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]="</a:effectStyle>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]="</a:effectStyle>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',n[n.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',n[n.length]="</a:effectStyle>",n[n.length]="</a:effectStyleLst>",n[n.length]="<a:bgFillStyleLst>",n[n.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',n[n.length]="</a:gradFill>",n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',n[n.length]="</a:gradFill>",n[n.length]="</a:bgFillStyleLst>",n[n.length]="</a:fmtScheme>",n[n.length]="</a:themeElements>",n[n.length]="<a:objectDefaults>",n[n.length]="<a:spDef>",n[n.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',n[n.length]="</a:spDef>",n[n.length]="<a:lnDef>",n[n.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',n[n.length]="</a:lnDef>",n[n.length]="</a:objectDefaults>",n[n.length]="<a:extraClrSchemeLst/>",n[n.length]="</a:theme>",n.join("")}function zw(){var e=hy();return dy(e,332),dy(e,334,Oy(1)),dy(e,335,function(e){var t=uy(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),Dy(e.name,t),t.slice(0,t.l)}({name:"XLDAPR",version:12e4,flags:3496657072})),dy(e,336),dy(e,339,function(e,t){var n=uy(8+2*t.length);return n.write_shift(4,e),Dy(t,n),n.slice(0,n.l)}(1,"XLDAPR")),dy(e,52),dy(e,35,Oy(514)),dy(e,4096,Oy(0)),dy(e,4097,Lb(1)),dy(e,36),dy(e,53),dy(e,340),dy(e,337,function(e,t){var n=uy(8);return n.write_shift(4,e),n.write_shift(4,t?1:0),n}(1,!0)),dy(e,51,function(e){var t=uy(4+8*e.length);t.write_shift(4,e.length);for(var n=0;n<e.length;++n)t.write_shift(4,e[n][0]),t.write_shift(4,e[n][1]);return t}([[1,0]])),dy(e,338),dy(e,333),e.end()}function Hw(){var e=[rv];return e.push('<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">\n  <metadataTypes count="1">\n    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>\n  </metadataTypes>\n  <futureMetadata name="XLDAPR" count="1">\n    <bk>\n      <extLst>\n        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">\n          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>\n        </ext>\n      </extLst>\n    </bk>\n  </futureMetadata>\n  <cellMetadata count="1">\n    <bk>\n      <rc t="1" v="0"/>\n    </bk>\n  </cellMetadata>\n</metadata>'),e.join("")}var Ww=1024;function Gw(e,t){for(var n=[21600,21600],r=["m0,0l0",n[1],n[0],n[1],n[0],"0xe"].join(","),a=[Ev("xml",null,{"xmlns:v":kv.v,"xmlns:o":kv.o,"xmlns:x":kv.x,"xmlns:mv":kv.mv}).replace(/\/>/,">"),Ev("o:shapelayout",Ev("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Ev("v:shapetype",[Ev("v:stroke",null,{joinstyle:"miter"}),Ev("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:n.join(","),path:r})];Ww<1e3*e;)Ww+=1e3;return t.forEach((function(e){var t=Sy(e[0]),n={color2:"#BEFF82",type:"gradient"};"gradient"==n.type&&(n.angle="-180");var r="gradient"==n.type?Ev("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,i=Ev("v:fill",r,n);++Ww,a=a.concat(["<v:shape"+Tv({id:"_x0000_s"+Ww,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(e[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",i,Ev("v:shadow",null,{on:"t",obscured:"t"}),Ev("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Sv("x:Anchor",[t.c+1,0,t.r+1,0,t.c+3,20,t.r+5,20].join(",")),Sv("x:AutoFill","False"),Sv("x:Row",String(t.r)),Sv("x:Column",String(t.c)),e[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])})),a.push("</xml>"),a.join("")}function qw(e){var t=[rv,Ev("comments",null,{xmlns:Av[0]})],n=[];return t.push("<authors>"),e.forEach((function(e){e[1].forEach((function(e){var r=lv(e.a);-1==n.indexOf(r)&&(n.push(r),t.push("<author>"+r+"</author>")),e.T&&e.ID&&-1==n.indexOf("tc="+e.ID)&&(n.push("tc="+e.ID),t.push("<author>tc="+e.ID+"</author>"))}))})),0==n.length&&(n.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach((function(e){var r=0,a=[];if(e[1][0]&&e[1][0].T&&e[1][0].ID?r=n.indexOf("tc="+e[1][0].ID):e[1].forEach((function(e){e.a&&(r=n.indexOf(lv(e.a))),a.push(e.t||"")})),t.push('<comment ref="'+e[0]+'" authorId="'+r+'"><text>'),a.length<=1)t.push(Sv("t",lv(a[0]||"")));else{for(var i="Comment:\n    "+a[0]+"\n",s=1;s<a.length;++s)i+="Reply:\n    "+a[s]+"\n";t.push(Sv("t",lv(i)))}t.push("</text></comment>")})),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function Kw(e,t,n){var r=[rv,Ev("ThreadedComments",null,{xmlns:_v.TCMNT}).replace(/[\/]>/,">")];return e.forEach((function(e){var a="";(e[1]||[]).forEach((function(i,s){if(i.T){i.a&&-1==t.indexOf(i.a)&&t.push(i.a);var o={ref:e[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+n.tcid++).slice(-12)+"}"};0==s?a=o.id:o.parentId=a,i.ID=o.id,i.a&&(o.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(i.a)).slice(-12)+"}"),r.push(Ev("threadedComment",Sv("text",i.t||""),o))}else delete i.ID}))})),r.push("</ThreadedComments>"),r.join("")}var Yw=Ry;function Qw(e){var t=hy(),n=[];return dy(t,628),dy(t,630),e.forEach((function(e){e[1].forEach((function(e){n.indexOf(e.a)>-1||(n.push(e.a.slice(0,54)),dy(t,632,function(e){return Dy(e.slice(0,54))}(e.a)))}))})),dy(t,631),dy(t,633),e.forEach((function(e){e[1].forEach((function(r){r.iauthor=n.indexOf(r.a);var a={s:Sy(e[0]),e:Sy(e[0])};dy(t,635,function(e,t){return null==t&&(t=uy(36)),t.write_shift(4,e[1].iauthor),Zy(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}([a,r])),r.t&&r.t.length>0&&dy(t,637,My(r)),dy(t,636),delete r.iauthor}))})),dy(t,634),dy(t,629),t.end()}var Xw=["xlsb","xlsm","xlam","biff8","xla"];var Jw=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function n(e,n,r,a){var i=!1,s=!1;0==r.length?s=!0:"["==r.charAt(0)&&(s=!0,r=r.slice(1,-1)),0==a.length?i=!0:"["==a.charAt(0)&&(i=!0,a=a.slice(1,-1));var o=r.length>0?0|parseInt(r,10):0,l=a.length>0?0|parseInt(a,10):0;return i?l+=t.c:--l,s?o+=t.r:--o,n+(i?"":"$")+wy(l)+(s?"":"$")+yy(o)}return function(r,a){return t=a,r.replace(e,n)}}(),$w=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Zw=function(){return function(e,t){return e.replace($w,(function(e,n,r,a,i,s){var o=by(a)-(r?0:t.c),l=vy(s)-(i?0:t.r);return n+"R"+(0==l?"":i?l+1:"["+l+"]")+"C"+(0==o?"":r?o+1:"["+o+"]")}))}}();function eS(e,t){return e.replace($w,(function(e,n,r,a,i,s){return n+("$"==r?r+a:wy(by(a)+t.c))+("$"==i?i+s:yy(vy(s)+t.r))}))}function tS(e){e.l+=1}function nS(e,t){var n=e.read_shift(1==t?1:2);return[16383&n,n>>14&1,n>>15&1]}function rS(e,t,n){var r=2;if(n){if(n.biff>=2&&n.biff<=5)return aS(e);12==n.biff&&(r=4)}var a=e.read_shift(r),i=e.read_shift(r),s=nS(e,2),o=nS(e,2);return{s:{r:a,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function aS(e){var t=nS(e,2),n=nS(e,2),r=e.read_shift(1),a=e.read_shift(1);return{s:{r:t[0],c:r,cRel:t[1],rRel:t[2]},e:{r:n[0],c:a,cRel:n[1],rRel:n[2]}}}function iS(e,t,n){if(n&&n.biff>=2&&n.biff<=5)return function(e){var t=nS(e,2),n=e.read_shift(1);return{r:t[0],c:n,cRel:t[1],rRel:t[2]}}(e);var r=e.read_shift(n&&12==n.biff?4:2),a=nS(e,2);return{r:r,c:a[0],cRel:a[1],rRel:a[2]}}function sS(e){var t=e.read_shift(2),n=e.read_shift(2);return{r:t,c:255&n,fQuoted:!!(16384&n),cRel:n>>15,rRel:n>>15}}function oS(e){var t=1&e[e.l+1];return e.l+=4,[t,1]}function lS(e){return[e.read_shift(1),e.read_shift(1)]}function cS(e,t){var n=[e.read_shift(1)];if(12==t)switch(n[0]){case 2:n[0]=4;break;case 4:n[0]=16;break;case 0:n[0]=1;break;case 1:n[0]=2}switch(n[0]){case 4:n[1]=Db(e,1)?"TRUE":"FALSE",12!=t&&(e.l+=7);break;case 37:case 16:n[1]=ub[e[e.l]],e.l+=12==t?4:8;break;case 0:e.l+=8;break;case 1:n[1]=eb(e);break;case 2:n[1]=zb(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+n[0])}return n}function uS(e,t,n){for(var r=e.read_shift(12==n.biff?4:2),a=[],i=0;i!=r;++i)a.push((12==n.biff?$y:Yb)(e,8));return a}function hS(e,t,n){var r=0,a=0;12==n.biff?(r=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),r=1+e.read_shift(2)),n.biff>=2&&n.biff<8&&(--r,0==--a&&(a=256));for(var i=0,s=[];i!=r&&(s[i]=[]);++i)for(var o=0;o!=a;++o)s[i][o]=cS(e,n.biff);return s}function dS(e,t,n){return e.l+=2,[sS(e)]}function fS(e){return e.l+=6,[]}function pS(e){return e.l+=2,[Pb(e),1&e.read_shift(2)]}var mS=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];var gS={1:{n:"PtgExp",f:function(e,t,n){return e.l++,n&&12==n.biff?[e.read_shift(4,"i"),0]:[e.read_shift(2),e.read_shift(n&&2==n.biff?1:2)]}},2:{n:"PtgTbl",f:cy},3:{n:"PtgAdd",f:tS},4:{n:"PtgSub",f:tS},5:{n:"PtgMul",f:tS},6:{n:"PtgDiv",f:tS},7:{n:"PtgPower",f:tS},8:{n:"PtgConcat",f:tS},9:{n:"PtgLt",f:tS},10:{n:"PtgLe",f:tS},11:{n:"PtgEq",f:tS},12:{n:"PtgGe",f:tS},13:{n:"PtgGt",f:tS},14:{n:"PtgNe",f:tS},15:{n:"PtgIsect",f:tS},16:{n:"PtgUnion",f:tS},17:{n:"PtgRange",f:tS},18:{n:"PtgUplus",f:tS},19:{n:"PtgUminus",f:tS},20:{n:"PtgPercent",f:tS},21:{n:"PtgParen",f:tS},22:{n:"PtgMissArg",f:tS},23:{n:"PtgStr",f:function(e,t,n){return e.l++,Fb(e,0,n)}},26:{n:"PtgSheet",f:function(e,t,n){return e.l+=5,e.l+=2,e.l+=2==n.biff?1:4,["PTGSHEET"]}},27:{n:"PtgEndSheet",f:function(e,t,n){return e.l+=2==n.biff?4:5,["PTGENDSHEET"]}},28:{n:"PtgErr",f:function(e){return e.l++,ub[e.read_shift(1)]}},29:{n:"PtgBool",f:function(e){return e.l++,0!==e.read_shift(1)}},30:{n:"PtgInt",f:function(e){return e.l++,e.read_shift(2)}},31:{n:"PtgNum",f:function(e){return e.l++,eb(e)}},32:{n:"PtgArray",f:function(e,t,n){var r=(96&e[e.l++])>>5;return e.l+=2==n.biff?6:12==n.biff?14:7,[r]}},33:{n:"PtgFunc",f:function(e,t,n){var r=(96&e[e.l])>>5;e.l+=1;var a=e.read_shift(n&&n.biff<=3?1:2);return[PS[a],jS[a],r]}},34:{n:"PtgFuncVar",f:function(e,t,n){var r=e[e.l++],a=e.read_shift(1),i=n&&n.biff<=3?[88==r?-1:0,e.read_shift(1)]:function(e){return[e[e.l+1]>>7,32767&e.read_shift(2)]}(e);return[a,(0===i[0]?jS:DS)[i[1]]]}},35:{n:"PtgName",f:function(e,t,n){var r=e.read_shift(1)>>>5&3,a=!n||n.biff>=8?4:2,i=e.read_shift(a);switch(n.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12}return[r,0,i]}},36:{n:"PtgRef",f:function(e,t,n){var r=(96&e[e.l])>>5;return e.l+=1,[r,iS(e,0,n)]}},37:{n:"PtgArea",f:function(e,t,n){return[(96&e[e.l++])>>5,rS(e,n.biff>=2&&n.biff,n)]}},38:{n:"PtgMemArea",f:function(e,t,n){var r=e.read_shift(1)>>>5&3;return e.l+=n&&2==n.biff?3:4,[r,e.read_shift(n&&2==n.biff?1:2)]}},39:{n:"PtgMemErr",f:cy},40:{n:"PtgMemNoMem",f:cy},41:{n:"PtgMemFunc",f:function(e,t,n){return[e.read_shift(1)>>>5&3,e.read_shift(n&&2==n.biff?1:2)]}},42:{n:"PtgRefErr",f:function(e,t,n){var r=e.read_shift(1)>>>5&3;return e.l+=4,n.biff<8&&e.l--,12==n.biff&&(e.l+=2),[r]}},43:{n:"PtgAreaErr",f:function(e,t,n){var r=(96&e[e.l++])>>5;return e.l+=n&&n.biff>8?12:n.biff<8?6:8,[r]}},44:{n:"PtgRefN",f:function(e,t,n){var r=(96&e[e.l])>>5;e.l+=1;var a=function(e,t,n){var r=n&&n.biff?n.biff:8;if(r>=2&&r<=5)return function(e){var t=e.read_shift(2),n=e.read_shift(1),r=(32768&t)>>15,a=(16384&t)>>14;return t&=16383,1==r&&t>=8192&&(t-=16384),1==a&&n>=128&&(n-=256),{r:t,c:n,cRel:a,rRel:r}}(e);var a=e.read_shift(r>=12?4:2),i=e.read_shift(2),s=(16384&i)>>14,o=(32768&i)>>15;if(i&=16383,1==o)for(;a>524287;)a-=1048576;if(1==s)for(;i>8191;)i-=16384;return{r:a,c:i,cRel:s,rRel:o}}(e,0,n);return[r,a]}},45:{n:"PtgAreaN",f:function(e,t,n){var r=(96&e[e.l++])>>5,a=function(e,t,n){if(n.biff<8)return aS(e);var r=e.read_shift(12==n.biff?4:2),a=e.read_shift(12==n.biff?4:2),i=nS(e,2),s=nS(e,2);return{s:{r:r,c:i[0],cRel:i[1],rRel:i[2]},e:{r:a,c:s[0],cRel:s[1],rRel:s[2]}}}(e,0,n);return[r,a]}},46:{n:"PtgMemAreaN",f:function(e){return[e.read_shift(1)>>>5&3,e.read_shift(2)]}},47:{n:"PtgMemNoMemN",f:function(e){return[e.read_shift(1)>>>5&3,e.read_shift(2)]}},57:{n:"PtgNameX",f:function(e,t,n){return 5==n.biff?function(e){var t=e.read_shift(1)>>>5&3,n=e.read_shift(2,"i");e.l+=8;var r=e.read_shift(2);return e.l+=12,[t,n,r]}(e):[e.read_shift(1)>>>5&3,e.read_shift(2),e.read_shift(4)]}},58:{n:"PtgRef3d",f:function(e,t,n){var r=(96&e[e.l])>>5;e.l+=1;var a=e.read_shift(2);return n&&5==n.biff&&(e.l+=12),[r,a,iS(e,0,n)]}},59:{n:"PtgArea3d",f:function(e,t,n){var r=(96&e[e.l++])>>5,a=e.read_shift(2,"i");if(n)switch(n.biff){case 5:e.l+=12,6;break;case 12:12}return[r,a,rS(e,0,n)]}},60:{n:"PtgRefErr3d",f:function(e,t,n){var r=(96&e[e.l++])>>5,a=e.read_shift(2),i=4;if(n)switch(n.biff){case 5:i=15;break;case 12:i=6}return e.l+=i,[r,a]}},61:{n:"PtgAreaErr3d",f:function(e,t,n){var r=(96&e[e.l++])>>5,a=e.read_shift(2),i=8;if(n)switch(n.biff){case 5:e.l+=12,i=6;break;case 12:i=12}return e.l+=i,[r,a]}},255:{}},vS={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},yS={1:{n:"PtgElfLel",f:pS},2:{n:"PtgElfRw",f:dS},3:{n:"PtgElfCol",f:dS},6:{n:"PtgElfRwV",f:dS},7:{n:"PtgElfColV",f:dS},10:{n:"PtgElfRadical",f:dS},11:{n:"PtgElfRadicalS",f:fS},13:{n:"PtgElfColS",f:fS},15:{n:"PtgElfColSV",f:fS},16:{n:"PtgElfRadicalLel",f:pS},25:{n:"PtgList",f:function(e){e.l+=2;var t=e.read_shift(2),n=e.read_shift(2),r=e.read_shift(4),a=e.read_shift(2),i=e.read_shift(2);return{ixti:t,coltype:3&n,rt:mS[n>>2&31],idx:r,c:a,C:i}}},29:{n:"PtgSxName",f:function(e){return e.l+=2,[e.read_shift(4)]}},255:{}},bS={0:{n:"PtgAttrNoop",f:function(e){return e.l+=4,[0,0]}},1:{n:"PtgAttrSemi",f:function(e,t,n){var r=255&e[e.l+1]?1:0;return e.l+=n&&2==n.biff?3:4,[r]}},2:{n:"PtgAttrIf",f:function(e,t,n){var r=255&e[e.l+1]?1:0;return e.l+=2,[r,e.read_shift(n&&2==n.biff?1:2)]}},4:{n:"PtgAttrChoose",f:function(e,t,n){e.l+=2;for(var r=e.read_shift(n&&2==n.biff?1:2),a=[],i=0;i<=r;++i)a.push(e.read_shift(n&&2==n.biff?1:2));return a}},8:{n:"PtgAttrGoto",f:function(e,t,n){var r=255&e[e.l+1]?1:0;return e.l+=2,[r,e.read_shift(n&&2==n.biff?1:2)]}},16:{n:"PtgAttrSum",f:function(e,t,n){e.l+=n&&2==n.biff?3:4}},32:{n:"PtgAttrBaxcel",f:oS},33:{n:"PtgAttrBaxcel",f:oS},64:{n:"PtgAttrSpace",f:function(e){return e.read_shift(2),lS(e)}},65:{n:"PtgAttrSpaceSemi",f:function(e){return e.read_shift(2),lS(e)}},128:{n:"PtgAttrIfError",f:function(e){var t=255&e[e.l+1]?1:0;return e.l+=2,[t,e.read_shift(2)]}},255:{}};function wS(e,t,n,r){if(r.biff<8)return cy(e,t);for(var a=e.l+t,i=[],s=0;s!==n.length;++s)switch(n[s][0]){case"PtgArray":n[s][1]=hS(e,0,r),i.push(n[s][1]);break;case"PtgMemArea":n[s][2]=uS(e,n[s][1],r),i.push(n[s][2]);break;case"PtgExp":r&&12==r.biff&&(n[s][1][1]=e.read_shift(4),i.push(n[s][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+n[s][0]}return 0!==(t=a-e.l)&&i.push(cy(e,t)),i}function SS(e,t,n){for(var r,a,i=e.l+t,s=[];i!=e.l;)t=i-e.l,a=e[e.l],r=gS[a]||gS[vS[a]],24!==a&&25!==a||(r=(24===a?yS:bS)[e[e.l+1]]),r&&r.f?s.push([r.n,r.f(e,t,n)]):cy(e,t);return s}function TS(e){for(var t=[],n=0;n<e.length;++n){for(var r=e[n],a=[],i=0;i<r.length;++i){var s=r[i];if(s)if(2===s[0])a.push('"'+s[1].replace(/"/g,'""')+'"');else a.push(s[1]);else a.push("")}t.push(a.join(","))}return t.join(";")}var ES={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function xS(e,t,n){if(!e)return"SH33TJSERR0";if(n.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var r=e.XTI[t];if(n.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),0==t?"":e.XTI[t-1];if(!r)return"SH33TJSERR1";var a="";if(n.biff>8)switch(e[r[0]][0]){case 357:return a=-1==r[1]?"#REF":e.SheetNames[r[1]],r[1]==r[2]?a:a+":"+e.SheetNames[r[2]];case 358:return null!=n.SID?e.SheetNames[n.SID]:"SH33TJSSAME"+e[r[0]][0];default:return"SH33TJSSRC"+e[r[0]][0]}switch(e[r[0]][0][0]){case 1025:return a=-1==r[1]?"#REF":e.SheetNames[r[1]]||"SH33TJSERR3",r[1]==r[2]?a:a+":"+e.SheetNames[r[2]];case 14849:return e[r[0]].slice(1).map((function(e){return e.Name})).join(";;");default:return e[r[0]][0][3]?(a=-1==r[1]?"#REF":e[r[0]][0][3][r[1]]||"SH33TJSERR4",r[1]==r[2]?a:a+":"+e[r[0]][0][3][r[2]]):"SH33TJSERR2"}}function _S(e,t,n){var r=xS(e,t,n);return"#REF"==r?r:function(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}(r,n)}function AS(e,t,n,r,a){var i,s,o,l,c=a&&a.biff||8,u={s:{c:0,r:0},e:{c:0,r:0}},h=[],d=0,f=0,p="";if(!e[0]||!e[0][0])return"";for(var m=-1,g="",v=0,y=e[0].length;v<y;++v){var b=e[0][v];switch(b[0]){case"PtgUminus":h.push("-"+h.pop());break;case"PtgUplus":h.push("+"+h.pop());break;case"PtgPercent":h.push(h.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(i=h.pop(),s=h.pop(),m>=0){switch(e[0][m][1][0]){case 0:g=Jg(" ",e[0][m][1][1]);break;case 1:g=Jg("\r",e[0][m][1][1]);break;default:if(g="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][m][1][0])}s+=g,m=-1}h.push(s+ES[b[0]]+i);break;case"PtgIsect":i=h.pop(),s=h.pop(),h.push(s+" "+i);break;case"PtgUnion":i=h.pop(),s=h.pop(),h.push(s+","+i);break;case"PtgRange":i=h.pop(),s=h.pop(),h.push(s+":"+i);break;case"PtgAttrChoose":case"PtgAttrGoto":case"PtgAttrIf":case"PtgAttrIfError":case"PtgAttrBaxcel":case"PtgAttrSemi":case"PtgMemArea":case"PtgTbl":case"PtgMemErr":case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":case"PtgMemFunc":case"PtgMemNoMem":break;case"PtgRef":o=fy(b[1][1],u,a),h.push(my(o,c));break;case"PtgRefN":o=n?fy(b[1][1],n,a):b[1][1],h.push(my(o,c));break;case"PtgRef3d":d=b[1][1],o=fy(b[1][2],u,a);p=_S(r,d,a);h.push(p+"!"+my(o,c));break;case"PtgFunc":case"PtgFuncVar":var w=b[1][0],S=b[1][1];w||(w=0);var T=0==(w&=127)?[]:h.slice(-w);h.length-=w,"User"===S&&(S=T.shift()),h.push(S+"("+T.join(",")+")");break;case"PtgBool":h.push(b[1]?"TRUE":"FALSE");break;case"PtgInt":case"PtgErr":h.push(b[1]);break;case"PtgNum":h.push(String(b[1]));break;case"PtgStr":h.push('"'+b[1].replace(/"/g,'""')+'"');break;case"PtgAreaN":l=py(b[1][1],n?{s:n}:u,a),h.push(gy(l,a));break;case"PtgArea":l=py(b[1][1],u,a),h.push(gy(l,a));break;case"PtgArea3d":d=b[1][1],l=b[1][2],p=_S(r,d,a),h.push(p+"!"+gy(l,a));break;case"PtgAttrSum":h.push("SUM("+h.pop()+")");break;case"PtgName":f=b[1][2];var E=(r.names||[])[f-1]||(r[0]||[])[f],x=E?E.Name:"SH33TJSNAME"+String(f);x&&"_xlfn."==x.slice(0,6)&&!a.xlfn&&(x=x.slice(6)),h.push(x);break;case"PtgNameX":var _,A=b[1][1];if(f=b[1][2],!(a.biff<=5)){var k="";if(14849==((r[A]||[])[0]||[])[0]||(1025==((r[A]||[])[0]||[])[0]?r[A][f]&&r[A][f].itab>0&&(k=r.SheetNames[r[A][f].itab-1]+"!"):k=r.SheetNames[f-1]+"!"),r[A]&&r[A][f])k+=r[A][f].Name;else if(r[0]&&r[0][f])k+=r[0][f].Name;else{var C=(xS(r,A,a)||"").split(";;");C[f-1]?k=C[f-1]:k+="SH33TJSERRX"}h.push(k);break}A<0&&(A=-A),r[A]&&(_=r[A][f]),_||(_={Name:"SH33TJSERRY"}),h.push(_.Name);break;case"PtgParen":var I="(",N=")";if(m>=0){switch(g="",e[0][m][1][0]){case 2:I=Jg(" ",e[0][m][1][1])+I;break;case 3:I=Jg("\r",e[0][m][1][1])+I;break;case 4:N=Jg(" ",e[0][m][1][1])+N;break;case 5:N=Jg("\r",e[0][m][1][1])+N;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][m][1][0])}m=-1}h.push(I+h.pop()+N);break;case"PtgRefErr":case"PtgRefErr3d":case"PtgAreaErr":case"PtgAreaErr3d":h.push("#REF!");break;case"PtgExp":o={c:b[1][1],r:b[1][0]};var O={c:n.c,r:n.r};if(r.sharedf[Ty(o)]){var R=r.sharedf[Ty(o)];h.push(AS(R,u,O,r,a))}else{var D=!1;for(i=0;i!=r.arrayf.length;++i)if(s=r.arrayf[i],!(o.c<s[0].s.c||o.c>s[0].e.c)&&!(o.r<s[0].s.r||o.r>s[0].e.r)){h.push(AS(s[1],u,O,r,a)),D=!0;break}D||h.push(b[1])}break;case"PtgArray":h.push("{"+TS(b[1])+"}");break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":m=v;break;case"PtgMissArg":h.push("");break;case"PtgList":h.push("Table"+b[1].idx+"[#"+b[1].rt+"]");break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");default:throw new Error("Unrecognized Formula Token: "+String(b))}if(3!=a.biff&&m>=0&&-1==["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"].indexOf(e[0][v][0])){var j=!0;switch((b=e[0][m])[1][0]){case 4:j=!1;case 0:g=Jg(" ",b[1][1]);break;case 5:j=!1;case 1:g=Jg("\r",b[1][1]);break;default:if(g="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+b[1][0])}h.push((j?g:"")+h.pop()+(j?"":g)),m=-1}}if(h.length>1&&a.WTF)throw new Error("bad formula stack");return h[0]}function kS(e,t,n,r,a){var i=qb(t,n,a),s=function(e){if(null==e){var t=uy(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}return tb("number"==typeof e?e:0)}(e.v),o=uy(6);o.write_shift(2,33),o.write_shift(4,0);for(var l=uy(e.bf.length),c=0;c<e.bf.length;++c)l[c]=e.bf[c];return Pm([i,s,o,l])}function CS(e,t,n){var r=e.read_shift(4),a=SS(e,r,n),i=e.read_shift(4);return[a,i>0?wS(e,i,a,n):null]}var IS=CS,NS=CS,OS=CS,RS=CS,DS={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},jS={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},PS={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};var LS="undefined"!==typeof Map;function MS(e,t,n){var r=0,a=e.length;if(n){if(LS?n.has(t):Object.prototype.hasOwnProperty.call(n,t))for(var i=LS?n.get(t):n[t];r<i.length;++r)if(e[i[r]].t===t)return e.Count++,i[r]}else for(;r<a;++r)if(e[r].t===t)return e.Count++,r;return e[a]={t:t},e.Count++,e.Unique++,n&&(LS?(n.has(t)||n.set(t,[]),n.get(t).push(a)):(Object.prototype.hasOwnProperty.call(n,t)||(n[t]=[]),n[t].push(a))),a}function FS(e,t){var n={min:e+1,max:e+1},r=-1;return t.MDW&&(bw=t.MDW),null!=t.width?n.customWidth=1:null!=t.wpx?r=Sw(t.wpx):null!=t.wch&&(r=t.wch),r>-1?(n.width=Tw(r),n.customWidth=1):null!=t.width&&(n.width=t.width),t.hidden&&(n.hidden=!0),null!=t.level&&(n.outlineLevel=n.level=t.level),n}function US(e,t){if(e){var n=[.7,.7,.75,.75,.3,.3];"xlml"==t&&(n=[1,1,1,1,.5,.5]),null==e.left&&(e.left=n[0]),null==e.right&&(e.right=n[1]),null==e.top&&(e.top=n[2]),null==e.bottom&&(e.bottom=n[3]),null==e.header&&(e.header=n[4]),null==e.footer&&(e.footer=n[5])}}function VS(e,t,n){var r=n.revssf[null!=t.z?t.z:"General"],a=60,i=e.length;if(null==r&&n.ssf)for(;a<392;++a)if(null==n.ssf[a]){Ag(t.z,a),n.ssf[a]=t.z,n.revssf[t.z]=r=a;break}for(a=0;a!=i;++a)if(e[a].numFmtId===r)return a;return e[i]={numFmtId:r,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},i}function BS(e,t,n){if(e&&e["!ref"]){var r=_y(e["!ref"]);if(r.e.c<r.s.c||r.e.r<r.s.r)throw new Error("Bad range ("+n+"): "+e["!ref"])}}var zS=["objects","scenarios","selectLockedCells","selectUnlockedCells"],HS=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function WS(e,t,n,r){if(e.c&&n["!comments"].push([t,e.c]),void 0===e.v&&"string"!==typeof e.f||"z"===e.t&&!e.f)return"";var a="",i=e.t,s=e.v;if("z"!==e.t)switch(e.t){case"b":a=e.v?"1":"0";break;case"n":a=""+e.v;break;case"e":a=ub[e.v];break;case"d":r&&r.cellDates?a=Yg(e.v,-1).toISOString():((e=Xg(e)).t="n",a=""+(e.v=Vg(Yg(e.v)))),"undefined"===typeof e.z&&(e.z=Km[14]);break;default:a=e.v}var o=Sv("v",lv(a)),l={r:t},c=VS(r.cellXfs,e,r);switch(0!==c&&(l.s=c),e.t){case"n":case"z":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;default:if(null==e.v){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(r&&r.bookSST){o=Sv("v",""+MS(r.Strings,e.v,r.revStrings)),l.t="s";break}l.t="str"}if(e.t!=i&&(e.t=i,e.v=s),"string"==typeof e.f&&e.f){var u=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;o=Ev("f",lv(e.f),u)+(null!=e.v?o:"")}return e.l&&n["!links"].push([t,e.l]),e.D&&(l.cm=1),Ev("c",o,l)}function GS(e,t,n,r){var a,i=[rv,Ev("worksheet",null,{xmlns:Av[0],"xmlns:r":_v.r})],s=n.SheetNames[e],o="",l=n.Sheets[s];null==l&&(l={});var c=l["!ref"]||"A1",u=_y(c);if(u.e.c>16383||u.e.r>1048575){if(t.WTF)throw new Error("Range "+c+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575),c=xy(u)}r||(r={}),l["!comments"]=[];var h=[];!function(e,t,n,r,a){var i=!1,s={},o=null;if("xlsx"!==r.bookType&&t.vbaraw){var l=t.SheetNames[n];try{t.Workbook&&(l=t.Workbook.Sheets[n].CodeName||l)}catch(YE){}i=!0,s.codeName=yv(lv(l))}if(e&&e["!outline"]){var c={summaryBelow:1,summaryRight:1};e["!outline"].above&&(c.summaryBelow=0),e["!outline"].left&&(c.summaryRight=0),o=(o||"")+Ev("outlinePr",null,c)}(i||o)&&(a[a.length]=Ev("sheetPr",o,s))}(l,n,e,t,i),i[i.length]=Ev("dimension",null,{ref:c}),i[i.length]=function(e,t,n,r){var a={workbookViewId:"0"};return(((r||{}).Workbook||{}).Views||[])[0]&&(a.rightToLeft=r.Workbook.Views[0].RTL?"1":"0"),Ev("sheetViews",Ev("sheetView",null,a),{})}(0,0,0,n),t.sheetFormat&&(i[i.length]=Ev("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),null!=l["!cols"]&&l["!cols"].length>0&&(i[i.length]=function(e,t){for(var n,r=["<cols>"],a=0;a!=t.length;++a)(n=t[a])&&(r[r.length]=Ev("col",null,FS(a,n)));return r[r.length]="</cols>",r.join("")}(0,l["!cols"])),i[a=i.length]="<sheetData/>",l["!links"]=[],null!=l["!ref"]&&(o=function(e,t,n,r){var a,i,s=[],o=[],l=_y(e["!ref"]),c="",u="",h=[],d=0,f=0,p=e["!rows"],m=Array.isArray(e),g={r:u},v=-1;for(f=l.s.c;f<=l.e.c;++f)h[f]=wy(f);for(d=l.s.r;d<=l.e.r;++d){for(o=[],u=yy(d),f=l.s.c;f<=l.e.c;++f){a=h[f]+u;var y=m?(e[d]||[])[f]:e[a];void 0!==y&&null!=(c=WS(y,a,e,t))&&o.push(c)}(o.length>0||p&&p[d])&&(g={r:u},p&&p[d]&&((i=p[d]).hidden&&(g.hidden=1),v=-1,i.hpx?v=_w(i.hpx):i.hpt&&(v=i.hpt),v>-1&&(g.ht=v,g.customHeight=1),i.level&&(g.outlineLevel=i.level)),s[s.length]=Ev("row",o.join(""),g))}if(p)for(;d<p.length;++d)p&&p[d]&&(g={r:d+1},(i=p[d]).hidden&&(g.hidden=1),v=-1,i.hpx?v=_w(i.hpx):i.hpt&&(v=i.hpt),v>-1&&(g.ht=v,g.customHeight=1),i.level&&(g.outlineLevel=i.level),s[s.length]=Ev("row","",g));return s.join("")}(l,t,0,0),o.length>0&&(i[i.length]=o)),i.length>a+1&&(i[i.length]="</sheetData>",i[a]=i[a].replace("/>",">")),l["!protect"]&&(i[i.length]=function(e){var t={sheet:1};return zS.forEach((function(n){null!=e[n]&&e[n]&&(t[n]="1")})),HS.forEach((function(n){null==e[n]||e[n]||(t[n]="0")})),e.password&&(t.password=mw(e.password).toString(16).toUpperCase()),Ev("sheetProtection",null,t)}(l["!protect"])),null!=l["!autofilter"]&&(i[i.length]=function(e,t,n,r){var a="string"==typeof e.ref?e.ref:xy(e.ref);n.Workbook||(n.Workbook={Sheets:[]}),n.Workbook.Names||(n.Workbook.Names=[]);var i=n.Workbook.Names,s=Ey(a);s.s.r==s.e.r&&(s.e.r=Ey(t["!ref"]).e.r,a=xy(s));for(var o=0;o<i.length;++o){var l=i[o];if("_xlnm._FilterDatabase"==l.Name&&l.Sheet==r){l.Ref="'"+n.SheetNames[r]+"'!"+a;break}}return o==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+n.SheetNames[r]+"'!"+a}),Ev("autoFilter",null,{ref:a})}(l["!autofilter"],l,n,e)),null!=l["!merges"]&&l["!merges"].length>0&&(i[i.length]=function(e){if(0===e.length)return"";for(var t='<mergeCells count="'+e.length+'">',n=0;n!=e.length;++n)t+='<mergeCell ref="'+xy(e[n])+'"/>';return t+"</mergeCells>"}(l["!merges"]));var d,f,p=-1,m=-1;return l["!links"].length>0&&(i[i.length]="<hyperlinks>",l["!links"].forEach((function(e){e[1].Target&&(d={ref:e[0]},"#"!=e[1].Target.charAt(0)&&(m=vb(r,-1,lv(e[1].Target).replace(/#.*$/,""),pb.HLINK),d["r:id"]="rId"+m),(p=e[1].Target.indexOf("#"))>-1&&(d.location=lv(e[1].Target.slice(p+1))),e[1].Tooltip&&(d.tooltip=lv(e[1].Tooltip)),i[i.length]=Ev("hyperlink",null,d))})),i[i.length]="</hyperlinks>"),delete l["!links"],null!=l["!margins"]&&(i[i.length]=(US(f=l["!margins"]),Ev("pageMargins",null,f))),t&&!t.ignoreEC&&void 0!=t.ignoreEC||(i[i.length]=Sv("ignoredErrors",Ev("ignoredError",null,{numberStoredAsText:1,sqref:c}))),h.length>0&&(m=vb(r,-1,"../drawings/drawing"+(e+1)+".xml",pb.DRAW),i[i.length]=Ev("drawing",null,{"r:id":"rId"+m}),l["!drawing"]=h),l["!comments"].length>0&&(m=vb(r,-1,"../drawings/vmlDrawing"+(e+1)+".vml",pb.VML),i[i.length]=Ev("legacyDrawing",null,{"r:id":"rId"+m}),l["!legacy"]=m),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function qS(e,t,n,r){var a=function(e,t,n){var r=uy(145),a=(n["!rows"]||[])[e]||{};r.write_shift(4,e),r.write_shift(4,0);var i=320;a.hpx?i=20*_w(a.hpx):a.hpt&&(i=20*a.hpt),r.write_shift(2,i),r.write_shift(1,0);var s=0;a.level&&(s|=a.level),a.hidden&&(s|=16),(a.hpx||a.hpt)&&(s|=32),r.write_shift(1,s),r.write_shift(1,0);var o=0,l=r.l;r.l+=4;for(var c={r:e,c:0},u=0;u<16;++u)if(!(t.s.c>u+1<<10||t.e.c<u<<10)){for(var h=-1,d=-1,f=u<<10;f<u+1<<10;++f)c.c=f,(Array.isArray(n)?(n[c.r]||[])[c.c]:n[Ty(c)])&&(h<0&&(h=f),d=f);h<0||(++o,r.write_shift(4,h),r.write_shift(4,d))}var p=r.l;return r.l=l,r.write_shift(4,o),r.l=p,r.length>r.l?r.slice(0,r.l):r}(r,n,t);(a.length>17||(t["!rows"]||[])[r])&&dy(e,0,a)}var KS=$y,YS=Zy;function QS(e){return[Vy(e),eb(e),"n"]}var XS=$y,JS=Zy;var $S=["left","right","top","bottom","header","footer"];function ZS(e,t,n,r,a,i,s){if(void 0===t.v)return!1;var o="";switch(t.t){case"b":o=t.v?"1":"0";break;case"d":(t=Xg(t)).z=t.z||Km[14],t.v=Vg(Yg(t.v)),t.t="n";break;case"n":case"e":o=""+t.v;break;default:o=t.v}var l={r:n,c:r};switch(l.s=VS(a.cellXfs,t,a),t.l&&i["!links"].push([Ty(l),t.l]),t.c&&i["!comments"].push([Ty(l),t.c]),t.t){case"s":case"str":return a.bookSST?(o=MS(a.Strings,t.v,a.revStrings),l.t="s",l.v=o,s?dy(e,18,function(e,t,n){return null==n&&(n=uy(8)),By(t,n),n.write_shift(4,t.v),n}(0,l)):dy(e,7,function(e,t,n){return null==n&&(n=uy(12)),Uy(t,n),n.write_shift(4,t.v),n}(0,l))):(l.t="str",s?dy(e,17,function(e,t,n){return null==n&&(n=uy(8+4*e.v.length)),By(t,n),Dy(e.v,n),n.length>n.l?n.slice(0,n.l):n}(t,l)):dy(e,6,function(e,t,n){return null==n&&(n=uy(12+4*e.v.length)),Uy(t,n),Dy(e.v,n),n.length>n.l?n.slice(0,n.l):n}(t,l))),!0;case"n":return t.v==(0|t.v)&&t.v>-1e3&&t.v<1e3?s?dy(e,13,function(e,t,n){return null==n&&(n=uy(8)),By(t,n),Xy(e.v,n),n}(t,l)):dy(e,2,function(e,t,n){return null==n&&(n=uy(12)),Uy(t,n),Xy(e.v,n),n}(t,l)):s?dy(e,16,function(e,t,n){return null==n&&(n=uy(12)),By(t,n),tb(e.v,n),n}(t,l)):dy(e,5,function(e,t,n){return null==n&&(n=uy(16)),Uy(t,n),tb(e.v,n),n}(t,l)),!0;case"b":return l.t="b",s?dy(e,15,function(e,t,n){return null==n&&(n=uy(5)),By(t,n),n.write_shift(1,e.v?1:0),n}(t,l)):dy(e,4,function(e,t,n){return null==n&&(n=uy(9)),Uy(t,n),n.write_shift(1,e.v?1:0),n}(t,l)),!0;case"e":return l.t="e",s?dy(e,14,function(e,t,n){return null==n&&(n=uy(8)),By(t,n),n.write_shift(1,e.v),n.write_shift(2,0),n.write_shift(1,0),n}(t,l)):dy(e,3,function(e,t,n){return null==n&&(n=uy(9)),Uy(t,n),n.write_shift(1,e.v),n}(t,l)),!0}return s?dy(e,12,function(e,t,n){return null==n&&(n=uy(4)),By(t,n)}(0,l)):dy(e,1,function(e,t,n){return null==n&&(n=uy(8)),Uy(t,n)}(0,l)),!0}function eT(e,t){var n,r;t&&t["!merges"]&&(dy(e,177,(n=t["!merges"].length,null==r&&(r=uy(4)),r.write_shift(4,n),r)),t["!merges"].forEach((function(t){dy(e,176,JS(t))})),dy(e,178))}function tT(e,t){t&&t["!cols"]&&(dy(e,390),t["!cols"].forEach((function(t,n){t&&dy(e,60,function(e,t,n){null==n&&(n=uy(18));var r=FS(e,t);n.write_shift(-4,e),n.write_shift(-4,e),n.write_shift(4,256*(r.width||10)),n.write_shift(4,0);var a=0;return t.hidden&&(a|=1),"number"==typeof r.width&&(a|=2),t.level&&(a|=t.level<<8),n.write_shift(2,a),n}(n,t))})),dy(e,391))}function nT(e,t){t&&t["!ref"]&&(dy(e,648),dy(e,649,function(e){var t=uy(24);return t.write_shift(4,4),t.write_shift(4,1),Zy(e,t),t}(_y(t["!ref"]))),dy(e,650))}function rT(e,t,n){t["!links"].forEach((function(t){if(t[1].Target){var r=vb(n,-1,t[1].Target.replace(/#.*$/,""),pb.HLINK);dy(e,494,function(e,t){var n=uy(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));Zy({s:Sy(e[0]),e:Sy(e[0])},n),Yy("rId"+t,n);var r=e[1].Target.indexOf("#");return Dy((-1==r?"":e[1].Target.slice(r+1))||"",n),Dy(e[1].Tooltip||"",n),Dy("",n),n.slice(0,n.l)}(t,r))}})),delete t["!links"]}function aT(e,t,n){dy(e,133),dy(e,137,function(e,t,n){null==n&&(n=uy(30));var r=924;return(((t||{}).Views||[])[0]||{}).RTL&&(r|=32),n.write_shift(2,r),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(1,0),n.write_shift(1,0),n.write_shift(2,0),n.write_shift(2,100),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(4,0),n}(0,n)),dy(e,138),dy(e,134)}function iT(e,t){var n,r;t["!protect"]&&dy(e,535,(n=t["!protect"],null==r&&(r=uy(66)),r.write_shift(2,n.password?mw(n.password):0),r.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach((function(e){e[1]?r.write_shift(4,null==n[e[0]]||n[e[0]]?0:1):r.write_shift(4,null!=n[e[0]]&&n[e[0]]?0:1)})),r))}function sT(e,t,n,r){var a=hy(),i=n.SheetNames[e],s=n.Sheets[i]||{},o=i;try{n&&n.Workbook&&(o=n.Workbook.Sheets[e].CodeName||o)}catch(YE){}var l,c,u=_y(s["!ref"]||"A1");if(u.e.c>16383||u.e.r>1048575){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575)}return s["!links"]=[],s["!comments"]=[],dy(a,129),(n.vbaraw||s["!outline"])&&dy(a,147,function(e,t,n){null==n&&(n=uy(84+4*e.length));var r=192;t&&(t.above&&(r&=-65),t.left&&(r&=-129)),n.write_shift(1,r);for(var a=1;a<3;++a)n.write_shift(1,0);return nb({auto:1},n),n.write_shift(-4,-1),n.write_shift(-4,-1),Hy(e,n),n.slice(0,n.l)}(o,s["!outline"])),dy(a,148,YS(u)),aT(a,0,n.Workbook),tT(a,s),function(e,t,n,r){var a,i=_y(t["!ref"]||"A1"),s="",o=[];dy(e,145);var l=Array.isArray(t),c=i.e.r;t["!rows"]&&(c=Math.max(i.e.r,t["!rows"].length-1));for(var u=i.s.r;u<=c;++u){s=yy(u),qS(e,t,i,u);var h=!1;if(u<=i.e.r)for(var d=i.s.c;d<=i.e.c;++d){u===i.s.r&&(o[d]=wy(d)),a=o[d]+s;var f=l?(t[u]||[])[d]:t[a];h=!!f&&ZS(e,f,u,d,r,t,h)}}dy(e,146)}(a,s,0,t),iT(a,s),function(e,t,n,r){if(t["!autofilter"]){var a=t["!autofilter"],i="string"===typeof a.ref?a.ref:xy(a.ref);n.Workbook||(n.Workbook={Sheets:[]}),n.Workbook.Names||(n.Workbook.Names=[]);var s=n.Workbook.Names,o=Ey(i);o.s.r==o.e.r&&(o.e.r=Ey(t["!ref"]).e.r,i=xy(o));for(var l=0;l<s.length;++l){var c=s[l];if("_xlnm._FilterDatabase"==c.Name&&c.Sheet==r){c.Ref="'"+n.SheetNames[r]+"'!"+i;break}}l==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+n.SheetNames[r]+"'!"+i}),dy(e,161,Zy(_y(i))),dy(e,162)}}(a,s,n,e),eT(a,s),rT(a,s,r),s["!margins"]&&dy(a,476,(l=s["!margins"],null==c&&(c=uy(48)),US(l),$S.forEach((function(e){tb(l[e],c)})),c)),t&&!t.ignoreEC&&void 0!=t.ignoreEC||nT(a,s),function(e,t,n,r){if(t["!comments"].length>0){var a=vb(r,-1,"../drawings/vmlDrawing"+(n+1)+".vml",pb.VML);dy(e,551,Yy("rId"+a)),t["!legacy"]=a}}(a,s,e,r),dy(a,130),a.end()}var oT=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];var lT="][*?/\\".split("");function cT(e,t){if(e.length>31){if(t)return!1;throw new Error("Sheet names cannot exceed 31 chars")}var n=!0;return lT.forEach((function(r){if(-1!=e.indexOf(r)){if(!t)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");n=!1}})),n}function uT(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];!function(e,t,n){e.forEach((function(r,a){cT(r);for(var i=0;i<a;++i)if(r==e[i])throw new Error("Duplicate Sheet Name: "+r);if(n){var s=t&&t[a]&&t[a].CodeName||r;if(95==s.charCodeAt(0)&&s.length>22)throw new Error("Bad Code Name: Worksheet"+s)}}))}(e.SheetNames,t,!!e.vbaraw);for(var n=0;n<e.SheetNames.length;++n)BS(e.Sheets[e.SheetNames[n]],e.SheetNames[n],n)}function hT(e){var t=[rv];t[t.length]=Ev("workbook",null,{xmlns:Av[0],"xmlns:r":_v.r});var n=e.Workbook&&(e.Workbook.Names||[]).length>0,r={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(oT.forEach((function(t){null!=e.Workbook.WBProps[t[0]]&&e.Workbook.WBProps[t[0]]!=t[1]&&(r[t[0]]=e.Workbook.WBProps[t[0]])})),e.Workbook.WBProps.CodeName&&(r.codeName=e.Workbook.WBProps.CodeName,delete r.CodeName)),t[t.length]=Ev("workbookPr",null,r);var a=e.Workbook&&e.Workbook.Sheets||[],i=0;if(a&&a[0]&&a[0].Hidden){for(t[t.length]="<bookViews>",i=0;i!=e.SheetNames.length&&a[i]&&a[i].Hidden;++i);i==e.SheetNames.length&&(i=0),t[t.length]='<workbookView firstSheet="'+i+'" activeTab="'+i+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",i=0;i!=e.SheetNames.length;++i){var s={name:lv(e.SheetNames[i].slice(0,31))};if(s.sheetId=""+(i+1),s["r:id"]="rId"+(i+1),a[i])switch(a[i].Hidden){case 1:s.state="hidden";break;case 2:s.state="veryHidden"}t[t.length]=Ev("sheet",null,s)}return t[t.length]="</sheets>",n&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach((function(e){var n={name:e.Name};e.Comment&&(n.comment=e.Comment),null!=e.Sheet&&(n.localSheetId=""+e.Sheet),e.Hidden&&(n.hidden="1"),e.Ref&&(t[t.length]=Ev("definedName",lv(e.Ref),n))})),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function dT(e,t){if(t.Workbook&&t.Workbook.Sheets){for(var n,r,a=t.Workbook.Sheets,i=0,s=-1,o=-1;i<a.length;++i)!a[i]||!a[i].Hidden&&-1==s?s=i:1==a[i].Hidden&&-1==o&&(o=i);if(!(o>s))dy(e,135),dy(e,158,(n=s,r||(r=uy(29)),r.write_shift(-4,0),r.write_shift(-4,460),r.write_shift(4,28800),r.write_shift(4,17600),r.write_shift(4,500),r.write_shift(4,n),r.write_shift(4,n),r.write_shift(1,120),r.length>r.l?r.slice(0,r.l):r)),dy(e,136)}}function fT(e,t){var n=hy();return dy(n,131),dy(n,128,function(e,t){t||(t=uy(127));for(var n=0;4!=n;++n)t.write_shift(4,0);return Dy("SheetJS",t),Dy(dm.version,t),Dy(dm.version,t),Dy("7262",t),t.length>t.l?t.slice(0,t.l):t}()),dy(n,153,function(e,t){t||(t=uy(72));var n=0;return e&&e.filterPrivacy&&(n|=8),t.write_shift(4,n),t.write_shift(4,0),Hy(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}(e.Workbook&&e.Workbook.WBProps||null)),dT(n,e),function(e,t){dy(e,143);for(var n=0;n!=t.SheetNames.length;++n){dy(e,156,(r={Hidden:t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[n]&&t.Workbook.Sheets[n].Hidden||0,iTabID:n+1,strRelID:"rId"+(n+1),name:t.SheetNames[n]},(a=void 0)||(a=uy(127)),a.write_shift(4,r.Hidden),a.write_shift(4,r.iTabID),Yy(r.strRelID,a),Dy(r.name.slice(0,31),a),a.length>a.l?a.slice(0,a.l):a))}var r,a;dy(e,144)}(n,e),dy(n,132),n.end()}function pT(e,t,n,r,a){return(".bin"===t.slice(-4)?sT:GS)(e,n,r,a)}function mT(e,t,n){return(".bin"===t.slice(-4)?Qw:qw)(e,n)}function gT(e,t){var n=[];return e.Props&&n.push(function(e,t){var n=[];return Pg(kb).map((function(e){for(var t=0;t<wb.length;++t)if(wb[t][1]==e)return wb[t];for(t=0;t<Eb.length;++t)if(Eb[t][1]==e)return Eb[t];throw e})).forEach((function(r){if(null!=e[r[1]]){var a=t&&t.Props&&null!=t.Props[r[1]]?t.Props[r[1]]:e[r[1]];"date"===r[2]&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"Z")),"number"==typeof a?a=String(a):!0===a||!1===a?a=a?"1":"0":a instanceof Date&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"")),n.push(Sv(kb[r[1]]||r[1],a))}})),Ev("DocumentProperties",n.join(""),{xmlns:kv.o})}(e.Props,t)),e.Custprops&&n.push(function(e,t){var n=["Worksheets","SheetNames"],r="CustomDocumentProperties",a=[];return e&&Pg(e).forEach((function(t){if(Object.prototype.hasOwnProperty.call(e,t)){for(var r=0;r<wb.length;++r)if(t==wb[r][1])return;for(r=0;r<Eb.length;++r)if(t==Eb[r][1])return;for(r=0;r<n.length;++r)if(t==n[r])return;var i=e[t],s="string";"number"==typeof i?(s="float",i=String(i)):!0===i||!1===i?(s="boolean",i=i?"1":"0"):i=String(i),a.push(Ev(cv(t),i,{"dt:dt":s}))}})),t&&Pg(t).forEach((function(n){if(Object.prototype.hasOwnProperty.call(t,n)&&(!e||!Object.prototype.hasOwnProperty.call(e,n))){var r=t[n],i="string";"number"==typeof r?(i="float",r=String(r)):!0===r||!1===r?(i="boolean",r=r?"1":"0"):r instanceof Date?(i="dateTime.tz",r=r.toISOString()):r=String(r),a.push(Ev(cv(n),r,{"dt:dt":i}))}})),"<"+r+' xmlns="'+kv.o+'">'+a.join("")+"</"+r+">"}(e.Props,e.Custprops)),n.join("")}function vT(e){return Ev("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+Zw(e.Ref,{r:0,c:0})})}function yT(e,t,n,r,a,i,s){if(!e||void 0==e.v&&void 0==e.f)return"";var o={};if(e.f&&(o["ss:Formula"]="="+lv(Zw(e.f,s))),e.F&&e.F.slice(0,t.length)==t){var l=Sy(e.F.slice(t.length+1));o["ss:ArrayRange"]="RC:R"+(l.r==s.r?"":"["+(l.r-s.r)+"]")+"C"+(l.c==s.c?"":"["+(l.c-s.c)+"]")}if(e.l&&e.l.Target&&(o["ss:HRef"]=lv(e.l.Target),e.l.Tooltip&&(o["x:HRefScreenTip"]=lv(e.l.Tooltip))),n["!merges"])for(var c=n["!merges"],u=0;u!=c.length;++u)c[u].s.c==s.c&&c[u].s.r==s.r&&(c[u].e.c>c[u].s.c&&(o["ss:MergeAcross"]=c[u].e.c-c[u].s.c),c[u].e.r>c[u].s.r&&(o["ss:MergeDown"]=c[u].e.r-c[u].s.r));var h="",d="";switch(e.t){case"z":if(!r.sheetStubs)return"";break;case"n":h="Number",d=String(e.v);break;case"b":h="Boolean",d=e.v?"1":"0";break;case"e":h="Error",d=ub[e.v];break;case"d":h="DateTime",d=new Date(e.v).toISOString(),null==e.z&&(e.z=e.z||Km[14]);break;case"s":h="String",d=((e.v||"")+"").replace(sv,(function(e){return iv[e]})).replace(uv,(function(e){return"&#x"+e.charCodeAt(0).toString(16).toUpperCase()+";"}))}var f=VS(r.cellXfs,e,r);o["ss:StyleID"]="s"+(21+f),o["ss:Index"]=s.c+1;var p=null!=e.v?d:"",m="z"==e.t?"":'<Data ss:Type="'+h+'">'+p+"</Data>";return(e.c||[]).length>0&&(m+=e.c.map((function(e){var t=Ev("ss:Data",(e.t||"").replace(/(\r\n|[\r\n])/g,"&#10;"),{xmlns:"http://www.w3.org/TR/REC-html40"});return Ev("Comment",t,{"ss:Author":e.a})})).join("")),Ev("Cell",m,o)}function bT(e,t){var n='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=Aw(t.hpt)),t.hpx&&(n+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(n+=' ss:Hidden="1"')),n+">"}function wT(e,t,n){var r=[],a=n.SheetNames[e],i=n.Sheets[a],s=i?function(e,t,n,r){if(!e)return"";if(!((r||{}).Workbook||{}).Names)return"";for(var a=r.Workbook.Names,i=[],s=0;s<a.length;++s){var o=a[s];o.Sheet==n&&(o.Name.match(/^_xlfn\./)||i.push(vT(o)))}return i.join("")}(i,0,e,n):"";return s.length>0&&r.push("<Names>"+s+"</Names>"),s=i?function(e,t,n,r){if(!e["!ref"])return"";var a=_y(e["!ref"]),i=e["!merges"]||[],s=0,o=[];e["!cols"]&&e["!cols"].forEach((function(e,t){Ew(e);var n=!!e.width,r=FS(t,e),a={"ss:Index":t+1};n&&(a["ss:Width"]=ww(r.width)),e.hidden&&(a["ss:Hidden"]="1"),o.push(Ev("Column",null,a))}));for(var l=Array.isArray(e),c=a.s.r;c<=a.e.r;++c){for(var u=[bT(c,(e["!rows"]||[])[c])],h=a.s.c;h<=a.e.c;++h){var d=!1;for(s=0;s!=i.length;++s)if(!(i[s].s.c>h)&&!(i[s].s.r>c)&&!(i[s].e.c<h)&&!(i[s].e.r<c)){i[s].s.c==h&&i[s].s.r==c||(d=!0);break}if(!d){var f={r:c,c:h},p=Ty(f),m=l?(e[c]||[])[h]:e[p];u.push(yT(m,p,e,t,0,0,f))}}u.push("</Row>"),u.length>2&&o.push(u.join(""))}return o.join("")}(i,t):"",s.length>0&&r.push("<Table>"+s+"</Table>"),r.push(function(e,t,n,r){if(!e)return"";var a=[];if(e["!margins"]&&(a.push("<PageSetup>"),e["!margins"].header&&a.push(Ev("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&a.push(Ev("Footer",null,{"x:Margin":e["!margins"].footer})),a.push(Ev("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),a.push("</PageSetup>")),r&&r.Workbook&&r.Workbook.Sheets&&r.Workbook.Sheets[n])if(r.Workbook.Sheets[n].Hidden)a.push(Ev("Visible",1==r.Workbook.Sheets[n].Hidden?"SheetHidden":"SheetVeryHidden",{}));else{for(var i=0;i<n&&(!r.Workbook.Sheets[i]||r.Workbook.Sheets[i].Hidden);++i);i==n&&a.push("<Selected/>")}return((((r||{}).Workbook||{}).Views||[])[0]||{}).RTL&&a.push("<DisplayRightToLeft/>"),e["!protect"]&&(a.push(Sv("ProtectContents","True")),e["!protect"].objects&&a.push(Sv("ProtectObjects","True")),e["!protect"].scenarios&&a.push(Sv("ProtectScenarios","True")),null==e["!protect"].selectLockedCells||e["!protect"].selectLockedCells?null==e["!protect"].selectUnlockedCells||e["!protect"].selectUnlockedCells||a.push(Sv("EnableSelection","UnlockedCells")):a.push(Sv("EnableSelection","NoSelection")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach((function(t){e["!protect"][t[0]]&&a.push("<"+t[1]+"/>")}))),0==a.length?"":Ev("WorksheetOptions",a.join(""),{xmlns:kv.x})}(i,0,e,n)),r.join("")}function ST(e,t){t||(t={}),e.SSF||(e.SSF=Xg(Km)),e.SSF&&(Cg(),kg(e.SSF),t.revssf=Fg(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],VS(t.cellXfs,{},{revssf:{General:0}}));var n=[];n.push(gT(e,t)),n.push(""),n.push(""),n.push("");for(var r=0;r<e.SheetNames.length;++r)n.push(Ev("Worksheet",wT(r,t,e),{"ss:Name":lv(e.SheetNames[r])}));return n[2]=function(e,t){var n=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach((function(e,t){var r=[];r.push(Ev("NumberFormat",null,{"ss:Format":lv(Km[e.numFmtId])}));var a={"ss:ID":"s"+(21+t)};n.push(Ev("Style",r.join(""),a))})),Ev("Styles",n.join(""))}(0,t),n[3]=function(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,n=[],r=0;r<t.length;++r){var a=t[r];null==a.Sheet&&(a.Name.match(/^_xlfn\./)||n.push(vT(a)))}return Ev("Names",n.join(""))}(e),rv+Ev("Workbook",n.join(""),{xmlns:kv.ss,"xmlns:o":kv.o,"xmlns:x":kv.x,"xmlns:ss":kv.ss,"xmlns:dt":kv.dt,"xmlns:html":kv.html})}var TT={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function ET(e,t){var n=t||{},r=Og.utils.cfb_new({root:"R"}),a="/Workbook";switch(n.bookType||"xls"){case"xls":n.bookType="biff8";case"xla":n.bookType||(n.bookType="xla");case"biff8":a="/Workbook",n.biff=8;break;case"biff5":a="/Book",n.biff=5;break;default:throw new Error("invalid type "+n.bookType+" for XLS CFB")}return Og.utils.cfb_add(r,a,jT(e,n)),8==n.biff&&(e.Props||e.Custprops)&&function(e,t){var n,r=[],a=[],i=[],s=0,o=Lg(sb,"n"),l=Lg(ob,"n");if(e.Props)for(n=Pg(e.Props),s=0;s<n.length;++s)(Object.prototype.hasOwnProperty.call(o,n[s])?r:Object.prototype.hasOwnProperty.call(l,n[s])?a:i).push([n[s],e.Props[n[s]]]);if(e.Custprops)for(n=Pg(e.Custprops),s=0;s<n.length;++s)Object.prototype.hasOwnProperty.call(e.Props||{},n[s])||(Object.prototype.hasOwnProperty.call(o,n[s])?r:Object.prototype.hasOwnProperty.call(l,n[s])?a:i).push([n[s],e.Custprops[n[s]]]);var c=[];for(s=0;s<i.length;++s)Ib.indexOf(i[s][0])>-1||xb.indexOf(i[s][0])>-1||null!=i[s][1]&&c.push(i[s]);a.length&&Og.utils.cfb_add(t,"/\x05SummaryInformation",Rb(a,TT.SI,l,ob)),(r.length||c.length)&&Og.utils.cfb_add(t,"/\x05DocumentSummaryInformation",Rb(r,TT.DSI,o,sb,c.length?c:null,TT.UDI))}(e,r),8==n.biff&&e.vbaraw&&function(e,t){t.FullPaths.forEach((function(n,r){if(0!=r){var a=n.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");"/"!==a.slice(-1)&&Og.utils.cfb_add(e,a,t.FileIndex[r].content)}}))}(r,Og.read(e.vbaraw,{type:"string"==typeof e.vbaraw?"binary":"buffer"})),r}var xT={0:{f:function(e,t){var n={},r=e.l+t;n.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var i=e.read_shift(1);return e.l=r,7&i&&(n.level=7&i),16&i&&(n.hidden=!0),32&i&&(n.hpt=a/20),n}},1:{f:function(e){return[Fy(e)]}},2:{f:function(e){return[Fy(e),Qy(e),"n"]}},3:{f:function(e){return[Fy(e),e.read_shift(1),"e"]}},4:{f:function(e){return[Fy(e),e.read_shift(1),"b"]}},5:{f:function(e){return[Fy(e),eb(e),"n"]}},6:{f:function(e){return[Fy(e),Ry(e),"str"]}},7:{f:function(e){return[Fy(e),e.read_shift(4),"s"]}},8:{f:function(e,t,n){var r=e.l+t,a=Fy(e);a.r=n["!row"];var i=[a,Ry(e),"str"];if(n.cellFormula){e.l+=2;var s=NS(e,r-e.l,n);i[3]=AS(s,0,a,n.supbooks,n)}else e.l=r;return i}},9:{f:function(e,t,n){var r=e.l+t,a=Fy(e);a.r=n["!row"];var i=[a,eb(e),"n"];if(n.cellFormula){e.l+=2;var s=NS(e,r-e.l,n);i[3]=AS(s,0,a,n.supbooks,n)}else e.l=r;return i}},10:{f:function(e,t,n){var r=e.l+t,a=Fy(e);a.r=n["!row"];var i=[a,e.read_shift(1),"b"];if(n.cellFormula){e.l+=2;var s=NS(e,r-e.l,n);i[3]=AS(s,0,a,n.supbooks,n)}else e.l=r;return i}},11:{f:function(e,t,n){var r=e.l+t,a=Fy(e);a.r=n["!row"];var i=[a,e.read_shift(1),"e"];if(n.cellFormula){e.l+=2;var s=NS(e,r-e.l,n);i[3]=AS(s,0,a,n.supbooks,n)}else e.l=r;return i}},12:{f:function(e){return[Vy(e)]}},13:{f:function(e){return[Vy(e),Qy(e),"n"]}},14:{f:function(e){return[Vy(e),e.read_shift(1),"e"]}},15:{f:function(e){return[Vy(e),e.read_shift(1),"b"]}},16:{f:QS},17:{f:function(e){return[Vy(e),Ry(e),"str"]}},18:{f:function(e){return[Vy(e),e.read_shift(4),"s"]}},19:{f:Py},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:function(e,t,n){var r=e.l+t;e.l+=4,e.l+=1;var a=e.read_shift(4),i=qy(e),s=OS(e,0,n),o=Wy(e);e.l=r;var l={Name:i,Ptg:s};return a<268435455&&(l.Sheet=a),o&&(l.Comment=o),l}},40:{},42:{},43:{f:function(e,t,n){var r={};r.sz=e.read_shift(2)/20;var a=function(e){var t=e.read_shift(1);return e.l++,{fBold:1&t,fItalic:2&t,fUnderline:4&t,fStrikeout:8&t,fOutline:16&t,fShadow:32&t,fCondense:64&t,fExtend:128&t}}(e);switch(a.fItalic&&(r.italic=1),a.fCondense&&(r.condense=1),a.fExtend&&(r.extend=1),a.fShadow&&(r.shadow=1),a.fOutline&&(r.outline=1),a.fStrikeout&&(r.strike=1),700===e.read_shift(2)&&(r.bold=1),e.read_shift(2)){case 1:r.vertAlign="superscript";break;case 2:r.vertAlign="subscript"}var i=e.read_shift(1);0!=i&&(r.underline=i);var s=e.read_shift(1);s>0&&(r.family=s);var o=e.read_shift(1);switch(o>0&&(r.charset=o),e.l++,r.color=function(e){var t={},n=e.read_shift(1)>>>1,r=e.read_shift(1),a=e.read_shift(2,"i"),i=e.read_shift(1),s=e.read_shift(1),o=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=r;var l=cb[r];l&&(t.rgb=vw(l));break;case 2:t.rgb=vw([i,s,o]);break;case 3:t.theme=r}return 0!=a&&(t.tint=a>0?a/32767:a/32768),t}(e),e.read_shift(1)){case 1:r.scheme="major";break;case 2:r.scheme="minor"}return r.name=Ry(e),r}},44:{f:function(e,t){return[e.read_shift(2),Ry(e)]}},45:{f:Rw},46:{f:Lw},47:{f:function(e,t){var n=e.l+t,r=e.read_shift(2),a=e.read_shift(2);return e.l=n,{ixfe:r,numFmtId:a}}},48:{},49:{f:function(e){return e.read_shift(4,"i")}},50:{},51:{f:function(e){for(var t=[],n=e.read_shift(4);n-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:rw},62:{f:function(e){return[Fy(e),Py(e),"is"]}},63:{f:function(e){var t={};t.i=e.read_shift(4);var n={};n.r=e.read_shift(4),n.c=e.read_shift(4),t.r=Ty(n);var r=e.read_shift(1);return 2&r&&(t.l="1"),8&r&&(t.a="1"),t}},64:{f:function(){}},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:cy,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:function(e){var t=e.read_shift(2);return e.l+=28,{RTL:32&t}}},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:function(e,t){var n={},r=e[e.l];return++e.l,n.above=!(64&r),n.left=!(128&r),e.l+=18,n.name=zy(e,t-19),n}},148:{f:KS,p:16},151:{f:function(){}},152:{},153:{f:function(e,t){var n={},r=e.read_shift(4);n.defaultThemeVersion=e.read_shift(4);var a=t>8?Ry(e):"";return a.length>0&&(n.CodeName=a),n.autoCompressPictures=!!(65536&r),n.backupFile=!!(64&r),n.checkCompatibility=!!(4096&r),n.date1904=!!(1&r),n.filterPrivacy=!!(8&r),n.hidePivotFieldList=!!(1024&r),n.promptedSolutions=!!(16&r),n.publishItems=!!(2048&r),n.refreshAllConnections=!!(262144&r),n.saveExternalLinkValues=!!(128&r),n.showBorderUnselectedTables=!!(4&r),n.showInkAnnotation=!!(32&r),n.showObjects=["all","placeholders","none"][r>>13&3],n.showPivotChartFilter=!!(32768&r),n.updateLinks=["userSet","never","always"][r>>8&3],n}},154:{},155:{},156:{f:function(e,t){var n={};return n.Hidden=e.read_shift(4),n.iTabID=e.read_shift(4),n.strRelID=Ky(e,t-8),n.name=Ry(e),n}},157:{},158:{},159:{T:1,f:function(e){return[e.read_shift(4),e.read_shift(4)]}},160:{T:-1},161:{T:1,f:$y},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:XS},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:function(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Ry(e)}}},336:{T:-1},337:{f:function(e){return e.l+=4,0!=e.read_shift(4)},T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Ky},357:{},358:{},359:{},360:{T:1},361:{},362:{f:ew},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:function(e,t,n){var r=e.l+t,a=Jy(e),i=e.read_shift(1),s=[a];if(s[2]=i,n.cellFormula){var o=IS(e,r-e.l,n);s[1]=o}else e.l=r;return s}},427:{f:function(e,t,n){var r=e.l+t,a=[$y(e,16)];if(n.cellFormula){var i=RS(e,r-e.l,n);a[1]=i,e.l=r}else e.l=r;return a}},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:function(e){var t={};return $S.forEach((function(n){t[n]=eb(e)})),t}},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:function(){}},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:function(e,t){var n=e.l+t,r=$y(e,16),a=Wy(e),i=Ry(e),s=Ry(e),o=Ry(e);e.l=n;var l={rfx:r,relId:a,loc:i,display:o};return s&&(l.Tooltip=s),l}},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Ky},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:Yw},633:{T:1},634:{T:-1},635:{T:1,f:function(e){var t={};t.iauthor=e.read_shift(4);var n=$y(e,16);return t.rfx=n.s,t.ref=Ty(n.s),e.l+=16,t}},636:{T:-1},637:{f:Ly},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:function(e,t){return e.l+=10,{name:Ry(e)}}},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:function(){}},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function _T(e,t,n,r){var a=t;if(!isNaN(a)){var i=r||(n||[]).length||0,s=e.next(4);s.write_shift(2,a),s.write_shift(2,i),i>0&&Yv(n)&&e.push(n)}}function AT(e,t,n){return e||(e=uy(7)),e.write_shift(2,t),e.write_shift(2,n),e.write_shift(2,0),e.write_shift(1,0),e}function kT(e,t,n,r){if(null!=t.v)switch(t.t){case"d":case"n":var a="d"==t.t?Vg(Yg(t.v)):t.v;return void(a==(0|a)&&a>=0&&a<65536?_T(e,2,function(e,t,n){var r=uy(9);return AT(r,e,t),r.write_shift(2,n),r}(n,r,a)):_T(e,3,function(e,t,n){var r=uy(15);return AT(r,e,t),r.write_shift(8,n,"f"),r}(n,r,a)));case"b":case"e":return void _T(e,5,function(e,t,n,r){var a=uy(9);return AT(a,e,t),Mb(n,r||"b",a),a}(n,r,t.v,t.t));case"s":case"str":return void _T(e,4,function(e,t,n){var r=uy(8+2*n.length);return AT(r,e,t),r.write_shift(1,n.length),r.write_shift(n.length,n,"sbcs"),r.l<r.length?r.slice(0,r.l):r}(n,r,(t.v||"").slice(0,255)))}_T(e,1,AT(null,n,r))}function CT(e,t){var n=t||{};null!=xm&&null==n.dense&&(n.dense=xm);for(var r=hy(),a=0,i=0;i<e.SheetNames.length;++i)e.SheetNames[i]==n.sheet&&(a=i);if(0==a&&n.sheet&&e.SheetNames[0]!=n.sheet)throw new Error("Sheet not found: "+n.sheet);return _T(r,4==n.biff?1033:3==n.biff?521:9,Xb(0,16,n)),function(e,t,n,r){var a,i=Array.isArray(t),s=_y(t["!ref"]||"A1"),o="",l=[];if(s.e.c>255||s.e.r>16383){if(r.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),a=xy(s)}for(var c=s.s.r;c<=s.e.r;++c){o=yy(c);for(var u=s.s.c;u<=s.e.c;++u){c===s.s.r&&(l[u]=wy(u)),a=l[u]+o;var h=i?(t[c]||[])[u]:t[a];h&&kT(e,h,c,u)}}}(r,e.Sheets[e.SheetNames[a]],0,n),_T(r,10),r.end()}function IT(e,t,n){_T(e,49,function(e,t){var n=e.name||"Arial",r=t&&5==t.biff,a=uy(r?15+n.length:16+2*n.length);return a.write_shift(2,20*(e.sz||12)),a.write_shift(4,0),a.write_shift(2,400),a.write_shift(4,0),a.write_shift(2,0),a.write_shift(1,n.length),r||a.write_shift(1,1),a.write_shift((r?1:2)*n.length,n,r?"sbcs":"utf16le"),a}({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},n))}function NT(e,t){if(t){var n=0;t.forEach((function(t,r){++n<=256&&t&&_T(e,125,function(e,t){var n=uy(12);n.write_shift(2,t),n.write_shift(2,t),n.write_shift(2,256*e.width),n.write_shift(2,0);var r=0;return e.hidden&&(r|=1),n.write_shift(1,r),r=e.level||0,n.write_shift(1,r),n.write_shift(2,0),n}(FS(r,t),r))}))}}function OT(e,t,n,r,a){var i=16+VS(a.cellXfs,t,a);if(null!=t.v||t.bf)if(t.bf)_T(e,6,kS(t,n,r,0,i));else switch(t.t){case"d":case"n":_T(e,515,function(e,t,n,r){var a=uy(14);return qb(e,t,r,a),tb(n,a),a}(n,r,"d"==t.t?Vg(Yg(t.v)):t.v,i));break;case"b":case"e":_T(e,517,function(e,t,n,r,a,i){var s=uy(8);return qb(e,t,r,s),Mb(n,i,s),s}(n,r,t.v,i,0,t.t));break;case"s":case"str":if(a.bookSST)_T(e,253,function(e,t,n,r){var a=uy(10);return qb(e,t,r,a),a.write_shift(4,n),a}(n,r,MS(a.Strings,t.v,a.revStrings),i));else _T(e,516,function(e,t,n,r,a){var i=!a||8==a.biff,s=uy(+i+8+(1+i)*n.length);return qb(e,t,r,s),s.write_shift(2,n.length),i&&s.write_shift(1,1),s.write_shift((1+i)*n.length,n,i?"utf16le":"sbcs"),s}(n,r,(t.v||"").slice(0,255),i,a));break;default:_T(e,513,qb(n,r,i))}else _T(e,513,qb(n,r,i))}function RT(e,t,n){var r,a=hy(),i=n.SheetNames[e],s=n.Sheets[i]||{},o=(n||{}).Workbook||{},l=(o.Sheets||[])[e]||{},c=Array.isArray(s),u=8==t.biff,h="",d=[],f=_y(s["!ref"]||"A1"),p=u?65536:16384;if(f.e.c>255||f.e.r>=p){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");f.e.c=Math.min(f.e.c,255),f.e.r=Math.min(f.e.c,p-1)}_T(a,2057,Xb(0,16,t)),_T(a,13,Lb(1)),_T(a,12,Lb(100)),_T(a,15,jb(!0)),_T(a,17,jb(!1)),_T(a,16,tb(.001)),_T(a,95,jb(!0)),_T(a,42,jb(!1)),_T(a,43,jb(!1)),_T(a,130,Lb(1)),_T(a,128,function(e){var t=uy(8);return t.write_shift(4,0),t.write_shift(2,e[0]?e[0]+1:0),t.write_shift(2,e[1]?e[1]+1:0),t}([0,0])),_T(a,131,jb(!1)),_T(a,132,jb(!1)),u&&NT(a,s["!cols"]),_T(a,512,function(e,t){var n=8!=t.biff&&t.biff?2:4,r=uy(2*n+6);return r.write_shift(n,e.s.r),r.write_shift(n,e.e.r+1),r.write_shift(2,e.s.c),r.write_shift(2,e.e.c+1),r.write_shift(2,0),r}(f,t)),u&&(s["!links"]=[]);for(var m=f.s.r;m<=f.e.r;++m){h=yy(m);for(var g=f.s.c;g<=f.e.c;++g){m===f.s.r&&(d[g]=wy(g)),r=d[g]+h;var v=c?(s[m]||[])[g]:s[r];v&&(OT(a,v,m,g,t),u&&v.l&&s["!links"].push([r,v.l]))}}var y=l.CodeName||l.name||i;return u&&_T(a,574,function(e){var t=uy(18),n=1718;return e&&e.RTL&&(n|=64),t.write_shift(2,n),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}((o.Views||[])[0])),u&&(s["!merges"]||[]).length&&_T(a,229,function(e){var t=uy(2+8*e.length);t.write_shift(2,e.length);for(var n=0;n<e.length;++n)Qb(e[n],t);return t}(s["!merges"])),u&&function(e,t){for(var n=0;n<t["!links"].length;++n){var r=t["!links"][n];_T(e,440,tw(r)),r[1].Tooltip&&_T(e,2048,nw(r))}delete t["!links"]}(a,s),_T(a,442,Hb(y)),u&&function(e,t){var n=uy(19);n.write_shift(4,2151),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(2,3),n.write_shift(1,1),n.write_shift(4,0),_T(e,2151,n),(n=uy(39)).write_shift(4,2152),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(2,3),n.write_shift(1,0),n.write_shift(4,0),n.write_shift(2,1),n.write_shift(4,4),n.write_shift(2,0),Qb(_y(t["!ref"]||"A1"),n),n.write_shift(4,4),_T(e,2152,n)}(a,s),_T(a,10),a.end()}function DT(e,t,n){var r=hy(),a=(e||{}).Workbook||{},i=a.Sheets||[],s=a.WBProps||{},o=8==n.biff,l=5==n.biff;(_T(r,2057,Xb(0,5,n)),"xla"==n.bookType&&_T(r,135),_T(r,225,o?Lb(1200):null),_T(r,193,function(e,t){t||(t=uy(e));for(var n=0;n<e;++n)t.write_shift(1,0);return t}(2)),l&&_T(r,191),l&&_T(r,192),_T(r,226),_T(r,92,function(e,t){var n=!t||8==t.biff,r=uy(n?112:54);for(r.write_shift(8==t.biff?2:1,7),n&&r.write_shift(1,0),r.write_shift(4,859007059),r.write_shift(4,5458548|(n?0:536870912));r.l<r.length;)r.write_shift(1,n?0:32);return r}(0,n)),_T(r,66,Lb(o?1200:1252)),o&&_T(r,353,Lb(0)),o&&_T(r,448),_T(r,317,function(e){for(var t=uy(2*e),n=0;n<e;++n)t.write_shift(2,n+1);return t}(e.SheetNames.length)),o&&e.vbaraw&&_T(r,211),o&&e.vbaraw)&&_T(r,442,Hb(s.CodeName||"ThisWorkbook"));_T(r,156,Lb(17)),_T(r,25,jb(!1)),_T(r,18,jb(!1)),_T(r,19,Lb(0)),o&&_T(r,431,jb(!1)),o&&_T(r,444,Lb(0)),_T(r,61,function(){var e=uy(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}()),_T(r,64,jb(!1)),_T(r,141,Lb(0)),_T(r,34,jb("true"==function(e){return e.Workbook&&e.Workbook.WBProps&&dv(e.Workbook.WBProps.date1904)?"true":"false"}(e))),_T(r,14,jb(!0)),o&&_T(r,439,jb(!1)),_T(r,218,Lb(0)),IT(r,0,n),function(e,t,n){t&&[[5,8],[23,26],[41,44],[50,392]].forEach((function(r){for(var a=r[0];a<=r[1];++a)null!=t[a]&&_T(e,1054,$b(a,t[a],n))}))}(r,e.SSF,n),function(e,t){for(var n=0;n<16;++n)_T(e,224,Zb({numFmtId:0,style:!0},0,t));t.cellXfs.forEach((function(n){_T(e,224,Zb(n,0,t))}))}(r,n),o&&_T(r,352,jb(!1));var c,u=r.end(),h=hy();o&&_T(h,140,(c||(c=uy(4)),c.write_shift(2,1),c.write_shift(2,1),c)),o&&n.Strings&&function(e,t,n,r){var a=r||(n||[]).length||0;if(a<=8224)return _T(e,t,n,a);var i=t;if(!isNaN(i)){for(var s=n.parts||[],o=0,l=0,c=0;c+(s[o]||8224)<=8224;)c+=s[o]||8224,o++;var u=e.next(4);for(u.write_shift(2,i),u.write_shift(2,c),e.push(n.slice(l,l+c)),l+=c;l<a;){for((u=e.next(4)).write_shift(2,60),c=0;c+(s[o]||8224)<=8224;)c+=s[o]||8224,o++;u.write_shift(2,c),e.push(n.slice(l,l+c)),l+=c}}}(h,252,function(e,t){var n=uy(8);n.write_shift(4,e.Count),n.write_shift(4,e.Unique);for(var r=[],a=0;a<e.length;++a)r[a]=Ub(e[a]);var i=Pm([n].concat(r));return i.parts=[n.length].concat(r.map((function(e){return e.length}))),i}(n.Strings)),_T(h,10);var d=h.end(),f=hy(),p=0,m=0;for(m=0;m<e.SheetNames.length;++m)p+=(o?12:11)+(o?2:1)*e.SheetNames[m].length;var g=u.length+p+d.length;for(m=0;m<e.SheetNames.length;++m){_T(f,133,Jb({pos:g,hs:(i[m]||{}).Hidden||0,dt:0,name:e.SheetNames[m]},n)),g+=t[m].length}var v=f.end();if(p!=v.length)throw new Error("BS8 "+p+" != "+v.length);var y=[];return u.length&&y.push(u),v.length&&y.push(v),d.length&&y.push(d),Pm(y)}function jT(e,t){for(var n=0;n<=e.SheetNames.length;++n){var r=e.Sheets[e.SheetNames[n]];if(r&&r["!ref"])Ey(r["!ref"]).e.c>255&&"undefined"!=typeof console&&console.error&&console.error("Worksheet '"+e.SheetNames[n]+"' extends beyond column IV (255).  Data may be lost.")}var a=t||{};switch(a.biff||2){case 8:case 5:return function(e,t){var n=t||{},r=[];e&&!e.SSF&&(e.SSF=Xg(Km)),e&&e.SSF&&(Cg(),kg(e.SSF),n.revssf=Fg(e.SSF),n.revssf[e.SSF[65535]]=0,n.ssf=e.SSF),n.Strings=[],n.Strings.Count=0,n.Strings.Unique=0,uE(n),n.cellXfs=[],VS(n.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var a=0;a<e.SheetNames.length;++a)r[r.length]=RT(a,n,e);return r.unshift(DT(e,r,n)),Pm(r)}(e,t);case 4:case 3:case 2:return CT(e,t)}throw new Error("invalid type "+a.bookType+" for BIFF")}function PT(e,t,n,r){for(var a=e["!merges"]||[],i=[],s=t.s.c;s<=t.e.c;++s){for(var o=0,l=0,c=0;c<a.length;++c)if(!(a[c].s.r>n||a[c].s.c>s)&&!(a[c].e.r<n||a[c].e.c<s)){if(a[c].s.r<n||a[c].s.c<s){o=-1;break}o=a[c].e.r-a[c].s.r+1,l=a[c].e.c-a[c].s.c+1;break}if(!(o<0)){var u=Ty({r:n,c:s}),h=r.dense?(e[n]||[])[s]:e[u],d=h&&null!=h.v&&(h.h||hv(h.w||(ky(h),h.w)||""))||"",f={};o>1&&(f.rowspan=o),l>1&&(f.colspan=l),r.editable?d='<span contenteditable="true">'+d+"</span>":h&&(f["data-t"]=h&&h.t||"z",null!=h.v&&(f["data-v"]=h.v),null!=h.z&&(f["data-z"]=h.z),h.l&&"#"!=(h.l.Target||"#").charAt(0)&&(d='<a href="'+h.l.Target+'">'+d+"</a>")),f.id=(r.id||"sjs")+"-"+u,i.push(Ev("td",d,f))}}return"<tr>"+i.join("")+"</tr>"}var LT='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',MT="</body></html>";function FT(e,t,n){return[].join("")+"<table"+(n&&n.id?' id="'+n.id+'"':"")+">"}function UT(e,t){var n=t||{},r=null!=n.header?n.header:LT,a=null!=n.footer?n.footer:MT,i=[r],s=Ey(e["!ref"]);n.dense=Array.isArray(e),i.push(FT(0,0,n));for(var o=s.s.r;o<=s.e.r;++o)i.push(PT(e,s,o,n));return i.push("</table>"+a),i.join("")}function VT(e,t,n){var r=n||{};null!=xm&&(r.dense=xm);var a=0,i=0;if(null!=r.origin)if("number"==typeof r.origin)a=r.origin;else{var s="string"==typeof r.origin?Sy(r.origin):r.origin;a=s.r,i=s.c}var o=t.getElementsByTagName("tr"),l=Math.min(r.sheetRows||1e7,o.length),c={s:{r:0,c:0},e:{r:a,c:i}};if(e["!ref"]){var u=Ey(e["!ref"]);c.s.r=Math.min(c.s.r,u.s.r),c.s.c=Math.min(c.s.c,u.s.c),c.e.r=Math.max(c.e.r,u.e.r),c.e.c=Math.max(c.e.c,u.e.c),-1==a&&(c.e.r=a=u.e.r+1)}var h=[],d=0,f=e["!rows"]||(e["!rows"]=[]),p=0,m=0,g=0,v=0,y=0,b=0;for(e["!cols"]||(e["!cols"]=[]);p<o.length&&m<l;++p){var w=o[p];if(zT(w)){if(r.display)continue;f[m]={hidden:!0}}var S=w.children;for(g=v=0;g<S.length;++g){var T=S[g];if(!r.display||!zT(T)){var E=T.hasAttribute("data-v")?T.getAttribute("data-v"):T.hasAttribute("v")?T.getAttribute("v"):bv(T.innerHTML),x=T.getAttribute("data-z")||T.getAttribute("z");for(d=0;d<h.length;++d){var _=h[d];_.s.c==v+i&&_.s.r<m+a&&m+a<=_.e.r&&(v=_.e.c+1-i,d=-1)}b=+T.getAttribute("colspan")||1,((y=+T.getAttribute("rowspan")||1)>1||b>1)&&h.push({s:{r:m+a,c:v+i},e:{r:m+a+(y||1)-1,c:v+i+(b||1)-1}});var A={t:"s",v:E},k=T.getAttribute("data-t")||T.getAttribute("t")||"";null!=E&&(0==E.length?A.t=k||"z":r.raw||0==E.trim().length||"s"==k||("TRUE"===E?A={t:"b",v:!0}:"FALSE"===E?A={t:"b",v:!1}:isNaN($g(E))?isNaN(ev(E).getDate())||(A={t:"d",v:Yg(E)},r.cellDates||(A={t:"n",v:Vg(A.v)}),A.z=r.dateNF||Km[14]):A={t:"n",v:$g(E)})),void 0===A.z&&null!=x&&(A.z=x);var C="",I=T.getElementsByTagName("A");if(I&&I.length)for(var N=0;N<I.length&&(!I[N].hasAttribute("href")||"#"==(C=I[N].getAttribute("href")).charAt(0));++N);C&&"#"!=C.charAt(0)&&(A.l={Target:C}),r.dense?(e[m+a]||(e[m+a]=[]),e[m+a][v+i]=A):e[Ty({c:v+i,r:m+a})]=A,c.e.c<v+i&&(c.e.c=v+i),v+=b}}++m}return h.length&&(e["!merges"]=(e["!merges"]||[]).concat(h)),c.e.r=Math.max(c.e.r,m-1+a),e["!ref"]=xy(c),m>=l&&(e["!fullref"]=xy((c.e.r=o.length-p+m-1+a,c))),e}function BT(e,t){return VT((t||{}).dense?[]:{},e,t)}function zT(e){var t="",n=function(e){return e.ownerDocument.defaultView&&"function"===typeof e.ownerDocument.defaultView.getComputedStyle?e.ownerDocument.defaultView.getComputedStyle:"function"===typeof getComputedStyle?getComputedStyle:null}(e);return n&&(t=n(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),"none"===t}var HT=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+Tv({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return rv+t}}(),WT=function(){var e="          <table:table-cell />\n",t=function(t,n,r){var a=[];a.push('      <table:table table:name="'+lv(n.SheetNames[r])+'" table:style-name="ta1">\n');var i=0,s=0,o=Ey(t["!ref"]||"A1"),l=t["!merges"]||[],c=0,u=Array.isArray(t);if(t["!cols"])for(s=0;s<=o.e.c;++s)a.push("        <table:table-column"+(t["!cols"][s]?' table:style-name="co'+t["!cols"][s].ods+'"':"")+"></table:table-column>\n");var h="",d=t["!rows"]||[];for(i=0;i<o.s.r;++i)h=d[i]?' table:style-name="ro'+d[i].ods+'"':"",a.push("        <table:table-row"+h+"></table:table-row>\n");for(;i<=o.e.r;++i){for(h=d[i]?' table:style-name="ro'+d[i].ods+'"':"",a.push("        <table:table-row"+h+">\n"),s=0;s<o.s.c;++s)a.push(e);for(;s<=o.e.c;++s){var f=!1,p={},m="";for(c=0;c!=l.length;++c)if(!(l[c].s.c>s)&&!(l[c].s.r>i)&&!(l[c].e.c<s)&&!(l[c].e.r<i)){l[c].s.c==s&&l[c].s.r==i||(f=!0),p["table:number-columns-spanned"]=l[c].e.c-l[c].s.c+1,p["table:number-rows-spanned"]=l[c].e.r-l[c].s.r+1;break}if(f)a.push("          <table:covered-table-cell/>\n");else{var g=Ty({r:i,c:s}),v=u?(t[i]||[])[s]:t[g];if(v&&v.f&&(p["table:formula"]=lv(("of:="+v.f.replace($w,"$1[.$2$3$4$5]").replace(/\]:\[/g,":")).replace(/;/g,"|").replace(/,/g,";")),v.F&&v.F.slice(0,g.length)==g)){var y=Ey(v.F);p["table:number-matrix-columns-spanned"]=y.e.c-y.s.c+1,p["table:number-matrix-rows-spanned"]=y.e.r-y.s.r+1}if(v){switch(v.t){case"b":m=v.v?"TRUE":"FALSE",p["office:value-type"]="boolean",p["office:boolean-value"]=v.v?"true":"false";break;case"n":m=v.w||String(v.v||0),p["office:value-type"]="float",p["office:value"]=v.v||0;break;case"s":case"str":m=null==v.v?"":v.v,p["office:value-type"]="string";break;case"d":m=v.w||Yg(v.v).toISOString(),p["office:value-type"]="date",p["office:date-value"]=Yg(v.v).toISOString(),p["table:style-name"]="ce1";break;default:a.push(e);continue}var b=lv(m).replace(/  +/g,(function(e){return'<text:s text:c="'+e.length+'"/>'})).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>");if(v.l&&v.l.Target){var w=v.l.Target;"#"==(w="#"==w.charAt(0)?"#"+w.slice(1).replace(/\./,"!"):w).charAt(0)||w.match(/^\w+:/)||(w="../"+w),b=Ev("text:a",b,{"xlink:href":w.replace(/&/g,"&amp;")})}a.push("          "+Ev("table:table-cell",Ev("text:p",b,{}),p)+"\n")}else a.push(e)}}a.push("        </table:table-row>\n")}return a.push("      </table:table>\n"),a.join("")};return function(e,n){var r=[rv],a=Tv({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),i=Tv({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});"fods"==n.bookType?(r.push("<office:document"+a+i+">\n"),r.push(bb().replace(/office:document-meta/g,"office:meta"))):r.push("<office:document-content"+a+">\n"),function(e,t){e.push(" <office:automatic-styles>\n"),e.push('  <number:date-style style:name="N37" number:automatic-order="true">\n'),e.push('   <number:month number:style="long"/>\n'),e.push("   <number:text>/</number:text>\n"),e.push('   <number:day number:style="long"/>\n'),e.push("   <number:text>/</number:text>\n"),e.push("   <number:year/>\n"),e.push("  </number:date-style>\n");var n=0;t.SheetNames.map((function(e){return t.Sheets[e]})).forEach((function(t){if(t&&t["!cols"])for(var r=0;r<t["!cols"].length;++r)if(t["!cols"][r]){var a=t["!cols"][r];if(null==a.width&&null==a.wpx&&null==a.wch)continue;Ew(a),a.ods=n;var i=t["!cols"][r].wpx+"px";e.push('  <style:style style:name="co'+n+'" style:family="table-column">\n'),e.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+i+'"/>\n'),e.push("  </style:style>\n"),++n}}));var r=0;t.SheetNames.map((function(e){return t.Sheets[e]})).forEach((function(t){if(t&&t["!rows"])for(var n=0;n<t["!rows"].length;++n)if(t["!rows"][n]){t["!rows"][n].ods=r;var a=t["!rows"][n].hpx+"px";e.push('  <style:style style:name="ro'+r+'" style:family="table-row">\n'),e.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+a+'"/>\n'),e.push("  </style:style>\n"),++r}})),e.push('  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">\n'),e.push('   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>\n'),e.push("  </style:style>\n"),e.push('  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>\n'),e.push(" </office:automatic-styles>\n")}(r,e),r.push("  <office:body>\n"),r.push("    <office:spreadsheet>\n");for(var s=0;s!=e.SheetNames.length;++s)r.push(t(e.Sheets[e.SheetNames[s]],e,s));return r.push("    </office:spreadsheet>\n"),r.push("  </office:body>\n"),"fods"==n.bookType?r.push("</office:document>"):r.push("</office:document-content>"),r.join("")}}();function GT(e,t){if("fods"==t.bookType)return WT(e,t);var n=nv(),r="",a=[],i=[];return tv(n,r="mimetype","application/vnd.oasis.opendocument.spreadsheet"),tv(n,r="content.xml",WT(e,t)),a.push([r,"text/xml"]),i.push([r,"ContentFile"]),tv(n,r="styles.xml",HT(e,t)),a.push([r,"text/xml"]),i.push([r,"StylesFile"]),tv(n,r="meta.xml",rv+bb()),a.push([r,"text/xml"]),i.push([r,"MetadataFile"]),tv(n,r="manifest.rdf",function(e){var t,n,r=[rv];r.push('<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">\n');for(var a=0;a!=e.length;++a)r.push(yb(e[a][0],e[a][1])),r.push((t="",n=e[a][0],['  <rdf:Description rdf:about="'+t+'">\n','    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+n+'"/>\n',"  </rdf:Description>\n"].join("")));return r.push(yb("","Document","pkg")),r.push("</rdf:RDF>"),r.join("")}(i)),a.push([r,"application/rdf+xml"]),tv(n,r="META-INF/manifest.xml",function(e){var t=[rv];t.push('<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">\n'),t.push('  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>\n');for(var n=0;n<e.length;++n)t.push('  <manifest:file-entry manifest:full-path="'+e[n][0]+'" manifest:media-type="'+e[n][1]+'"/>\n');return t.push("</manifest:manifest>"),t.join("")}(a)),n}function qT(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function KT(e){return"undefined"!=typeof TextEncoder?(new TextEncoder).encode(e):Rm(yv(e))}function YT(e){var t=e.reduce((function(e,t){return e+t.length}),0),n=new Uint8Array(t),r=0;return e.forEach((function(e){n.set(e,r),r+=e.length})),n}function QT(e,t){var n=t?t[0]:0,r=127&e[n];e:if(e[n++]>=128){if(r|=(127&e[n])<<7,e[n++]<128)break e;if(r|=(127&e[n])<<14,e[n++]<128)break e;if(r|=(127&e[n])<<21,e[n++]<128)break e;if(r+=(127&e[n])*Math.pow(2,28),++n,e[n++]<128)break e;if(r+=(127&e[n])*Math.pow(2,35),++n,e[n++]<128)break e;if(r+=(127&e[n])*Math.pow(2,42),++n,e[n++]<128)break e}return t&&(t[0]=n),r}function XT(e){var t=new Uint8Array(7);t[0]=127&e;var n=1;e:if(e>127){if(t[n-1]|=128,t[n]=e>>7&127,++n,e<=16383)break e;if(t[n-1]|=128,t[n]=e>>14&127,++n,e<=2097151)break e;if(t[n-1]|=128,t[n]=e>>21&127,++n,e<=268435455)break e;if(t[n-1]|=128,t[n]=e/256>>>21&127,++n,e<=34359738367)break e;if(t[n-1]|=128,t[n]=e/65536>>>21&127,++n,e<=4398046511103)break e;t[n-1]|=128,t[n]=e/16777216>>>21&127,++n}return t.slice(0,n)}function JT(e){var t=0,n=127&e[t];e:if(e[t++]>=128){if(n|=(127&e[t])<<7,e[t++]<128)break e;if(n|=(127&e[t])<<14,e[t++]<128)break e;if(n|=(127&e[t])<<21,e[t++]<128)break e;n|=(127&e[t])<<28}return n}function $T(e){for(var t=[],n=[0];n[0]<e.length;){var r,a=n[0],i=QT(e,n),s=7&i,o=0;if(0==(i=Math.floor(i/8)))break;switch(s){case 0:for(var l=n[0];e[n[0]++]>=128;);r=e.slice(l,n[0]);break;case 5:o=4,r=e.slice(n[0],n[0]+o),n[0]+=o;break;case 1:o=8,r=e.slice(n[0],n[0]+o),n[0]+=o;break;case 2:o=QT(e,n),r=e.slice(n[0],n[0]+o),n[0]+=o;break;default:throw new Error("PB Type ".concat(s," for Field ").concat(i," at offset ").concat(a))}var c={data:r,type:s};null==t[i]?t[i]=[c]:t[i].push(c)}return t}function ZT(e){var t=[];return e.forEach((function(e,n){e.forEach((function(e){e.data&&(t.push(XT(8*n+e.type)),2==e.type&&t.push(XT(e.data.length)),t.push(e.data))}))})),YT(t)}function eE(e){for(var t,n=[],r=[0];r[0]<e.length;){var a=QT(e,r),i=$T(e.slice(r[0],r[0]+a));r[0]+=a;var s={id:JT(i[1][0].data),messages:[]};i[2].forEach((function(t){var n=$T(t.data),a=JT(n[3][0].data);s.messages.push({meta:n,data:e.slice(r[0],r[0]+a)}),r[0]+=a})),(null==(t=i[3])?void 0:t[0])&&(s.merge=JT(i[3][0].data)>>>0>0),n.push(s)}return n}function tE(e){var t=[];return e.forEach((function(e){var n=[];n[1]=[{data:XT(e.id),type:0}],n[2]=[],null!=e.merge&&(n[3]=[{data:XT(+!!e.merge),type:0}]);var r=[];e.messages.forEach((function(e){r.push(e.data),e.meta[3]=[{type:0,data:XT(e.data.length)}],n[2].push({data:ZT(e.meta),type:2})}));var a=ZT(n);t.push(XT(a.length)),t.push(a),r.forEach((function(e){return t.push(e)}))})),YT(t)}function nE(e,t){if(0!=e)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var n=[0],r=QT(t,n),a=[];n[0]<t.length;){var i=3&t[n[0]];if(0!=i){var s=0,o=0;if(1==i?(o=4+(t[n[0]]>>2&7),s=(224&t[n[0]++])<<3,s|=t[n[0]++]):(o=1+(t[n[0]++]>>2),2==i?(s=t[n[0]]|t[n[0]+1]<<8,n[0]+=2):(s=(t[n[0]]|t[n[0]+1]<<8|t[n[0]+2]<<16|t[n[0]+3]<<24)>>>0,n[0]+=4)),a=[YT(a)],0==s)throw new Error("Invalid offset 0");if(s>a[0].length)throw new Error("Invalid offset beyond length");if(o>=s)for(a.push(a[0].slice(-s)),o-=s;o>=a[a.length-1].length;)a.push(a[a.length-1]),o-=a[a.length-1].length;a.push(a[0].slice(-s,-s+o))}else{var l=t[n[0]++]>>2;if(l<60)++l;else{var c=l-59;l=t[n[0]],c>1&&(l|=t[n[0]+1]<<8),c>2&&(l|=t[n[0]+2]<<16),c>3&&(l|=t[n[0]+3]<<24),l>>>=0,l++,n[0]+=c}a.push(t.slice(n[0],n[0]+l)),n[0]+=l}}var u=YT(a);if(u.length!=r)throw new Error("Unexpected length: ".concat(u.length," != ").concat(r));return u}function rE(e){for(var t=[],n=0;n<e.length;){var r=e[n++],a=e[n]|e[n+1]<<8|e[n+2]<<16;n+=3,t.push(nE(r,e.slice(n,n+a))),n+=a}if(n!==e.length)throw new Error("data is not a valid framed stream!");return YT(t)}function aE(e){for(var t=[],n=0;n<e.length;){var r=Math.min(e.length-n,268435455),a=new Uint8Array(4);t.push(a);var i=XT(r),s=i.length;t.push(i),r<=60?(s++,t.push(new Uint8Array([r-1<<2]))):r<=256?(s+=2,t.push(new Uint8Array([240,r-1&255]))):r<=65536?(s+=3,t.push(new Uint8Array([244,r-1&255,r-1>>8&255]))):r<=16777216?(s+=4,t.push(new Uint8Array([248,r-1&255,r-1>>8&255,r-1>>16&255]))):r<=4294967296&&(s+=5,t.push(new Uint8Array([252,r-1&255,r-1>>8&255,r-1>>16&255,r-1>>>24&255]))),t.push(e.slice(n,n+r)),s+=r,a[0]=0,a[1]=255&s,a[2]=s>>8&255,a[3]=s>>16&255,n+=r}return YT(t)}function iE(e,t){var n=new Uint8Array(32),r=qT(n),a=12,i=0;switch(n[0]=5,e.t){case"n":n[1]=2,function(e,t,n){var r=Math.floor(0==n?0:Math.LOG10E*Math.log(Math.abs(n)))+6176-20,a=n/Math.pow(10,r-6176);e[t+15]|=r>>7,e[t+14]|=(127&r)<<1;for(var i=0;a>=1;++i,a/=256)e[t+i]=255&a;e[t+15]|=n>=0?0:128}(n,a,e.v),i|=1,a+=16;break;case"b":n[1]=6,r.setFloat64(a,e.v?1:0,!0),i|=2,a+=8;break;case"s":if(-1==t.indexOf(e.v))throw new Error("Value ".concat(e.v," missing from SST!"));n[1]=3,r.setUint32(a,t.indexOf(e.v),!0),i|=8,a+=4;break;default:throw"unsupported cell type "+e.t}return r.setUint32(8,i,!0),n.slice(0,a)}function sE(e,t){var n=new Uint8Array(32),r=qT(n),a=12,i=0;switch(n[0]=3,e.t){case"n":n[2]=2,r.setFloat64(a,e.v,!0),i|=32,a+=8;break;case"b":n[2]=6,r.setFloat64(a,e.v?1:0,!0),i|=32,a+=8;break;case"s":if(-1==t.indexOf(e.v))throw new Error("Value ".concat(e.v," missing from SST!"));n[2]=3,r.setUint32(a,t.indexOf(e.v),!0),i|=16,a+=4;break;default:throw"unsupported cell type "+e.t}return r.setUint32(4,i,!0),n.slice(0,a)}function oE(e){return QT($T(e)[1][0].data)}function lE(e,t,n){var r,a,i,s;if(!(null==(r=e[6])?void 0:r[0])||!(null==(a=e[7])?void 0:a[0]))throw"Mutation only works on post-BNC storages!";if((null==(s=null==(i=e[8])?void 0:i[0])?void 0:s.data)&&JT(e[8][0].data)>0||!1)throw"Math only works with normal offsets";for(var o=0,l=qT(e[7][0].data),c=0,u=[],h=qT(e[4][0].data),d=0,f=[],p=0;p<t.length;++p)if(null!=t[p]){var m,g;switch(l.setUint16(2*p,c,!0),h.setUint16(2*p,d,!0),typeof t[p]){case"string":m=iE({t:"s",v:t[p]},n),g=sE({t:"s",v:t[p]},n);break;case"number":m=iE({t:"n",v:t[p]},n),g=sE({t:"n",v:t[p]},n);break;case"boolean":m=iE({t:"b",v:t[p]},n),g=sE({t:"b",v:t[p]},n);break;default:throw new Error("Unsupported value "+t[p])}u.push(m),c+=m.length,f.push(g),d+=g.length,++o}else l.setUint16(2*p,65535,!0),h.setUint16(2*p,65535);for(e[2][0].data=XT(o);p<e[7][0].data.length/2;++p)l.setUint16(2*p,65535,!0),h.setUint16(2*p,65535,!0);return e[6][0].data=YT(u),e[3][0].data=YT(f),o}function cE(e){return function(t){for(var n=0;n!=e.length;++n){var r=e[n];void 0===t[r[0]]&&(t[r[0]]=r[1]),"n"===r[2]&&(t[r[0]]=Number(t[r[0]]))}}}function uE(e){cE([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function hE(e,t){return"ods"==t.bookType?GT(e,t):"numbers"==t.bookType?function(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var n=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var r=Ey(n["!ref"]);r.s.r=r.s.c=0;var a=!1;r.e.c>9&&(a=!0,r.e.c=9),r.e.r>49&&(a=!0,r.e.r=49),a&&console.error("The Numbers writer is currently limited to ".concat(xy(r)));var i=TE(n,{range:r,header:1}),s=["~Sh33tJ5~"];i.forEach((function(e){return e.forEach((function(e){"string"==typeof e&&s.push(e)}))}));var o={},l=[],c=Og.read(t.numbers,{type:"base64"});c.FileIndex.map((function(e,t){return[e,c.FullPaths[t]]})).forEach((function(e){var t=e[0],n=e[1];2==t.type&&t.name.match(/\.iwa/)&&eE(rE(t.content)).forEach((function(e){l.push(e.id),o[e.id]={deps:[],location:n,type:JT(e.messages[0].meta[1][0].data)}}))})),l.sort((function(e,t){return e-t}));var u=l.filter((function(e){return e>1})).map((function(e){return[e,XT(e)]}));c.FileIndex.map((function(e,t){return[e,c.FullPaths[t]]})).forEach((function(e){var t=e[0];e[1],t.name.match(/\.iwa/)&&eE(rE(t.content)).forEach((function(e){e.messages.forEach((function(t){u.forEach((function(t){e.messages.some((function(e){return 11006!=JT(e.meta[1][0].data)&&function(e,t){e:for(var n=0;n<=e.length-t.length;++n){for(var r=0;r<t.length;++r)if(e[n+r]!=t[r])continue e;return!0}return!1}(e.data,t[1])}))&&o[t[0]].deps.push(e.id)}))}))}))}));for(var h,d=Og.find(c,o[1].location),f=eE(rE(d.content)),p=0;p<f.length;++p){var m=f[p];1==m.id&&(h=m)}var g=oE($T(h.messages[0].data)[1][0].data);for(f=eE(rE((d=Og.find(c,o[g].location)).content)),p=0;p<f.length;++p)(m=f[p]).id==g&&(h=m);for(g=oE($T(h.messages[0].data)[2][0].data),f=eE(rE((d=Og.find(c,o[g].location)).content)),p=0;p<f.length;++p)(m=f[p]).id==g&&(h=m);for(g=oE($T(h.messages[0].data)[2][0].data),f=eE(rE((d=Og.find(c,o[g].location)).content)),p=0;p<f.length;++p)(m=f[p]).id==g&&(h=m);var v=$T(h.messages[0].data);v[6][0].data=XT(r.e.r+1),v[7][0].data=XT(r.e.c+1);for(var y=oE(v[46][0].data),b=Og.find(c,o[y].location),w=eE(rE(b.content)),S=0;S<w.length&&w[S].id!=y;++S);if(w[S].id!=y)throw"Bad ColumnRowUIDMapArchive";var T=$T(w[S].messages[0].data);T[1]=[],T[2]=[],T[3]=[];for(var E=0;E<=r.e.c;++E){var x=[];x[1]=x[2]=[{type:0,data:XT(E+420690)}],T[1].push({type:2,data:ZT(x)}),T[2].push({type:0,data:XT(E)}),T[3].push({type:0,data:XT(E)})}T[4]=[],T[5]=[],T[6]=[];for(var _=0;_<=r.e.r;++_)(x=[])[1]=x[2]=[{type:0,data:XT(_+726270)}],T[4].push({type:2,data:ZT(x)}),T[5].push({type:0,data:XT(_)}),T[6].push({type:0,data:XT(_)});w[S].messages[0].data=ZT(T),b.content=aE(tE(w)),b.size=b.content.length,delete v[46];var A=$T(v[4][0].data);A[7][0].data=XT(r.e.r+1);var k=oE($T(A[1][0].data)[2][0].data);if((w=eE(rE((b=Og.find(c,o[k].location)).content)))[0].id!=k)throw"Bad HeaderStorageBucket";var C=$T(w[0].messages[0].data);for(_=0;_<i.length;++_){var I=$T(C[2][0].data);I[1][0].data=XT(_),I[4][0].data=XT(i[_].length),C[2][_]={type:C[2][0].type,data:ZT(I)}}w[0].messages[0].data=ZT(C),b.content=aE(tE(w)),b.size=b.content.length;var N=oE(A[2][0].data);if((w=eE(rE((b=Og.find(c,o[N].location)).content)))[0].id!=N)throw"Bad HeaderStorageBucket";for(C=$T(w[0].messages[0].data),E=0;E<=r.e.c;++E)(I=$T(C[2][0].data))[1][0].data=XT(E),I[4][0].data=XT(r.e.r+1),C[2][E]={type:C[2][0].type,data:ZT(I)};w[0].messages[0].data=ZT(C),b.content=aE(tE(w)),b.size=b.content.length;var O=oE(A[4][0].data);!function(){for(var e,t=Og.find(c,o[O].location),n=eE(rE(t.content)),r=0;r<n.length;++r){var a=n[r];a.id==O&&(e=a)}var i=$T(e.messages[0].data);i[3]=[];var l=[];s.forEach((function(e,t){l[1]=[{type:0,data:XT(t)}],l[2]=[{type:0,data:XT(1)}],l[3]=[{type:2,data:KT(e)}],i[3].push({type:2,data:ZT(l)})})),e.messages[0].data=ZT(i);var u=aE(tE(n));t.content=u,t.size=t.content.length}();var R=$T(A[3][0].data),D=R[1][0];delete R[2];var j=$T(D.data),P=oE(j[2][0].data);!function(){for(var e,t=Og.find(c,o[P].location),n=eE(rE(t.content)),a=0;a<n.length;++a){var l=n[a];l.id==P&&(e=l)}var u=$T(e.messages[0].data);delete u[6],delete R[7];var h=new Uint8Array(u[5][0].data);u[5]=[];for(var d=0,f=0;f<=r.e.r;++f){var p=$T(h);d+=lE(p,i[f],s),p[1][0].data=XT(f),u[5].push({data:ZT(p),type:2})}u[1]=[{type:0,data:XT(r.e.c+1)}],u[2]=[{type:0,data:XT(r.e.r+1)}],u[3]=[{type:0,data:XT(d)}],u[4]=[{type:0,data:XT(r.e.r+1)}],e.messages[0].data=ZT(u);var m=aE(tE(n));t.content=m,t.size=t.content.length}(),D.data=ZT(j),A[3][0].data=ZT(R),v[4][0].data=ZT(A),h.messages[0].data=ZT(v);var L=aE(tE(f));return d.content=L,d.size=d.content.length,c}(e,t):"xlsb"==t.bookType?function(e,t){Ww=1024,e&&!e.SSF&&(e.SSF=Xg(Km));e&&e.SSF&&(Cg(),kg(e.SSF),t.revssf=Fg(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF);t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,LS?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var n="xlsb"==t.bookType?"bin":"xml",r=Xw.indexOf(t.bookType)>-1,a={workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""};uE(t=t||{});var i=nv(),s="",o=0;t.cellXfs=[],VS(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});if(tv(i,s="docProps/core.xml",Tb(e.Props,t)),a.coreprops.push(s),vb(t.rels,2,s,pb.CORE_PROPS),s="docProps/app.xml",e.Props&&e.Props.SheetNames);else if(e.Workbook&&e.Workbook.Sheets){for(var l=[],c=0;c<e.SheetNames.length;++c)2!=(e.Workbook.Sheets[c]||{}).Hidden&&l.push(e.SheetNames[c]);e.Props.SheetNames=l}else e.Props.SheetNames=e.SheetNames;e.Props.Worksheets=e.Props.SheetNames.length,tv(i,s,_b(e.Props)),a.extprops.push(s),vb(t.rels,3,s,pb.EXT_PROPS),e.Custprops!==e.Props&&Pg(e.Custprops||{}).length>0&&(tv(i,s="docProps/custom.xml",Ab(e.Custprops)),a.custprops.push(s),vb(t.rels,4,s,pb.CUST_PROPS));for(o=1;o<=e.SheetNames.length;++o){var u={"!id":{}},h=e.Sheets[e.SheetNames[o-1]];(h||{})["!type"];if(tv(i,s="xl/worksheets/sheet"+o+"."+n,pT(o-1,s,t,e,u)),a.sheets.push(s),vb(t.wbrels,-1,"worksheets/sheet"+o+"."+n,pb.WS[0]),h){var d=h["!comments"],f=!1,p="";d&&d.length>0&&(tv(i,p="xl/comments"+o+"."+n,mT(d,p,t)),a.comments.push(p),vb(u,-1,"../comments"+o+"."+n,pb.CMNT),f=!0),h["!legacy"]&&f&&tv(i,"xl/drawings/vmlDrawing"+o+".vml",Gw(o,h["!comments"])),delete h["!comments"],delete h["!legacy"]}u["!id"].rId1&&tv(i,mb(s),gb(u))}null!=t.Strings&&t.Strings.length>0&&(tv(i,s="xl/sharedStrings."+n,function(e,t,n){return(".bin"===t.slice(-4)?fw:hw)(e,n)}(t.Strings,s,t)),a.strs.push(s),vb(t.wbrels,-1,"sharedStrings."+n,pb.SST));tv(i,s="xl/workbook."+n,function(e,t,n){return(".bin"===t.slice(-4)?fT:hT)(e,n)}(e,s,t)),a.workbooks.push(s),vb(t.rels,1,s,pb.WB),tv(i,s="xl/theme/theme1.xml",Bw(e.Themes,t)),a.themes.push(s),vb(t.wbrels,-1,"theme/theme1.xml",pb.THEME),tv(i,s="xl/styles."+n,function(e,t,n){return(".bin"===t.slice(-4)?Vw:kw)(e,n)}(e,s,t)),a.styles.push(s),vb(t.wbrels,-1,"styles."+n,pb.STY),e.vbaraw&&r&&(tv(i,s="xl/vbaProject.bin",e.vbaraw),a.vba.push(s),vb(t.wbrels,-1,"vbaProject.bin",pb.VBA));return tv(i,s="xl/metadata."+n,function(e){return(".bin"===e.slice(-4)?zw:Hw)()}(s)),a.metadata.push(s),vb(t.wbrels,-1,"metadata."+n,pb.XLMETA),tv(i,"[Content_Types].xml",fb(a,t)),tv(i,"_rels/.rels",gb(t.rels)),tv(i,"xl/_rels/workbook."+n+".rels",gb(t.wbrels)),delete t.revssf,delete t.ssf,i}(e,t):dE(e,t)}function dE(e,t){Ww=1024,e&&!e.SSF&&(e.SSF=Xg(Km)),e&&e.SSF&&(Cg(),kg(e.SSF),t.revssf=Fg(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,LS?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var n="xml",r=Xw.indexOf(t.bookType)>-1,a={workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""};uE(t=t||{});var i=nv(),s="",o=0;if(t.cellXfs=[],VS(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),tv(i,s="docProps/core.xml",Tb(e.Props,t)),a.coreprops.push(s),vb(t.rels,2,s,pb.CORE_PROPS),s="docProps/app.xml",e.Props&&e.Props.SheetNames);else if(e.Workbook&&e.Workbook.Sheets){for(var l=[],c=0;c<e.SheetNames.length;++c)2!=(e.Workbook.Sheets[c]||{}).Hidden&&l.push(e.SheetNames[c]);e.Props.SheetNames=l}else e.Props.SheetNames=e.SheetNames;e.Props.Worksheets=e.Props.SheetNames.length,tv(i,s,_b(e.Props)),a.extprops.push(s),vb(t.rels,3,s,pb.EXT_PROPS),e.Custprops!==e.Props&&Pg(e.Custprops||{}).length>0&&(tv(i,s="docProps/custom.xml",Ab(e.Custprops)),a.custprops.push(s),vb(t.rels,4,s,pb.CUST_PROPS));var u=["SheetJ5"];for(t.tcid=0,o=1;o<=e.SheetNames.length;++o){var h={"!id":{}},d=e.Sheets[e.SheetNames[o-1]];(d||{})["!type"];if(tv(i,s="xl/worksheets/sheet"+o+"."+n,GS(o-1,t,e,h)),a.sheets.push(s),vb(t.wbrels,-1,"worksheets/sheet"+o+"."+n,pb.WS[0]),d){var f=d["!comments"],p=!1,m="";if(f&&f.length>0){var g=!1;f.forEach((function(e){e[1].forEach((function(e){1==e.T&&(g=!0)}))})),g&&(tv(i,m="xl/threadedComments/threadedComment"+o+"."+n,Kw(f,u,t)),a.threadedcomments.push(m),vb(h,-1,"../threadedComments/threadedComment"+o+"."+n,pb.TCMNT)),tv(i,m="xl/comments"+o+"."+n,qw(f)),a.comments.push(m),vb(h,-1,"../comments"+o+"."+n,pb.CMNT),p=!0}d["!legacy"]&&p&&tv(i,"xl/drawings/vmlDrawing"+o+".vml",Gw(o,d["!comments"])),delete d["!comments"],delete d["!legacy"]}h["!id"].rId1&&tv(i,mb(s),gb(h))}return null!=t.Strings&&t.Strings.length>0&&(tv(i,s="xl/sharedStrings."+n,hw(t.Strings,t)),a.strs.push(s),vb(t.wbrels,-1,"sharedStrings."+n,pb.SST)),tv(i,s="xl/workbook."+n,hT(e)),a.workbooks.push(s),vb(t.rels,1,s,pb.WB),tv(i,s="xl/theme/theme1.xml",Bw(e.Themes,t)),a.themes.push(s),vb(t.wbrels,-1,"theme/theme1.xml",pb.THEME),tv(i,s="xl/styles."+n,kw(e,t)),a.styles.push(s),vb(t.wbrels,-1,"styles."+n,pb.STY),e.vbaraw&&r&&(tv(i,s="xl/vbaProject.bin",e.vbaraw),a.vba.push(s),vb(t.wbrels,-1,"vbaProject.bin",pb.VBA)),tv(i,s="xl/metadata."+n,Hw()),a.metadata.push(s),vb(t.wbrels,-1,"metadata."+n,pb.XLMETA),u.length>1&&(tv(i,s="xl/persons/person.xml",function(e){var t=[rv,Ev("personList",null,{xmlns:_v.TCMNT,"xmlns:x":Av[0]}).replace(/[\/]>/,">")];return e.forEach((function(e,n){t.push(Ev("person",null,{displayName:e,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:e,providerId:"None"}))})),t.push("</personList>"),t.join("")}(u)),a.people.push(s),vb(t.wbrels,-1,"persons/person.xml",pb.PEOPLE)),tv(i,"[Content_Types].xml",fb(a,t)),tv(i,"_rels/.rels",gb(t.rels)),tv(i,"xl/_rels/workbook.xml.rels",gb(t.wbrels)),delete t.revssf,delete t.ssf,i}function fE(e,t){var n="";switch((t||{}).type||"base64"){case"buffer":case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":n=km(e.slice(0,12));break;case"binary":n=e;break;default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[n.charCodeAt(0),n.charCodeAt(1),n.charCodeAt(2),n.charCodeAt(3),n.charCodeAt(4),n.charCodeAt(5),n.charCodeAt(6),n.charCodeAt(7)]}function pE(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return jg(t.file,Og.write(e,{type:Cm?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return Og.write(e,t)}function mE(e,t){var n={},r=Cm?"nodebuffer":"undefined"!==typeof Uint8Array?"array":"string";if(t.compression&&(n.compression="DEFLATE"),t.password)n.type=r;else switch(t.type){case"base64":n.type="base64";break;case"binary":n.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":n.type=r;break;default:throw new Error("Unrecognized type "+t.type)}var a=e.FullPaths?Og.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[n.type]||n.type,compression:!!t.compression}):e.generate(n);if("undefined"!==typeof Deno&&"string"==typeof a){if("binary"==t.type||"base64"==t.type)return a;a=new Uint8Array(Dm(a))}return t.password&&"undefined"!==typeof encrypt_agile?pE(encrypt_agile(a,t.password),t):"file"===t.type?jg(t.file,a):"string"==t.type?vv(a):a}function gE(e,t,n){n||(n="");var r=n+e;switch(t.type){case"base64":return Am(yv(r));case"binary":return yv(r);case"string":return e;case"file":return jg(t.file,r,"utf8");case"buffer":return Cm?Im(r,"utf8"):"undefined"!==typeof TextEncoder?(new TextEncoder).encode(r):gE(r,{type:"binary"}).split("").map((function(e){return e.charCodeAt(0)}))}throw new Error("Unrecognized type "+t.type)}function vE(e,t){switch(t.type){case"string":case"base64":case"binary":for(var n="",r=0;r<e.length;++r)n+=String.fromCharCode(e[r]);return"base64"==t.type?Am(n):"string"==t.type?vv(n):n;case"file":return jg(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function yE(e,t){bm(),uT(e);var n=Xg(t||{});if(n.cellStyles&&(n.cellNF=!0,n.sheetStubs=!0),"array"==n.type){n.type="binary";var r=yE(e,n);return n.type="array",Dm(r)}var a=0;if(n.sheet&&(a="number"==typeof n.sheet?n.sheet:e.SheetNames.indexOf(n.sheet),!e.SheetNames[a]))throw new Error("Sheet not found: "+n.sheet+" : "+typeof n.sheet);switch(n.bookType||"xlsb"){case"xml":case"xlml":return gE(ST(e,n),n);case"slk":case"sylk":return gE(iw.from_sheet(e.Sheets[e.SheetNames[a]],n),n);case"htm":case"html":return gE(UT(e.Sheets[e.SheetNames[a]],n),n);case"txt":return function(e,t){switch(t.type){case"base64":return Am(e);case"binary":case"string":return e;case"file":return jg(t.file,e,"binary");case"buffer":return Cm?Im(e,"binary"):e.split("").map((function(e){return e.charCodeAt(0)}))}throw new Error("Unrecognized type "+t.type)}(AE(e.Sheets[e.SheetNames[a]],n),n);case"csv":return gE(_E(e.Sheets[e.SheetNames[a]],n),n,"\ufeff");case"dif":return gE(sw.from_sheet(e.Sheets[e.SheetNames[a]],n),n);case"dbf":return vE(aw.from_sheet(e.Sheets[e.SheetNames[a]],n),n);case"prn":return gE(lw.from_sheet(e.Sheets[e.SheetNames[a]],n),n);case"rtf":return gE(gw.from_sheet(e.Sheets[e.SheetNames[a]],n),n);case"eth":return gE(ow.from_sheet(e.Sheets[e.SheetNames[a]],n),n);case"fods":return gE(GT(e,n),n);case"wk1":return vE(cw.sheet_to_wk1(e.Sheets[e.SheetNames[a]],n),n);case"wk3":return vE(cw.book_to_wk3(e,n),n);case"biff2":n.biff||(n.biff=2);case"biff3":n.biff||(n.biff=3);case"biff4":return n.biff||(n.biff=4),vE(jT(e,n),n);case"biff5":n.biff||(n.biff=5);case"biff8":case"xla":case"xls":return n.biff||(n.biff=8),function(e,t){var n=t||{};return pE(ET(e,n),n)}(e,n);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return function(e,t){var n=Xg(t||{});return mE(hE(e,n),n)}(e,n);default:throw new Error("Unrecognized bookType |"+n.bookType+"|")}}function bE(e){if(!e.bookType){var t=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();t.match(/^\.[a-z]+$/)&&(e.bookType=t.slice(1)),e.bookType={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"}[e.bookType]||e.bookType}}function wE(e,t,n){var r=n||{};return r.type="file",r.file=t,bE(r),yE(e,r)}function SE(e,t,n,r,a,i,s,o){var l=yy(n),c=o.defval,u=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),h=!0,d=1===a?[]:{};if(1!==a)if(Object.defineProperty)try{Object.defineProperty(d,"__rowNum__",{value:n,enumerable:!1})}catch(YE){d.__rowNum__=n}else d.__rowNum__=n;if(!s||e[n])for(var f=t.s.c;f<=t.e.c;++f){var p=s?e[n][f]:e[r[f]+l];if(void 0!==p&&void 0!==p.t){var m=p.v;switch(p.t){case"z":if(null==m)break;continue;case"e":m=0==m?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+p.t)}if(null!=i[f]){if(null==m)if("e"==p.t&&null===m)d[i[f]]=null;else if(void 0!==c)d[i[f]]=c;else{if(!u||null!==m)continue;d[i[f]]=null}else d[i[f]]=u&&("n"!==p.t||"n"===p.t&&!1!==o.rawNumbers)?m:ky(p,m,o);null!=m&&(h=!1)}}else{if(void 0===c)continue;null!=i[f]&&(d[i[f]]=c)}}return{row:d,isempty:h}}function TE(e,t){if(null==e||null==e["!ref"])return[];var n={t:"n",v:0},r=0,a=1,i=[],s=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},c=t||{},u=null!=c.range?c.range:e["!ref"];switch(1===c.header?r=1:"A"===c.header?r=2:Array.isArray(c.header)?r=3:null==c.header&&(r=0),typeof u){case"string":l=_y(u);break;case"number":(l=_y(e["!ref"])).s.r=u;break;default:l=u}r>0&&(a=0);var h=yy(l.s.r),d=[],f=[],p=0,m=0,g=Array.isArray(e),v=l.s.r,y=0,b={};g&&!e[v]&&(e[v]=[]);var w=c.skipHidden&&e["!cols"]||[],S=c.skipHidden&&e["!rows"]||[];for(y=l.s.c;y<=l.e.c;++y)if(!(w[y]||{}).hidden)switch(d[y]=wy(y),n=g?e[v][y]:e[d[y]+h],r){case 1:i[y]=y-l.s.c;break;case 2:i[y]=d[y];break;case 3:i[y]=c.header[y-l.s.c];break;default:if(null==n&&(n={w:"__EMPTY",t:"s"}),o=s=ky(n,null,c),m=b[s]||0){do{o=s+"_"+m++}while(b[o]);b[s]=m,b[o]=1}else b[s]=1;i[y]=o}for(v=l.s.r+a;v<=l.e.r;++v)if(!(S[v]||{}).hidden){var T=SE(e,l,v,d,r,i,g,c);(!1===T.isempty||(1===r?!1!==c.blankrows:c.blankrows))&&(f[p++]=T.row)}return f.length=p,f}var EE=/"/g;function xE(e,t,n,r,a,i,s,o){for(var l=!0,c=[],u="",h=yy(n),d=t.s.c;d<=t.e.c;++d)if(r[d]){var f=o.dense?(e[n]||[])[d]:e[r[d]+h];if(null==f)u="";else if(null!=f.v){l=!1,u=""+(o.rawNumbers&&"n"==f.t?f.v:ky(f,null,o));for(var p=0,m=0;p!==u.length;++p)if((m=u.charCodeAt(p))===a||m===i||34===m||o.forceQuotes){u='"'+u.replace(EE,'""')+'"';break}"ID"==u&&(u='"ID"')}else null==f.f||f.F?u="":(l=!1,(u="="+f.f).indexOf(",")>=0&&(u='"'+u.replace(EE,'""')+'"'));c.push(u)}return!1===o.blankrows&&l?null:c.join(s)}function _E(e,t){var n=[],r=null==t?{}:t;if(null==e||null==e["!ref"])return"";var a=_y(e["!ref"]),i=void 0!==r.FS?r.FS:",",s=i.charCodeAt(0),o=void 0!==r.RS?r.RS:"\n",l=o.charCodeAt(0),c=new RegExp(("|"==i?"\\|":i)+"+$"),u="",h=[];r.dense=Array.isArray(e);for(var d=r.skipHidden&&e["!cols"]||[],f=r.skipHidden&&e["!rows"]||[],p=a.s.c;p<=a.e.c;++p)(d[p]||{}).hidden||(h[p]=wy(p));for(var m=0,g=a.s.r;g<=a.e.r;++g)(f[g]||{}).hidden||null!=(u=xE(e,a,g,h,s,l,i,r))&&(r.strip&&(u=u.replace(c,"")),(u||!1!==r.blankrows)&&n.push((m++?o:"")+u));return delete r.dense,n.join("")}function AE(e,t){t||(t={}),t.FS="\t",t.RS="\n";var n=_E(e,t);if("undefined"==typeof Sm||"string"==t.type)return n;var r=Sm.utils.encode(1200,n,"str");return String.fromCharCode(255)+String.fromCharCode(254)+r}function kE(e,t,n){var r,a=n||{},i=+!a.skipHeader,s=e||{},o=0,l=0;if(s&&null!=a.origin)if("number"==typeof a.origin)o=a.origin;else{var c="string"==typeof a.origin?Sy(a.origin):a.origin;o=c.r,l=c.c}var u={s:{c:0,r:0},e:{c:l,r:o+t.length-1+i}};if(s["!ref"]){var h=_y(s["!ref"]);u.e.c=Math.max(u.e.c,h.e.c),u.e.r=Math.max(u.e.r,h.e.r),-1==o&&(o=h.e.r+1,u.e.r=o+t.length-1+i)}else-1==o&&(o=0,u.e.r=t.length-1+i);var d=a.header||[],f=0;t.forEach((function(e,t){Pg(e).forEach((function(n){-1==(f=d.indexOf(n))&&(d[f=d.length]=n);var c=e[n],u="z",h="",p=Ty({c:l+f,r:o+t+i});r=CE(s,p),!c||"object"!==typeof c||c instanceof Date?("number"==typeof c?u="n":"boolean"==typeof c?u="b":"string"==typeof c?u="s":c instanceof Date?(u="d",a.cellDates||(u="n",c=Vg(c)),h=a.dateNF||Km[14]):null===c&&a.nullError&&(u="e",c=0),r?(r.t=u,r.v=c,delete r.w,delete r.R,h&&(r.z=h)):s[p]=r={t:u,v:c},h&&(r.z=h)):s[p]=c}))})),u.e.c=Math.max(u.e.c,l+d.length-1);var p=yy(o);if(i)for(f=0;f<d.length;++f)s[wy(f+l)+p]={t:"s",v:d[f]};return s["!ref"]=xy(u),s}function CE(e,t,n){if("string"==typeof t){if(Array.isArray(e)){var r=Sy(t);return e[r.r]||(e[r.r]=[]),e[r.r][r.c]||(e[r.r][r.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return CE(e,Ty("number"!=typeof t?t:{r:t,c:n||0}))}function IE(){return{SheetNames:[],Sheets:{}}}function NE(e,t,n,r){var a=1;if(!n)for(;a<=65535&&-1!=e.SheetNames.indexOf(n="Sheet"+a);++a,n=void 0);if(!n||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(r&&e.SheetNames.indexOf(n)>=0){var i=n.match(/(^.*?)(\d+)$/);a=i&&+i[2]||0;var s=i&&i[1]||n;for(++a;a<=65535&&-1!=e.SheetNames.indexOf(n=s+a);++a);}if(cT(n),e.SheetNames.indexOf(n)>=0)throw new Error("Worksheet with name |"+n+"| already exists!");return e.SheetNames.push(n),e.Sheets[n]=t,n}function OE(e,t,n){return t?(e.l={Target:t},n&&(e.l.Tooltip=n)):delete e.l,e}var RE={encode_col:wy,encode_row:yy,encode_cell:Ty,encode_range:xy,decode_col:by,decode_row:vy,split_cell:function(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")},decode_cell:Sy,decode_range:Ey,format_cell:ky,sheet_add_aoa:Iy,sheet_add_json:kE,sheet_add_dom:VT,aoa_to_sheet:Ny,json_to_sheet:function(e,t){return kE(null,e,t)},table_to_sheet:BT,table_to_book:function(e,t){return Cy(BT(e,t),t)},sheet_to_csv:_E,sheet_to_txt:AE,sheet_to_json:TE,sheet_to_html:UT,sheet_to_formulae:function(e){var t,n="",r="";if(null==e||null==e["!ref"])return[];var a,i=_y(e["!ref"]),s="",o=[],l=[],c=Array.isArray(e);for(a=i.s.c;a<=i.e.c;++a)o[a]=wy(a);for(var u=i.s.r;u<=i.e.r;++u)for(s=yy(u),a=i.s.c;a<=i.e.c;++a)if(n=o[a]+s,r="",void 0!==(t=c?(e[u]||[])[a]:e[n])){if(null!=t.F){if(n=t.F,!t.f)continue;r=t.f,-1==n.indexOf(":")&&(n=n+":"+n)}if(null!=t.f)r=t.f;else{if("z"==t.t)continue;if("n"==t.t&&null!=t.v)r=""+t.v;else if("b"==t.t)r=t.v?"TRUE":"FALSE";else if(void 0!==t.w)r="'"+t.w;else{if(void 0===t.v)continue;r="s"==t.t?"'"+t.v:""+t.v}}l[l.length]=n+"="+r}return l},sheet_to_row_object_array:TE,sheet_get_cell:CE,book_new:IE,book_append_sheet:NE,book_set_sheet_visibility:function(e,t,n){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var r=function(e,t){if("number"==typeof t){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}if("string"==typeof t){var n=e.SheetNames.indexOf(t);if(n>-1)return n;throw new Error("Cannot find sheet name |"+t+"|")}throw new Error("Cannot find sheet |"+t+"|")}(e,t);switch(e.Workbook.Sheets[r]||(e.Workbook.Sheets[r]={}),n){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+n)}e.Workbook.Sheets[r].Hidden=n},cell_set_number_format:function(e,t){return e.z=t,e},cell_set_hyperlink:OE,cell_set_internal_link:function(e,t,n){return OE(e,"#"+t,n)},cell_add_comment:function(e,t,n){e.c||(e.c=[]),e.c.push({t:t,a:n||"SheetJS"})},sheet_set_array_formula:function(e,t,n,r){for(var a="string"!=typeof t?t:_y(t),i="string"==typeof t?t:xy(t),s=a.s.r;s<=a.e.r;++s)for(var o=a.s.c;o<=a.e.c;++o){var l=CE(e,s,o);l.t="n",l.F=i,delete l.v,s==a.s.r&&o==a.s.c&&(l.f=n,r&&(l.D=!0))}return e},consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};dm.version;const DE=()=>{const[e,t]=(0,a.useState)([]),[n,r]=(0,a.useState)([]),[i,s]=(0,a.useState)(""),[o,l]=(0,a.useState)(""),[c,u]=(0,a.useState)(""),[h,d]=(0,a.useState)("all"),[f,p]=(0,a.useState)([]),[m,g]=(0,a.useState)(null),[v,y]=(0,a.useState)(!1),b=re();(0,a.useEffect)((()=>{(async()=>{const e=(await Mp(Nf(qp,"users"))).docs.map((e=>({...e.data(),id:e.id})));t(e),p(e);const n=e.filter((e=>"sales-manager"===e.role));r(n)})()}),[]);return(0,Yp.jsxs)("div",{className:"manage-users-container",children:[(0,Yp.jsx)("h1",{children:"Hantera Anv\xe4ndare"}),(0,Yp.jsxs)("div",{className:"filter-container",children:[(0,Yp.jsxs)("div",{className:"dropdowns-container",children:[(0,Yp.jsx)("label",{htmlFor:"sales-manager-select",children:"V\xe4lj F\xf6rs\xe4ljningschef:"}),(0,Yp.jsxs)("select",{id:"sales-manager-select",value:i,onChange:e=>s(e.target.value),children:[(0,Yp.jsx)("option",{value:"",children:"Alla"}),n.map((e=>(0,Yp.jsxs)("option",{value:e.id,children:[e.firstName," ",e.lastName]},e.id)))]}),(0,Yp.jsxs)("div",{className:"status-filter-container",children:[(0,Yp.jsx)("label",{htmlFor:"status-filter",children:"Status:"}),(0,Yp.jsxs)("select",{id:"status-filter",value:h,onChange:e=>d(e.target.value),children:[(0,Yp.jsx)("option",{value:"all",children:"Alla"}),(0,Yp.jsx)("option",{value:"active",children:"Aktiva"}),(0,Yp.jsx)("option",{value:"inactive",children:"Avslutade"})]})]})]}),(0,Yp.jsxs)("div",{className:"date-filter-container",children:[(0,Yp.jsx)("label",{children:"Fr\xe5n:"}),(0,Yp.jsx)("input",{type:"date",value:o,onChange:e=>l(e.target.value)}),(0,Yp.jsx)("label",{children:"Till:"}),(0,Yp.jsx)("input",{type:"date",value:c,onChange:e=>u(e.target.value)})]}),(0,Yp.jsxs)("div",{className:"buttons-container",children:[(0,Yp.jsx)("button",{className:"filter-button",onClick:()=>{const t=o?new Date(o):null,n=c?new Date(c):null,r=e.filter((e=>{const r=e.sistaArbetsdag?new Date(e.sistaArbetsdag):null,a="all"===h||"active"===h&&!e.sistaArbetsdag||"inactive"===h&&e.sistaArbetsdag,s=!t||!n||!r||r>=t&&r<=n,o=""===i||e.managerUid===i;return a&&s&&o}));p(r)},children:"Filtrera"}),(0,Yp.jsx)("button",{className:"filter-button",onClick:()=>{s(""),l(""),u(""),d("all"),p(e)},children:"Nollst\xe4ll"}),(0,Yp.jsx)("button",{className:"export-button",onClick:()=>{const e=RE.json_to_sheet(f.map((e=>({Namn:"".concat(e.firstName," ").concat(e.lastName),Epost:e.email,Roll:e.role,"S\xe4lj ID":e.salesId||"N/A",Startdatum:e.startDatum||"N/A","Sista arbetsdag":e.sistaArbetsdag||"N/A"})))),t=RE.book_new();RE.book_append_sheet(t,e,"Anv\xe4ndare"),wE(t,"anv\xe4ndare.xlsx")},children:"Exportera"})]})]}),(0,Yp.jsx)("div",{className:"user-table-container",children:(0,Yp.jsxs)("table",{className:"user-table",children:[(0,Yp.jsx)("thead",{children:(0,Yp.jsxs)("tr",{children:[(0,Yp.jsx)("th",{children:"Namn"}),(0,Yp.jsx)("th",{children:"E-post"}),(0,Yp.jsx)("th",{children:"Roll"}),(0,Yp.jsx)("th",{children:"S\xe4lj ID"}),(0,Yp.jsx)("th",{children:"Team"}),(0,Yp.jsx)("th",{children:"Startdatum"}),(0,Yp.jsx)("th",{children:"Sista arbetsdag"}),(0,Yp.jsx)("th",{children:"\xc5tg\xe4rder"})]})}),(0,Yp.jsx)("tbody",{children:f.map((e=>(0,Yp.jsxs)("tr",{children:[(0,Yp.jsxs)("td",{"data-label":"Namn",children:[e.firstName," ",e.lastName]}),(0,Yp.jsx)("td",{"data-label":"E-post",children:e.email}),(0,Yp.jsx)("td",{"data-label":"Roll",children:e.role}),(0,Yp.jsx)("td",{"data-label":"S\xe4lj ID",children:e.salesId||"N/A"}),(0,Yp.jsx)("td",{"data-label":"Team",children:(0,Yp.jsxs)("select",{className:"team-dropdown",value:e.managerUid||"",onChange:n=>(async(e,n)=>{try{const r=Rf(qp,"users",e);await Up(r,{managerUid:n}),t((t=>t.map((t=>t.id===e?{...t,managerUid:n}:t)))),p((t=>t.map((t=>t.id===e?{...t,managerUid:n}:t))))}catch(r){console.error("Kunde inte uppdatera managerUid:",r),alert("Ett fel uppstod vid uppdatering av team. F\xf6rs\xf6k igen!")}})(e.id,n.target.value),children:[(0,Yp.jsx)("option",{value:"",children:"Ingen manager"}),n.map((e=>(0,Yp.jsxs)("option",{value:e.id,children:[e.firstName," ",e.lastName]},e.id)))]})}),(0,Yp.jsx)("td",{"data-label":"Startdatum",children:e.startDatum||"N/A"}),(0,Yp.jsx)("td",{"data-label":"Sista arbetsdag",children:e.sistaArbetsdag||"N/A"}),(0,Yp.jsxs)("td",{"data-label":"\xc5tg\xe4rder",children:[(0,Yp.jsx)("button",{className:"button-profile",onClick:()=>{return t=e.id,void b("/user-profile/".concat(t));var t},children:"Min profil"}),(0,Yp.jsx)("button",{className:"button-danger",onClick:()=>(e=>{g(e),y(!0)})(e),children:"Ta bort"})]})]},e.id)))})]})}),v&&(0,Yp.jsx)("div",{className:"modal-overlay",children:(0,Yp.jsxs)("div",{className:"modal-content",children:[(0,Yp.jsx)("h2",{children:"Vad vill du g\xf6ra med anv\xe4ndaren?"}),(0,Yp.jsx)("p",{children:"V\xe4lj ett alternativ nedan f\xf6r att hantera anv\xe4ndaren:"}),m&&!m.active&&(0,Yp.jsx)("button",{onClick:async()=>{if(m){const e=Rf(qp,"users",m.id);await Up(e,{active:!0}),p(f.map((e=>e.id===m.id?{...e,active:!0}:e))),alert("Anv\xe4ndaren har aktiverats."),y(!1)}},className:"button-activate",children:"Aktivera"}),(0,Yp.jsx)("button",{onClick:async()=>{if(m){const e=Rf(qp,"users",m.id);await Up(e,{active:!1}),p(f.map((e=>e.id===m.id?{...e,active:!1}:e))),alert("Anv\xe4ndaren har inaktiverats."),y(!1)}},className:"button-inactivate",children:"Inaktivera"}),(0,Yp.jsx)("button",{onClick:async()=>{m&&(await Vp(Rf(qp,"users",m.id)),p(f.filter((e=>e.id!==m.id))),alert("Anv\xe4ndaren och all tillh\xf6rande data har tagits bort."),y(!1))},className:"button-danger",children:"Ta bort all data"}),(0,Yp.jsx)("button",{onClick:()=>y(!1),className:"button-cancel",children:"Avbryt"})]})})]})},jE=()=>{const{currentUser:e}=$p(),[t,n]=(0,a.useState)([]),[r,i]=(0,a.useState)(null),[s,o]=(0,a.useState)(!1),[l,c]=(0,a.useState)("");(0,a.useEffect)((()=>{(async()=>{if(e&&e.uid){const t=pp(Nf(qp,"users"),gp("managerUid","==",e.uid)),r=(await Mp(t)).docs.map((e=>({...e.data(),id:e.id})));n(r)}})()}),[e]);const u=()=>{i(null),c(""),o(!1)};return(0,Yp.jsxs)("div",{className:"manage-users-container",children:[(0,Yp.jsx)("h1",{children:"Teammedlemmar"}),(0,Yp.jsxs)("table",{className:"user-table",children:[(0,Yp.jsx)("thead",{children:(0,Yp.jsxs)("tr",{children:[(0,Yp.jsx)("th",{children:"Namn"}),(0,Yp.jsx)("th",{children:"E-post"}),(0,Yp.jsx)("th",{children:"Roll"}),(0,Yp.jsx)("th",{children:"S\xe4lj ID"}),(0,Yp.jsx)("th",{children:"Startdatum"}),(0,Yp.jsx)("th",{children:"Sista arbetsdag"}),(0,Yp.jsx)("th",{children:"\xc5tg\xe4rder"})]})}),(0,Yp.jsx)("tbody",{children:t.length>0?t.map((e=>(0,Yp.jsxs)("tr",{children:[(0,Yp.jsxs)("td",{"data-label":"Namn",children:[e.firstName," ",e.lastName]}),(0,Yp.jsx)("td",{"data-label":"E-post",children:e.email}),(0,Yp.jsx)("td",{"data-label":"Roll",children:e.role}),(0,Yp.jsx)("td",{"data-label":"S\xe4lj ID",children:e.salesId||"N/A"}),(0,Yp.jsx)("td",{"data-label":"Startdatum",children:e.startDatum||"N/A"}),(0,Yp.jsx)("td",{"data-label":"Sista arbetsdag",children:e.sistaArbetsdag||"N/A"}),(0,Yp.jsx)("td",{"data-label":"\xc5tg\xe4rder",children:(0,Yp.jsx)("button",{className:"button-profile",onClick:()=>(e=>{const n=t.find((t=>t.id===e));i(n),o(!0)})(e.id),children:"Slutade"})})]},e.id))):(0,Yp.jsx)("tr",{children:(0,Yp.jsx)("td",{colSpan:"7",children:"Inga anv\xe4ndare hittades."})})})]}),s&&(0,Yp.jsx)("div",{className:"modal",children:(0,Yp.jsxs)("div",{className:"modal-content",children:[(0,Yp.jsxs)("h2",{children:["Ange sista arbetsdag f\xf6r ",null===r||void 0===r?void 0:r.firstName," ",null===r||void 0===r?void 0:r.lastName]}),(0,Yp.jsxs)("label",{children:["Sista arbetsdag:",(0,Yp.jsx)("input",{type:"date",value:l,onChange:e=>c(e.target.value),required:!0})]}),(0,Yp.jsxs)("div",{className:"modal-buttons",children:[(0,Yp.jsx)("button",{className:"button-success",onClick:async()=>{if(r&&l)try{const e=Rf(qp,"users",r.id);await Up(e,{sistaArbetsdag:l}),n((e=>e.map((e=>e.id===r.id?{...e,sistaArbetsdag:l}:e)))),u()}catch(e){console.error("Fel vid uppdatering av sista arbetsdag:",e)}},children:"Spara"}),(0,Yp.jsx)("button",{className:"button-neutral",onClick:u,children:"Avbryt"})]})]})})]})},PE=()=>{const[e,t]=(0,a.useState)([]),[n,r]=(0,a.useState)(""),[i,s]=(0,a.useState)([]),[o,l]=(0,a.useState)(0);return(0,a.useEffect)((()=>{(async()=>{try{const e=Nf(qp,"users"),t=await Mp(e),n=new Set,r=t.docs.map((async e=>{const t=Nf(e.ref,"salesSpecifications");(await Mp(t)).forEach((e=>{n.add(e.id)}))}));await Promise.all(r);const a=Array.from(n).map((e=>({id:e,label:e})));s(a)}catch(e){console.error("Fel vid h\xe4mtning av l\xf6neperioder:",e)}})()}),[]),(0,Yp.jsxs)("div",{className:"salary-statistics-container",children:[(0,Yp.jsx)("h1",{children:"L\xf6nestatistik"}),(0,Yp.jsx)("div",{className:"total-salary-container",children:(0,Yp.jsxs)("h3",{children:["Total l\xf6n f\xf6r perioden: ",(0,Yp.jsxs)("span",{className:"total-salary",children:[o," SEK"]})]})}),(0,Yp.jsxs)("div",{className:"filter-container",children:[(0,Yp.jsx)("label",{htmlFor:"salary-period-select",children:"V\xe4lj L\xf6neperiod:"}),(0,Yp.jsxs)("select",{id:"salary-period-select",value:n,onChange:e=>r(e.target.value),children:[(0,Yp.jsx)("option",{value:"",children:"V\xe4lj en period"}),i.map((e=>(0,Yp.jsx)("option",{value:e.id,children:e.label},e.id)))]}),(0,Yp.jsx)("button",{onClick:async()=>{if(n)try{const e=Nf(qp,"users"),r=await Mp(e),a={};r.docs.forEach((e=>{a[e.id]={id:e.id,...e.data()}}));const i=pp(Of(qp,"salesSpecifications")),s=(await Mp(i)).docs.filter((e=>e.id===n)),o=[];let c=0;s.forEach((e=>{const t=e.data();c+=t.salary||0;const r=e.ref.parent.parent,i=r?r.id:null,s=a[i]||{};o.push({...s,salesSpecifications:{[n]:t}})})),t(o),l(c)}catch(e){console.error("Fel vid h\xe4mtning av anv\xe4ndardata:",e)}},className:"fetch-button",children:"Visa L\xf6nestatistik"}),(0,Yp.jsx)("button",{onClick:()=>{const t=e.map((e=>{var t;return{Namn:e.name,Personnummer:e.personnummer,"S\xe4lj ID":e.salesId||"N/A",Gatuadress:e.gatuadress,"Postnummer & Ort":e.postnummerOrt,Bank:e.bank,Clearingnummer:e.clearingnummer,Kontonummer:e.kontonummer,Epost:e.email,Telefon:e.telefon,Startdatum:e.startDatum,"Sista arbetsdag":e.sistaArbetsdag||"N/A","L\xf6n f\xf6r perioden":(null===(t=e.salesSpecifications[n])||void 0===t?void 0:t.salary)||"N/A"}})),r=RE.json_to_sheet(t),a=RE.book_new();RE.book_append_sheet(a,r,"L\xf6nestatistik"),wE(a,"L\xf6nestatistik_".concat(n,".xlsx"))},className:"export-button",children:"Exportera till Excel"})]}),(0,Yp.jsx)("div",{className:"salary-table-container",children:(0,Yp.jsxs)("table",{className:"salary-table",children:[(0,Yp.jsx)("thead",{children:(0,Yp.jsxs)("tr",{children:[(0,Yp.jsx)("th",{children:"Namn"}),(0,Yp.jsx)("th",{children:"Personnummer"}),(0,Yp.jsx)("th",{children:"S\xe4lj ID"}),(0,Yp.jsx)("th",{children:"Gatuadress"}),(0,Yp.jsx)("th",{children:"Postnummer & Ort"}),(0,Yp.jsx)("th",{children:"Bank"}),(0,Yp.jsx)("th",{children:"Clearingnummer"}),(0,Yp.jsx)("th",{children:"Kontonummer"}),(0,Yp.jsx)("th",{children:"E-post"}),(0,Yp.jsx)("th",{children:"Telefon"}),(0,Yp.jsx)("th",{children:"Startdatum"}),(0,Yp.jsx)("th",{children:"Sista arbetsdag"}),(0,Yp.jsx)("th",{children:"L\xf6n f\xf6r perioden"})]})}),(0,Yp.jsx)("tbody",{children:e.length>0?e.map((e=>{var t;return(0,Yp.jsxs)("tr",{children:[(0,Yp.jsx)("td",{"data-label":"Namn",children:e.name}),(0,Yp.jsx)("td",{"data-label":"Personnummer",children:e.personnummer}),(0,Yp.jsx)("td",{"data-label":"S\xe4lj ID",children:e.salesId||"N/A"}),(0,Yp.jsx)("td",{"data-label":"Gatuadress",children:e.gatuadress}),(0,Yp.jsx)("td",{"data-label":"Postnummer & Ort",children:e.postnummerOrt}),(0,Yp.jsx)("td",{"data-label":"Bank",children:e.bank}),(0,Yp.jsx)("td",{"data-label":"Clearingnummer",children:e.clearingnummer}),(0,Yp.jsx)("td",{"data-label":"Kontonummer",children:e.kontonummer}),(0,Yp.jsx)("td",{"data-label":"E-post",children:e.email}),(0,Yp.jsx)("td",{"data-label":"Telefon",children:e.telefon}),(0,Yp.jsx)("td",{"data-label":"Startdatum",children:e.startDatum}),(0,Yp.jsx)("td",{"data-label":"Sista arbetsdag",children:e.sistaArbetsdag||"N/A"}),(0,Yp.jsx)("td",{"data-label":"L\xf6n f\xf6r perioden",children:(null===(t=e.salesSpecifications[n])||void 0===t?void 0:t.salary)||"N/A"})]},e.id)})):(0,Yp.jsx)("tr",{children:(0,Yp.jsx)("td",{colSpan:"13",children:"Inga anv\xe4ndare hittades f\xf6r den valda perioden."})})})]})})]})},LE=()=>{const{currentUser:e}=$p(),[t,n]=(0,a.useState)(null),[r,i]=(0,a.useState)([]),[s,o]=(0,a.useState)([]),[l,c]=(0,a.useState)({}),[u,h]=(0,a.useState)({}),[d,f]=(0,a.useState)(""),[p,m]=(0,a.useState)(""),[g,v]=(0,a.useState)(""),[y,b]=(0,a.useState)(0),[w,S]=(0,a.useState)(""),[T,E]=(0,a.useState)(""),[x,_]=(0,a.useState)([]),[A,k]=(0,a.useState)(null),[C,I]=(0,a.useState)(!0),[N,O]=(0,a.useState)([]),[R,D]=(0,a.useState)({}),[j,P]=(0,a.useState)(0),[L,M]=(0,a.useState)(null);(0,a.useEffect)((()=>{console.log("Inloggad anv\xe4ndare:",e),e?(F(),U(),V(),B()):console.log("Ingen inloggad anv\xe4ndare.")}),[e]);const F=async()=>{if(e)try{const t=Rf(qp,"users",e.uid),r=await Pp(t);r.exists()?n(r.data()):console.log("Ingen s\xe5dan anv\xe4ndare!")}catch(t){console.error("Fel vid h\xe4mtning av managerdata:",t)}},U=async()=>{if(e)try{const t=pp(Nf(qp,"users"),gp("managerUid","==",e.uid)),n=(await Mp(t)).docs.map((e=>({...e.data(),id:e.id})));i(n)}catch(t){console.error("Fel vid h\xe4mtning av teammedlemmar:",t)}},V=async()=>{if(e)try{const t=pp(Nf(qp,"finalReports"),gp("managerUid","==",e.uid),bp("date","desc"),Sp(2)),n=await Mp(t),r=n.docs.map((e=>({...e.data(),id:e.id})));_(r);const a=n.docs[n.docs.length-1];k(a),I(2===n.docs.length)}catch(t){console.error("Fel vid h\xe4mtning av slutrapporter:",t)}},B=async()=>{try{const e=Nf(qp,"organizations"),t=(await Mp(e)).docs.map((e=>({id:e.id,...e.data()})));O(t)}catch(e){console.error("Fel vid h\xe4mtning av organization:",e)}},z=async e=>{try{const n=Rf(qp,"finalReports",e),r=await Pp(n);if(r.exists()){const a=r.data().salesData;for(const[n]of Object.entries(a))try{const t=pp(Nf(qp,"users/".concat(n,"/reports")),gp("finalReportId","==",e)),r=await Mp(t);if(r.empty){console.log("Inga rapporter att ta bort f\xf6r anv\xe4ndare ".concat(n));continue}for(const e of r.docs)console.log("Tar bort rapport f\xf6r anv\xe4ndare ".concat(n," med rapport-id: ").concat(e.id)),await Vp(e.ref)}catch(t){console.error("Fel vid borttagning av rapport f\xf6r anv\xe4ndare ".concat(n,":"),t)}await Vp(n),_((t=>t.filter((t=>t.id!==e)))),alert("Rapporten och dess relaterade anv\xe4ndarrapporter har tagits bort.")}else console.log("Ingen rapport funnen att ta bort!")}catch(t){console.error("Fel vid borttagning av rapport:",t)}};return(0,Yp.jsxs)("div",{className:"final-report-container",children:[(0,Yp.jsx)("h1",{children:"Slutrapport f\xf6r teamet"}),(0,Yp.jsxs)("div",{className:"filter-container",children:[(0,Yp.jsx)("label",{children:"Datum:"}),(0,Yp.jsx)("input",{type:"date",value:T,onChange:e=>E(e.target.value),required:!0}),(0,Yp.jsx)("label",{children:"Organisation:"}),(0,Yp.jsxs)("select",{value:p,onChange:e=>m(e.target.value),required:!0,children:[(0,Yp.jsx)("option",{value:"",children:"V\xe4lj organisation"}),N.map((e=>(0,Yp.jsx)("option",{value:e.name,children:e.name},e.id)))]}),(0,Yp.jsx)("label",{children:"Plats:"}),(0,Yp.jsx)("input",{type:"text",placeholder:"Ange plats...",value:d,onChange:e=>f(e.target.value),required:!0})]}),(0,Yp.jsxs)("div",{className:"dropdown-container",children:[(0,Yp.jsx)("label",{children:"L\xe4gg till teammedlem:"}),(0,Yp.jsxs)("select",{onChange:e=>{const t=e.target.value;if(t&&!s.find((e=>e.id===t))){const e=r.find((e=>e.id===t));o([...s,e])}},children:[(0,Yp.jsx)("option",{value:"",children:"V\xe4lj teammedlem"}),r.filter((e=>!s.find((t=>t.id===e.id)))).map((e=>(0,Yp.jsxs)("option",{value:e.id,children:[e.firstName," ",e.lastName]},e.id)))]})]}),(0,Yp.jsxs)("table",{className:"report-table",children:[(0,Yp.jsx)("thead",{children:(0,Yp.jsxs)("tr",{children:[(0,Yp.jsx)("th",{children:"Teammedlem"}),(0,Yp.jsx)("th",{children:"Status"}),(0,Yp.jsx)("th",{children:"Antal f\xf6rs\xe4ljningar"}),("Factor"===p||"HelloFresh"===p)&&(0,Yp.jsx)("th",{children:"\xc5teraktiveringar"}),(0,Yp.jsx)("th",{children:"\xc5tg\xe4rder"})]})}),(0,Yp.jsx)("tbody",{children:s.map((e=>(0,Yp.jsxs)("tr",{children:[(0,Yp.jsxs)("td",{children:[e.firstName," ",e.lastName]}),(0,Yp.jsx)("td",{children:(0,Yp.jsxs)("select",{value:u[e.id]||"N\xe4rvarande",onChange:t=>((e,t)=>{const{value:n}=e.target;h((e=>({...e,[t]:n})))})(t,e.id),children:[(0,Yp.jsx)("option",{value:"N\xe4rvarande",children:"N\xe4rvarande"}),(0,Yp.jsx)("option",{value:"Sjuk",children:"Sjuk"}),(0,Yp.jsx)("option",{value:"Ledig",children:"Ledig"})]})}),(0,Yp.jsx)("td",{children:(0,Yp.jsx)("input",{type:"text",value:l[e.id]||"",onChange:t=>((e,t)=>{const{value:n}=e.target,r=n.replace(/[^0-9+\-]/g,"");c((e=>({...e,[t]:r})));const a=Object.values({...l,[t]:r}).map((e=>parseInt(e.replace(/[^\d]/g,""))||0)).reduce(((e,t)=>e+t),0);b(a)})(t,e.id),placeholder:"0"})}),("Factor"===p||"HelloFresh"===p)&&(0,Yp.jsx)("td",{children:(0,Yp.jsx)("input",{type:"text",value:R[e.id]||"",onChange:t=>((e,t)=>{const{value:n}=e.target,r=n.replace(/[^0-9+\-]/g,"");D((e=>({...e,[t]:r})));const a=Object.values({...R,[t]:r}).map((e=>parseInt(e.replace(/[^\d]/g,""))||0)).reduce(((e,t)=>e+t),0);P(a)})(t,e.id),placeholder:"0"})}),(0,Yp.jsx)("td",{children:(0,Yp.jsx)("button",{className:"remove-button",onClick:()=>{return t=e.id,o(s.filter((e=>e.id!==t))),c((e=>{const{[t]:n,...r}=e;return r})),D((e=>{const{[t]:n,...r}=e;return r})),void h((e=>{const{[t]:n,...r}=e;return r}));var t},children:"Ta bort"})})]},e.id)))})]}),(0,Yp.jsxs)("div",{className:"additional-info",children:[(0,Yp.jsxs)("div",{className:"input-group",children:[(0,Yp.jsx)("label",{children:"Totalt f\xf6rs\xe4ljningar:"}),(0,Yp.jsx)("span",{className:"total-sales",children:y})]}),("Factor"===p||"HelloFresh"===p)&&(0,Yp.jsxs)("div",{className:"input-group",children:[(0,Yp.jsx)("label",{children:"Totalt \xe5teraktiveringar:"}),(0,Yp.jsx)("span",{className:"total-sales",children:j})]}),(0,Yp.jsxs)("div",{className:"input-group",children:[(0,Yp.jsx)("label",{children:"M\xe5luppfyllnad:"}),(0,Yp.jsx)("input",{type:"text",value:w,onChange:e=>S(e.target.value),placeholder:"Ange m\xe5l..."})]})]}),(0,Yp.jsx)("button",{onClick:async()=>{try{const n={managerUid:e.uid,managerName:t?"".concat(t.firstName," ").concat(t.lastName):e.email,date:T,organisation:p,location:d,absentMembers:g,totalSales:y,goal:w,totalReactivations:j,salesData:s.reduce(((e,t)=>(e[t.id]={sales:l[t.id]||"0",reactivations:R[t.id]||"0",status:u[t.id]||"N\xe4rvarande",name:"".concat(t.firstName," ").concat(t.lastName),salesId:t.salesId||"N/A"},e)),{}),createdAt:(new Date).toISOString()};console.log("Skapar rapport med data:",n);const r=await Bp(Nf(qp,"finalReports"),n);console.log("Rapport tillagd i finalReports-samlingen:",r.id);for(const t of s){const n=Nf(Rf(qp,"users",t.id),"reports"),a={finalReportId:r.id,managerUid:e.uid,date:T,organisation:p,location:d,sales:l[t.id]||"0",reactivations:R[t.id]||"0",status:u[t.id]||"N\xe4rvarande",createdBy:e.uid,createdAt:(new Date).toISOString()};console.log("Sparar rapport till anv\xe4ndarens reports: ".concat(t.id),a),await Bp(n,a)}alert("Rapport sparad och anv\xe4ndarens rapporter uppdaterade!"),E(""),m(""),f(""),v(""),c({}),D({}),b(0),P(0),S(""),h({}),o([])}catch(n){console.error("Fel vid sparande av rapport:",n)}},className:"submit-button",children:"Spara Rapport"}),(0,Yp.jsxs)("div",{className:"report-list-container",children:[(0,Yp.jsx)("h2",{children:"Tidigare Rapporter"}),0===x.length?(0,Yp.jsx)("p",{children:"Inga tidigare rapporter hittades."}):(0,Yp.jsx)(Yp.Fragment,{children:(()=>{const e=x.filter((e=>"Factor"===e.organisation||"HelloFresh"===e.organisation)),t=x.filter((e=>"Factor"!==e.organisation&&"HelloFresh"!==e.organisation));return(0,Yp.jsxs)(Yp.Fragment,{children:[e.length>0&&(0,Yp.jsxs)("div",{className:"previous-reports-table-wrapper",children:[(0,Yp.jsx)("h3",{children:"Factor & HelloFresh Rapporter"}),(0,Yp.jsxs)("table",{className:"previous-reports-table",children:[(0,Yp.jsx)("thead",{children:(0,Yp.jsxs)("tr",{children:[(0,Yp.jsx)("th",{children:"Datum"}),(0,Yp.jsx)("th",{children:"Organisation"}),(0,Yp.jsx)("th",{children:"Plats"}),(0,Yp.jsx)("th",{children:"Totalt F\xf6rs\xe4ljningar"}),(0,Yp.jsx)("th",{children:"Totalt \xc5teraktiveringar"}),(0,Yp.jsx)("th",{children:"M\xe5l"}),(0,Yp.jsx)("th",{children:"Sjuka/Lediga"}),(0,Yp.jsx)("th",{children:"Skapad av"}),(0,Yp.jsx)("th",{children:"\xc5tg\xe4rder"})]})}),(0,Yp.jsx)("tbody",{children:e.map((e=>(0,Yp.jsxs)(a.Fragment,{children:[(0,Yp.jsxs)("tr",{children:[(0,Yp.jsx)("td",{"data-label":"Datum",children:e.date}),(0,Yp.jsx)("td",{"data-label":"Organisation",children:e.organisation}),(0,Yp.jsx)("td",{"data-label":"Plats",children:e.location}),(0,Yp.jsx)("td",{"data-label":"Totalt F\xf6rs\xe4ljningar",children:e.totalSales}),(0,Yp.jsx)("td",{"data-label":"Totalt \xc5teraktiveringar",children:e.totalReactivations||0}),(0,Yp.jsx)("td",{"data-label":"M\xe5l",children:e.goal}),(0,Yp.jsx)("td",{"data-label":"Sjuka/Lediga",children:e.absentMembers||"-"}),(0,Yp.jsx)("td",{"data-label":"Skapad av",children:e.managerName}),(0,Yp.jsxs)("td",{"data-label":"\xc5tg\xe4rder",children:[(0,Yp.jsx)("button",{onClick:()=>M(L===e.id?null:e.id),children:L===e.id?"D\xf6lj":"Visa"}),(0,Yp.jsx)("button",{onClick:()=>z(e.id),className:"delete-button",children:"Ta bort"})]})]}),L===e.id&&(0,Yp.jsx)("tr",{className:"expanded-row",children:(0,Yp.jsxs)("td",{colSpan:"9",children:[(0,Yp.jsx)("h4",{children:"Teammedlemmars f\xf6rs\xe4ljning/\xe5teraktivering:"}),(0,Yp.jsx)("ul",{children:Object.values(e.salesData).map(((e,t)=>(0,Yp.jsxs)("li",{children:[e.name," - S\xe4lj ID: ",e.salesId," - F\xf6rs\xe4ljning: ",e.sales," - \xc5teraktiveringar: ",e.reactivations||0," - Status: ",e.status]},t)))})]})})]},e.id)))})]})]}),t.length>0&&(0,Yp.jsxs)("div",{className:"previous-reports-table-wrapper",children:[(0,Yp.jsx)("h3",{children:"\xd6vriga Rapporter"}),(0,Yp.jsxs)("table",{className:"previous-reports-table",children:[(0,Yp.jsx)("thead",{children:(0,Yp.jsxs)("tr",{children:[(0,Yp.jsx)("th",{children:"Datum"}),(0,Yp.jsx)("th",{children:"Organisation"}),(0,Yp.jsx)("th",{children:"Plats"}),(0,Yp.jsx)("th",{children:"Totalt F\xf6rs\xe4ljningar"}),(0,Yp.jsx)("th",{children:"M\xe5l"}),(0,Yp.jsx)("th",{children:"Sjuka/Lediga"}),(0,Yp.jsx)("th",{children:"Skapad av"}),(0,Yp.jsx)("th",{children:"\xc5tg\xe4rder"})]})}),(0,Yp.jsx)("tbody",{children:t.map((e=>(0,Yp.jsxs)(a.Fragment,{children:[(0,Yp.jsxs)("tr",{children:[(0,Yp.jsx)("td",{"data-label":"Datum",children:e.date}),(0,Yp.jsx)("td",{"data-label":"Organisation",children:e.organisation}),(0,Yp.jsx)("td",{"data-label":"Plats",children:e.location}),(0,Yp.jsx)("td",{"data-label":"Totalt F\xf6rs\xe4ljningar",children:e.totalSales}),(0,Yp.jsx)("td",{"data-label":"M\xe5l",children:e.goal}),(0,Yp.jsx)("td",{"data-label":"Sjuka/Lediga",children:e.absentMembers||"-"}),(0,Yp.jsx)("td",{"data-label":"Skapad av",children:e.managerName}),(0,Yp.jsxs)("td",{"data-label":"\xc5tg\xe4rder",children:[(0,Yp.jsx)("button",{onClick:()=>M(L===e.id?null:e.id),children:L===e.id?"D\xf6lj":"Visa"}),(0,Yp.jsx)("button",{onClick:()=>z(e.id),className:"delete-button",children:"Ta bort"})]})]}),L===e.id&&(0,Yp.jsx)("tr",{className:"expanded-row",children:(0,Yp.jsxs)("td",{colSpan:"8",children:[(0,Yp.jsx)("h4",{children:"Teammedlemmars f\xf6rs\xe4ljning:"}),(0,Yp.jsx)("ul",{children:Object.values(e.salesData).map(((e,t)=>(0,Yp.jsxs)("li",{children:[e.name," - S\xe4lj ID: ",e.salesId," - F\xf6rs\xe4ljning: ",e.sales," - Status: ",e.status]},t)))})]})})]},e.id)))})]})]})]})})()})]}),C&&(0,Yp.jsx)("button",{onClick:async()=>{if(e&&A)try{const t=pp(Nf(qp,"finalReports"),gp("managerUid","==",e.uid),bp("date","desc"),Ep(A),Sp(2)),n=await Mp(t),r=n.docs.map((e=>({...e.data(),id:e.id})));_((e=>[...e,...r]));const a=n.docs[n.docs.length-1];k(a),I(2===n.docs.length)}catch(t){console.error("Fel vid h\xe4mtning av fler rapporter:",t)}},className:"load-more-button",children:"Ladda mer"})]})},ME=10,FE=()=>{const[e,t]=(0,a.useState)([]),[n,r]=(0,a.useState)([]),[i,s]=(0,a.useState)([]),[o,l]=(0,a.useState)([]),[c,u]=(0,a.useState)({}),[h,d]=(0,a.useState)(""),[f,p]=(0,a.useState)(""),[m,g]=(0,a.useState)(""),[v,y]=(0,a.useState)([]),[b,w]=(0,a.useState)([]),[S,T]=(0,a.useState)("salesSpecification"),[E,x]=(0,a.useState)([]),[_,A]=(0,a.useState)({key:"date",direction:"asc"}),[k,C]=(0,a.useState)(""),[I,N]=(0,a.useState)(""),[O,R]=(0,a.useState)(0),[D,j]=(0,a.useState)(""),[P,L]=(0,a.useState)([]),[M,F]=(0,a.useState)(null),[U,V]=(0,a.useState)(null),[B,z]=(0,a.useState)(null),[H,W]=(0,a.useState)(!1),{currentUser:G}=$p(),q=e=>{const t=e.reduce(((e,t)=>{const n=t.totalApproved||t.sales||t.total||0;return e+parseFloat(n)}),0);R(t)},K=e=>{const t=[...e];return t.sort(((e,t)=>e[_.key]<t[_.key]?"asc"===_.direction?-1:1:e[_.key]>t[_.key]?"asc"===_.direction?1:-1:0)),t},Y=e=>{let t="asc";_.key===e&&"asc"===_.direction&&(t="desc"),A({key:e,direction:t}),l(K(o))},Q=()=>{let t;d(""),p(""),g(""),j(""),"salesSpecification"===S?(t=e,y([...new Set(e.map((e=>e.salesperson)))])):"finalReport"===S?(t=n,y([...new Set(n.map((e=>e.salesperson||e.name)))])):"kvalit\xe9"===S&&(t=i,y([...new Set(i.map((e=>e.teamMember)))])),l(t),q(t)};(0,a.useEffect)((()=>{const e={};o.forEach((t=>{const n=t.organisation||"N/A",r=parseFloat(t.totalApproved||t.sales||t.total||0);e[n]=(e[n]||0)+r})),u(e)}),[o]),(0,a.useEffect)((()=>{(async()=>{if(G){F(null),V(null),z(null);try{if("salesSpecification"===S){const e=(await Mp(Nf(qp,"users"))).docs.map((e=>({id:e.id,...e.data()}))),n={};let r;e.forEach((e=>{n[e.id]=e})),r=k&&I?pp(Of(qp,"salesSpecifications"),gp("date",">=",k),gp("date","<=",I),bp("date"),Sp(ME)):pp(Of(qp,"salesSpecifications"),bp("__name__"),Sp(ME));const a=await Mp(r),i=[],s=new Set;a.forEach((e=>{const t=e.data(),r=t.period||e.id;s.add(r);const a=e.ref.parent.parent,o=a?a.id:null,l=n[o]||{};i.push({period:r,totalApproved:t.totalApproved||0,salesperson:"".concat(l.firstName||""," ").concat(l.lastName||"").trim()||"N/A",salesId:l.salesId||"N/A",managerUid:l.managerUid||"",date:t.date||r,type:"Sales Specification",organisation:l.organisation||"N/A"})})),F(a.docs[a.docs.length-1]),t(i),l(i),w([...s]),q(i);const o=e.filter((e=>"sales-manager"===e.role));x(o),y([...new Set(i.map((e=>e.salesperson)))]),console.log("Fetched Sales Specifications:",i)}else if("finalReport"===S){let e=k&&I?m?pp(Nf(qp,"finalReports"),gp("managerUid","==",m),gp("date",">=",k),gp("date","<=",I),bp("date"),Sp(ME)):pp(Nf(qp,"finalReports"),gp("date",">=",k),gp("date","<=",I),bp("date"),Sp(ME)):m?pp(Nf(qp,"finalReports"),gp("managerUid","==",m),bp("date"),Sp(ME)):pp(Nf(qp,"finalReports"),bp("date"),Sp(ME));const t=await Mp(e),n=t.docs.flatMap((e=>{const t=e.data(),n=e.id;return Object.keys(t.salesData||{}).map((e=>({...t.salesData[e],date:t.date,reportId:n,managerUid:t.managerUid,location:t.location||"N/A",organisation:t.organisation||"N/A",type:"Final Report"})))}));V(t.docs[t.docs.length-1]),r(n),l(n),q(n),w([...new Set(n.map((e=>e.date)))]);const a=(await Mp(Nf(qp,"users"))).docs.map((e=>({id:e.id,...e.data()})));x(a.filter((e=>"sales-manager"===e.role))),y([...new Set(n.map((e=>e.salesperson||e.name)))]);const i=new Set(n.map((e=>e.status)));L([...i]),console.log("Fetched Final Reports:",n)}else if("kvalit\xe9"===S){let e=k&&I?m?pp(Nf(qp,"qualityReports"),gp("managerUid","==",m),gp("date",">=",k),gp("date","<=",I),bp("date"),Sp(ME)):pp(Nf(qp,"qualityReports"),gp("date",">=",k),gp("date","<=",I),bp("date"),Sp(ME)):m?pp(Nf(qp,"qualityReports"),gp("managerUid","==",m),bp("date"),Sp(ME)):pp(Nf(qp,"qualityReports"),bp("date"),Sp(ME));const t=await Mp(e),n=t.docs.flatMap((e=>{const t=e.data(),n=e.id;return Object.entries(t.members||{}).map((e=>{let[r,a]=e;return{reportId:n,date:t.date,organisation:t.organisation||"N/A",managerUid:t.managerUid||"",teamMember:a.name||"N/A",salesId:a.salesId||"N/A",regSales:a.regSales||0,invalidAmount:a.invalidAmount||0,outOfTarget:a.outOfTarget||0,pending:a.pending||0,total:a.total||0,assignedTo:t.assignedTo||[],type:"Quality Report"}}))}));z(t.docs[t.docs.length-1]),s(n),l(n),q(n),w([...new Set(n.map((e=>e.date)))]);const r=(await Mp(Nf(qp,"users"))).docs.map((e=>({id:e.id,...e.data()})));x(r.filter((e=>"sales-manager"===e.role))),y([...new Set(n.map((e=>e.teamMember)))]),console.log("Fetched Quality Reports:",n)}}catch(e){console.error("Fel vid h\xe4mtning av data:",e)}}else console.log("Ingen inloggad anv\xe4ndare")})()}),[G,S,k,I,m]);return(0,Yp.jsxs)("div",{className:"statistics-container",children:[(0,Yp.jsx)("h1",{children:"Admin Statistik"}),(0,Yp.jsx)("table",{className:"filter-table",children:(0,Yp.jsxs)("tbody",{children:[(0,Yp.jsxs)("tr",{children:[(0,Yp.jsx)("td",{children:(0,Yp.jsx)("label",{htmlFor:"data-source-select",children:"V\xe4lj Datak\xe4lla:"})}),(0,Yp.jsx)("td",{children:(0,Yp.jsxs)("select",{id:"data-source-select",value:S,onChange:e=>{T(e.target.value),Q()},children:[(0,Yp.jsx)("option",{value:"salesSpecification",children:"S\xe4ljspecifikation"}),(0,Yp.jsx)("option",{value:"finalReport",children:"Slutrapport"}),(0,Yp.jsx)("option",{value:"kvalit\xe9",children:"Kvalit\xe9"})]})}),(0,Yp.jsx)("td",{children:(0,Yp.jsx)("label",{htmlFor:"manager-select",children:"V\xe4lj F\xf6rs\xe4ljningschef:"})}),(0,Yp.jsx)("td",{children:(0,Yp.jsxs)("select",{id:"manager-select",value:m,onChange:e=>g(e.target.value),children:[(0,Yp.jsx)("option",{value:"",children:"Alla chefer"}),E.map((e=>(0,Yp.jsxs)("option",{value:e.id,children:[e.firstName," ",e.lastName]},e.id)))]})})]}),(0,Yp.jsxs)("tr",{children:[(0,Yp.jsx)("td",{children:(0,Yp.jsx)("label",{htmlFor:"start-date",children:"Startdatum:"})}),(0,Yp.jsx)("td",{children:(0,Yp.jsx)("input",{type:"date",id:"start-date",value:k,onChange:e=>C(e.target.value)})}),(0,Yp.jsx)("td",{children:(0,Yp.jsx)("label",{htmlFor:"end-date",children:"Slutdatum:"})}),(0,Yp.jsx)("td",{children:(0,Yp.jsx)("input",{type:"date",id:"end-date",value:I,onChange:e=>N(e.target.value)})})]}),(0,Yp.jsxs)("tr",{children:[(0,Yp.jsx)("td",{children:(0,Yp.jsx)("label",{htmlFor:"period-select",children:"V\xe4lj Period:"})}),(0,Yp.jsx)("td",{children:(0,Yp.jsxs)("select",{id:"period-select",value:h,onChange:e=>d(e.target.value),children:[(0,Yp.jsx)("option",{value:"",children:"Alla perioder"}),b.map((e=>(0,Yp.jsx)("option",{value:e,children:e},e)))]})}),(0,Yp.jsx)("td",{children:(0,Yp.jsx)("label",{htmlFor:"salesperson-select",children:"V\xe4lj S\xe4ljare:"})}),(0,Yp.jsx)("td",{children:(0,Yp.jsxs)("select",{id:"salesperson-select",value:f,onChange:e=>p(e.target.value),children:[(0,Yp.jsx)("option",{value:"",children:"Alla"}),v.map(((e,t)=>(0,Yp.jsx)("option",{value:e,children:e},t)))]})})]}),"finalReport"===S&&(0,Yp.jsxs)("tr",{children:[(0,Yp.jsx)("td",{children:(0,Yp.jsx)("label",{htmlFor:"status-select",children:"V\xe4lj Status:"})}),(0,Yp.jsx)("td",{children:(0,Yp.jsxs)("select",{id:"status-select",value:D,onChange:e=>j(e.target.value),children:[(0,Yp.jsx)("option",{value:"",children:"Alla"}),P.map((e=>(0,Yp.jsx)("option",{value:e,children:e},e)))]})}),(0,Yp.jsx)("td",{colSpan:"2"})]}),(0,Yp.jsx)("tr",{children:(0,Yp.jsxs)("td",{colSpan:"4",style:{textAlign:"center"},children:[(0,Yp.jsx)("button",{className:"filter-button",onClick:()=>{let t;if("salesSpecification"===S?t=[...e]:"finalReport"===S?t=[...n]:"kvalit\xe9"===S&&(t=[...i]),m){t=t.filter((e=>e.managerUid===m));const e=new Set(t.map((e=>e.salesperson||e.teamMember)));y([...e])}f&&(t=t.filter((e=>e.name===f||e.salesperson===f||e.teamMember===f))),h&&(t=t.filter((e=>e.period===h))),"finalReport"===S&&D&&(t=t.filter((e=>e.status===D)));const r=K(t);l(r),q(r)},children:"Filtrera"}),(0,Yp.jsx)("button",{className:"reset-button",onClick:Q,children:"Nollst\xe4ll"})]})})]})}),(0,Yp.jsx)("div",{className:"total-sales",children:(0,Yp.jsxs)("h3",{children:["Totalt F\xf6rs\xe4ljning: ",O]})}),(0,Yp.jsxs)("div",{className:"org-totals",children:[(0,Yp.jsx)("h3",{children:"Totalt per Organisation:"}),0===Object.keys(c).length?(0,Yp.jsx)("p",{children:"Ingen data tillg\xe4nglig"}):(0,Yp.jsxs)("table",{children:[(0,Yp.jsx)("thead",{children:(0,Yp.jsxs)("tr",{children:[(0,Yp.jsx)("th",{children:"Organisation"}),(0,Yp.jsx)("th",{children:"F\xf6rs\xe4ljning"})]})}),(0,Yp.jsx)("tbody",{children:Object.entries(c).map((e=>{let[t,n]=e;return(0,Yp.jsxs)("tr",{children:[(0,Yp.jsx)("td",{children:t}),(0,Yp.jsx)("td",{children:n})]},t)}))})]})]}),(0,Yp.jsx)("div",{className:"table-container",children:(0,Yp.jsxs)("table",{className:"statistics-table",children:[(0,Yp.jsx)("thead",{children:(0,Yp.jsx)("tr",{children:"kvalit\xe9"===S?(0,Yp.jsxs)(Yp.Fragment,{children:[(0,Yp.jsxs)("th",{onClick:()=>Y("date"),children:["Datum ","date"===_.key?"asc"===_.direction?"\u25b2":"\u25bc":""]}),(0,Yp.jsx)("th",{children:"Organisation"}),(0,Yp.jsx)("th",{children:"Teammedlem"}),(0,Yp.jsx)("th",{children:"Sales ID"}),(0,Yp.jsx)("th",{children:"Reg S\xe4lj"}),(0,Yp.jsx)("th",{children:"Ogiltigt Belopp"}),(0,Yp.jsx)("th",{children:"Utanf\xf6r m\xe5lgrupp"}),(0,Yp.jsx)("th",{children:"Pending"}),(0,Yp.jsx)("th",{children:"Total"})]}):(0,Yp.jsxs)(Yp.Fragment,{children:[(0,Yp.jsx)("th",{children:"S\xe4ljare"}),(0,Yp.jsx)("th",{children:"finalReport"===S?"Status":"Period"}),(0,Yp.jsxs)("th",{onClick:()=>Y("date"),children:["Datum ","date"===_.key?"asc"===_.direction?"\u25b2":"\u25bc":""]}),"finalReport"===S&&(0,Yp.jsx)("th",{children:"Organisation"}),(0,Yp.jsx)("th",{children:"F\xf6rs\xe4ljning"}),(0,Yp.jsx)("th",{children:"Typ"})]})})}),(0,Yp.jsx)("tbody",{children:0===o.length?(0,Yp.jsx)("tr",{children:(0,Yp.jsx)("td",{colSpan:"kvalit\xe9"===S?9:"finalReport"===S?6:5,children:"Ingen data tillg\xe4nglig"})}):o.map(((e,t)=>(0,Yp.jsx)("tr",{children:"kvalit\xe9"===S?(0,Yp.jsxs)(Yp.Fragment,{children:[(0,Yp.jsx)("td",{"data-label":"Datum",children:e.date||"N/A"}),(0,Yp.jsx)("td",{"data-label":"Organisation",children:e.organisation||"N/A"}),(0,Yp.jsx)("td",{"data-label":"Teammedlem",children:e.teamMember||"N/A"}),(0,Yp.jsx)("td",{"data-label":"Sales ID",children:e.salesId||"N/A"}),(0,Yp.jsx)("td",{"data-label":"Reg S\xe4lj",children:e.regSales||0}),(0,Yp.jsx)("td",{"data-label":"Ogiltigt Belopp",children:e.invalidAmount||0}),(0,Yp.jsx)("td",{"data-label":"Utanf\xf6r m\xe5lgrupp",children:e.outOfTarget||0}),(0,Yp.jsx)("td",{"data-label":"Pending",children:e.pending||0}),(0,Yp.jsx)("td",{"data-label":"Total",children:e.total||0})]}):(0,Yp.jsxs)(Yp.Fragment,{children:[(0,Yp.jsx)("td",{"data-label":"S\xe4ljare",children:e.name||e.salesperson||"N/A"}),(0,Yp.jsx)("td",{"data-label":"finalReport"===S?"Status":"Period",children:"finalReport"===S?e.status||"N/A":e.period||"N/A"}),(0,Yp.jsx)("td",{"data-label":"Datum",children:e.date||"N/A"}),"finalReport"===S&&(0,Yp.jsx)("td",{"data-label":"Organisation",children:e.organisation||"N/A"}),(0,Yp.jsx)("td",{"data-label":"F\xf6rs\xe4ljning",children:e.totalApproved||e.sales||"N/A"}),(0,Yp.jsx)("td",{"data-label":"Typ",children:e.type||("salesSpecification"===S?"Sales Specification":"")})]})},t)))})]})}),(0,Yp.jsx)("div",{style:{textAlign:"center",marginTop:"20px"},children:("salesSpecification"===S&&M||"finalReport"===S&&U||"kvalit\xe9"===S&&B)&&(0,Yp.jsx)("button",{className:"load-more-button",onClick:async()=>{if(!H){W(!0);try{if("salesSpecification"===S&&M){const n=pp(Of(qp,"salesSpecifications"),bp("__name__"),Ep(M),Sp(ME)),r=await Mp(n),a=(await Mp(Nf(qp,"users"))).docs.map((e=>({id:e.id,...e.data()}))),i={};a.forEach((e=>{i[e.id]=e}));const s=[],o=new Set;r.forEach((e=>{const t=e.data(),n=t.period||e.id;o.add(n);const r=e.ref.parent.parent,a=r?r.id:null,l=i[a]||{};s.push({period:n,totalApproved:t.totalApproved||0,salesperson:"".concat(l.firstName||""," ").concat(l.lastName||"").trim()||"N/A",salesId:l.salesId||"N/A",managerUid:l.managerUid||"",date:t.date||n,type:"Sales Specification"})})),F(r.docs[r.docs.length-1]),t((e=>[...e,...s])),l((e=>[...e,...s])),w((e=>[...new Set([...e,...o])])),q([...e,...s]),y((e=>[...new Set([...e,...s.map((e=>e.salesperson))])]))}else if("finalReport"===S&&U){let e;e=k&&I?m?pp(Nf(qp,"finalReports"),gp("managerUid","==",m),gp("date",">=",k),gp("date","<=",I),bp("date"),Ep(U),Sp(ME)):pp(Nf(qp,"finalReports"),gp("date",">=",k),gp("date","<=",I),bp("date"),Ep(U),Sp(ME)):m?pp(Nf(qp,"finalReports"),gp("managerUid","==",m),bp("date"),Ep(U),Sp(ME)):pp(Nf(qp,"finalReports"),bp("date"),Ep(U),Sp(ME));const t=await Mp(e),a=t.docs.flatMap((e=>{const t=e.data(),n=e.id;return Object.keys(t.salesData||{}).map((e=>({...t.salesData[e],date:t.date,reportId:n,managerUid:t.managerUid,location:t.location||"N/A",organisation:t.organisation||"N/A",type:"Final Report"})))}));V(t.docs[t.docs.length-1]),r((e=>[...e,...a])),l((e=>[...e,...a])),w((e=>[...new Set([...e,...a.map((e=>e.date))])])),q([...n,...a]),y((e=>[...new Set([...e,...a.map((e=>e.salesperson||e.name))])]))}else if("kvalit\xe9"===S&&B){let e;e=k&&I?m?pp(Nf(qp,"qualityReports"),gp("managerUid","==",m),gp("date",">=",k),gp("date","<=",I),bp("date"),Ep(B),Sp(ME)):pp(Nf(qp,"qualityReports"),gp("date",">=",k),gp("date","<=",I),bp("date"),Ep(B),Sp(ME)):m?pp(Nf(qp,"qualityReports"),gp("managerUid","==",m),bp("date"),Ep(B),Sp(ME)):pp(Nf(qp,"qualityReports"),bp("date"),Ep(B),Sp(ME));const t=await Mp(e),n=t.docs.flatMap((e=>{const t=e.data(),n=e.id;return Object.entries(t.members||{}).map((e=>{let[r,a]=e;return{reportId:n,date:t.date,organisation:t.organisation||"N/A",managerUid:t.managerUid||"",teamMember:a.name||"N/A",salesId:a.salesId||"N/A",regSales:a.regSales||0,invalidAmount:a.invalidAmount||0,outOfTarget:a.outOfTarget||0,pending:a.pending||0,total:a.total||0,assignedTo:t.assignedTo||[],type:"Quality Report"}}))}));z(t.docs[t.docs.length-1]),s((e=>[...e,...n])),l((e=>[...e,...n])),w((e=>[...new Set([...e,...n.map((e=>e.date))])])),q([...i,...n]),y((e=>[...new Set([...e,...n.map((e=>e.teamMember))])]))}}catch(a){console.error("Fel vid paginerad h\xe4mtning:",a)}finally{W(!1)}}},disabled:H,children:H?"Laddar...":"Load More"})})]})},UE=()=>{const[e,t]=(0,a.useState)("Final Report"),[n,r]=(0,a.useState)([]),[i,s]=(0,a.useState)([]),[o,l]=(0,a.useState)([]),[c,u]=(0,a.useState)(""),[h,d]=(0,a.useState)([]),[f,p]=(0,a.useState)(""),[m,g]=(0,a.useState)(""),[v,y]=(0,a.useState)(0),{currentUser:b}=$p();(0,a.useEffect)((()=>{b&&(w(),S())}),[b]);const w=async()=>{try{const e=pp(Nf(qp,"finalReports"),gp("managerUid","==",b.uid)),t=(await Mp(e)).docs.flatMap((e=>{const t=e.data();return Object.keys(t.salesData||{}).map((n=>({...t.salesData[n],date:t.date,reportId:e.id,location:t.location||"N/A",managerName:t.managerName,status:t.salesData[n].status||"N/A",organisation:t.organisation||"N/A",type:"Final Report"})))}));r(t)}catch(e){console.error("Fel vid h\xe4mtning av slutrapporter:",e)}},S=async()=>{try{const e=pp(Nf(qp,"qualityReports"),gp("assignedTo","array-contains",b.uid)),t=(await Mp(e)).docs.flatMap((e=>{const t=e.data();return Object.keys(t.members||{}).map((n=>({...t.members[n],date:t.date,reportId:e.id,organisation:t.organisation||"N/A",teamMember:"".concat(t.members[n].name||"N/A"),salesId:t.members[n].salesId||"N/A",regSales:t.members[n].regSales||0,invalidAmount:t.members[n].invalidAmount||0,outOfTarget:t.members[n].outOfTarget||0,pending:t.members[n].pending||0,total:t.members[n].total||0,type:"Quality"})))}));s(t)}catch(e){console.error("Fel vid h\xe4mtning av kvalitetsrapporter:",e)}},T=e=>{const t=e.reduce(((e,t)=>{const n=t.sales||t.regSales||0;return e+parseFloat(n)}),0);y(t)};return(0,a.useEffect)((()=>{const t="Final Report"===e?n:i;l(t),T(t);const r=new Set(t.map((e=>e.name||e.teamMember)));d([...r])}),[e,n,i]),(0,Yp.jsxs)("div",{className:"statistics-container",children:[(0,Yp.jsx)("h1",{children:"F\xf6rs\xe4ljningschefens Statistik"}),(0,Yp.jsxs)("div",{className:"filter-container",children:[(0,Yp.jsxs)("div",{children:[(0,Yp.jsx)("label",{children:"V\xe4lj Rapporttyp:"}),(0,Yp.jsxs)("select",{value:e,onChange:e=>t(e.target.value),children:[(0,Yp.jsx)("option",{value:"Final Report",children:"Slutrapport"}),(0,Yp.jsx)("option",{value:"Quality",children:"Kvalit\xe9"})]})]}),(0,Yp.jsxs)("div",{children:[(0,Yp.jsx)("label",{children:"V\xe4lj S\xe4ljare:"}),(0,Yp.jsxs)("select",{value:c,onChange:e=>u(e.target.value),children:[(0,Yp.jsx)("option",{value:"",children:"Alla"}),h.map(((e,t)=>(0,Yp.jsx)("option",{value:e,children:e},t)))]})]}),(0,Yp.jsxs)("div",{children:[(0,Yp.jsx)("label",{children:"Startdatum:"}),(0,Yp.jsx)("input",{type:"date",value:f,onChange:e=>p(e.target.value)})]}),(0,Yp.jsxs)("div",{children:[(0,Yp.jsx)("label",{children:"Slutdatum:"}),(0,Yp.jsx)("input",{type:"date",value:m,onChange:e=>g(e.target.value)})]}),(0,Yp.jsx)("button",{className:"filter-button",onClick:()=>{let t=[..."Final Report"===e?n:i];if(c&&(t=t.filter((e=>e.name===c||e.teamMember===c))),f&&m){const e=new Date(f),n=new Date(m);t=t.filter((t=>{const r=new Date(t.date);return r>=e&&r<=n}))}l(t),T(t)},children:"Filtrera"})]}),(0,Yp.jsx)("div",{className:"total-sales",children:(0,Yp.jsxs)("h3",{children:["Totalt F\xf6rs\xe4ljning: ",v]})}),(0,Yp.jsx)("div",{className:"table-container",children:(0,Yp.jsxs)("table",{className:"statistics-table",children:[(0,Yp.jsx)("thead",{children:"Final Report"===e?(0,Yp.jsxs)("tr",{children:[(0,Yp.jsx)("th",{children:"S\xe4ljare"}),(0,Yp.jsx)("th",{children:"Datum"}),(0,Yp.jsx)("th",{children:"Plats"}),(0,Yp.jsx)("th",{children:"Organisation"}),(0,Yp.jsx)("th",{children:"F\xf6rs\xe4ljning"}),(0,Yp.jsx)("th",{children:"Status"})]}):(0,Yp.jsxs)("tr",{children:[(0,Yp.jsx)("th",{children:"Datum"}),(0,Yp.jsx)("th",{children:"Organisation"}),(0,Yp.jsx)("th",{children:"Teammedlem"}),(0,Yp.jsx)("th",{children:"Sales ID"}),(0,Yp.jsx)("th",{children:"Reg S\xe4lj"}),(0,Yp.jsx)("th",{children:"Ogiltigt Belopp"}),(0,Yp.jsx)("th",{children:"Utanf\xf6r m\xe5lgrupp"}),(0,Yp.jsx)("th",{children:"Pending"}),(0,Yp.jsx)("th",{children:"Total"})]})}),(0,Yp.jsx)("tbody",{children:0===o.length?(0,Yp.jsx)("tr",{children:(0,Yp.jsx)("td",{colSpan:"Final Report"===e?6:9,children:"Ingen data tillg\xe4nglig"})}):o.map(((t,n)=>(0,Yp.jsx)("tr",{children:"Final Report"===e?(0,Yp.jsxs)(Yp.Fragment,{children:[(0,Yp.jsx)("td",{children:t.name}),(0,Yp.jsx)("td",{children:t.date}),(0,Yp.jsx)("td",{children:t.location}),(0,Yp.jsx)("td",{children:t.organisation}),(0,Yp.jsx)("td",{children:t.sales||"N/A"}),(0,Yp.jsx)("td",{children:t.status})]}):(0,Yp.jsxs)(Yp.Fragment,{children:[(0,Yp.jsx)("td",{children:t.date}),(0,Yp.jsx)("td",{children:t.organisation}),(0,Yp.jsx)("td",{children:t.teamMember}),(0,Yp.jsx)("td",{children:t.salesId}),(0,Yp.jsx)("td",{children:t.regSales}),(0,Yp.jsx)("td",{children:t.invalidAmount}),(0,Yp.jsx)("td",{children:t.outOfTarget}),(0,Yp.jsx)("td",{children:t.pending}),(0,Yp.jsx)("td",{children:t.total})]})},n)))})]})})]})},VE=()=>{const[e,t]=(0,a.useState)([]),[n,r]=(0,a.useState)([]),[i,s]=(0,a.useState)(""),[o,l]=(0,a.useState)(""),[c,u]=(0,a.useState)(0),{currentUser:h}=$p();(0,a.useEffect)((()=>{(async()=>{if(h)try{const e=Nf(qp,"users",h.uid,"reports"),n=await Mp(e);if(n.empty)return void console.log("Inga rapporter hittades i anv\xe4ndarens reports-samling.");const a=n.docs.map((e=>({...e.data(),reportId:e.id})));t(a),r(a),d(a)}catch(e){console.error("Fel vid h\xe4mtning av data:",e)}else console.log("Ingen inloggad anv\xe4ndare.")})()}),[h]);const d=e=>{const t=e.reduce(((e,t)=>{const n=t.sales||0;return e+parseFloat(n)}),0);u(t)};return(0,Yp.jsxs)("div",{className:"user-statistics-container",children:[(0,Yp.jsx)("h1",{children:"Min Statistik"}),(0,Yp.jsxs)("div",{className:"filter-container",children:[(0,Yp.jsxs)("div",{className:"filter-group",children:[(0,Yp.jsx)("label",{htmlFor:"start-date",children:"Startdatum:"}),(0,Yp.jsx)("input",{type:"date",id:"start-date",value:i,onChange:e=>s(e.target.value)})]}),(0,Yp.jsxs)("div",{className:"filter-group",children:[(0,Yp.jsx)("label",{htmlFor:"end-date",children:"Slutdatum:"}),(0,Yp.jsx)("input",{type:"date",id:"end-date",value:o,onChange:e=>l(e.target.value)})]}),(0,Yp.jsxs)("div",{className:"filter-buttons",children:[(0,Yp.jsx)("button",{className:"filter-button",onClick:()=>{let t=[...e];if(i&&o){const e=new Date(i),n=new Date(o);t=t.filter((t=>{const r=new Date(t.date);return r>=e&&r<=n}))}r(t),d(t)},children:"Filtrera"}),(0,Yp.jsx)("button",{className:"reset-button",onClick:()=>{s(""),l(""),r(e),d(e)},children:"Nollst\xe4ll"})]})]}),(0,Yp.jsx)("div",{className:"total-sales",children:(0,Yp.jsxs)("h3",{children:["Totalt F\xf6rs\xe4ljning: ",c]})}),(0,Yp.jsx)("div",{className:"table-container",children:(0,Yp.jsxs)("table",{className:"user-statistics-table",children:[(0,Yp.jsx)("thead",{children:(0,Yp.jsxs)("tr",{children:[(0,Yp.jsx)("th",{children:"Dag"}),(0,Yp.jsx)("th",{children:"Kampanj"}),(0,Yp.jsx)("th",{children:"Organisation"}),(0,Yp.jsx)("th",{children:"Antal F\xf6rs\xe4ljningar"})]})}),(0,Yp.jsx)("tbody",{children:0===n.length?(0,Yp.jsx)("tr",{children:(0,Yp.jsx)("td",{colSpan:"4",children:"Ingen data tillg\xe4nglig"})}):n.map(((e,t)=>(0,Yp.jsxs)("tr",{children:[(0,Yp.jsx)("td",{children:e.date||"N/A"}),(0,Yp.jsx)("td",{children:e.location||"N/A"}),(0,Yp.jsx)("td",{children:e.organisation||"N/A"}),(0,Yp.jsx)("td",{children:e.sales||"0"})]},t)))})]})})]})},BE=()=>(0,Yp.jsxs)("div",{children:[(0,Yp.jsx)("h1",{children:"Uppdragsgivares Dashboard"}),(0,Yp.jsx)("p",{children:"V\xe4lkommen till uppdragsgivares panel."})]}),zE=()=>{const[e,t]=(0,a.useState)(""),[n,r]=(0,a.useState)([]),{currentUserRole:i}=$p(),s=async()=>{try{const e=(await Mp(Nf(qp,"organizations"))).docs.map((e=>({id:e.id,...e.data()})));r(e)}catch(e){console.error("Fel vid h\xe4mtning av organisationer:",e)}};(0,a.useEffect)((()=>{s()}),[]);return(0,Yp.jsxs)("div",{className:"manage-organizations",children:[(0,Yp.jsx)("h1",{children:"Hantera Organisationer"}),(0,Yp.jsxs)("form",{onSubmit:async n=>{if(n.preventDefault(),e.trim())try{(await Mp(Nf(qp,"organizations"))).empty&&console.log("Ingen organisation finns, skapar f\xf6rsta organisationen..."),await Bp(Nf(qp,"organizations"),{name:e,createdAt:new Date}),t(""),s(),console.log("Organisationen har lagts till!")}catch(r){console.error("Fel vid till\xe4gg av organisation:",r)}},className:"add-org-form",children:[(0,Yp.jsx)("input",{type:"text",placeholder:"Organisationsnamn",value:e,onChange:e=>t(e.target.value),required:!0}),(0,Yp.jsx)("button",{type:"submit",children:"L\xe4gg till"})]}),(0,Yp.jsx)("ul",{className:"organization-list",children:n.map((e=>(0,Yp.jsxs)("li",{children:[e.name,(0,Yp.jsx)("button",{onClick:()=>(async e=>{try{await Vp(Rf(qp,"organizations",e)),s(),console.log("Organisationen har tagits bort!")}catch(t){console.error("Fel vid borttagning av organisation:",t)}})(e.id),children:"Ta bort"})]},e.id)))})]})},HE=()=>(0,Yp.jsxs)("div",{className:"factor-dashboard",children:[(0,Yp.jsx)("h1",{children:"Dashboard Factor"}),(0,Yp.jsx)("p",{children:"V\xe4lkommen till Factors aktivitet\xb4s logg."}),(0,Yp.jsx)("p",{children:"Siffrorna nedan styrs av agentens anv\xe4ndande av systemet och \xe4r d\xe4rmed inte tillf\xf6rlitligt utan ska endast ses som en fingervisning."}),(0,Yp.jsx)("iframe",{title:"Dashboard",src:"https://codicent.com/html/midsale/embeddeddashboard/index.html?name=johan&token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImU2N2ZjMTM0LTMwNzYtNGEzOS05Y2U2LTBmNDk4YWY2N2NlMCIsIm5pY2tuYW1lIjoiQWJlcmciLCJuYW1lIjoiIiwidXNlcklkIjoiZTY3ZmMxMzQtMzA3Ni00YTM5LTljZTYtMGY0OThhZjY3Y2UwIiwicHJvamVjdCI6ImhlbGxvZnJlc2giLCJuYmYiOjE3MzY1MDk5NzEsImV4cCI6MTc2ODA0NTk3MSwiaWF0IjoxNzM2NTA5OTcxfQ.zPguA84qNygDZNNo5ynSWHyTr4kjIXVDFiCouBGeHFw&email=johan%40izaxon.com&codicent=factor",width:"100%",height:"1300px",style:{border:0}})]}),WE=()=>(0,Yp.jsxs)("div",{className:"hellofresh-container",children:[(0,Yp.jsx)("h1",{className:"hellofresh-header",children:"HelloFresh"}),(0,Yp.jsx)("p",{className:"hellofresh-text",children:"V\xe4lkommen till HelloFresh aktivitet\xb4s logg"}),(0,Yp.jsx)("p",{children:"Siffrorna nedan styrs av agentens anv\xe4ndande av systemet och \xe4r d\xe4rmed inte tillf\xf6rlitligt utan ska endast ses som en fingervisning."}),(0,Yp.jsx)("iframe",{title:"Dashboard",src:"https://codicent.com/html/midsale/embeddeddashboard/index.html?name=MidSale&token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImU2N2ZjMTM0LTMwNzYtNGEzOS05Y2U2LTBmNDk4YWY2N2NlMCIsIm5pY2tuYW1lIjoiQWJlcmciLCJuYW1lIjoiIiwidXNlcklkIjoiZTY3ZmMxMzQtMzA3Ni00YTM5LTljZTYtMGY0OThhZjY3Y2UwIiwicHJvamVjdCI6ImhlbGxvZnJlc2giLCJuYmYiOjE3Mzc0NzA0OTcsImV4cCI6MTc2OTAwNjQ5NywiaWF0IjoxNzM3NDcwNDk3fQ.KufosCLsjjifeCZQEu4Ie4dJUCob0ykd5pEU46s5ZQY&email=johan%40izaxon.com&codicent=hellofresh",width:"100%",height:"1800px",style:{border:0}})]}),GE=()=>{const[e,t]=(0,a.useState)(""),[n,r]=(0,a.useState)(""),[i,s]=(0,a.useState)("");return(0,Yp.jsx)("div",{className:"forgot-password-container",children:(0,Yp.jsxs)("div",{className:"forgot-password-box",children:[(0,Yp.jsx)("h1",{children:"\xc5terst\xe4ll l\xf6senord"}),(0,Yp.jsxs)("form",{onSubmit:async t=>{t.preventDefault(),r(""),s("");try{await async function(e,t,n){const r=Xr(e),a={requestType:"PASSWORD_RESET",email:t,clientType:"CLIENT_TYPE_WEB"};n&&ja(r,a,n),await ra(r,a,"getOobCode",ha)}(Gp,e),r("Ett \xe5terst\xe4llningsmail har skickats. Kontrollera din e-post.")}catch(i){s("Fel vid l\xf6senords\xe5terst\xe4llning: "+i.message)}},children:[(0,Yp.jsx)("label",{htmlFor:"email",children:"E-post"}),(0,Yp.jsx)("input",{type:"email",id:"email",value:e,onChange:e=>t(e.target.value),placeholder:"Ange din e-postadress"}),(0,Yp.jsx)("button",{type:"submit",children:"Skicka"})]}),n&&(0,Yp.jsx)("p",{style:{color:"green"},children:n}),i&&(0,Yp.jsx)("p",{style:{color:"red"},children:i})]})})};const qE=function(){return(0,Yp.jsx)(Zp,{children:(0,Yp.jsx)(Ce,{children:(0,Yp.jsxs)(Te,{children:[(0,Yp.jsx)(we,{path:"/",element:(0,Yp.jsx)(ye,{replace:!0,to:"/login"})}),(0,Yp.jsx)(we,{path:"/login",element:(0,Yp.jsx)(Qp,{})}),(0,Yp.jsx)(we,{path:"/forgot-password",element:(0,Yp.jsx)(GE,{})}),(0,Yp.jsxs)(we,{path:"/",element:(0,Yp.jsx)(um,{}),children:[(0,Yp.jsx)(we,{path:"/admin/dashboard",element:(0,Yp.jsx)(hm,{role:"admin",children:(0,Yp.jsx)(Xp,{})})}),(0,Yp.jsx)(we,{path:"/uppdragsgivare/factor-dashboard",element:(0,Yp.jsx)(hm,{role:"uppdragsgivare",children:(0,Yp.jsx)(HE,{})})}),(0,Yp.jsx)(we,{path:"/uppdragsgivare/hellofresh",element:(0,Yp.jsx)(hm,{role:["user","sales-manager","admin","uppdragsgivare"],children:(0,Yp.jsx)(WE,{})})}),(0,Yp.jsx)(we,{path:"/user/dashboard",element:(0,Yp.jsx)(hm,{role:["user","sales-manager"],children:(0,Yp.jsx)(em,{})})}),(0,Yp.jsx)(we,{path:"/manage-organizations",element:(0,Yp.jsx)(hm,{role:["admin","quality"],children:(0,Yp.jsx)(zE,{})})}),(0,Yp.jsx)(we,{path:"/sales-manager/dashboard",element:(0,Yp.jsx)(hm,{role:"sales-manager",children:(0,Yp.jsx)(tm,{})})}),(0,Yp.jsx)(we,{path:"/quality/dashboard",element:(0,Yp.jsx)(hm,{role:"quality",children:(0,Yp.jsx)(nm,{})})}),(0,Yp.jsx)(we,{path:"/uppdragsgivare/dashboard",element:(0,Yp.jsx)(hm,{role:"uppdragsgivare",children:(0,Yp.jsx)(BE,{})})}),(0,Yp.jsx)(we,{path:"/quality/reporting",element:(0,Yp.jsx)(hm,{role:"quality",children:(0,Yp.jsx)(rm,{})})}),(0,Yp.jsx)(we,{path:"/quality/statistics",element:(0,Yp.jsx)(hm,{role:"quality",children:(0,Yp.jsx)(am,{})})}),(0,Yp.jsx)(we,{path:"/admin/additional-link",element:(0,Yp.jsx)(hm,{role:"admin",children:(0,Yp.jsx)("div",{children:"Admin-specifik l\xe4nk"})})}),(0,Yp.jsx)(we,{path:"/add-user",element:(0,Yp.jsx)(hm,{role:["admin","sales-manager"],children:(0,Yp.jsx)(im,{})})}),(0,Yp.jsx)(we,{path:"/sales-info",element:(0,Yp.jsx)(hm,{role:"admin",children:(0,Yp.jsx)(sm,{})})}),(0,Yp.jsx)(we,{path:"/sales-specification",element:(0,Yp.jsx)(hm,{role:"admin",children:(0,Yp.jsx)(om,{})})}),(0,Yp.jsx)(we,{path:"/user/sales-specification",element:(0,Yp.jsx)(hm,{role:["user","sales-manager"],children:(0,Yp.jsx)(lm,{})})}),(0,Yp.jsx)(we,{path:"/profile",element:(0,Yp.jsx)(hm,{role:["user","sales-manager","admin","quality","uppdragsgivare"],children:(0,Yp.jsx)(cm,{})})}),(0,Yp.jsx)(we,{path:"/admin/manage-users",element:(0,Yp.jsx)(hm,{role:"admin",children:(0,Yp.jsx)(DE,{})})}),(0,Yp.jsx)(we,{path:"/sales-manager/manage-users",element:(0,Yp.jsx)(hm,{role:"sales-manager",children:(0,Yp.jsx)(jE,{})})}),(0,Yp.jsx)(we,{path:"/user-profile/:id",element:(0,Yp.jsx)(hm,{role:["admin","sales-manager"],children:(0,Yp.jsx)(cm,{})})}),(0,Yp.jsx)(we,{path:"/admin/salary-statistics",element:(0,Yp.jsx)(hm,{role:"admin",children:(0,Yp.jsx)(PE,{})})}),(0,Yp.jsx)(we,{path:"/sales-manager/final-report",element:(0,Yp.jsx)(hm,{role:"sales-manager",children:(0,Yp.jsx)(LE,{})})}),(0,Yp.jsx)(we,{path:"/admin/statistics",element:(0,Yp.jsx)(hm,{role:"admin",children:(0,Yp.jsx)(FE,{})})}),(0,Yp.jsx)(we,{path:"/sales-manager/statistics",element:(0,Yp.jsx)(hm,{role:"sales-manager",children:(0,Yp.jsx)(UE,{})})}),(0,Yp.jsx)(we,{path:"/user/statistics",element:(0,Yp.jsx)(hm,{role:"user",children:(0,Yp.jsx)(VE,{})})})]}),(0,Yp.jsx)(we,{path:"/unauthorized",element:(0,Yp.jsx)("div",{children:"Unauthorized Access"})}),(0,Yp.jsx)(we,{path:"*",element:(0,Yp.jsx)("div",{children:"404 - Page not found"})})]})})})},KE=e=>{e&&e instanceof Function&&n.e(453).then(n.bind(n,453)).then((t=>{let{getCLS:n,getFID:r,getFCP:a,getLCP:i,getTTFB:s}=t;n(e),r(e),a(e),i(e),s(e)}))};s.createRoot(document.getElementById("root")).render((0,Yp.jsx)(a.StrictMode,{children:(0,Yp.jsx)(Zp,{children:(0,Yp.jsx)(qE,{})})})),KE()})();
//# sourceMappingURL=main.4c477c8c.js.map